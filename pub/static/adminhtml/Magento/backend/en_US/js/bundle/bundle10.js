require.config({"config": {
        "jsbuild":{"Nwdthemes_Revslider/admin/assets/js/source/edit_layers.js":"define(\r\n    'editLayers',\r\n    ['jquery', 'tpColorPicker', 'themepunchTools', 'loading', 'wpUtil', 'perfectScrollbar', 'contextMenu', 'admin', 'editLayersTimeline', 'settings', 'cssEditor'],\r\n    function(jQuery, tpColorPicker, punchgs, showWaitAMinute, wpUtil, perfectScrollbar, tpLayerContextMenu, UniteAdminRev, tpLayerTimelinesRev, RevSliderSettings, UniteCssEditorRev) {\r\n\r\n        /*!\r\n         * VERSION: beta 0.2.3\r\n         * DATE: 2013-07-10\r\n         * UPDATES AND DOCS AT: http://www.greensock.com\r\n         *\r\n         * @license Copyright (c) 2008-2013, GreenSock. All rights reserved.\r\n         * SplitText is a Club GreenSock membership benefit; You must have a valid membership to use\r\n         * this code without violating the terms of use. Visit http://www.greensock.com/club/ to sign up or get more details.\r\n         * This work is subject to the software agreement that was issued with your membership.\r\n         *\r\n         * @author: Jack Doyle, jack@greensock.com\r\n         */\r\n        (function(t){\"use strict\";var e=t.GreenSockGlobals||t,i=function(t){var i,s=t.split(\".\"),r=e;for(i=0;s.length>i;i++)r[s[i]]=r=r[s[i]]||{};return r},s=i(\"com.greensock.utils\"),r=function(t){var e=t.nodeType,i=\"\";if(1===e||9===e||11===e){if(\"string\"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=r(t)}else if(3===e||4===e)return t.nodeValue;return i},n=document,a=n.defaultView?n.defaultView.getComputedStyle:function(){},o=/([A-Z])/g,h=function(t,e,i,s){var r;return(i=i||a(t,null))?(t=i.getPropertyValue(e.replace(o,\"-$1\").toLowerCase()),r=t||i.length?t:i[e]):t.currentStyle&&(i=t.currentStyle,r=i[e]),s?r:parseInt(r,10)||0},l=function(t){return t.length&&t[0]&&(t[0].nodeType&&t[0].style&&!t.nodeType||t[0].length&&t[0][0])?!0:!1},_=function(t){var e,i,s,r=[],n=t.length;for(e=0;n>e;e++)if(i=t[e],l(i))for(s=i.length,s=0;i.length>s;s++)r.push(i[s]);else r.push(i);return r},u=\")eefec303079ad17405c\",c=/(?:<br>|<br\\/>|<br \\/>)/gi,p=n.all&&!n.addEventListener,f=\"<div style='position:relative;display:inline-block;\"+(p?\"*display:inline;*zoom:1;'\":\"'\"),m=function(t){t=t||\"\";var e=-1!==t.indexOf(\"++\"),i=1;return e&&(t=t.split(\"++\").join(\"\")),function(){return f+(t?\" class='\"+t+(e?i++:\"\")+\"'>\":\">\")}},d=s.SplitText=e.SplitText=function(t,e){if(\"string\"==typeof t&&(t=d.selector(t)),!t)throw\"cannot split a null element.\";this.elements=l(t)?_(t):[t],this.chars=[],this.words=[],this.lines=[],this._originals=[],this.vars=e||{},this.split(e)},g=function(t,e,i,s,o){c.test(t.innerHTML)&&(t.innerHTML=t.innerHTML.replace(c,u));var l,_,p,f,d,g,v,y,T,w,b,x,P,S=r(t),C=e.type||e.split||\"chars,words,lines\",k=-1!==C.indexOf(\"lines\")?[]:null,R=-1!==C.indexOf(\"words\"),A=-1!==C.indexOf(\"chars\"),D=\"absolute\"===e.position||e.absolute===!0,O=D?\"&#173; \":\" \",M=-999,L=a(t),I=h(t,\"paddingLeft\",L),E=h(t,\"borderBottomWidth\",L)+h(t,\"borderTopWidth\",L),N=h(t,\"borderLeftWidth\",L)+h(t,\"borderRightWidth\",L),F=h(t,\"paddingTop\",L)+h(t,\"paddingBottom\",L),U=h(t,\"paddingLeft\",L)+h(t,\"paddingRight\",L),X=h(t,\"textAlign\",L,!0),z=t.clientHeight,B=t.clientWidth,j=S.length,Y=\"</div>\",q=m(e.wordsClass),V=m(e.charsClass),Q=-1!==(e.linesClass||\"\").indexOf(\"++\"),G=e.linesClass;for(Q&&(G=G.split(\"++\").join(\"\")),p=q(),f=0;j>f;f++)g=S.charAt(f),\")\"===g&&S.substr(f,20)===u?(p+=Y+\"<BR/>\",f!==j-1&&(p+=\" \"+q()),f+=19):\" \"===g&&\" \"!==S.charAt(f-1)&&f!==j-1?(p+=Y,f!==j-1&&(p+=O+q())):p+=A&&\" \"!==g?V()+g+\"</div>\":g;for(t.innerHTML=p+Y,d=t.getElementsByTagName(\"*\"),j=d.length,v=[],f=0;j>f;f++)v[f]=d[f];if(k||D)for(f=0;j>f;f++)y=v[f],_=y.parentNode===t,(_||D||A&&!R)&&(T=y.offsetTop,k&&_&&T!==M&&\"BR\"!==y.nodeName&&(l=[],k.push(l),M=T),D&&(y._x=y.offsetLeft,y._y=T,y._w=y.offsetWidth,y._h=y.offsetHeight),k&&(R!==_&&A||(l.push(y),y._x-=I),_&&f&&(v[f-1]._wordEnd=!0)));for(f=0;j>f;f++)y=v[f],_=y.parentNode===t,\"BR\"!==y.nodeName?(D&&(b=y.style,R||_||(y._x+=y.parentNode._x,y._y+=y.parentNode._y),b.left=y._x+\"px\",b.top=y._y+\"px\",b.position=\"absolute\",b.display=\"block\",b.width=y._w+1+\"px\",b.height=y._h+\"px\"),R?_?s.push(y):A&&i.push(y):_?(t.removeChild(y),v.splice(f--,1),j--):!_&&A&&(T=!k&&!D&&y.nextSibling,t.appendChild(y),T||t.appendChild(n.createTextNode(\" \")),i.push(y))):k||D?(t.removeChild(y),v.splice(f--,1),j--):R||t.appendChild(y);if(k){for(D&&(w=n.createElement(\"div\"),t.appendChild(w),x=w.offsetWidth+\"px\",T=w.offsetParent===t?0:t.offsetLeft,t.removeChild(w)),b=t.style.cssText,t.style.cssText=\"display:none;\";t.firstChild;)t.removeChild(t.firstChild);for(P=!D||!R&&!A,f=0;k.length>f;f++){for(l=k[f],w=n.createElement(\"div\"),w.style.cssText=\"display:block;text-align:\"+X+\";position:\"+(D?\"absolute;\":\"relative;\"),G&&(w.className=G+(Q?f+1:\"\")),o.push(w),j=l.length,d=0;j>d;d++)\"BR\"!==l[d].nodeName&&(y=l[d],w.appendChild(y),P&&(y._wordEnd||R)&&w.appendChild(n.createTextNode(\" \")),D&&(0===d&&(w.style.top=y._y+\"px\",w.style.left=I+T+\"px\"),y.style.top=\"0px\",T&&(y.style.left=y._x-T+\"px\")));R||A||(w.innerHTML=r(w).split(String.fromCharCode(160)).join(\" \")),D&&(w.style.width=x,w.style.height=y._h+\"px\"),t.appendChild(w)}t.style.cssText=b}D&&(z>t.clientHeight&&(t.style.height=z-F+\"px\",z>t.clientHeight&&(t.style.height=z+E+\"px\")),B>t.clientWidth&&(t.style.width=B-U+\"px\",B>t.clientWidth&&(t.style.width=B+N+\"px\")))},v=d.prototype;v.split=function(t){this.isSplit&&this.revert(),this.vars=t||this.vars,this._originals.length=this.chars.length=this.words.length=this.lines.length=0;for(var e=0;this.elements.length>e;e++)this._originals[e]=this.elements[e].innerHTML,g(this.elements[e],this.vars,this.chars,this.words,this.lines);return this.isSplit=!0,this},v.revert=function(){if(!this._originals)throw\"revert() call wasn't scoped properly.\";for(var t=this._originals.length;--t>-1;)this.elements[t].innerHTML=this._originals[t];return this.chars=[],this.words=[],this.lines=[],this.isSplit=!1,this},d.selector=t.$||t.jQuery||function(e){return t.$?(d.selector=t.$,t.$(e)):n?n.getElementById(\"#\"===e.charAt(0)?e.substr(1):e):e}})(window||{});\r\n\r\n\r\n        /*! ROTATABLE */\r\n        // ROTATABLE\r\n        //\r\n        !function(t,e){t.widget(\"ui.rotatable\",t.ui.mouse,{options:{handle:!1,angle:!1,start:null,rotate:null,stop:null},handle:function(t){return t===e?this.options.handle:void(this.options.handle=t)},angle:function(t){return t===e?this.options.angle:(this.options.angle=t,void this.performRotation(this.options.angle))},_create:function(){var e;this.options.handle?e=this.options.handle:(e=t(document.createElement(\"div\")),e.addClass(\"ui-rotatable-handle\")),this.listeners={rotateElement:t.proxy(this.rotateElement,this),startRotate:t.proxy(this.startRotate,this),stopRotate:t.proxy(this.stopRotate,this)},e.draggable({helper:\"clone\",start:this.dragStart,handle:e}),e.bind(\"mousedown\",this.listeners.startRotate),e.appendTo(this.element),0!=this.options.angle?(this.elementCurrentAngle=this.options.angle,this.performRotation(this.elementCurrentAngle)):this.elementCurrentAngle=0},_destroy:function(){this.element.removeClass(\"ui-rotatable\"),this.element.find(\".ui-rotatable-handle\").remove()},performRotation:function(t){var e=180*t/Math.PI;punchgs.TweenLite.set(this.element,{rotationZ:e+\"deg\"})},getElementOffset:function(){this.performRotation(0);var t=this.element.offset();return this.performRotation(this.elementCurrentAngle),t},getElementCenter:function(){var t=this.getElementOffset(),e=t.left+this.element.width()/2,n=t.top+this.element.height()/2;return Array(e,n)},dragStart:function(){return this.element?!1:void 0},startRotate:function(e){var n=this.getElementCenter(),i=e.pageX-n[0],s=e.pageY-n[1];return this.mouseStartAngle=Math.atan2(s,i),this.elementStartAngle=this.elementCurrentAngle,this.hasRotated=!1,this._propagate(\"start\",e),t(document).bind(\"mousemove\",this.listeners.rotateElement),t(document).bind(\"mouseup\",this.listeners.stopRotate),!1},rotateElement:function(t){if(!this.element)return!1;var e=this.getElementCenter(),n=t.pageX-e[0],i=t.pageY-e[1],s=Math.atan2(i,n),o=s-this.mouseStartAngle+this.elementStartAngle;this.performRotation(o);var r=this.elementCurrentAngle;return this.elementCurrentAngle=o,this._propagate(\"rotate\",t),r!=o&&(this._trigger(\"rotate\",t,this.ui()),this.hasRotated=!0),!1},stopRotate:function(e){return this.element?(t(document).unbind(\"mousemove\",this.listeners.rotateElement),t(document).unbind(\"mouseup\",this.listeners.stopRotate),this.elementStopAngle=this.elementCurrentAngle,this.hasRotated&&this._propagate(\"stop\",e),setTimeout(function(){this.element=!1},10),!1):void 0},_propagate:function(e,n){t.ui.plugin.call(this,e,[n,this.ui()]),\"rotate\"!==e&&this._trigger(e,n,this.ui())},plugins:{},ui:function(){return{element:this.element,angle:{start:this.elementStartAngle,current:this.elementCurrentAngle,stop:this.elementStopAngle}}}})}(jQuery);\r\n\r\n        jQuery(document).ready(function(){\r\n            jQuery.widget( \"custom.catcomplete\", jQuery.ui.autocomplete, {\r\n                _create: function() {\r\n                    this._super();\r\n                    this.widget().menu( \"option\", \"items\", \"> :not(.ui-autocomplete-category)\" );\r\n                },\r\n                _renderMenu: function( ul, items ) {\r\n                    var that = this,\r\n                        currentCategory = \"\";\r\n                    if (items){\r\n                        jQuery.each( items, function( index, item ) {\r\n                            var li;\r\n                            if ( item.version != currentCategory ) {\r\n                                if (ul.closest(\"#tp-thelistoffonts\").length>0)\r\n                                    ul.append( \"<li class='ui-autocomplete-category' style='font-size: 24px;'>\" + item.version + \"</li>\" );\r\n                                else\r\n                                    ul.append( \"<li class='ui-autocomplete-category' style='font-size: 24px;'>Version: \" + item.version + \"</li>\" );\r\n                                currentCategory = item.version;\r\n                            }\r\n                            li = that._renderItemData( ul, item );\r\n                            if ( item.version ) {\r\n                                li.attr( \"aria-label\", item.version + \" : \" + item.label );\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                }\r\n            });\r\n\r\n        });\r\n\r\n\r\n        // Color Picker Presets\r\n        jQuery(document).ready(function() {\r\n\r\n            if(typeof tp_color_picker_presets === 'undefined' || !tp_color_picker_presets) {\r\n                tp_color_picker_presets = {colors: [], gradients: []};\r\n            }\r\n\r\n            if(!tp_color_picker_presets.colors) tp_color_picker_presets.colors = [];\r\n            if(!tp_color_picker_presets.gradients) tp_color_picker_presets.gradients = [];\r\n\r\n            jQuery.tpColorPicker({\r\n\r\n                /* core: {colors: [], gradients: []}, */\r\n                custom: tp_color_picker_presets,\r\n                onAjax: function(action, data, colorType, eventToTrigger, currentInputElement) {\r\n\r\n                    var do_save = false,\r\n                        colors = tp_color_picker_presets[colorType];\r\n\r\n                    switch(action) {\r\n                        case 'save':\r\n                            colors[colors.length] = data;\r\n                            do_save = true;\r\n                            break;\r\n\r\n                        case 'delete':\r\n                            var len = colors.length;\r\n                            for(var i = 0; i < len; i++) {\r\n                                for(var prop in colors[i]) {\r\n                                    if(prop === data) colors.splice(i, 1);\r\n                                }\r\n                            }\r\n                            do_save = true;\r\n                            break;\r\n                    }\r\n\r\n                    if(do_save){\r\n                        UniteAdminRev.ajaxRequest('save_color_preset', {'presets': tp_color_picker_presets}, function(response){\r\n                            var e = response.error || false;\r\n                            jQuery(document).trigger(eventToTrigger, [e]);\r\n                        });\r\n                    }\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n\r\n        // EDIT Slider Functions\r\n        // VERSION: 5.0\r\n        // DATE: 28-04-2015\r\n        var UniteLayersRev = new function(){\r\n\r\n            var initTop = 100,\r\n                initLeft = 100,\r\n                initSpeed = 300,\r\n\r\n                initTopVideo = 20,\r\n                initLeftVideo = 20,\r\n                g_startTime = 500,\r\n                g_stepTime = 0,\r\n                g_slideTime,\r\n\r\n\r\n                initText = \"Caption Text\",\r\n                initGroupName = \"Group\",\r\n                initRowName = \"Row\",\r\n                initColumnName = \"Column\",\r\n                layout = 'desktop', //can be also tablet and mobil\r\n                transSettings = [],\r\n\r\n                t = this,\r\n                u = tpLayerTimelinesRev,\r\n                cm = tpLayerContextMenu,\r\n\r\n                initArrFontTypes = [],\r\n                containerID = \"#divLayers\",\r\n                container,\r\n\r\n                update_layer_changes = true,\r\n                id_counter = 0,\r\n                initLayers = null,\r\n                initDemoLayers = null,\r\n                initStaticLayers = [], //only used in non static slides, to show static slides in the action tab\r\n                initDemoSettings = null,\r\n                layerresized = false,\r\n                layerGeneralParamsStatus = false,\r\n                initLayerAnims = [],\r\n                initLayerAnimsDefault = [],\r\n                currentAnimationType = 'customin',\r\n                curDemoSlideID = 0,\r\n                slideIDs = {},\r\n\r\n                alluniqueids = [],\r\n\r\n                selectedLayerWidth = 0,\r\n                selectedlayerHeight = 0,\r\n\r\n                totalWidth = 0,\r\n                totalHeight = 0,\r\n                unique_layer_id = 0,\r\n                global_action_template = null,\r\n                global_layer_import_template = null,\r\n                updateRevTimer = 0,\r\n                updateRevChange = 0,\r\n                save_needed = false,\r\n                import_slides = {},\r\n                lastchangedinput = \"\";\r\n\r\n            // LAYER VERSION NUMBER FOR CLEAN OUTPUT IN FRONTEND\r\n            t.core = 5;\r\n            t.sub = 3;\r\n            t.subsub = 0;\r\n\r\n            t.newlayercoord = {x:-1,y:-1};\r\n\r\n            u.layout = layout;\r\n\r\n            t.groupMove = {x:0, y:0};\r\n            t.selectedLayerSerial = -1;\r\n            t.selectedLayers = new Array();\r\n            t.justDropped = false;\r\n\r\n            t.arrLayers = {};\r\n            t.arrLayersClone = {};\r\n\r\n            t.arrLayersDemo = {};\r\n            t.arrLayersChanges = {undo:[], redo:[]};\r\n\r\n            t.ignorAllUndoRedoLogs = false;\r\n\r\n            t.attributegroups = [\r\n                { id:\"0\",icon:\"move\", groupname:\"Layer Position\", keys:[\"left.desktop\", \"top.desktop\", \"align_hor.desktop\", \"align_vert.desktop\", \"left.notebook\", \"top.notebook\", \"align_hor.notebook\", \"align_vert.notebook\", \"left.tablet\", \"top.tablet\", \"align_hor.tablet\", \"align_vert.tablet\", \"left.mobile\", \"top.mobile\", \"align_hor.mobile\", \"align_vert.mobile\"]},\r\n                { id:\"1\",icon:\"play\", groupname:\"Start Animation\", keys:[\"x_rotate_start\",\"x_rotate_start_reverse\",\"x_start\",\"x_start_reverse\",\"y_rotate_start\",\"y_rotate_start_reverse\",\"y_start\",\"y_start_reverse\",\"z_rotate_start\",\"z_rotate_start_reverse\",\"z_start\"]},\r\n                { id:\"2\",icon:\"play\", groupname:\"End Animation\", keys:[\"x_end\",\"x_end_reverse\",\"x_origin_end\",\"x_rotate_end\",\"x_rotate_end_reverse\",\"y_end\",\"y_end_reverse\",\"y_rotate_end\",\"y_rotate_end_reverse\",\"z_end\",\"z_rotate_end\",\"z_rotate_end_reverse\"]},\r\n                { id:\"31\",icon:\"play\", groupname:\"Frames\", keys:[\"splitdelay\",\"animation\",\"split\",\"split_extratime\",\"relative_time\",\"easing\",\"speed\",\"time\"]},\r\n                { id:\"3\",icon:\"play\", groupname:\"Loop Animation\", keys:[\"loop_angle\",\"loop_animation\",\"loop_easing\",\"loop_enddeg\",\"loop_radius\",\"loop_speed\",\"loop_startdeg\",\"loop_xend\",\"loop_xorigin\",\"loop_xstart\",\"loop_yend\",\"loop_yorigin\",\"loop_ystart\",\"loop_zoomend\",\"loop_zoomstart\"]},\r\n                { id:\"4\",icon:\"play\", groupname:\"Mask Animation\", keys:[\"mask_ease_end\",\"mask_ease_start\",\"mask_end\",\"mask_speed_end\",\"mask_speed_start\",\"mask_start\",\"mask_x_end\",\"mask_x_end_reverse\",\"mask_x_start\",\"mask_x_start_reverse\",\"mask_y_end\",\"mask_y_end_reverse\",\"mask_y_start\",\"mask_y_start_reverse\"]},\r\n                { id:\"5\",icon:\"font\", groupname:\"Formatting\", keys:[\"displaymode.desktop\",\"displaymode.notebook\",\"displaymode.tablet\",\"displaymode.mobile\",\"autolinebreak\",\"whitespace.desktop\",\"whitespace.notebook\",\"whitespace.tablet\",\"whitespace.mobile\",\"html_tag\",\"layer-selectable\"]},\r\n                { id:\"6\",icon:\"cog\", groupname:\"Behavior\", keys:[\"basealign\",\"lazy-load\",\"resizeme\",\"resize-full\",\"responsive_offset\"]},\r\n                { id:\"7\",icon:\"eye\", groupname:\"Visibilty\", keys:[\"hiddenunder\",\"visible-desktop\",\"visible-notebook\",\"visible-tablet\",\"visible-mobile\",\"show-on-hover\"]},\r\n                { id:\"8\",icon:\"resize-full\", groupname:\"Sizing\", keys:[\"scaleProportional\",\"video_data.fullwidth\", \"video_data.cover\", \"originalWidth\",\"originalHeight\",\"cover_mode\",\"height\",\"width\",\"image-size\",\"video_height.desktop\",\"video_height.notebook\",\"video_height.tablet\",\"video_height.mobile\",\"video_width.desktop\",\"video_width.notebook\",\"video_width.tablet\",\"video_width.mobile\",\"max_height.desktop\",\"max_height.notebook\",\"max_height.tablet\",\"max_height.mobile\",\"min_height.desktop\",\"min_height.notebook\",\"min_height.tablet\",\"min_height.mobile\",\"max_width.desktop\",\"max_width.notebook\",\"max_width.tablet\",\"max_width.mobile\",\"scaleX.desktop\",\"scaleX.notebook\",\"scaleX.tablet\",\"scaleX.mobile\",\"scaleY.desktop\",\"scaleY.notebook\",\"scaleY.tablet\",\"scaleY.mobile\"]},\r\n                { id:\"9\",icon:\"font\", groupname:\"Naming and Alias\", keys:[\"text\",\"alias\"]},\r\n\r\n                { id:\"30\",icon:\"resize-vertical\", groupname:\"Order\", keys:[\"order\", \"p_uid\"]},\r\n\r\n                { id:\"10\",icon:\"cancel\", groupname:\"Deleted\", keys:[\"deleted\"]},\r\n                { id:\"11\",icon:\"plus\", groupname:\"Created\", keys:[\"layer_unavailable\"]},\r\n                { id:\"12\",icon:\"link\", groupname:\"Source\", keys:[\"svg.src\",\"image_url\"]},\r\n                { id:\"13\",icon:\"star\", groupname:\"SVG Style\", keys:[\"svg.svgstroke-color\",\"svg.svgstroke-dasharray\",\"svg.svgstroke-dashoffset\",\"svg.svgstroke-width\",\"svg.svgstroke-hover-color\",\"svg.svgstroke-hover-dasharray\",\"svg.svgstroke-hover-dashoffset\",\"svg.svgstroke-hover-transparency\",\"svg.svgstroke-hover-width\"]},\r\n                { id:\"14\",icon:\"palette\", groupname:\"Main Styling\", keys:[\"static_styles.color.desktop\",\"static_styles.color.notebook\",\"static_styles.color.tablet\",\"static_styles.color.mobile\",\"static_styles.font-size.desktop\",\"static_styles.font-size.notebook\",\"static_styles.font-size.tablet\",\"static_styles.font-size.mobile\",\"static_styles.font-weight.desktop\",\"static_styles.font-weight.notebook\",\"static_styles.font-weight.tablet\",\"static_styles.font-weight.mobile\",\"static_styles.line-height.desktop\",\"static_styles.line-height.notebook\",\"static_styles.line-height.tablet\",\"static_styles.line-height.mobile\"]},\r\n\r\n                { id:\"15\",icon:\"thumbs-up\", groupname:\"Layer Action\", keys:[\"layer_action\",\"layer_action.action\",\"layer_action.action_delay\",\"layer_action.actioncallback\",\"layer_action.image_link\",\"layer_action.jump_to_slide\",\"layer_action.jump_to_slide\",\"layer_action.link_open_in\",\"layer_action.link_type\",\"layer_action.scrollunder_offset\",\"layer_action.toggle_class\",\"layer_action.toggle_layer_type\",\"layer_action.tooltip_event\"]},\r\n\r\n\r\n                { id:\"16\",icon:\"droplet\", groupname:\"Styling Text\", keys:[\"deformation.color-transparency\",\"deformation.font-family\",\"deformation.font-style\",\"deformation.opacity\",\"deformation.text-align\",\"deformation.vertical-align\",\"deformation.display\",\"deformation.text-decoration\"]},\r\n                { id:\"17\",icon:\"droplet\", groupname:\"Styling Padding\", keys:[\"deformation.padding\",\"deformation.padding.0\",\"deformation.padding.1\",\"deformation.padding.2\",\"deformation.padding.3\"]},\r\n                { id:\"17\",icon:\"droplet\", groupname:\"Styling Margin\", keys:[\"margin.desktop\",\"margin.notebook\",\"margin.tablet\",\"margin.mobile\"]},\r\n                { id:\"18\",icon:\"droplet\", groupname:\"Styling Corners\", keys:[\"deformation.corner_left\",\"deformation.corner_right\"]},\r\n                { id:\"19\",icon:\"droplet\", groupname:\"Styling Background\", keys:[\"deformation.background-color\",\"deformation.background-transparency\"]},\r\n                { id:\"20\",icon:\"droplet\", groupname:\"Styling Border\", keys:[\"deformation.border-color\",\"deformation.border-radius.0\",\"deformation.border-radius.1\",\"deformation.border-radius.2\",\"deformation.border-radius.3\",\"deformation.border-style\",\"deformation.border-transparency\",\"deformation.border-width\"]},\r\n                { id:\"21\",icon:\"droplet\", groupname:\"Styling Transforms\", keys:[\"deformation.2d_origin_x\",\"deformation.2d_origin_y\",\"deformation.parallax\",\"deformation.pers\",\"deformation.scalex\",\"deformation.scaley\",\"deformation.skewx\",\"deformation.skewy\",\"deformation.text-transform\",\"deformation.x\",\"deformation.xrotate\",\"deformation.y\",\"deformation.yrotate\",\"deformation.z\"]},\r\n\r\n                { id:\"22\",icon:\"droplet\", groupname:\"Styling Hover\", keys:[\"hover\",\"deformation-hover.css_cursor\",\"deformation-hover.easing\"]},\r\n                { id:\"23\",icon:\"droplet\", groupname:\"Styling Hover Text\", keys:[\"deformation-hover.color\",\"deformation-hover.color-transparency\",\"deformation-hover.font-family\",\"deformation-hover.font-style\",\"deformation-hover.opacity\",\"deformation-hover.text-align\",\"deformation-hover.vertical-align\",\"deformation-hover.text-decoration\"]},\r\n                { id:\"24\",icon:\"droplet\", groupname:\"Styling Hover Padding\", keys:[\"deformation-hover.padding\",\"deformation-hover.padding.0\",\"deformation-hover.padding.1\",\"deformation-hover.padding.2\",\"deformation-hover.padding.3\"]},\r\n                { id:\"24\",icon:\"droplet\", groupname:\"Styling Hover Margin\", keys:[\"deformation-hover.margin\",\"deformation-hover.margin.0\",\"deformation-hover.margin.1\",\"deformation-hover.margin.2\",\"deformation-hover.margin.3\"]},\r\n                { id:\"25\",icon:\"droplet\", groupname:\"Styling Hover Corners\", keys:[\"deformation-hover.corner_left\",\"deformation-hover.corner_right\"]},\r\n                { id:\"26\",icon:\"droplet\", groupname:\"Styling Hover Background\", keys:[\"deformation-hover.background-color\",\"deformation-hover.background-transparency\"]},\r\n                { id:\"27\",icon:\"droplet\", groupname:\"Styling Hover Border\", keys:[\"deformation-hover.border-color\",\"deformation-hover.border-radius.0\",\"deformation-hover.border-radius.1\",\"deformation-hover.border-radius.2\",\"deformation-hover.border-radius.3\",\"deformation-hover.border-style\",\"deformation-hover.border-transparency\",\"deformation-hover.border-width\"]},\r\n                { id:\"28\",icon:\"droplet\", groupname:\"Styling Hover Transforms\", keys:[\"deformation-hover.2d_origin_x\",\"deformation-hover.2d_origin_y\",\"deformation-hover.parallax\",\"deformation-hover.pers\",\"deformation-hover.scalex\",\"deformation-hover.scaley\",\"deformation-hover.skewx\",\"deformation-hover.skewy\",\"deformation-hover.text-transform\",\"deformation-hover.x\",\"deformation-hover.xrotate\",\"deformation-hover.y\",\"deformation-hover.yrotate\",\"deformation-hover.z\"]},\r\n                { id:\"29\",icon:\"video\",   groupname:\"Video/Audo Settings\", keys:[\"video_data.urlAudio\",\"video_data.previewimage\",\"video_data.link\",\"video_data.thumb_medium.url\", \"video_type\",\"video_data.id\",\"video_data.video_type\",\"video_data.title\",\"video_data.author\",\"video_data.description\", \"video_data.args\",\"video_data.autoplay\",\"video_data.nextslide\",\"video_data.forcerewind\",\"video_data.controls\",\"video_data.mute\",\"video_data.stopallvideo\",\"video_data.allowfullscreen\",\"video_data.videoloop\",\"video_data.show_cover_pause\",\"video_data.start_at\",\"video_data.end_at\",\"video_data.volume\",\"video_data.desc_small\",\"video_data.thumb_small.url\",\"video_data.thumb_small.width\",\"video_data.thumb_small.height\",\"video_data.thumb_medium.width\",\"video_data.thumb_medium.height\",\"video_data.video_height\"]},\r\n                { id:\"30\",icon:\"droplet\", groupname:\"Styling Hover Pointer Events\", keys:[\"deformation-hover.pointer_events\"]}\r\n        \r\n            ];\r\n\r\n\r\n\r\n            t.addon_callbacks = [];     // Array of Callbacks.  { callback: function,  parameters: [ internalpar, par1, par2, par3]}\r\n\r\n\r\n\r\n\r\n            t.set_save_needed = function(setto){\r\n\r\n                save_needed = setto;\r\n            }\r\n\r\n            t.ulff_core = 0;\r\n\r\n            t.setGlobalAction = function (glfunc){\r\n                global_action_template = glfunc;\r\n            }\r\n            t.setGlobalSlideImport = function (glfunc){\r\n                global_layer_import_template = glfunc;\r\n            }\r\n\r\n\r\n            t.getLayout = function() {\r\n                return layout;\r\n            }\r\n\r\n            t.setInitSlideIds = function(jsonIds){ slideIDs = jQuery.parseJSON(jsonIds); }\r\n\r\n            // set init layers object (from db)\r\n            t.setInitLayersJson = function(jsonLayers){ initLayers = jQuery.parseJSON(jsonLayers); }\r\n\r\n            // set init static layers object in non static slides, for the usage of actions (from db)\r\n            t.setInitStaticLayersJson = function(jsonLayers){ initStaticLayers = jQuery.parseJSON(jsonLayers); }\r\n\r\n            // set init demo layers object (from db)\r\n            t.setInitDemoLayersJson = function(jsonLayers){ initDemoLayers = jQuery.parseJSON(jsonLayers); }\r\n\r\n            // set init demo settings object (from db)\r\n            t.setInitDemoSettingsJson = function(jsonLayers){ initDemoSettings = jQuery.parseJSON(jsonLayers); }\r\n\r\n            // set init layer animations (from db)\r\n            t.setInitLayerAnim = function(jsonLayersAnims){ initLayerAnims = jQuery.parseJSON(jsonLayersAnims); }\r\n\r\n            // set init layer animations (from db)\r\n            t.setInitLayerAnimsDefault = function(jsonLayersAnims){ initLayerAnimsDefault = jQuery.parseJSON(jsonLayersAnims); }\r\n\r\n            // set all settings that need trans\r\n            t.setInitTransSetting = function(jsonTransSett){ transSettings = jQuery.parseJSON(jsonTransSett); }\r\n\r\n            // update init layer animations (from db)\r\n            t.updateInitLayerAnim = function(layerAnims){\r\n                initLayerAnims = [];\r\n                initLayerAnims = layerAnims;\r\n            }\r\n\r\n            // set init captions classes array (from the captions.css)\r\n            t.setInitCaptionClasses = function(jsonClasses){ initArrCaptionClasses = jQuery.parseJSON(jsonClasses); }\r\n\r\n            t.setCaptionClasses = function(objClasses){ initArrCaptionClasses = objClasses; }\r\n\r\n            // set init font family types array\r\n            t.setInitFontTypes = function(jsonClasses){ initArrFontTypes = jQuery.parseJSON(jsonClasses); }\r\n\r\n            // GET / SET MAIN TIME\r\n            t.getMaintime = function() { return g_slideTime; }\r\n            t.setMaintime = function(a) { g_slideTime = a; }\r\n\r\n            // GET OBJECT LENGTH\r\n            t.getObjectLength = function(obj) {\r\n                var i = 0;\r\n                for (var a in obj) if (obj.hasOwnProperty(a)) {\r\n                    i++;\r\n                }\r\n                return i;\r\n            }\r\n\r\n\r\n            t.sortFontTypesByUsage = function(){\r\n                for(var skey in sgfamilies) if (sgfamilies.hasOwnProperty(skey)) {\r\n                    for(var key in initArrFontTypes) if (initArrFontTypes.hasOwnProperty(key)) {\r\n                        if (initArrFontTypes[key]!==undefined && initArrFontTypes[key]['label']!==undefined && sgfamilies[skey]!==undefined)\r\n                            if(initArrFontTypes[key]['label'].replace(/\\ /g,'+') == sgfamilies[skey].replace(/\\ /g,'+')){\r\n                                //add to front\r\n                                if(typeof(initArrFontTypes[key]['top']) == 'undefined'){ //push to top and define top\r\n                                    initArrFontTypes[key]['top'] = true;\r\n                                    //initArrFontTypes[key]['version'] = rev_lang.google_fonts_loaded;\r\n                                }\r\n                                break;\r\n                            }\r\n                    }\r\n                }\r\n\r\n                //reorder the keys from 1 to xxx\r\n                var items = {};\r\n                var i = 0;\r\n                for(var index in initArrFontTypes) if (initArrFontTypes.hasOwnProperty(index)) {\r\n                    items[i] = initArrFontTypes[index];\r\n                    i++;\r\n                }\r\n                initArrFontTypes = items;\r\n\r\n\r\n                //reinitialize the catcomplete on the field!\r\n                //jQuery(\"#css_font-family\").catcomplete(\"option\",\"source\",initArrFontTypes);\r\n\r\n            }\r\n\r\n            /**\r\n             * SET option to object depending on which size is choosen\r\n             */\r\n            t.setVal = function(obj, handle, val, setall, setspecific,set_all_force){\r\n                if(jQuery.inArray(handle, transSettings) !== -1){ //handle is in the list, so save only on the current choosen size\r\n\r\n                    if(setall){\r\n                        if(typeof(obj[handle]) !== 'object') obj[handle] = {};\r\n                        if (set_all_force==undefined || set_all_force==false) {\r\n                            obj[handle][layout] = val;\r\n                        } else {\r\n                            obj[handle]['desktop'] = val;\r\n                            obj[handle]['notebook'] = val;\r\n                            obj[handle]['tablet'] = val;\r\n                            obj[handle]['mobile'] = val;\r\n                        }\r\n                    }else if(setspecific !== undefined && setspecific!==null){\r\n                        for(var i in setspecific) if (setspecific.hasOwnProperty(i)) {\r\n                            if(typeof(obj[handle]) !== 'undefined' && typeof(obj[handle][setspecific[i]]) !== 'undefined'){\r\n                                obj[handle][setspecific[i]] = val;\r\n                            }else{\r\n                                if(typeof(obj[handle]) === 'undefined') obj[handle] = {};\r\n                                obj[handle][setspecific[i]] = val;\r\n                            }\r\n                        }\r\n                    }else{\r\n                        if(typeof(obj[handle]) !== 'undefined' && typeof(obj[handle][layout]) !== 'undefined'){\r\n                            obj[handle][layout] = val;\r\n                        }else{\r\n                            if(typeof(obj[handle]) === 'undefined') obj[handle] = {};\r\n                            obj[handle][layout] = val;\r\n                        }\r\n                    }\r\n                }else{\r\n                    obj[handle] = val;\r\n                }\r\n\r\n                return obj;\r\n            }\r\n\r\n\r\n            /**\r\n             * GET option to object depending on which size is choosen\r\n             */\r\n            t.getVal = function(obj, handle,forcelayout){\r\n                forcelayout = forcelayout===undefined ? layout : forcelayout;\r\n                if(typeof(obj) === 'undefined') return;\r\n\r\n                if(jQuery.inArray(handle, transSettings) !== -1){ //handle is in the list, so save only on the current choosen size\r\n                    if(typeof(obj[handle]) !== 'undefined' && typeof(obj[handle][forcelayout]) !== 'undefined'){\r\n\r\n                        return obj[handle][forcelayout];\r\n                    }else{\r\n                        if(typeof(obj[handle]) !== 'undefined' && typeof(obj[handle]) !== 'object'){\r\n                            return obj[handle];\r\n                        }else{\r\n                            if(typeof(obj[handle]) !== 'undefined'){\r\n                                //return next bigger / smaller value depending on what exists. First check bigger, then check smaller\r\n                                var nextval = '',\r\n                                    returnval = 'novalue',\r\n                                    calcblayout = \"desktop\";\r\n\r\n                                switch(forcelayout){\r\n                                    case 'desktop':\r\n                                        if(typeof(obj[handle]['notebook']) !== 'undefined')   {\r\n                                            returnval = obj[handle]['notebook'];\r\n                                            calcblayout = \"notebook\";\r\n                                        }\r\n                                        else\r\n                                        if(typeof(obj[handle]['tablet']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['tablet'];\r\n                                            calcblayout = \"tablet\";\r\n                                        }\r\n                                        else\r\n                                        if(typeof(obj[handle]['mobile']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['mobile'];\r\n                                            calcblayout = \"mobile\";\r\n                                        }\r\n                                        break;\r\n                                    case 'notebook':\r\n                                        if(typeof(obj[handle]['desktop']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['desktop'];\r\n                                            calcblayout = \"desktop\";\r\n                                        }\r\n                                        else\r\n                                        if(typeof(obj[handle]['tablet']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['tablet'];\r\n                                            calcblayout = \"tablet\";\r\n                                        }\r\n                                        else\r\n                                        if(typeof(obj[handle]['mobile']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['mobile'];\r\n                                            calcblayout = \"mobile\";\r\n                                        }\r\n                                        break;\r\n                                    case 'tablet':\r\n                                        if(typeof(obj[handle]['notebook']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['notebook'];\r\n                                            calcblayout = \"notebook\";\r\n                                        }\r\n                                        else\r\n                                        if(typeof(obj[handle]['desktop']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['desktop'];\r\n                                            calcblayout = \"desktop\";\r\n                                        }\r\n                                        else\r\n                                        if(typeof(obj[handle]['mobile']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['mobile'];\r\n                                            calcblayout = \"mobile\";\r\n                                        }\r\n                                        break;\r\n                                    case 'mobile':\r\n                                        if(typeof(obj[handle]['tablet']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['tablet'];\r\n                                            calcblayout = \"tablet\";\r\n                                        }\r\n                                        else\r\n                                        if(typeof(obj[handle]['notebook']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['notebook'];\r\n                                            calcblayout = \"notebook\";\r\n                                        }\r\n                                        else\r\n                                        if(typeof(obj[handle]['desktop']) !== 'undefined') {\r\n                                            returnval =  obj[handle]['desktop'];\r\n                                            calcblayout = \"desktop\";\r\n                                        }\r\n                                        break;\r\n                                }\r\n\r\n                                if (returnval!='novalue') {\r\n                                    /*if (handle==\"top\" || handle==\"left\") returnval = 0;\r\n                                     if (handle==\"align_hor\") returnval = \"left\";\r\n                                     if (handle==\"align_hor\") returnval = \"left\";*/\r\n                                    return returnval;\r\n                                }\r\n\r\n                            }\r\n                            return; //returns undefined\r\n                        }\r\n                    }\r\n                }else{\r\n                    if(typeof(obj[handle]) !== 'undefined' && typeof(obj[handle]) !== 'object'){\r\n                        return obj[handle];\r\n                    }else{\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * insert template to editor\r\n             */\r\n            t.insertTemplate = function(text){\r\n                if(add_meta_into === ''){\r\n                    if(t.selectedLayerSerial == -1) return(false);\r\n\r\n                    if(text.lastIndexOf(\"%\")<0){\r\n                        jQuery('#layer_text').val(jQuery('#layer_text').val()+'{{'+text+'}}');\r\n                    }\r\n                    else{\r\n                        jQuery('#layer_text').val(jQuery('#layer_text').val()+text);\r\n                    }\r\n                    t.updateLayerFromFields();\r\n                }else{\r\n                    if(jQuery.type(add_meta_into) == \"object\"){\r\n                        add_meta_into.val(add_meta_into.val()+'{{'+text+'}}').trigger('change');\r\n                    } else {\r\n                        jQuery('input[name=\"' + add_meta_into + '\"]').val(jQuery('input[name=\"' + add_meta_into + '\"]').val() + '{{' + text + '}}');\r\n                    }\r\n                }\r\n                jQuery('#dialog_template_insert').dialog('close');\r\n            }\r\n\r\n\r\n            /**************************************\r\n             -\tRefresh The Grid Size \t-\r\n             ***************************************/\r\n            t.refreshGridSize = function(){\r\n\r\n                var hcl = jQuery('#hor-css-linear .helplines-offsetcontainer'),\r\n                    vcl = jQuery('#ver-css-linear .helplines-offsetcontainer'),\r\n                    grid_size = jQuery('#rs-grid-sizes option:selected').val(),\r\n                    snapto = jQuery('#rs-grid-snapto option:selected').val(),\r\n                    wrapper = jQuery('#divLayers');\r\n\r\n\r\n                if (grid_size!=\"custom\") {\r\n                    wrapper.css({position:\"relative\"});\r\n                    wrapper.find('#helpergrid').remove();\r\n                    wrapper.append('<div id=\"helpergrid\" style=\"position:absolute;top:0px;left:0px;position:absolute;z-index:0;width:100%;height:100%\"></div>');\r\n                    var hg = wrapper.find('#helpergrid');\r\n                    if (grid_size>4) {\r\n                        for (var i=1;i<(wrapper.height()/grid_size);i++) {\r\n                            var jump = i*grid_size;\r\n                            hg.append('<div class=\"helplines\" style=\"background-color:#4affff;width:100%;height:1px;position:absolute;left:0px;top:'+jump+'px\"></div>');\r\n                        }\r\n\r\n                        for (var i=1;i<(wrapper.width()/grid_size);i++) {\r\n                            var jump = i*grid_size;\r\n                            hg.append('<div class=\"helplines\" style=\"background-color:#4affff;height:100%;width:1px;position:absolute;top:0px;left:'+jump+'px\"></div>');\r\n                        }\r\n                    }\r\n                    punchgs.TweenLite.to(hcl,0.3,{autoAlpha:0});\r\n                    punchgs.TweenLite.to(vcl,0.3,{autoAlpha:0});\r\n                } else {\r\n                    punchgs.TweenLite.to(hcl,0.3,{autoAlpha:1});\r\n                    punchgs.TweenLite.to(vcl,0.3,{autoAlpha:1});\r\n                    wrapper.find('#helpergrid').remove();\r\n                    try{hcl.find('.helplines').draggable(\"destroy\");} catch(e) {}\r\n                    try{vcl.find('.helplines').draggable(\"destroy\");} catch(e) {}\r\n                    hcl.find('.helplines').draggable({ handle:\".helpline-drag\", axis:\"x\" });\r\n                    vcl.find('.helplines').draggable({ handle:\".helpline-drag\", axis:\"y\" });\r\n                }\r\n\r\n                for(var key in t.arrLayers) if (t.arrLayers.hasOwnProperty(key)) {\r\n                    var layer = t.getHtmlLayerFromSerial(key);\r\n                    layer.draggable({\r\n                        drag: t.onLayerDrag,\r\n                        snap: snapto,\r\n                        snapMode:\"outer\"\r\n\r\n                    });\r\n                }\r\n            }\r\n\r\n            /**\r\n             * Add unique layer ids\r\n             **/\r\n            t.add_missing_unique_ids = function(){\r\n                var layers = t.getSimpleLayers();\r\n                var addfor = {};\r\n\r\n                //first round, check which one are missing unique IDs and set the unique_layer_id to be used by new layers\r\n                for(var key in layers) if (layers.hasOwnProperty(key)) {\r\n                    if(layers[key].unique_id === undefined){\r\n                        addfor[key] = true;\r\n                    }else{\r\n                        if(layers[key].unique_id > unique_layer_id)\r\n                            unique_layer_id = layers[key].unique_id;\r\n                    }\r\n                }\r\n\r\n                for(var key in addfor) if (addfor.hasOwnProperty(key)) {\r\n                    unique_layer_id++;\r\n                    var objUpdate = {};\r\n                    objUpdate.unique_id = unique_layer_id;\r\n\r\n                    update_layer_changes = false;\r\n                    t.updateLayer(key, objUpdate);\r\n                    update_layer_changes = true;\r\n                }\r\n\r\n            }\r\n\r\n\r\n            //======================================================\r\n            //\tInit Functions\r\n            //======================================================\r\n            t.init = function(slideTime){\r\n\r\n                if(jQuery().draggable == undefined || jQuery().autocomplete == undefined)\r\n                    jQuery(\"#jqueryui_error_message\").show();\r\n\r\n\r\n                jQuery('body').addClass(\"rs-layer-editor-view\");\r\n\r\n                g_slideTime = Number(slideTime);\r\n                u.init(t);\r\n                container = jQuery(containerID);\r\n                var demoRows = new Array();\r\n\r\n                //add all layers from init\r\n                if(initDemoLayers){\r\n                    var len = initDemoLayers.length;\r\n                    if(len){\r\n                        for(var i=0;i<len;i++){\r\n                            for(var key in initDemoLayers[i]) if (initDemoLayers[i].hasOwnProperty(key)) {\r\n                                curDemoSlideID = i;\r\n                                if (initDemoLayers[i][key].type===\"row\" || initDemoLayers[i][key].type===\"column\") {\r\n                                    demoRows.push(initDemoLayers[i][key].unique_id)\r\n                                } else {\r\n                                    if (jQuery.inArray(initDemoLayers[i][key].p_uid,demoRows)==-1)\r\n                                        addLayer(initDemoLayers[i][key],true,true,true);\r\n                                }\r\n                            }\r\n                        }\r\n                    }else{\r\n                        for(var i in initDemoLayers) if (initDemoLayers.hasOwnProperty(i)) {\r\n                            for(var key in initDemoLayers[i]) if (initDemoLayers[i].hasOwnProperty(key)) {\r\n                                curDemoSlideID = i;\r\n                                if (initDemoLayers[i][key].type===\"row\" || initDemoLayers[i][key].type===\"column\") {\r\n                                    demoRows.push(initDemoLayers[i][key].unique_id)\r\n                                } else {\r\n                                    if (jQuery.inArray(initDemoLayers[i][key].p_uid,demoRows)==-1)\r\n                                        addLayer(initDemoLayers[i][key],true,true,true);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                u.organiseGroupsAndLayer(false,true);\r\n\r\n                var len = initLayers.length;\r\n                if(initLayers){\r\n                    if(len){\r\n                        for(var i=0;i<len;i++) {\r\n                            initLayers[i].addedToStage=false;\r\n                        }\r\n\r\n                        // ADD GROUPS AND LAYERS WITHOUT GROUPS BEFORE THE ROWS\r\n                        for(var i=0;i<len;i++) {\r\n                            if (initLayers[i].type===\"row\") break;\r\n                            if (initLayers[i].type!==\"row\" && initLayers[i].type!==\"column\") {\r\n                                if (initLayers[i].type!==\"group\" || initLayers[i].p_uid===-1) {\r\n                                    initLayers[i].addedToStage=true;\r\n                                    addLayer(initLayers[i],true,false,true);\r\n                                }\r\n                            }\r\n                        }\r\n                        t.add_missing_unique_ids();\r\n\r\n\r\n\r\n                        //ADD ROOT LAYERS BEFORE ROWS\r\n                        for(var i=0;i<len;i++) {\r\n                            if (initLayers[i].type==\"row\") break;\r\n                            if (initLayers[i].addedToStage!==true && initLayers[i].type!==\"row\" && initLayers[i].type!==\"column\" && initLayers[i].type!==\"group\" ) {\r\n                                initLayers[i].addedToStage=true;\r\n                                addLayer(initLayers[i],true,false,true);\r\n                            }\r\n                        }\r\n\r\n\r\n                        // ADD GROUPS AND ROWS\r\n                        t.add_missing_unique_ids();\r\n                        for(var i=0;i<len;i++) {\r\n                            if (initLayers[i].addedToStage!==true && (initLayers[i].type===\"group\" || initLayers[i].type===\"row\"))  {\r\n                                initLayers[i].addedToStage=true;\r\n                                addLayer(initLayers[i],true,false,true);\r\n                            }\r\n                        }\r\n\r\n\r\n                        // ADD COLUMNS INTO ROWS\r\n                        t.add_missing_unique_ids();\r\n                        for(var i=0;i<len;i++) {\r\n                            if (initLayers[i].type===\"column\") {\r\n                                initLayers[i].addedToStage=true;\r\n                                addLayer(initLayers[i],true,false,true);\r\n                            }\r\n                        }\r\n\r\n\r\n                        //ADD ROOT LAYERS AFTER ROWS\r\n                        t.add_missing_unique_ids();\r\n                        for(var i=0;i<len;i++) {\r\n                            if (initLayers[i].addedToStage!==true) {\r\n                                addLayer(initLayers[i],true,false,true);\r\n                            }\r\n                        }\r\n\r\n                    }else{\r\n                        for(var i in initLayers) if (initLayers.hasOwnProperty(i)) {\r\n                            initLayers[i].addedToStage=false;\r\n                        }\r\n\r\n                        // ADD GROUPS AND LAYERS WITHOUT GROUPS BEFORE THE ROWS\r\n                        for(var i in initLayers) if (initLayers.hasOwnProperty(i)) {\r\n                            if (initLayers[i].type===\"row\") break;\r\n                            if (initLayers[i].type!==\"row\" && initLayers[i].type!==\"column\") {\r\n                                if (initLayers[i].type!==\"group\" || initLayers[i].p_uid===-1) {\r\n                                    initLayers[i].addedToStage=true;\r\n                                    addLayer(initLayers[i],true,false,true);\r\n                                }\r\n                            }\r\n                        }\r\n                        t.add_missing_unique_ids();\r\n\r\n                        //ADD ROOT LAYERS BEFORE ROWS\r\n                        for(var i in initLayers) if (initLayers.hasOwnProperty(i)) {\r\n                            if (initLayers[i].type==\"row\") break;\r\n                            if (initLayers[i].addedToStage!==true && initLayers[i].type!==\"row\" && initLayers[i].type!==\"column\" && initLayers[i].type!==\"group\" ) {\r\n                                initLayers[i].addedToStage=true;\r\n                                addLayer(initLayers[i],true,false,true);\r\n                            }\r\n                        }\r\n\r\n\r\n                        // ADD GROUPS AND ROWS\r\n                        t.add_missing_unique_ids();\r\n                        for(var i in initLayers) if (initLayers.hasOwnProperty(i)) {\r\n                            if (initLayers[i].addedToStage!==true && (initLayers[i].type===\"group\" || initLayers[i].type===\"row\"))  {\r\n                                initLayers[i].addedToStage=true;\r\n                                addLayer(initLayers[i],true,false,true);\r\n                            }\r\n                        }\r\n\r\n\r\n                        // ADD COLUMNS INTO ROWS\r\n                        t.add_missing_unique_ids();\r\n                        for(var i in initLayers) if (initLayers.hasOwnProperty(i)) {\r\n                            if (initLayers[i].type===\"column\") {\r\n                                initLayers[i].addedToStage=true;\r\n                                addLayer(initLayers[i],true,false,true);\r\n                            }\r\n                        }\r\n\r\n\r\n                        //ADD ROOT LAYERS AFTER ROWS\r\n                        t.add_missing_unique_ids();\r\n                        for(var i in initLayers) if (initLayers.hasOwnProperty(i)) {\r\n                            if (initLayers[i].addedToStage!==true) {\r\n                                addLayer(initLayers[i],true,false,true);\r\n                            }\r\n                        }\r\n                    }\r\n                    t.add_missing_unique_ids();\r\n                }\r\n\r\n                // IF LAYERS ADDED, WE CAN CALCULATE THE SCROLLER\r\n                u.timeLineTableDimensionUpdate();\r\n\r\n                // One Time Refresh of TimeTable (to reset Action, Wait texts on Time Line Layers)\r\n\r\n                u.updateAllLayerTimeline();\r\n\r\n\r\n                //disable the properties box\r\n                disableFormFields();\r\n\r\n\r\n                //init elements\r\n                initMainEvents();\t// CLICK ON CONTAINER\r\n\r\n                initButtons();\t\t// MAIN BUTTONS - ADD LAYERS, DUPLICATE, DELETE\r\n\r\n                initHtmlFields();\t// HTML FIELD HANDLINGS\r\n\r\n                initAlignTable();\r\n\r\n                initLoopFunctions();\r\n\r\n                scaleAndResetLayerInit();\r\n\r\n                positionChanged_Core();\r\n\r\n                initBackgroundFunctions();\r\n\r\n\r\n                // STICKY CATEGORIES FOR SCROLL SELECTORS\r\n                jQuery('#tp-thelistofclasses ul, #tp-thelistoffonts ul').bind('scroll',function() {\r\n                    var u = jQuery(this),\r\n                        s = u.scrollTop(),\r\n                        os = u.data('olds'),\r\n                        h = u.parent().height(),\r\n                        l,\r\n                        d = os==undefined || os<s ? \"up\" : \"down\";\r\n                    u.find('.ui-autocomplete-category').each(function(i) {\r\n                        var t = jQuery(this),\r\n                            p = t.next().position().top,\r\n                            corr = i==0 ? 0 : 15;\r\n\r\n                        if ((d==\"up\" && p<50) || (d==\"down\" && p<(0-corr))) {\r\n\r\n                            t.css({position:\"absolute\",top:s-(corr),zIndex:i});\r\n                            t.next().css({marginTop:(50+corr)})\r\n                        } else {\r\n                            t.css({position:\"relative\",top:0,zIndex:i});\r\n                            t.next().css({marginTop:0})\r\n                        }\r\n                    });\r\n                    u.data('olds',s);\r\n                });\r\n\r\n\r\n                // HIDE/SHOW MAIN IMAGE SELECTION\r\n                jQuery('.bgsrcchanger').each(function(){\r\n                    if(jQuery(this)[0].checked)\r\n                        initSliderMainOptions(jQuery(this));\r\n                });\r\n                // INIT CLICK HANDLING ON MAIN IMAGE SETTINGS\r\n                jQuery('.bgsrcchanger').click(function() {\r\n                    initSliderMainOptions(jQuery(this));\r\n                });\r\n\r\n                jQuery('#alt_option').change(function(){\r\n                    if(jQuery('#alt_option option:selected').val() == 'custom'){\r\n                        jQuery('#alt_attr').show();\r\n                    }else{\r\n                        jQuery('#alt_attr').hide();\r\n                    }\r\n                });\r\n\r\n                jQuery('#title_option').change(function(){\r\n                    if(jQuery('#title_option option:selected').val() == 'custom'){\r\n                        jQuery('#title_attr').show();\r\n                    }else{\r\n                        jQuery('#title_attr').hide();\r\n                    }\r\n                });\r\n\r\n                initDisallowCaptionsOnClick();\r\n\r\n\r\n\r\n                // OPEN LEFT PANEL TO FULL\r\n                jQuery('.open_right_panel').click(function() {\r\n                    var orp = jQuery('.layer_props_wrapper')\r\n                    if (orp.hasClass(\"openeed\")) {\r\n                        orp.removeClass(\"openeed\");\r\n                    } else {\r\n                        orp.addClass(\"openeed\");\r\n                    }\r\n                });\r\n\r\n                jQuery('#rs-grid-sizes, #rs-grid-snapto').change(function() {\r\n                    t.refreshGridSize();\r\n                });\r\n\r\n                jQuery('#layer_alt_option').change(function(){\r\n                    if(jQuery('#layer_alt_option option:selected').val() == 'custom'){\r\n                        jQuery('#layer_alt').show();\r\n                    }else{\r\n                        jQuery('#layer_alt').hide();\r\n                    }\r\n                });\r\n\r\n                jQuery('select[name=\"rev_show_the_slides\"]').change(function(){\r\n                    var nextsh = jQuery('#divbgholder').find('.slotholder');\r\n\r\n                    jQuery('.demo_layer').addClass(\"invisible_demolayer\");\r\n\r\n                    nextsh.addClass(\"trans_bg\");\r\n                    nextsh.css(\"background-image\",\"none\");\r\n                    nextsh.css(\"background-color\",\"transparent\");\r\n                    nextsh.css(\"background-position\",\"top center\");\r\n                    nextsh.css(\"background-size\",\"cover\"); //100% 100%\r\n                    nextsh.css(\"background-repeat\",\"no-repeat\");\r\n\r\n                    jQuery('.tp-bgimg').css({backgroundImage:\"none\",backgroundColor:\"transparent\"});\r\n\r\n                    if(jQuery(this).val() !== 'none'){\r\n                        var sv = jQuery(this).val();\r\n                        jQuery('.demo_layer_'+sv).show();\r\n                        jQuery('.demo_layer_'+sv).removeClass(\"invisible_demolayer\");\r\n\r\n                        if(typeof initDemoSettings[sv] !== 'undefined'){\r\n                            var bgfit = (initDemoSettings[sv]['bg_fit'] == 'percentage') ? initDemoSettings[sv]['bg_fit_x'] + '% ' + initDemoSettings[sv]['bg_fit_y'] + '% ' : initDemoSettings[sv]['bg_fit'];\r\n                            var bgpos = (initDemoSettings[sv]['bg_position'] == 'percentage') ? initDemoSettings[sv]['bg_position_x'] + '% ' + initDemoSettings[sv]['bg_position_y'] + '% ' : initDemoSettings[sv]['bg_position'];\r\n\r\n                            if(initDemoSettings[sv]['bg_fit'] == 'contain'){\r\n                                jQuery('#divLayers-wrapper').css('maxWidth', jQuery('#divbgholder').css('minWidth'));\r\n                            }else{\r\n                                jQuery('#divLayers-wrapper').css('maxWidth', 'none');\r\n                            }\r\n\r\n                            switch(initDemoSettings[sv]['background_type']){\r\n                                case \"image\":\r\n                                case \"meta\":\r\n                                case \"streamyoutube\":\r\n                                case \"streamvimeo\":\r\n                                case \"streaminstagram\":\r\n                                case \"youtube\":\r\n                                case \"vimeo\":\r\n                                case \"html5\":\r\n                                    var urlImage = initDemoSettings[sv]['image'];\r\n                                    jQuery('#the_image_source_url').html(urlImage);\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-image\",\"url('\"+urlImage+\"')\");\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-color\",\"transparent\");\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-size\",bgfit);\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-position\",bgpos);\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-repeat\",initDemoSettings[sv]['bg_repeat']);\r\n                                    nextsh.find('.defaultimg, .slotslidebg').removeClass(\"trans_bg\");\r\n                                    break;\r\n                                case \"trans\":\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-image\",\"none\");\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-color\",\"transparent\");\r\n                                    nextsh.find('.defaultimg, .slotslidebg').addClass(\"trans_bg\");\r\n                                    break;\r\n                                case \"solid\":\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-image\",\"none\");\r\n                                    nextsh.find('.defaultimg, .slotslidebg').removeClass(\"trans_bg\");\r\n                                    var bgColor = window.RevColor.get(initDemoSettings[sv]['slide_bg_color']);\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-color\",bgColor);\r\n                                    break;\r\n                                case \"external\":\r\n                                    var urlImage = initDemoSettings[sv]['slide_bg_external'];\r\n                                    jQuery('#the_image_source_url').html(urlImage);\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-image\",\"url('\"+urlImage+\"')\");\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-color\",\"transparent\");\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-size\",bgfit);\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-position\",bgpos);\r\n                                    nextsh.find('.defaultimg, .slotslidebg').css(\"background-repeat\",initDemoSettings[sv]['bg_repeat']);\r\n                                    nextsh.find('.defaultimg, .slotslidebg').removeClass(\"trans_bg\");\r\n                                    break;\r\n                            }\r\n                        }\r\n                    }\r\n                    jQuery('#divbgholder').css({backgroundImage:\"none\",backgroundColor:\"transparent\"});\r\n                    //t.changeSlotBGs();\r\n                });\r\n\r\n                jQuery('#thumb_for_admin').on('change',function() {\r\n                    t.changeSlotBGs();\r\n                });\r\n\r\n                if (jQuery('#slide_thumb_button_preview').find('div').length>0)\r\n                    jQuery('.show_on_thumbnail_exist').show();\r\n\r\n                jQuery('.rs-slide-device_selector').click(function(){\r\n                    if(rev_adv_resp_sizes == false) return;\r\n\r\n                    var changeto = jQuery(this).data('val');\r\n                    layout = changeto;\r\n                    u.layout = changeto\r\n\r\n                    var minheight = 0;\r\n                    jQuery('.row-zone-container').each(function() {\r\n                        minheight=minheight + jQuery(this).height();\r\n                    });\r\n\r\n                    minheight = minheight < rev_sizes[changeto][1] ? rev_sizes[changeto][1] : minheight;\r\n\r\n                    jQuery('.tp-bgimg.defaultimg, #divLayers').css({\r\n                        width:rev_sizes[changeto][0],\r\n                        height:minheight\r\n                    });\r\n\r\n                    if (__slidertype!=\"auto\") {\r\n                        jQuery('#divbgholder').css({minWidth:rev_sizes[changeto][0], maxWidth:\"100%\", marginLeft:\"auto\",marginRight:\"auto\"});\r\n                        jQuery('#divbgholder').css({minHeight:minheight,height:minheight});\r\n                        jQuery('.slotholder .tp-bgimg.defaultimg').css({minWidth:rev_sizes[changeto][0], maxWidth:\"100%\" });\r\n                        jQuery('.tp-bgimg.defaultimg').css({\r\n                            width:\"100%\"\r\n                        })\r\n                    } else {\r\n\r\n                        jQuery('#divbgholder').css({minWidth:rev_sizes[changeto][0], maxWidth:rev_sizes[changeto][0], marginLeft:\"auto\",marginRight:\"auto\"});\r\n                        jQuery('#divbgholder').css({minHeight:minheight,height:minheight});\r\n                        jQuery('.slotholder .tp-bgimg.defaultimg').css({minWidth:rev_sizes[changeto][0], maxWidth:rev_sizes[changeto][0] })\r\n\r\n                    }\r\n\r\n\r\n\r\n                    jQuery('#divLayers-wrapper').css('height', minheight + 1);\r\n\r\n                    jQuery('.rs-slide-device_selector').removeClass('selected');\r\n\r\n                    jQuery(this).addClass('selected');\r\n\r\n                    //update positions of all other slides elements if static slide is selected\r\n                    u.resetSlideAnimations();\r\n                    jQuery(window).trigger(\"resize\");\r\n                    redrawAllLayerHtml();\r\n                    t.setMiddleRowZone(100);\r\n                    // update Background Size !!\r\n\r\n                });\r\n\r\n\r\n                //DESELECT ALL LAYERS WHEN CLICKED SOME NEUTRAL PLACE\r\n                jQuery('#divbgholder .oldslotholder, #divbgholder .slotholder, #divbgholder .defaultimg, #top-toolbar-wrapper, #layer-settings-toolbar-bottom').on('click',function(e) {\r\n                    var button = e.which || e.button;\r\n                    if ( button === 1 )  cm.toggleMenuOff();\r\n                    if(e.target != this) return;\r\n                    u.checkMultipleSelectedItems(true);\r\n                    unselectLayers();\r\n                });\r\n\r\n\r\n                var cfith = function(layer,a) {\r\n                    layer['deformation-hover'][a] = layer['deformation'][a];\r\n                    return layer;\r\n                }\r\n                var cfhti = function(layer,a) {\r\n                    layer['deformation'][a] = layer['deformation-hover'][a];\r\n                    return layer;\r\n                }\r\n\r\n\r\n                //copy idle to hover\r\n                jQuery('.copy-from-idle').click(function(){\r\n\r\n                    if(confirm(rev_lang.copy_styles_to_idle_from_hover)){\r\n                        var layer = t.getCurrentLayer();\r\n\r\n                        layer['deformation-hover']['color'] = t.getVal(layer['static_styles'], 'color');\r\n                        layer['deformation-hover']['2d_rotation'] = layer['2d_rotation'];\r\n\r\n                        layer = cfith(layer,'2d_origin_x');\r\n                        layer = cfith(layer,'2d_origin_y');\r\n                        layer = cfith(layer,'background-color');\r\n                        layer = cfith(layer,'background-transparency');\r\n                        layer = cfith(layer,'border-color');\r\n                        layer = cfith(layer,'border-radius');\r\n                        layer = cfith(layer,'border-style');\r\n                        layer = cfith(layer,'border-transparency');\r\n                        layer = cfith(layer,'border-width');\r\n                        layer = cfith(layer,'color-transparency');\r\n                        layer = cfith(layer,'opacity');\r\n                        layer = cfith(layer,'scalex');\r\n                        layer = cfith(layer,'scaley');\r\n                        layer = cfith(layer,'skewx');\r\n                        layer = cfith(layer,'skewy');\r\n                        layer = cfith(layer,'text-decoration');\r\n                        layer = cfith(layer,'x');\r\n                        layer = cfith(layer,'xrotate');\r\n                        layer = cfith(layer,'y');\r\n                        layer = cfith(layer,'yrotate');\r\n                        layer = cfith(layer,'z');\r\n\r\n                        t.updateLayerFormFields(t.selectedLayerSerial);\r\n\r\n                        t.updateLayerFromFields();\r\n                    }\r\n                });\r\n\r\n\r\n                //copy hover to idle\r\n                jQuery('.copy-from-hover').click(function(){\r\n                    if(confirm(rev_lang.copy_styles_to_hover_from_idle)){\r\n                        var layer = t.getCurrentLayer();\r\n                        layer['2d_rotation'] = layer['deformation-hover']['2d_rotation'];\r\n                        layer['static_styles'] = t.setVal(layer['static_styles'], 'color', layer['deformation-hover']['color'], false);\r\n\r\n                        layer = cfhti(layer,'2d_origin_x');\r\n                        layer = cfhti(layer,'2d_origin_y');\r\n                        layer = cfhti(layer,'background-color');\r\n                        layer = cfhti(layer,'background-transparency');\r\n                        layer = cfhti(layer,'border-color');\r\n                        layer = cfhti(layer,'border-radius');\r\n                        layer = cfhti(layer,'border-style');\r\n                        layer = cfhti(layer,'border-transparency');\r\n                        layer = cfhti(layer,'border-width');\r\n                        layer = cfhti(layer,'color-transparency');\r\n                        layer = cfhti(layer,'opacity');\r\n                        layer = cfhti(layer,'scalex');\r\n                        layer = cfhti(layer,'scaley');\r\n                        layer = cfhti(layer,'skewx');\r\n                        layer = cfhti(layer,'skewy');\r\n                        layer = cfhti(layer,'text-decoration');\r\n                        layer = cfhti(layer,'x');\r\n                        layer = cfhti(layer,'xrotate');\r\n                        layer = cfhti(layer,'y');\r\n                        layer = cfhti(layer,'yrotate');\r\n                        layer = cfhti(layer,'z');\r\n\r\n                        t.updateLayerFormFields(t.selectedLayerSerial);\r\n\r\n                        t.updateLayerFromFields();\r\n                    }\r\n                });\r\n\r\n\r\n                jQuery('#button_css_reset').click(function(){\r\n                    var layer = t.getCurrentLayer();\r\n                    if(layer !== null){\r\n                        t.reset_to_default_static_styles(layer);\r\n\r\n                        // Reset Fields from Style Template\r\n                        updateSubStyleParameters(layer, true);\r\n                        t.updateLayerFromFields();\r\n                    }\r\n                });\r\n\r\n                var getGridDimension = function() {\r\n                    var d = jQuery('#divLayers'),\r\n                        dl = d.offset(),\r\n                        dlw = jQuery('#divLayers-wrapper').offset(),\r\n                        rp = {top:dl.top-dlw.top, left:dl.left-dlw.left, bottom:dl.top-dlw.top+d.height(),right:dl.left-dlw.left+d.width()};\r\n                    return rp;\r\n                }\r\n\r\n\r\n                function edit_content_current_layer(){\r\n\r\n                    var layer = t.getCurrentLayer();\r\n                    if(layer !== null){\r\n\r\n                        switch(layer.type){\r\n                            case 'text':\r\n                            case 'button':\r\n\r\n                                t.showHideContentEditor(true);\r\n                                jQuery('#quick-layers-wrapper').slideUp(300);\r\n                                jQuery('.current-active-main-toolbar').removeClass(\"opened\");\r\n                                jQuery('#button_show_all_layer i').removeClass(\"eg-icon-up\").addClass(\"eg-icon-menu\");\r\n                                jQuery('#layer_text').focus();\r\n\r\n                                break;\r\n                            case 'video':\r\n                                var objVideoData = layer.video_data;\r\n\r\n                                //open video dialog\r\n                                UniteAdminRev.openVideoDialog(function(videoData){\r\n                                    //update video layer\r\n                                    var objLayer = getVideoObjLayer(videoData);\r\n\r\n                                    t.updateCurrentLayer(objLayer);\r\n                                    updateHtmlLayersFromObject(t.selectedLayerSerial);\r\n                                    t.updateLayerFormFields(t.selectedLayerSerial);\r\n                                    redrawLayerHtml(t.selectedLayerSerial);\r\n\r\n                                    scaleNormalVideo();\r\n                                }, objVideoData);\r\n                                break;\r\n                            case 'image':\r\n                                if (layer.image_library===\"objectlibrary\") {\r\n                                    jQuery('#dialog_addobj').data('changeimg',true);\r\n                                    jQuery('#dialog_addobj').data('changeimgserial',layer.serial);\r\n                                    t.callObjectLibraryDialog(\"object\");\r\n                                } else {\r\n                                    UniteAdminRev.openAddImageDialog(rev_lang.select_layer_image,function(urlImage){\r\n                                        var objData = {};\r\n                                        objData.image_url = urlImage;\r\n                                        t.updateCurrentLayer(objData);\r\n\r\n                                        redrawLayerHtml(t.selectedLayerSerial);\r\n                                        t.add_layer_change();\r\n                                        scaleNormal();\r\n                                    });\r\n                                }\r\n                                break;\r\n                            case 'shape':\r\n                                break;\r\n                            case 'svg':\r\n\r\n                                jQuery('#dialog_addobj').data('changesvg',true);\r\n                                jQuery('#dialog_addobj').data('changesvgserial',layer.serial);\r\n                                t.callObjectLibraryDialog(\"object\");\r\n\r\n                                break;\r\n                            case 'audio':\r\n                                //do audio stuff here\r\n                                var objVideoData = layer.video_data;\r\n\r\n                                //open video dialog\r\n                                UniteAdminRev.openVideoDialog(function(videoData){\r\n                                    //update video layer\r\n                                    var objLayer = getVideoObjLayer(videoData);\r\n\r\n                                    t.updateCurrentLayer(objLayer);\r\n                                    updateHtmlLayersFromObject(t.selectedLayerSerial);\r\n                                    t.updateLayerFormFields(t.selectedLayerSerial);\r\n                                    redrawLayerHtml(t.selectedLayerSerial);\r\n                                    u.drawAudioMap(layer);\r\n\r\n                                }, objVideoData, 'audio');\r\n                                break;\r\n                            //case 'no_edit':\r\n                            //do nothing!!\r\n                            //break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                jQuery('body').on('dblclick','.layer_selected',edit_content_current_layer);\r\n\r\n\r\n                setTimeout(function() {\r\n                    jQuery('#form_slide_params').find('input, select').on('change',function() {\r\n                        t.set_save_needed(true);\r\n                    });\r\n                },500);\r\n\r\n                // EDIT LAYER CONTENT FROM QUICK LIST\r\n                jQuery('body').on('click','.button_change_image_source, .button_edit_layer, .button_change_video_settings, .button_reset_size, .button_edit_shape, .button_change_audio_settings, .button_change_svg_settings',function() {\r\n\r\n                    jQuery(':focus').blur(); // Blur Focused Elements first\r\n                    var b = jQuery(this),\r\n                        serial = b.closest('.layer-toolbar-li').data('serial');\r\n                    t.setLayerSelected(serial);\r\n                    if (b.hasClass(\"button_reset_size\"))\r\n                        resetCurrentElementSize();\r\n                    else\r\n                        edit_content_current_layer();\r\n                });\r\n\r\n                jQuery('body').on('click','.layer-title-with-icon',function() {\r\n                    var a = jQuery(this),\r\n                        infocus = a.find('input').is(\":focus\");\r\n                    if (!infocus)\r\n                        jQuery(':focus').blur(); // Blur Focused Elements first\r\n                    var b = jQuery(this),\r\n                        serial = b.closest('.layer-toolbar-li').data('serial');\r\n\r\n                    t.setLayerSelected(serial,false,infocus);\r\n\r\n                })\r\n\r\n\r\n                // EDIT LAYER CONTENT FROM MAIN TOOLBAR\r\n                jQuery('#button_edit_layer, #button_change_video_settings,#button_change_image_source').click(edit_content_current_layer);\r\n\r\n                //delete layer actions:\r\n                jQuery('body').on('click',\".button_delete_layer, #button_delete_layer\", function(){\r\n\r\n                    jQuery(':focus').blur(); // Blur Focused Elements first\r\n                    var b = jQuery(this);\r\n\r\n                    if(b.hasClass(\"button-now-disabled\")) return(false);\r\n\r\n                    if (b.hasClass(\"button_delete_layer\")) {\r\n                        var serial = b.closest('.layer-toolbar-li').data('serial');\r\n                        t.setLayerSelected(serial);\r\n                    }\r\n\r\n\r\n                    var objLayer = t.getCurrentLayer();\r\n\r\n\r\n                    if (objLayer.type===\"column\") return false;\r\n\r\n                    if ((objLayer.type===\"group\" || objLayer.type===\"row\") && t.getLayersInGroup(objLayer.unique_id).layers.length>0) {\r\n                        jQuery('#delete-full-group-dialog').dialog({\r\n                            width:600,\r\n                            open: function() {\r\n                                // On open, hide the original submit button\r\n                            },\r\n                            buttons: [\r\n                                {\r\n                                    text: \"Remove All Layers\",\r\n                                    click: function() {\r\n                                        var list = t.getLayersInGroup(objLayer.unique_id);\r\n                                        jQuery.each(list.layers,function(i,layer) {\r\n                                            t.deleteLayer(layer.serial);\r\n                                        });\r\n                                        jQuery.each(list.columns,function(i,column) {\r\n                                            t.deleteLayer(column.serial);\r\n                                        });\r\n                                        t.deleteLayer(objLayer.serial);\r\n                                        u.organiseGroupsAndLayer(true);\r\n                                        jQuery( this ).dialog( \"close\" );\r\n                                    }\r\n                                },\r\n                                {\r\n                                    text: \"Move Layers to Root\",\r\n                                    click: function() {\r\n                                        var list = t.getLayersInGroup(objLayer.unique_id);\r\n                                        jQuery.each(list.layers,function(i,layer) {\r\n                                            layer.p_uid = -1;\r\n                                        });\r\n                                        jQuery.each(list.columns,function(i,column) {\r\n                                            t.deleteLayer(column.serial);\r\n                                        });\r\n                                        t.deleteLayer(objLayer.serial);\r\n                                        u.organiseGroupsAndLayer(true);\r\n                                        jQuery( this ).dialog( \"close\" );\r\n                                    }\r\n                                },\r\n                                {\r\n                                    text: \"Cancel Action\",\r\n                                    click: function() {\r\n                                        jQuery( this ).dialog( \"close\" );\r\n                                    }\r\n                                }\r\n                            ]\r\n                        })\r\n                    } else {\r\n                        if(confirm(rev_lang.delete_layer)){\r\n\r\n                            if (b.hasClass(\"button_delete_layer\")) {\r\n                                var serial = b.closest('.layer-toolbar-li').data('serial');\r\n                                t.setLayerSelected(serial);\r\n                            }\r\n\r\n                            //delete selected layer\r\n                            deleteCurrentLayer();\r\n                            unselectLayers();\r\n                        }\r\n                    }\r\n                });\r\n\r\n\r\n                t.makeRowSortableDroppable();\r\n\r\n\r\n                //DUPLICATE layer actions:\r\n                jQuery('body').on('click',\".button_duplicate_layer, #button_duplicate_layer\",function(){\r\n                    jQuery(':focus').blur(); // Blur Focused Elements first\r\n                    var b = jQuery(this);\r\n\r\n                    if(b.hasClass(\"button-now-disabled\")) return(false);\r\n                    if (b.hasClass(\"button_duplicate_layer\")) {\r\n                        var serial = b.closest('.layer-toolbar-li').data('serial');\r\n                        t.setLayerSelected(serial);\r\n                    }\r\n                    //duplicate selected layer\r\n                    duplicateCurrentLayer();\r\n                    return false;\r\n                });\r\n\r\n                t.showHideContentEditor(false);\r\n\r\n                t.changeSlotBGs();\r\n                jQuery(\"#hide_layer_content_editor\").click(function() {\r\n                    t.showHideContentEditor(false);\r\n                });\r\n\r\n                jQuery('#layer_animation, #layer_endanimation').change(function(){\r\n\r\n                    //set values from elements if existing\r\n                    var set_anim = (jQuery(this).attr('id') == 'layer_animation') ? 'in' : 'out';\r\n                    var anim_handle = jQuery(this).val();\r\n\r\n                    var found = false;\r\n                    for(var key in initLayerAnims) if (initLayerAnims.hasOwnProperty(key)) {\r\n                        if('custom'+set_anim+'-'+initLayerAnims[key]['id'] == anim_handle){\r\n                            switch(set_anim){\r\n                                case 'in':\r\n                                    setNewAnimFromObj('start', initLayerAnims[key]['params']);\r\n                                    break;\r\n                                case 'out':\r\n                                    setNewAnimFromObj('end', initLayerAnims[key]['params']);\r\n                                    break;\r\n                            }\r\n                            found = true;\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    if(found == false){\r\n                        for(var key in initLayerAnimsDefault) if (initLayerAnimsDefault.hasOwnProperty(key)) {\r\n                            if(key == anim_handle){\r\n                                switch(set_anim){\r\n                                    case 'in':\r\n                                        setNewAnimFromObj('start', initLayerAnimsDefault[key]['params']);\r\n                                        break;\r\n                                    case 'out':\r\n                                        setNewAnimFromObj('end', initLayerAnimsDefault[key]['params']);\r\n                                        break;\r\n                                }\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if(set_anim == 'out' && anim_handle == 'auto'){ //check if masking is enabled for in-animation, if yes do it here, too\r\n                        if(jQuery('#masking-start')[0].checked){\r\n                            if(jQuery('#masking-start')[0].checked == true){\r\n                                jQuery('#masking-end').attr('checked', true);\r\n                                RevSliderSettings.onoffStatus(jQuery('#masking-end'));\r\n                                jQuery('.mask-end-settings').show();\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    t.updateLayerFromFields();\r\n                });\r\n\r\n\r\n                jQuery('#layer_caption').change(function(){\r\n                    //check if style is existing. If not, change fields from rename to save\r\n                    if(UniteCssEditorRev.checkIfHandleExists(jQuery(this).val())){\r\n                        jQuery('#extra_style_settings').removeClass('normal_rename normal_save save_rename save_save').addClass('normal_rename');\r\n                    }else{\r\n                        jQuery('#extra_style_settings').removeClass('normal_rename normal_save save_rename save_save').addClass('normal_save');\r\n                    }\r\n                });\r\n\r\n\r\n                jQuery('.save-current-animin, .save-current-animout').click(function() {\r\n                    var what = (jQuery(this).hasClass('save-current-animin')) ? 'start' : 'end';\r\n                    var handle = (what == 'start') ? jQuery('select[name=\"layer_animation\"] option:selected').val() : jQuery('select[name=\"layer_endanimation\"] option:selected').val();\r\n\r\n                    if(handle !== 'custom'){\r\n                        for(var key in initLayerAnimsDefault) if (initLayerAnimsDefault.hasOwnProperty(key)) {\r\n                            if(key === handle){\r\n                                alert(rev_lang.cant_modify_default_anims);\r\n                                return false;\r\n                            }\r\n                        }\r\n                    }\r\n                    var anim = {};\r\n\r\n                    anim['params'] = createNewAnimObj(what);\r\n\r\n                    if(handle == 'custom'){\r\n                        //add dialog box asking for name. Then check if name exists or is default\r\n                        jQuery('#rs-save-under-animation').val('');\r\n\r\n                        var objLayer = t.getCurrentLayer();\r\n\r\n                        if(what == 'start' && typeof(objLayer['orig-anim']) !== 'undefined') jQuery('#rs-save-under-animation').val(objLayer['orig-anim']);\r\n                        if(what == 'end' && typeof(objLayer['orig-endanim']) !== 'undefined') jQuery('#rs-save-under-animation').val(objLayer['orig-endanim']);\r\n\r\n                        jQuery('#dialog_save_animation').dialog({\r\n                            modal: true,\r\n                            width: 300,\r\n                            height: 200,\r\n                            resizable: false,\r\n                            dialogClass:\"tpdialogs\",\r\n                            create:function(ui) {\r\n                                jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                            },\r\n                            buttons:{\r\n                                'Save':function(){\r\n                                    var new_name = jQuery('#rs-save-under-animation').val();\r\n                                    var new_handle = UniteAdminRev.sanitize_input(new_name);\r\n\r\n                                    var do_insert = true;\r\n                                    for(var key in initLayerAnimsDefault) if (initLayerAnimsDefault.hasOwnProperty(key)) {\r\n                                        //if(key == new_handle){\r\n                                        if(initLayerAnimsDefault[key]['handle'] == new_handle){\r\n                                            alert(rev_lang.name_is_default_animations_cant_be_changed);\r\n                                            return false;\r\n                                        }\r\n                                    }\r\n\r\n                                    for(var key in initLayerAnims) if (initLayerAnims.hasOwnProperty(key)) {\r\n                                        //if(key == new_handle){\r\n                                        if(initLayerAnims[key]['handle'] == new_handle){\r\n                                            do_insert = (what == 'start') ? 'customin' : 'customout';\r\n                                            do_insert += '-'+initLayerAnims[key]['id'];\r\n                                            break;\r\n                                        }\r\n                                    }\r\n\r\n                                    anim['handle'] = new_handle;\r\n\r\n                                    anim['params']['type'] = (what == 'start') ? 'customin' : 'customout';\r\n\r\n                                    if(do_insert === true){\r\n                                        updateAnimInDb(new_handle, anim, false);\r\n                                        jQuery(this).dialog('close');\r\n                                    }else{\r\n                                        if(confirm(rev_lang.override_animation)){\r\n                                            updateAnimInDb(do_insert, anim, true);\r\n                                            jQuery(this).dialog('close');\r\n                                        }\r\n                                    }\r\n                                },\r\n                                'Cancel':function(){\r\n                                    jQuery(this).dialog('close');\r\n                                }\r\n                            }\r\n                        });\r\n                    }else{\r\n                        anim['params']['type'] = (what == 'start') ? 'customin' : 'customout';\r\n\r\n                        if(confirm(rev_lang.overwrite_animation)){\r\n                            updateAnimInDb(handle, anim, true);\r\n                            //check every layer if animation is set, if yes, then update values\r\n\r\n                        }\r\n                    }\r\n\r\n\r\n                });\r\n\r\n\r\n\r\n\r\n                jQuery('.save-as-current-animin, .save-as-current-animout').click(function() {\r\n                    var what = (jQuery(this).hasClass('save-as-current-animin')) ? 'start' : 'end';\r\n\r\n                    var curAnimHandle = (jQuery(this).hasClass('save-as-current-animin')) ? jQuery('#layer_animation option:selected').val() : jQuery('#layer_endanimation option:selected').val();\r\n\r\n                    currentAnimationType = (jQuery(this).hasClass('save-as-current-animin')) ? 'customin' : 'customout';\r\n\r\n                    jQuery('#dialog_save_as_animation').dialog({\r\n                        modal: true,\r\n                        width: 300,\r\n                        height: 200,\r\n                        resizable: false,\r\n                        dialogClass:\"tpdialogs\",\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                        buttons:{\r\n                            'Save':function(){\r\n                                var new_name = jQuery('#rs-save-as-animation').val(),\r\n                                    new_handle = UniteAdminRev.sanitize_input(new_name),\r\n                                    is_new_handle_existing = false,\r\n                                    anim = {};\r\n\r\n                                for(var key in initLayerAnimsDefault) if (initLayerAnimsDefault.hasOwnProperty(key)) {\r\n                                    if(key == new_handle){\r\n                                        is_new_handle_existing = true;\r\n                                        break;\r\n                                    }\r\n                                }\r\n\r\n                                for(var key in initLayerAnims) if (initLayerAnims.hasOwnProperty(key)) {\r\n                                    if(initLayerAnims[key]['handle'] == new_handle){\r\n                                        is_new_handle_existing = true;\r\n                                        break;\r\n                                    }\r\n                                }\r\n\r\n                                if(is_new_handle_existing){\r\n                                    alert(rev_lang.anim_with_handle_exists);\r\n                                    return false;\r\n                                }\r\n\r\n                                anim['params'] = createNewAnimObj(what);\r\n                                anim['handle'] = new_handle;\r\n                                anim['params']['type'] = currentAnimationType;\r\n\r\n                                updateAnimInDb(new_handle, anim, false);\r\n                                jQuery(this).dialog('close');\r\n                            },\r\n                            'Cancel':function(){\r\n                                jQuery(this).dialog('close');\r\n                            }\r\n                        }\r\n                    });\r\n\r\n\r\n\r\n                });\r\n\r\n                //jQuery('.rename-current-anim').click(function() {\r\n                jQuery('.rename-current-animin, .rename-current-animout').click(function() {\r\n                    var curAnimHandle = (jQuery(this).hasClass('rename-current-animin')) ? jQuery('#layer_animation option:selected').val() : jQuery('#layer_endanimation option:selected').val();\r\n                    var curAnimText = (jQuery(this).hasClass('rename-current-animin')) ? jQuery('#layer_animation option:selected').text() : jQuery('#layer_endanimation option:selected').text();\r\n\r\n                    if(curAnimHandle !== 'custom'){\r\n                        for(var key in initLayerAnimsDefault) if (initLayerAnimsDefault.hasOwnProperty(key)) {\r\n                            if(key === curAnimHandle){\r\n                                alert(rev_lang.cant_modify_default_anims);\r\n                                return false;\r\n                            }\r\n                        }\r\n                    }\r\n                    if(curAnimHandle == 'custom') return false;\r\n\r\n                    var curAnimID = curAnimHandle.replace('customin-', '').replace('customout-', '');\r\n\r\n                    jQuery('#rs-rename-animation').val(curAnimText);\r\n\r\n                    jQuery('#dialog_rename_animation').dialog({\r\n                        modal: true,\r\n                        width: 300,\r\n                        height: 200,\r\n                        resizable: false,\r\n                        dialogClass:\"tpdialogs\",\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                        buttons:{\r\n                            'Rename':function(){\r\n                                var new_name = jQuery('#rs-rename-animation').val(),\r\n                                    new_handle = UniteAdminRev.sanitize_input(new_name),\r\n                                    is_found = false,\r\n                                    is_new_handle_existing = false;\r\n\r\n                                for(var key in initLayerAnimsDefault) if (initLayerAnimsDefault.hasOwnProperty(key)) {\r\n                                    if(key == new_handle){\r\n                                        is_new_handle_existing = true;\r\n                                        break;\r\n                                    }\r\n                                }\r\n\r\n                                var id = '';\r\n\r\n                                for(var key in initLayerAnims) if (initLayerAnims.hasOwnProperty(key)) {\r\n                                    if(key == new_handle) is_new_handle_existing = true;\r\n                                    if(initLayerAnims[key]['id'] == curAnimID){\r\n                                        is_found = true;\r\n                                        id = initLayerAnims[key]['id'];\r\n                                        break;\r\n                                    }\r\n                                }\r\n\r\n                                if(is_new_handle_existing){\r\n                                    alert(rev_lang.anim_with_handle_exists);\r\n                                    return false;\r\n                                }\r\n\r\n                                if(is_found){\r\n                                    renameAnimInDb(id, new_handle);\r\n\r\n                                    jQuery(this).dialog('close');\r\n                                    return false;\r\n                                }\r\n                            },\r\n                            'Cancel':function(){\r\n                                jQuery(this).dialog('close');\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n\r\n                //jQuery('#delete-current-start-anim, #delete-current-end-anim').click(function(){\r\n                jQuery('#delete-current-animin, #delete-current-animout').click(function(){\r\n                    var curAnimHandle = (jQuery(this).attr('id') == 'delete-current-animin') ? jQuery('#layer_animation').val() : jQuery('#layer_endanimation').val();\r\n                    var curAnimText = (jQuery(this).attr('id') == 'delete-current-animin') ? jQuery('#layer_animation option:selected').text() : jQuery('#layer_endanimation option:selected').text();\r\n\r\n                    var isOriginal = (curAnimHandle.indexOf('custom') > -1) ? false : true;\r\n\r\n                    if(isOriginal || curAnimHandle == 'custom'){\r\n                        alert(rev_lang.default_animations_cant_delete);\r\n                    }else{\r\n                        if(confirm(rev_lang.really_delete_anim+' \"'+curAnimText+'\"?')){\r\n                            deleteAnimInDb(curAnimHandle);\r\n                        }\r\n                    }\r\n\r\n                });\r\n\r\n                //SHOW / HIDE EXTRA ANIMATION SETTINGS\r\n                jQuery('#add_customanimation_in').click(function() {\r\n                    currentAnimationType = 'customin';\r\n                    var btn = jQuery(this);\r\n\r\n                    var sc = jQuery('#extra_start_animation_settings'),\r\n                        ec = jQuery('#extra_end_animation_settings');\r\n                    if (sc.css(\"display\")==\"block\") {\r\n                        sc.hide(200);\r\n                        btn.removeClass(\"selected\");\r\n                    } else {\r\n                        sc.show(200);\r\n                        btn.addClass(\"selected\");\r\n                    }\r\n                    ec.hide(200);\r\n                });\r\n\r\n\r\n                jQuery('#add_customanimation_out').click(function() {\r\n                    currentAnimationType = 'customout';\r\n                    var btn = jQuery(this);\r\n                    var sc = jQuery('#extra_start_animation_settings'),\r\n                        ec = jQuery('#extra_end_animation_settings');\r\n                    if (ec.css(\"display\")==\"block\") {\r\n                        ec.hide(200);\r\n                        btn.removeClass(\"selected\");\r\n                    } else {\r\n                        ec.show(200);\r\n                        btn.addClass(\"selected\");\r\n                    }\r\n                    sc.hide(200);\r\n\r\n                });\r\n\r\n\r\n                jQuery('#reset-current-animin, #reset-current-animout').click(function(){\r\n                    var what = (jQuery(this).hasClass('reset-current-animin')) ? 'start' : 'end';\r\n\r\n                    var objLayer = t.getCurrentLayer();\r\n\r\n                    if(what == 'start' && typeof(objLayer['orig-anim-handle']) !== 'undefined'){\r\n                        jQuery('#layer_animation option[value=\"'+objLayer['orig-anim-handle']+'\"]').attr('selected', true).change();\r\n                    }\r\n                    if(what == 'end' && typeof(objLayer['orig-endanim-handle']) !== 'undefined'){\r\n                        jQuery('#layer_endanimation option[value=\"'+objLayer['orig-endanim-handle']+'\"]').attr('selected', true).change();\r\n                    }\r\n                });\r\n\r\n\r\n                jQuery('#button_edit_css, #style-morestyle, .close_extra_settings').click(function() {\r\n\r\n                    var es = jQuery('#extra_style_settings'),\r\n                        btn = jQuery('#button_edit_css'),\r\n                        mainbt = jQuery(\"#style-morestyle\");\r\n\r\n                    if (es.css(\"display\")==\"block\") {\r\n                        es.hide(200);\r\n                        btn.removeClass(\"selected\");\r\n                        mainbt.removeClass(\"showmore\");\r\n                    } else {\r\n                        es.show(200);\r\n                        btn.addClass(\"selected\");\r\n                        mainbt.addClass(\"showmore\");\r\n                    }\r\n                });\r\n\r\n\r\n\r\n\r\n                // SWITCH BACK AND FORWARDS BETWEEN SETTINGS AND SAVE DPENEDING IF RENAME OF SAVE BUTTON IS VISIBLE\r\n                jQuery('.rename-current-css').click(function() {\r\n\r\n                    jQuery('#rs-rename-css').val(jQuery('#layer_caption').val());\r\n\r\n                    jQuery('#dialog_rename_css').dialog({\r\n                        modal:true,\r\n                        resizable:false,\r\n                        width:400,\r\n                        closeOnEscape:true,\r\n                        dialogClass:\"tpdialogs\",\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                        buttons:{\r\n                            'Rename':function(){\r\n                                jQuery('#rs-rename-css').val(UniteAdminRev.sanitize_input(jQuery('#rs-rename-css').val()));\r\n                                var new_css_name = jQuery('#rs-rename-css').val();\r\n                                if(new_css_name != ''){\r\n                                    var curStyleName = jQuery('#layer_caption').val();\r\n\r\n                                    var\tis_existing = UniteCssEditorRev.checkIfHandleExists(new_css_name);\r\n                                    var\tis_existing_old = UniteCssEditorRev.checkIfHandleExists(curStyleName);\r\n\r\n                                    if(is_existing_old === false){ alert(rev_lang.css_orig_name_does_not_exists); return false; }\r\n\r\n                                    if(is_existing !== false || curStyleName == new_css_name){ alert(rev_lang.css_name_already_exists); return false; } //cant rename to another existing name\r\n\r\n                                    UniteCssEditorRev.renameStylesInDb(curStyleName, new_css_name);\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                });\r\n\r\n\r\n                /**\r\n                 * Save As Current CSS\r\n                 **/\r\n                jQuery('.save-as-current-css').click(function() {\r\n                    //modal with selection of new style name\r\n                    jQuery('#rs-save-as-css').val(jQuery('#layer_caption').val());\r\n\r\n                    jQuery('#dialog_save_as_css').dialog({\r\n                        modal:true,\r\n                        resizable:false,\r\n                        width:400,\r\n                        closeOnEscape:true,\r\n                        dialogClass:\"tpdialogs\",\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                        buttons:{\r\n                            'Save':function(){\r\n                                jQuery('#rs-save-as-css').val(UniteAdminRev.sanitize_input(jQuery('#rs-save-as-css').val()));\r\n                                var new_css_name = jQuery('#rs-save-as-css').val();\r\n                                if(new_css_name != ''){\r\n\r\n                                    var\tis_existing = UniteCssEditorRev.checkIfHandleExists(new_css_name);\r\n                                    if(is_existing !== false){ alert(rev_lang.css_name_already_exists); return false; } //cant rename to another existing name\r\n\r\n                                    UniteCssEditorRev.saveStylesInDb(new_css_name, true, jQuery('#dialog_save_as_css'));\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                });\r\n\r\n\r\n                /**\r\n                 * Delete Current CSS\r\n                 **/\r\n                jQuery('.delete-current-css').click(function() {\r\n                    if(confirm(rev_lang.delete_this_caption) === false) return false;\r\n\r\n                    var curStyleName = jQuery('#layer_caption').val();\r\n\r\n                    var\tis_existing = UniteCssEditorRev.checkIfHandleExists(curStyleName);\r\n                    if(is_existing === false){ alert(rev_lang.css_name_does_not_exists); return false; } //cant rename to another existing name\r\n\r\n                    //rename the css name or create new one depending on what is set\r\n                    UniteCssEditorRev.deleteStylesInDb(curStyleName, is_existing);\r\n\r\n                });\r\n\r\n\r\n                /**\r\n                 * Save Current CSS\r\n                 **/\r\n                jQuery('.save-current-css').click(function() {\r\n                    if(confirm(rev_lang.this_will_change_the_class)){\r\n                        var save_handle = jQuery('#layer_caption').val();\r\n                        var id = UniteCssEditorRev.checkIfHandleExists(save_handle);\r\n\r\n                        if(id !== false){ //update existing style\r\n                            UniteCssEditorRev.saveStylesInDb(save_handle, false);\r\n                        }else{ //save as new\r\n                            UniteCssEditorRev.saveStylesInDb(save_handle, true);\r\n                        }\r\n                    }\r\n                });\r\n\r\n\r\n                jQuery('.reset-current-css').click(function() {\r\n\r\n                    jQuery('input[name=\"rs-css-set-on[]\"]').each(function(){\r\n                        jQuery(this).attr('checked', true);\r\n                    });\r\n                    jQuery('input[name=\"rs-css-include[]\"]').each(function(){\r\n                        jQuery(this).attr('checked', true);\r\n                    });\r\n\r\n                    var layer = t.getCurrentLayer();\r\n                    if(layer.style !== undefined){\r\n                        //open modal and ask for changes\r\n                        jQuery('#dialog-change-style-from-css').dialog({\r\n                            buttons:{'OK':function(){\r\n                                //check what should be updated on which device types\r\n                                var is_allowed = false,\r\n                                    set_to = {'device':[],'include':[]};\r\n\r\n                                jQuery('input[name=\"rs-css-set-on[]\"]').each(function(){\r\n                                    if(jQuery(this)[0].checked){\r\n                                        is_allowed = true;\r\n                                        set_to['device'].push(jQuery(this).val());\r\n                                    }\r\n                                });\r\n\r\n                                jQuery('input[name=\"rs-css-include[]\"]').each(function(){\r\n                                    if(jQuery(this)[0].checked){\r\n                                        set_to['include'].push(jQuery(this).val());\r\n                                    }\r\n                                });\r\n\r\n                                if(!is_allowed){\r\n                                    alert(rev_lang.select_at_least_one_device_type);\r\n                                    return true;\r\n                                }\r\n\r\n                                layer.style = jQuery('#layer_caption').val();\r\n\r\n\r\n                                //update values that can be set without changing the class\r\n                                t.reset_to_default_static_styles(layer, set_to['include'], set_to['device']);\r\n                                // Reset Fields from Style Template\r\n\r\n                                updateSubStyleParameters(layer, true);\r\n\r\n                                jQuery('#layer_caption').change();\r\n                                t.updateLayerFromFields();\r\n\r\n                                jQuery('#dialog-change-style-from-css').dialog('close');\r\n                            },'Close':function(){\r\n                                jQuery('#dialog-change-style-from-css').dialog('close');\r\n                            }},\r\n                            minWidth: 275,\r\n                            minHeight: 365,\r\n                            modal: true,\r\n                            dialogClass: 'tpdialogs',\r\n                            create:function(ui) {\r\n                                jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                            },\r\n                            close: function( event, ui ){\r\n                            },\r\n                            open:function() {\r\n                                jQuery('.rs-style-device_input').each(function() {\r\n                                    var inp = jQuery(this);\r\n                                    if (inp.attr('checked')===\"checked\")\r\n                                        inp.siblings('.rs-style-device_selector_prev').addClass(\"selected\");\r\n                                    else\r\n                                        inp.siblings('.rs-style-device_selector_prev').removeClass(\"selected\");\r\n                                })\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                });\r\n\r\n                jQuery('body').on('click change','.rs-style-device_input',function() {\r\n                    var inp = jQuery(this);\r\n                    if (inp.attr('checked')===\"checked\")\r\n                        inp.siblings('.rs-style-device_selector_prev').addClass(\"selected\");\r\n                    else\r\n                        inp.siblings('.rs-style-device_selector_prev').removeClass(\"selected\");\r\n                });\r\n\r\n\r\n\r\n\r\n                // TAB CHANGES IN SLIDER SETTINGS AND IN ANIMATION EXTRAS\r\n                jQuery('.rs-layer-animation-settings-tabs li, .rs-layer-settings-tabs li').click(function() {\r\n\r\n                    var tn = jQuery(this),\r\n                        tw = tn.closest('ul').find('.selected');\r\n                    jQuery(tw.data('content')).hide(0);\r\n                    tw.removeClass(\"selected\");\r\n                    tn.addClass(\"selected\");\r\n                    jQuery(tn.data('content')).show(0);\r\n\r\n                    if(tn.data('content') == '#rs-hover-content-wrapper'){\r\n                        //4 u kriki\r\n                    }\r\n\r\n                });\r\n\r\n                // MOUSE MOVE SHOULD MOVE THE SMALL BLUE LINES ON RULERS\r\n                jQuery('body').on('mousemove','#thelayer-editor-wrapper',function(event) {\r\n\r\n                    jQuery('#verlinie,#horlinie,#verlinetext,#horlinetext').css({visibility:'visible'});\r\n\r\n                    var mx = event.pageX - jQuery(this).offset().left,\r\n                        my = event.pageY - jQuery(this).offset().top,\r\n                        dl = jQuery('#divLayers'),\r\n                        l = parseInt(dl.offset().left,0) - parseInt(jQuery('#thelayer-editor-wrapper').offset().left,0);\r\n\r\n                    jQuery('#verlinie').css({left:mx+\"px\"});\r\n                    jQuery('#horlinie').css({top:my+\"px\"});\r\n\r\n                    jQuery('#verlinetext').html(Math.round(mx-l));\r\n                    jQuery('#horlinetext').html(Math.round(my-90));\r\n\r\n                    jQuery('#hor-css-linear .helplines-offsetcontainer').data('x',event.pageX-jQuery('#hor-css-linear .helplines-offsetcontainer').offset().left);\r\n                    jQuery('#hor-css-linear .helplines-offsetcontainer').data('y',my);\r\n                });\r\n\r\n                // Reset position on\r\n                jQuery('body').on('mouseout','#thelayer-editor-wrapper',function(event) {\r\n                    jQuery('#verlinie,#horlinie,#verlinetext,#horlinetext').css({visibility:'hidden'});\r\n                });\r\n\r\n                // ON CLICK DRAW SOME HELP GRID LINES\r\n                jQuery('#hor-css-linear, #ver-css-linear, #verlinie, #horlinie').click(function() {\r\n                    var hcl = jQuery('#hor-css-linear .helplines-offsetcontainer'),\r\n                        vcl = jQuery('#ver-css-linear .helplines-offsetcontainer'),\r\n                        x = hcl.data('x'),\r\n                        y = hcl.data('y')-40,\r\n                        ph = jQuery('#thelayer-editor-wrapper').outerHeight(true),\r\n                        pw = jQuery('#thelayer-editor-wrapper').outerWidth(true);\r\n\r\n                    jQuery('#helpergrid').remove();\r\n                    jQuery('#rs-grid-sizes').val('custom');\r\n                    punchgs.TweenLite.to(hcl,0.3,{autoAlpha:1});\r\n                    punchgs.TweenLite.to(vcl,0.3,{autoAlpha:1});\r\n\r\n                    if (y<40 && x>0)\r\n                        hcl.append('<div class=\"helplines\" data-left=\"'+x+'\" data-top=\"'+y+'\" style=\"position:absolute;width:1px;height:'+(ph-41)+'px;background:#4AFFFF;left:'+x+'px;top:-15px\"><i class=\"helpline-drag eg-icon-move\"></i><i class=\"helpline-remove eg-icon-cancel\"></i></div>');\r\n                    if (x<40 && y>0)\r\n                        vcl.append('<div class=\"helplines\" data-left=\"'+x+'\" data-top=\"'+y+'\"  style=\"position:absolute;width:'+(pw-35)+'px;height:1px;background:#4AFFFF;top:'+y+'px;left:-15px\"><i class=\"helpline-drag eg-icon-move\"></i><i class=\"helpline-remove eg-icon-cancel\"></i></div>');\r\n\r\n                    try{hcl.find('.helplines').draggable(\"destroy\");} catch(e) {}\r\n                    try{vcl.find('.helplines').draggable(\"destroy\");} catch(e) {}\r\n                    hcl.find('.helplines').draggable({ handle:\".helpline-drag\", axis:\"x\" });\r\n                    vcl.find('.helplines').draggable({ handle:\".helpline-drag\", axis:\"y\" });\r\n                });\r\n\r\n                // REMOVE HELPLINE MOVERS\r\n                jQuery('body').on(\"click\",\".helpline-remove\",function() {\r\n                    jQuery(this).parent().remove();\r\n                });\r\n\r\n                jQuery('.extra_sub_settings_wrapper').addClass(\"normal_rename\");\r\n\r\n                jQuery('#extra_start_animation_settings input, #extra_end_animation_settings input').change(function(){\r\n                    if(jQuery(this).attr('id') === 'new_start_animation_name' || jQuery(this).attr('id') === 'new_end_animation_name') return false;\r\n\r\n                    var my_sel = (currentAnimationType == 'customin') ? jQuery('#layer_animation') : jQuery('#layer_endanimation'); //customout\r\n                    if(currentAnimationType == 'customin')\r\n                        jQuery(this).closest('.extra_start_animation_settings').removeClass('normal_rename normal_save save_rename save_save').addClass('normal_save');\r\n                    else\r\n                        jQuery(this).closest('.extra_end_animation_settings').removeClass('normal_rename normal_save save_rename save_save').addClass('normal_save');\r\n\r\n                    var original = my_sel.find('option:selected').text();\r\n                    var original_handle = my_sel.find('option:selected').val();\r\n                    if(my_sel.find('option:selected').val() !== 'custom'){\r\n                        my_sel.find('option[value=\"custom\"]').attr('selected', true).change();\r\n                        //set animation fallback to the original\r\n                        if(currentAnimationType == 'customin')\r\n                            t.updateCurrentLayer({'animation':'custom','orig-anim':original,'orig-anim-handle':original_handle});\r\n                        else\r\n                            t.updateCurrentLayer({'endanimation':'custom','orig-endanim':original,'orig-endanim-handle':original_handle});\r\n\r\n                    }\r\n                });\r\n\r\n\r\n                jQuery('#extra_style_settings input, #extra_style_settings select').change(function(){\r\n                    if(jQuery(this).attr('id') === 'overwrite_style_name' || jQuery(this).attr('id') === 'new_style_name') return false;\r\n                    jQuery('#extra_style_settings').removeClass('normal_rename normal_save save_rename save_save').addClass('normal_save');\r\n                });\r\n\r\n                // CHANGES ON BACKGROUND ELEMENTS SHOULD REDRAW THE SLIDE TIMELINE\r\n                jQuery('input[name=\"background_type\"], #slide_bg_fit, input[name=\"bg_fit_x\"], input[name=\"bg_fit_y\"], #slide_bg_position,input[name=\"bg_position_x\"],input[name=\"bg_position_y\"],#slide_bg_repeat ').change(function() {\r\n                    t.changeSlotBGs();\r\n                })\r\n\r\n\r\n                jQuery('body').on('blur','.timer-layer-text',function() {\r\n                    t.updateLayerFromFields();\r\n                });\r\n\r\n                jQuery('#the_current-editing-layer-title').on('blur',function() {\r\n                    jQuery('#layer_sort_'+t.selectedLayerSerial+\">.layer_sort_inner_wrapper .timer-layer-text\").val(jQuery(this).val());\r\n                    t.updateLayerFromFields();\r\n                });\r\n\r\n                jQuery('body').on('blur','.layer-title-in-list',function() {\r\n                    var serial = jQuery(this).closest('li').data('serial');\r\n                    if (serial===undefined || serial===\"\") return false;\r\n                    jQuery('#layer_sort_'+serial+\" \"+'>.layer_sort_inner_wrapper .timer-layer-text').val(jQuery(this).val());\r\n                    var objUpdate= {};\r\n                    objUpdate.alias = jQuery(this).val();\r\n                    t.updateLayerFromFields();\r\n                });\r\n\r\n\r\n                // LOCK / UNLOCK /\r\n                jQuery('body').on(\"click\",'.quick-layer-lock',function() {\r\n                    var b = jQuery(this),\r\n                        i = b.find('i'),\r\n                        p = b.closest('.layer-toolbar-li'),\r\n                        serial = p.data('serial'),\r\n                        htmllayer = t.getHtmlLayerFromSerial(serial);\r\n\r\n                    if (serial===undefined || serial===\"\") return false;\r\n\r\n                    if(u.isLayerLocked(htmllayer)) {\r\n                        u.unlockLayer(serial);\r\n                        jQuery('.layer-toolbar-li').each(function() {\r\n                            var li = jQuery(this);\r\n                            if (li.data('serial')==serial) {\r\n                                var b=li.find('.quick-layer-lock'),\r\n                                    i=b.find('i');\r\n                                b.addClass(\"in-on\").removeClass(\"in-off\");\r\n                                i.removeClass(\"eg-icon-lock\").addClass(\"eg-icon-lock-open\");\r\n                            }\r\n                        });\r\n                    } else {\r\n                        u.lockLayer(serial);\r\n                        jQuery('.layer-toolbar-li').each(function() {\r\n                            var li = jQuery(this);\r\n                            if (li.data('serial')==serial) {\r\n                                var b=li.find('.quick-layer-lock'),\r\n                                    i=b.find('i');\r\n                                b.addClass(\"in-off\").removeClass(\"in-on\");\r\n                                i.removeClass(\"eg-icon-lock-open\").addClass(\"eg-icon-lock\");\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n\r\n                // VIEW / UNVIEW ELEMENTS\r\n                jQuery('body').on(\"click\",'.quick-layer-view',function() {\r\n                    var b = jQuery(this),\r\n                        p = b.closest('.layer-toolbar-li'),\r\n                        serial = p.data('serial');\r\n\r\n                    if (serial===undefined || serial===\"\") return false;\r\n                    var\tobjLayer = t.getLayer(serial);\r\n\r\n\r\n                    if(u.isLayerVisible(objLayer.references.htmlLayer)){\r\n                        objLayer.visible = false;\r\n                        u.hideLayer(objLayer);\r\n                        jQuery('.layer-toolbar-li').each(function() {\r\n                            var li = jQuery(this);\r\n                            if (li.data('serial')==serial) {\r\n                                var b=li.find('.quick-layer-view'),\r\n                                    i=b.find('i');\r\n                                b.addClass(\"in-off\").removeClass(\"in-on\");\r\n                                i.removeClass(\"eg-icon-eye\").addClass(\"eg-icon-eye-off\");\r\n                            }\r\n                        });\r\n                    }else{\r\n                        objLayer.visible = true;\r\n                        u.showLayer(objLayer);\r\n                        jQuery('.layer-toolbar-li').each(function() {\r\n                            var li = jQuery(this);\r\n                            if (li.data('serial')==serial) {\r\n                                var b=li.find('.quick-layer-view'),\r\n                                    i=b.find('i');\r\n                                b.addClass(\"in-on\").removeClass(\"in-off\");\r\n                                i.removeClass(\"eg-icon-eye-off\").addClass(\"eg-icon-eye\");\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n\r\n                jQuery('.rs-row-break-selector').click(function() {\r\n                    var _t = jQuery(this);\r\n                    jQuery('.rs-row-break-selector.selected').removeClass('selected');\r\n                    _t.addClass(\"selected\");\r\n                    jQuery('#column_break_at option:selected').prop('selected',false);\r\n                    jQuery('#column_break_at option[value=\"'+_t.data(\"val\")+'\"]').attr('selected','selected');\r\n                    var objUpdate = {};\r\n                    objUpdate[\"column_break_at\"] = _t.data(\"val\");\r\n                    t.updateLayer(t.selectedLayerSerial,objUpdate,false,true)\r\n                });\r\n\r\n                // GROUP / COLUMNG HANDLING\r\n                jQuery('#rs-check-row-layout').click(function(){\r\n\r\n                    //get current selected layer\r\n                    var row_layer = t.getCurrentLayer();\r\n\r\n                    //check if layer is a row and can have columns\r\n                    if(row_layer.type !== 'row') return false;\r\n\r\n                    var rl = jQuery('input[name=\"rs-row-layout\"]').val(),\r\n                        rl_san = rl.replace(/[^\\d\\+\\/ ]/gi, ''); //remove all but numbers, / and +\r\n\r\n                    jQuery('input[name=\"rs-row-layout\"]').val(rl_san);\r\n\r\n                    if(rl !== rl_san){\r\n                        alert('Wrong format, please enter for example 1/2 + 1/4 + 1/4');\r\n                        return false;\r\n                    }\r\n\r\n                    //now check if the calculation is 1, if not then error_get_last\r\n                    var result = eval(rl_san);\r\n                    result = Math.ceil(result*100000000000000) / 100000000000000;\r\n\r\n\r\n                    if(result !== 1){\r\n                        alert('The columns have to be added up to 1, so for example 1/2 + 1/8 is lower than 1');\r\n                        return false;\r\n                    }\r\n\r\n\r\n                    t.ignorAllUndoRedoLogs = true;\r\n\r\n                    //check how many columns we have and how big they are\r\n                    var columns_f = rl_san.split('+'),\r\n                        columns = new Array(),\r\n                        undeleted_columns = new Array(),\r\n                        deleted_columns = new Array();\r\n\r\n                    //Collect Columns in the Current ROW\r\n                    jQuery.each(t.arrLayers, function(index,objLayer) {\r\n                        if(objLayer.type === \"column\" && objLayer.p_uid == row_layer.unique_id) {\r\n                            columns.push(objLayer);\r\n                            if (objLayer.deleted!==true) undeleted_columns.push(objLayer);\r\n                            if (objLayer.deleted===true) deleted_columns.push(objLayer);\r\n                        }\r\n                    });\r\n\r\n                    if(columns_f.length > undeleted_columns.length){ //new has more\r\n                        //add columns until even\r\n                        var availablecolumns = 0;\r\n                        for(var i = columns.length; i < columns_f.length; i++){\r\n                            var c_objLayer = {\r\n                                type: \"column\",\r\n                                text: initColumnName + (id_counter +1),\r\n                                p_uid: row_layer.unique_id,\r\n                                column_size: columns_f[i],\r\n                                createdOnInit: false\r\n                            }\r\n                            addLayer(c_objLayer);\r\n                            availablecolumns++;\r\n                        }\r\n\r\n                        for (var i=0;i<deleted_columns.length;i++) {\r\n                            if (availablecolumns<columns_f.length-1) {\r\n                                var objData = { deleted:false};\r\n                                t.updateLayer(deleted_columns[i].serial,objData,false,true)\r\n                                deleted_columns[i].deleted = false;\r\n                                deleted_columns[i].references.htmlLayer.removeClass(\"layer-deleted\");\r\n                                deleted_columns[i].references.quicklayer.removeClass(\"layer-deleted\");\r\n                                deleted_columns[i].references.sorttable.layer.removeClass(\"layer-deleted\");\r\n                                deleted_columns[i].references.sorttable.timeline.removeClass(\"layer-deleted\");\r\n                            }\r\n                            availablecolumns++;\r\n                        }\r\n\r\n                    }else if(columns_f.length < undeleted_columns.length){ //new has less\r\n                        // Remove highest Columsn 1by1 and move Layers to last available Column\r\n                        for(var i = undeleted_columns.length; i > columns_f.length; i--){\r\n                            //check the columns, remove the highest unique_id and save all the layers by moving them to the column before\r\n                            var highest = 0,\r\n                                second = 0;\r\n\r\n                            jQuery.each(undeleted_columns, function(index,column) {\r\n                                if (column!=undefined && column.unique_id > highest && column.deleted===false) {\r\n                                    second = highest;\r\n                                    highest = column.unique_id;\r\n                                }\r\n                            });\r\n                            jQuery.each(t.arrLayers, function(index,objLayer) {\r\n                                if (objLayer.p_uid === highest) objLayer.p_uid = second;\r\n                                if (objLayer.unique_id === highest) t.deleteLayer(objLayer.serial);\r\n                            });\r\n                        }\r\n\r\n                    }else{ //same amount\r\n\r\n                    }\r\n                    var i = 0;\r\n                    //set the column sizes\r\n                    jQuery.each(t.arrLayers, function(index,objLayer){\r\n                        if(objLayer.p_uid == row_layer.unique_id && objLayer.deleted===false && i<columns_f.length){\r\n                            objLayer.column_size = columns_f[i];\r\n                            i++;\r\n                        }\r\n                    })\r\n                    t.ignorAllUndoRedoLogs = false;\r\n                    u.organiseGroupsAndLayer(u);\r\n                    u.allLayerToIdle();\r\n                    t.makeRowSortableDroppable();\r\n                    t.setLayerSelected(row_layer.serial);\r\n                    row_layer.references.htmlLayer.find('.row_editor').addClass(\"open_re\");\r\n\r\n                    jQuery('#rs-layout-row-composer').show(); //.appendTo(row_layer.references.htmlLayer.find('.row_toolbar'));\r\n                    u.timeLineTableDimensionUpdate();\r\n                    t.hideRowLayoutComposer();\r\n\r\n                });\r\n\r\n                //change image actions\r\n                jQuery(\"#button_change_background_image, #button_change_background_image_objlib\").click(function(){\r\n                    var layer = t.getCurrentLayer();\r\n                    if(layer !== null){\r\n                        if (jQuery(this).attr('id') == 'button_change_background_image_objlib') {\r\n                            layer.image_library = \"objectlibrary\";\r\n                            jQuery('#dialog_addobj').data('changeimg',true);\r\n                            jQuery('#dialog_addobj').data('changeimgserial',layer.serial);\r\n                            t.callObjectLibraryDialog(\"layer\");\r\n                        } else {\r\n                            delete(layer.image_library);\r\n                            UniteAdminRev.openAddImageDialog(rev_lang.select_layer_image,function(urlImage){\r\n                                switchLayerBackground({bgimage_url:urlImage});\r\n                            });\r\n                        }\r\n                    }\r\n                });    //change image click.\r\n\r\n                jQuery(\"#button_clear_background_image\").click(function(){\r\n                    switchLayerBackground({bgimage_url:\"\"});\r\n                });\r\n\r\n                t.sortFontTypesByUsage();\r\n                t.cloneArrLayers();\r\n                // INIT CONTEXT MENU\r\n                cm.init(t, tpLayerTimelinesRev);\r\n\r\n            }\r\n\r\n            /***\r\n             *     SET Dimension of Slide based on Rows New\r\n             */\r\n            t.extendSlideHeightBasedOnRows = function() {\r\n                var minheight = 0;\r\n                if (typeof rev_sizes ==\"undefined\" || rev_sizes===undefined) return;\r\n                jQuery('.row-zone-container').each(function() {\r\n                    var _t=jQuery(this);\r\n                    if (!_t.hasClass(\"emptyzone\"))\r\n                        minheight=minheight + _t.height();\r\n                });\r\n                minheight = minheight <rev_sizes[layout][1] ? rev_sizes[layout][1] : minheight;\r\n\r\n                jQuery('.tp-bgimg.defaultimg, #divLayers').each(function() {\r\n                    var _ = jQuery(this);\r\n                    if (!jQuery(this).hasClass(\"slide-transition-example\"))\r\n                        _.css({height:minheight});\r\n                });\r\n\r\n                if (__slidertype!=\"auto\")\r\n                    jQuery('#divbgholder').css({minHeight:minheight,height:minheight});\r\n                else\r\n                    jQuery('#divbgholder').css({minHeight:minheight,height:minheight});\r\n                jQuery('#divLayers-wrapper').css('height', minheight + 1);\r\n\r\n                /*u.resetSlideAnimations();\r\n                 jQuery(window).trigger(\"resize\");\r\n                 redrawAllLayerHtml();\r\n                 t.setMiddleRowZone(100);*/\r\n            }\r\n\r\n\r\n            /***\r\n             * Returns all Layers and Columns within a Group\r\n             */\r\n            t.getLayersInGroup = function(unique_id) {\r\n                var list = {\r\n                    layers : [],\r\n                    columns : []\r\n                };\r\n                // Find All Columns\r\n                jQuery.each(t.arrLayers,function(index,objLayer) {\r\n                    if (objLayer.p_uid === unique_id && objLayer.type===\"column\")\r\n                        list.columns.push(objLayer);\r\n                });\r\n                // Find All Layers in Group and Columns\r\n                jQuery.each(t.arrLayers,function(index,objLayer) {\r\n                    if (objLayer.p_uid === unique_id && objLayer.type!==\"column\")\r\n                        list.layers.push(objLayer);\r\n                    for (var i=0;i<list.columns.length;i++) {\r\n                        if (list.columns[i].unique_id === objLayer.p_uid) {\r\n                            list.layers.push(objLayer);\r\n                        }\r\n                    }\r\n                });\r\n                return list;\r\n            }\r\n\r\n            t.getHighestGroupOrder = function(zone) {\r\n                var hgroup = 0;\r\n                for (key in t.arrLayers) if (t.arrLayers.hasOwnProperty(key)) {\r\n                    var layer = t.arrLayers[key];\r\n                    if (layer.type===\"row\" && t.getVal(layer, 'align_vert')===zone)\r\n                        if (hgroup<=layer.groupOrder) hgroup = layer.groupOrder+1;\r\n\r\n                }\r\n                return hgroup;\r\n            }\r\n\r\n            t.makeRowSortableDroppable = function() {\r\n\r\n                //Dropable and Sortable Elements in Rows and Columns\r\n                jQuery('#divLayers, .tp_layer_group_inner_wrapper .slide_layer_type_column, .slide_layer_type_group .tp_layer_group_inner_wrapper').droppable({\r\n                    refreshPositions:true,\r\n                    tolerance:\"pointer\",\r\n                    accept:\".slide_layer_type_text, .slide_layer_type_image, .slide_layer_type_video, .slide_layer_type_shape, .slide_layer_type_audio, .slide_layer_type_svg, .slide_layer_type_button\",\r\n                    over:function(event,ui) {\r\n                        var col = jQuery(event.target);\r\n                        jQuery('.slide_layer_type_column, .slide_layer_type_row, .slide_layer_type_group').removeClass(\"layer_selected\").removeClass('layerchild_selected');\r\n                        if (col[0].id!==\"divLayers\") {\r\n                            punchgs.TweenLite.set(col,{zIndex:0});\r\n                            col.addClass(\"layer_selected\").addClass('layerchild_selected');\r\n                        }\r\n                        if (event.target.id!==\"divLayers\");\r\n                        col.closest('.slide_layer_type_row, .slide_layer_type_group').addClass(\"layer_selected\");\r\n                        col.closest('.row-zone-container').addClass('layerrow_selected');\r\n\r\n\r\n\r\n                    },\r\n                    out:function(event,ui) {\r\n                        var col = jQuery(event.target);\r\n                        punchgs.TweenLite.set(col,{zIndex:1});\r\n                        if (col[0].id!==\"divLayers\")\r\n                            col.removeClass(\"layer_selected\").removeClass('layerchild_selected');\r\n                        col.closest('.layer_selected').removeClass(\"layer_selected\").removeClass('layerchild_selected');\r\n                        col.find('.layer_selected').removeClass(\"layer_selected\").removeClass('layerchild_selected');\r\n                        col.closest('.row-zone-container').removeClass('layerrow_selected');\r\n                        jQuery(ui.draggable).addClass(\"layer_selected\");\r\n\r\n                        //if (ui.draggable[0].parentNode.id!==\"divLayers\") jQuery('#divLayers').addClass(\"readytodrop\");\r\n\r\n                    },\r\n                    drop:function(event,ui) {\r\n\r\n                        jQuery(ui.draggable).data('dropin',jQuery(event.target));\r\n                        t.setMiddleRowZone(100);\r\n                        t.checkRowZoneContents();\r\n                        jQuery('.row-zone-container').removeClass(\"nowyouseeme\");\r\n                        jQuery('.row-zone-container').removeClass('layerrow_selected');\r\n\r\n                    }\r\n                });\r\n\r\n                jQuery('#row-zone-top, #row-zone-middle, #row-zone-bottom').sortable({\r\n                    refreshPositions:true,\r\n                    handle:\".row_moveme\",\r\n                    start:function(event,ui) {\r\n\r\n                        ui.placeholder.html(ui.item.html());\r\n                        jQuery('.row-zone-container').addClass(\"nowyouseeme\");\r\n                        jQuery('.row-zone-container').addClass('layerrow_selected');\r\n\r\n                    },\r\n                    stop:function(event,ui) {\r\n\r\n                        jQuery('.row-zone-container').removeClass(\"nowyouseeme\");\r\n                        jQuery('.row-zone-container').removeClass('layerrow_selected');\r\n                        t.setRowZoneOrders();\r\n                        u.organiseGroupsAndLayer();\r\n                    },\r\n                    update:function(event,ui) {\r\n                        var objLayer = t.getLayer(t.selectedLayerSerial);\r\n                        switch (ui.item[0].parentNode.id) {\r\n                            case \"row-zone-top\":\r\n                                objLayer = t.setVal(objLayer, 'align_vert', \"top\", true);\r\n                                break;\r\n                            case \"row-zone-middle\":\r\n                                objLayer = t.setVal(objLayer, 'align_vert', \"middle\", true);\r\n                                break;\r\n                            case \"row-zone-bottom\":\r\n                                objLayer = t.setVal(objLayer, 'align_vert', \"bottom\", true);\r\n                                break;\r\n                        }\r\n                        //t.setInnerGroupOrders(jQuery('#'+ui.item[0].parentNode.id));\r\n                        t.setRowZoneOrders();\r\n                        u.organiseGroupsAndLayer();\r\n                        t.updateLayerFormFields(objLayer.serial);\r\n                        t.setMiddleRowZone(100);\r\n                        t.checkRowZoneContents();\r\n\r\n\r\n\r\n                    },\r\n                    sort:function(event,ui) {\r\n\r\n                    }\r\n                })\r\n\r\n                jQuery('.slide_layer_type_column .tp_layer_group_inner_wrapper').sortable({\r\n                    refreshPositions:true,\r\n                    placeholder:'layer_placeholder_in_column',\r\n                    start:function(event,ui) {\r\n\r\n                        jQuery('.slide_layer_type_column, .slide_layer_type_row').removeClass(\"layer_selected\").removeClass('layerchild_selected');\r\n                        jQuery('.row-zone-container').removeClass('layerrow_selected');\r\n                        ui.placeholder.html(ui.item.html());\r\n                        var img = ui.placeholder.find('.innerslide_layer>img');\r\n                        if (img.length>0) {\r\n                            img.css({width:ui.item.width(), height:ui.item.height()});\r\n                        }\r\n                    },\r\n                    items:\"> .slide_layer_type_text, > .slide_layer_type_image, > .slide_layer_type_video, > .slide_layer_type_shape, > .slide_layer_type_audio, > .slide_layer_type_svg, > .slide_layer_type_button\",\r\n                    cancel:    \".slide_layer_type_row, .slide_layer_type_column, .slide_layer_type_group\",\r\n                    update:function(event,ui) {\r\n                        t.setInnerGroupOrders(jQuery(ui.item[0].parentNode));\r\n                        t.setMiddleRowZone(100);\r\n\r\n                    },\r\n                    sort:function(event,ui) {\r\n                        var a = jQuery(event.target);\r\n                        a.closest('.slide_layer_type_column').addClass(\"layer_selected\").addClass('layerchild_selected');\r\n                        a.closest('.slide_layer_type_row').addClass(\"layer_selected\");\r\n\r\n                    }\r\n                });\r\n            }\r\n\r\n            t.setRowZoneOrders = function() {\r\n                t.setInnerGroupOrders(jQuery('#row-zone-top'));\r\n                t.setInnerGroupOrders(jQuery('#row-zone-middle'));\r\n                t.setInnerGroupOrders(jQuery('#row-zone-bottom'));\r\n            }\r\n\r\n            t.setInnerGroupOrders = function (container) {\r\n\r\n                var order = container.sortable('toArray',{attribute:\"data-uniqueid\"});\r\n                for (var i=0;i<order.length;i++) {\r\n                    var objUpdate = {groupOrder:i};\r\n                    t.updateLayer(t.getLayerByUniqueId(order[i]).serial,objUpdate,false,true);\r\n                }\r\n\r\n            }\r\n\r\n\r\n\r\n            t.droppedContainerCheck = function (objLayer){\r\n\r\n\r\n                var htmllayer = objLayer.references.htmlLayer,\r\n                    dropcontainer = htmllayer.data('dropin'),\r\n                    p_uid;\r\n\r\n                if (objLayer.type===\"row\" || objLayer.type===\"column\" || objLayer.type===\"group\") {\r\n                    // Ignoe Drop. Return to old containerwe\r\n                } else {\r\n\r\n                    // ELEMENT IS DROPPED INTO A GROUP\r\n\r\n                    if (dropcontainer !=undefined && dropcontainer[0].classList.contains(\"tp_layer_group_inner_wrapper\")) {\r\n                        // ELEMENT IS ALREADY IN THE GROUP\r\n                        if (dropcontainer[0].contains(htmllayer[0])) {\r\n                            p_uid = objLayer.p_uid;\r\n                        } else {\r\n\r\n                            objLayer = t.setVal(objLayer,'align_hor',\"left\");\r\n                            objLayer = t.setVal(objLayer,'align_vert',\"top\");\r\n\r\n                            // ELEMENT IS DROPPED FIRST TIME IN THE GROUP\r\n                            var pos = htmllayer.position(),\r\n                                ocp = {left:0,top:0},\r\n                                zp = {left:0,top:0},\r\n                                origpos = htmllayer.data('originalPosition');\r\n                            if (objLayer.p_uid != -1) {\r\n\r\n                                var oldcontainer = t.getLayerByUniqueId(objLayer.p_uid)\r\n                                if (oldcontainer.type===\"column\" || oldcontainer.type===\"group\") {\r\n                                    ocp =  oldcontainer.references.htmlLayer.position();\r\n                                    var zc = oldcontainer.references.htmlLayer.closest(\".row-zone-container\");\r\n                                    zp = zc === undefined || zc.length==0 ? {left:0, top:0} : zc.position();\r\n                                    zp.top += zc === undefined || zc.length==0 ? 0 : parseInt(zc.css(\"marginTop\"),0);\r\n                                }\r\n\r\n                            }\r\n                            dropcontainer[0].appendChild(htmllayer[0]);\r\n\r\n                            p_uid = htmllayer.closest('.slide_layer_type_group').data('uniqueid');\r\n                            var pobj =  t.getLayerByUniqueId(p_uid),\r\n                                dim = {w:htmllayer.width(), h:htmllayer.height()};\r\n\r\n\r\n\r\n                            objLayer.p_uid = p_uid;\r\n\r\n                            jQuery.each(pobj.left,function(i,key) {\r\n                                if (objLayer.top!==undefined && pobj.top!==undefined && pobj.top[i]!==undefined) {\r\n                                    if (pobj.align_hor[i]===\"right\")\r\n                                        if (rev_sizes!==undefined)\r\n                                            newl = Math.round(pos.left+ocp.left- (rev_sizes[i][0]- (parseInt(pobj.left[i],0)+parseInt(pobj.max_width[i],0))));\r\n                                        else\r\n                                            newl = Math.round(pos.left+ocp.left- (jQuery('#divLayers').width() - parseInt(pobj.left[i],0)));\r\n                                    else\r\n                                        newl = Math.round(pos.left+ocp.left- parseInt(pobj.left[i],0));\r\n\r\n                                    if (pobj.align_vert[i]===\"bottom\")\r\n                                        if (rev_sizes!==undefined)\r\n                                            newt = Math.round(pos.top+ocp.top+zp.top- (rev_sizes[i][1]- (parseInt(pobj.top[i],0)+parseInt(pobj.max_height[i],0))));\r\n                                        else\r\n                                            newt = Math.round(pos.top+ocp.top+zp.top- (jQuery('#divLayers').height() - parseInt(pobj.top[i],0)));\r\n                                    else\r\n                                        newt = Math.round(pos.top+ocp.top+zp.top - parseInt(pobj.top[i],0));\r\n\r\n                                    objLayer.left[i] = oldcontainer ? newl : newl-1;\r\n                                    objLayer.top[i] = oldcontainer ? newt : newt-1;\r\n                                }\r\n                            });\r\n                            t.updateHtmlLayerPosition(false,objLayer,t.getVal(objLayer, 'top'),t.getVal(objLayer, 'left'),t.getVal(objLayer, 'align_hor'),t.getVal(objLayer, 'align_vert'));\r\n                            u.organiseGroupsAndLayer(false);\r\n                            pobj.references.htmlLayer.addClass(\"inwork\");\r\n                            jQuery('#focusongroup').addClass(\"inwork\");\r\n                        }\r\n\r\n                    } else\r\n\r\n                    if (dropcontainer !=undefined &&  dropcontainer[0].classList.contains(\"slide_layer_type_column\")) {\r\n                        // ELEMENT IS DROPPED INTO A ROW'S COLUMN\r\n                        if (!dropcontainer[0].getElementsByClassName('tp_layer_group_inner_wrapper')[0].contains(htmllayer[0]))\r\n                            dropcontainer[0].getElementsByClassName('tp_layer_group_inner_wrapper')[0].appendChild(htmllayer[0]);\r\n                        p_uid =  htmllayer.closest('.slide_layer_type_column').data('uniqueid');\r\n\r\n                        // SET ELEMENT WHITESPACE NORMAL IF IT COMES FROM ROOT\r\n                        var oldcontainer = t.getLayerByUniqueId(objLayer.p_uid);\r\n                        if (oldcontainer.type!==\"column\" && oldcontainer.type!==\"group\")\r\n                            objLayer = t.setVal(objLayer,'whitespace','normal');\r\n\r\n                        objLayer.p_uid = p_uid;\r\n                        u.organiseGroupsAndLayer(false);\r\n                        var ah = t.getVal(objLayer, 'align_hor'),\r\n                            av = t.getVal(objLayer, 'align_vert');\r\n                        ah = \"left\";\r\n                        av = \"top\";\r\n\r\n\r\n\r\n                        objLayer = t.setVal(objLayer,'align_hor',ah);\r\n                        objLayer = t.setVal(objLayer,'align_vert',av);\r\n                        if (objLayer.type===\"text\") {\r\n                            //    objLayer = t.setVal(objLayer, 'max_width', \"auto\", true);\r\n                            objLayer = t.setVal(objLayer, 'max_height', \"auto\", true);\r\n                        }\r\n                        if (objLayer.type===\"shape\") {\r\n                            var shapesizing = jQuery('#layer_cover_mode option:selected').val();\r\n                            if (shapesizing===\"fullheight\" || shapesizing===\"cover\" || shapesizing===\"cover-proportional\") {\r\n                                jQuery('#layer_cover_mode option:selected').prop('selected',false);\r\n                                var objUpdate = {};\r\n\r\n                                if (shapesizing===\"fullheight\") {\r\n                                    jQuery('#layer_cover_mode option[value=\"custom\"]').attr(\"selected\",\"selected\");\r\n                                    objUpdate = t.setVal(objUpdate, 'cover_mode', 'custom', true);\r\n                                }\r\n                                else {\r\n                                    jQuery('#layer_cover_mode option[value=\"fullwidth\"]').attr(\"selected\",\"selected\");\r\n                                    objUpdate = t.setVal(objUpdate, 'cover_mode', 'fullwidth', true);\r\n                                }\r\n                                t.updateLayer(objLayer.serial,objUpdate);\r\n                                t.set_cover_mode();\r\n                            }\r\n                        }\r\n                        setTimeout(function() {\r\n                            t.extendSlideHeightBasedOnRows();\r\n                        },100);\r\n                        unselectAllFocusedGroup();\r\n                    } else\r\n\r\n                    if (dropcontainer !=undefined &&  dropcontainer[0].id===\"divLayers\" && htmllayer[0].parentNode.id!==\"divLayers\") {\r\n                        // Add Back to Mainstage\r\n                        var pos = htmllayer.position(),\r\n                            pobj = t.getLayerByUniqueId(objLayer.p_uid),\r\n                            off = pobj!=undefined && pobj.references!=undefined  && pobj.references.htmlLayer!=undefined ? pobj.references.htmlLayer.position() : {top:0,left:0},\r\n                            zp = {left:0, top:0},\r\n                            rp = {left:0, top:0};\r\n\r\n                        objLayer = t.setVal(objLayer,'align_hor',\"left\");\r\n                        objLayer = t.setVal(objLayer,'align_vert',\"top\");\r\n\r\n                        if (objLayer.p_uid != -1) {\r\n                            var oldcontainer = t.getLayerByUniqueId(objLayer.p_uid)\r\n                            if (oldcontainer.type===\"column\") {\r\n                                ocp =  oldcontainer.references.htmlLayer.position();\r\n                                var zc = oldcontainer.references.htmlLayer.closest(\".row-zone-container\"),\r\n                                    rc = oldcontainer.references.htmlLayer.closest(\".slide_layer_type_row\");\r\n                                rp = rc === undefined || rp.length==0 ? {left:0, top:0} : rc.position();\r\n                                zp = zc === undefined || zc.length==0 ? {left:0, top:0} : zc.position();\r\n                                zp.top += zc === undefined || zc.length==0 ? 0 : parseInt(zc.css(\"marginTop\"),0);\r\n                                rp.top += rc === undefined || rc.length==0 ? 0 : parseInt(rc.css(\"marginTop\"),0);\r\n                            }\r\n                        }\r\n                        objLayer.p_uid = -1;\r\n\r\n                        document.getElementById('divLayers').appendChild(htmllayer[0]);\r\n\r\n\r\n                        jQuery.each(objLayer.left,function(i,key) {\r\n                            objLayer.left[i] = Math.round(pos.left+1+off.left+zp.left+rp.left);\r\n                            objLayer.top[i] =  Math.round(pos.top+1+off.top+zp.top+rp.top);\r\n                        });\r\n\r\n\r\n                        t.updateHtmlLayerPosition(false,objLayer,t.getVal(objLayer, 'top'),t.getVal(objLayer, 'left'),\"left\",\"top\");\r\n                        u.organiseGroupsAndLayer(false);\r\n                        unselectAllFocusedGroup();\r\n                    }\r\n                }\r\n                t.setMiddleRowZone();\r\n                t.resetLayerSelected(objLayer);\r\n            }\r\n\r\n            t.checkRowZoneContents = function() {\r\n                jQuery('.row-zone-container').each(function() {\r\n                    if (this.children.length === 0)\r\n                        jQuery(this).addClass(\"emptyzone\");\r\n                    else\r\n                        jQuery(this).removeClass(\"emptyzone\");\r\n                })\r\n            }\r\n\r\n            t.setMiddleRowZone = function(delay) {\r\n                delay = delay === undefined ? 0 : delay;\r\n                setTimeout(function() {\r\n                    var rzm = document.getElementById('row-zone-middle');\r\n                    rzm.style.marginTop = (0 - jQuery(rzm).height()/2)+\"px\";\r\n                },delay);\r\n            }\r\n\r\n            t.showHideToggleContent = function(objLayer) {\r\n                if (objLayer[\"toggle\"]===true) {\r\n                    jQuery('#layer_text_wrapper').addClass(\"withtoggle\");\r\n                } else {\r\n                    jQuery('#layer_text_wrapper').removeClass(\"withtoggle\");\r\n                }\r\n            }\r\n\r\n            t.showHideContentEditor = function(show) {\r\n\r\n                if (show) {\r\n                    jQuery('#button_edit_layer').hide();\r\n                    jQuery('#button_delete_layer').hide();\r\n                    jQuery('#button_duplicate_layer').hide();\r\n                    jQuery('#tp-addiconbutton').show();\r\n                    jQuery('#hide_layer_content_editor').show();\r\n                    jQuery('#linkInsertTemplate').show();\r\n                    jQuery('#layer_text_wrapper').show();\r\n                    jQuery('#button_reset_size').hide();\r\n                    jQuery('#button_change_video_settings').hide();\r\n                    jQuery('#layer_text_wrapper').addClass('currently_editing_txt');\r\n                    jQuery('#layer-short-tool-placeholder-a').hide();\r\n                    jQuery('#layer-short-tool-placeholder-b').hide();\r\n                } else {\r\n                    jQuery('#layer-short-tool-placeholder-a').show();\r\n                    jQuery('#layer-short-tool-placeholder-b').show();\r\n                    jQuery('#button_edit_layer').hide();\r\n                    jQuery('#button_change_image_source').hide();\r\n                    jQuery('#button_delete_layer').show();\r\n                    jQuery('#button_duplicate_layer').show();\r\n                    jQuery('#tp-addiconbutton').hide();\r\n                    jQuery('#hide_layer_content_editor').hide();\r\n                    jQuery('#linkInsertTemplate').hide();\r\n                    jQuery('#button_reset_size').hide();\r\n                    jQuery('#button_change_video_settings').hide();\r\n                    jQuery('#layer_text_wrapper').hide();\r\n                    jQuery('#layer_text_wrapper').removeClass('currently_editing_txt');\r\n                }\r\n\r\n                var objLayer = t.selectedLayerSerial === -1 ? \"\" : t.getLayer(t.selectedLayerSerial);\r\n\r\n                t.toolbarInPos(objLayer);\r\n                t.showHideToggleContent(objLayer);\r\n            }\r\n\r\n\r\n\r\n            t.changeSlotBGs = function() {\r\n\r\n                // MOVE ALL DATA TO THE RIGHT CONTAINER TO ANIMATE IT\r\n                var nextsh = jQuery('#divbgholder').find('.slotholder'),\r\n\r\n                    bgimg = jQuery(\"#image_url\").val(),\r\n                    bgpos = (jQuery('#slide_bg_position').val() == 'percentage') ? jQuery(\"input[name='bg_position_x']\").val() + '% ' + jQuery(\"input[name='bg_position_y']\").val() + '% ' : jQuery('#slide_bg_position').val(),\r\n                    bgfit = (jQuery('#slide_bg_fit').val() == 'percentage') ? jQuery(\"input[name='bg_fit_x']\").val() + '% ' + jQuery(\"input[name='bg_fit_y']\").val() + '% ' : jQuery('#slide_bg_fit').val(),\r\n                    bgcolor = window.RevColor.get(jQuery('#slide_bg_color').val());\r\n                gallery_type = jQuery('input[name=\"rs-gallery-type\"]').val();\r\n\r\n                jQuery('#the_image_source_url').html(bgimg);\r\n\r\n                jQuery('#video-settings').hide();\r\n                jQuery('#bg-setting-wrap').show();\r\n                jQuery('#vid-rev-youtube-options').hide();\r\n                jQuery('#vid-rev-vimeo-options').hide();\r\n                jQuery('#streamvideo_cover').hide();\r\n                jQuery('#streamvideo_cover_both').hide();\r\n\r\n                jQuery('#button_change_image').show();\r\n                jQuery('#button_change_image_objlib').show();\r\n\r\n                jQuery('.video_volume_wrapper').hide();\r\n\r\n                jQuery('#slide_selector .list_slide_links li.selected .slide-media-container ').removeClass(\"mini-transparent\").css({backgroundSize:\"cover\"});\r\n                var bbggtt = jQuery('input[name=\"background_type\"]:checked').data('bgtype');\r\n                switch(bbggtt){\r\n                    case \"image\":\r\n                        jQuery('#button_change_image').hide();\r\n                        jQuery('#button_change_image_objlib').hide();\r\n\r\n                        switch(gallery_type){\r\n                            case 'gallery':\r\n                                jQuery('#button_change_image').show();\r\n                                jQuery('#button_change_image_objlib').show();\r\n                                break;\r\n                            case 'posts':\r\n                                bgimg = rs_plugin_url+'public/assets/assets/sources/post.png';\r\n                                break;\r\n                            case 'woocommerce':\r\n                                bgimg = rs_plugin_url+'public/assets/assets/sources/wc.png';\r\n                                break;\r\n                            case 'facebook':\r\n                                bgimg = rs_plugin_url+'public/assets/assets/sources/fb.png';\r\n                                break;\r\n                            case 'twitter':\r\n                                bgimg = rs_plugin_url+'public/assets/assets/sources/tw.png';\r\n                                break;\r\n                            case 'instagram':\r\n                                bgimg = rs_plugin_url+'public/assets/assets/sources/ig.png';\r\n                                break;\r\n                            case 'flickr':\r\n                                bgimg = rs_plugin_url+'public/assets/assets/sources/fr.png';\r\n                                break;\r\n                            case 'youtube':\r\n                                bgimg = rs_plugin_url+'public/assets/assets/sources/yt.png';\r\n                                break;\r\n                            case 'vimeo':\r\n                                bgimg = rs_plugin_url+'public/assets/assets/sources/vm.png';\r\n                                break;\r\n                        }\r\n\r\n                        jQuery('.mainbg-sub-kenburns-selector').show();\r\n                        jQuery('.mainbg-sub-parallax-selector').show();\r\n                        jQuery('.mainbg-sub-settings-selector').show();\r\n                        jQuery('#button_change_image').appendTo(jQuery('#tp-bgimagewpsrc'));\r\n                        jQuery('#button_change_image_objlib').appendTo(jQuery('#tp-bgimagewpsrc'));\r\n\r\n                        nextsh.find('.defaultimg, .slotslidebg').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:bgpos,\r\n                            backgroundSize:bgfit,\r\n                            backgroundColor:\"transparent\"});\r\n                        jQuery('#ken_burn_slot_example').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:bgpos,\r\n                            backgroundSize:bgfit,\r\n                            backgroundColor:\"transparent\"}).data('src',bgimg);\r\n                        t.updateKenBurnExampleValues();\r\n                        break;\r\n                    case \"trans\":\r\n\r\n                        jQuery('#slide_selector .list_slide_links li.selected .slide-media-container ').css(\"background-image\",\"\").css(\"background-repeat\",\"\").addClass(\"mini-transparent\").css({backgroundSize:\"inherit\"});\r\n\r\n                        nextsh.find('.defaultimg, .slotslidebg').css({\r\n                            backgroundImage:\"none\",\r\n                            backgroundPosition:bgpos,\r\n                            backgroundSize:bgfit,\r\n                            backgroundColor:\"transparent\"});\r\n                        jQuery('.mainbg-sub-kenburns-selector').hide();\r\n                        jQuery('.mainbg-sub-parallax-selector').hide();\r\n                        jQuery('.mainbg-sub-settings-selector').hide();\r\n                        break;\r\n                    case \"solid\":\r\n                        nextsh.find('.defaultimg, .slotslidebg').css({\r\n                            backgroundImage:\"none\",\r\n                            backgroundPosition:bgpos,\r\n                            backgroundSize:bgfit,\r\n                            backgroundColor:bgcolor});\r\n                        jQuery('.mainbg-sub-kenburns-selector').hide();\r\n                        jQuery('.mainbg-sub-parallax-selector').hide();\r\n                        jQuery('.mainbg-sub-settings-selector').hide();\r\n                        jQuery('#slide_selector .list_slide_links li.selected .slide-media-container ').css({\r\n                            backgroundImage:\"none\",\r\n                            backgroundPosition:bgpos,\r\n                            backgroundSize:bgfit,\r\n                            backgroundColor:bgcolor});\r\n                        break;\r\n                    case \"external\":\r\n                        bgimg = jQuery('#slide_bg_external').val();\r\n\r\n                        jQuery('#the_image_source_url').html(bgimg);\r\n                        nextsh.find('.defaultimg, .slotslidebg').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:bgpos,\r\n                            backgroundSize:bgfit,\r\n                            backgroundColor:\"transparent\"});\r\n                        jQuery('#ken_burn_slot_example').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:bgpos,\r\n                            backgroundSize:bgfit,\r\n                            backgroundColor:\"transparent\"}).data('src',bgimg);\r\n                        t.updateKenBurnExampleValues();\r\n                        jQuery('.mainbg-sub-kenburns-selector').show();\r\n                        jQuery('.mainbg-sub-parallax-selector').show();\r\n                        jQuery('.mainbg-sub-settings-selector').show();\r\n                        break;\r\n                    case \"streamtwitter\":\r\n                    case \"streamtwitterboth\":\r\n                        jQuery('#streamvideo_cover').show();\r\n                        jQuery('#streamvideo_cover_both').show();\r\n                        bgimg = rs_plugin_url+'public/assets/assets/sources/tw.png';\r\n                        nextsh.find('.defaultimg, .slotslidebg, #ken_burn_slot_example').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:'center center',\r\n                            backgroundSize:'cover',\r\n                            backgroundColor:\"transparent\"});\r\n                        jQuery('#ken_burn_slot_example').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:'center center',\r\n                            backgroundSize:'cover',\r\n                            backgroundColor:\"transparent\"}).data('src',bgimg);\r\n                        t.updateKenBurnExampleValues();\r\n                        jQuery('.mainbg-sub-kenburns-selector').hide();\r\n                        jQuery('.mainbg-sub-parallax-selector').show();\r\n                        jQuery('.mainbg-sub-settings-selector').show();\r\n                        jQuery('#button_change_image').appendTo(jQuery('#vimeo-image-picker'));\r\n                        jQuery('#button_change_image_objlib').appendTo(jQuery('#vimeo-image-picker'));\r\n                        jQuery('#video-settings').show();\r\n                        jQuery('#bg-setting-wrap').hide();\r\n                        jQuery('#vid-rev-vimeo-options').show();\r\n                        jQuery('#vid-rev-youtube-options').show();\r\n                        jQuery('.video_volume_wrapper').show();\r\n\r\n                        break;\r\n                    case \"streamyoutube\":\r\n                    case \"streamyoutubeboth\":\r\n                        jQuery('#streamvideo_cover').show();\r\n                        jQuery('#streamvideo_cover_both').show();\r\n                        bgimg = rs_plugin_url+'public/assets/assets/sources/yt.png';\r\n                    case \"youtube\":\r\n                        nextsh.find('.defaultimg, .slotslidebg, #ken_burn_slot_example').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:'center center',\r\n                            backgroundSize:'cover',\r\n                            backgroundColor:\"transparent\"});\r\n                        jQuery('#ken_burn_slot_example').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:'center center',\r\n                            backgroundSize:'cover',\r\n                            backgroundColor:\"transparent\"}).data('src',bgimg);\r\n                        t.updateKenBurnExampleValues();\r\n                        jQuery('.mainbg-sub-kenburns-selector').hide();\r\n                        jQuery('.mainbg-sub-parallax-selector').show();\r\n                        jQuery('.mainbg-sub-settings-selector').show();\r\n                        jQuery('#button_change_image').appendTo(jQuery('#youtube-image-picker'));\r\n                        jQuery('#button_change_image_objlib').appendTo(jQuery('#youtube-image-picker'));\r\n                        jQuery('#video-settings').show();\r\n                        jQuery('#bg-setting-wrap').hide();\r\n                        jQuery('#vid-rev-youtube-options').show();\r\n                        jQuery('.video_volume_wrapper').show();\r\n                        break;\r\n                    case \"streamvimeo\":\r\n                    case \"streamvimeoboth\":\r\n                        jQuery('#streamvideo_cover').show();\r\n                        jQuery('#streamvideo_cover_both').show();\r\n                        bgimg = rs_plugin_url+'public/assets/assets/sources/vm.png';\r\n                    case \"vimeo\":\r\n                        nextsh.find('.defaultimg, .slotslidebg, #ken_burn_slot_example').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:'center center',\r\n                            backgroundSize:'cover',\r\n                            backgroundColor:\"transparent\"});\r\n                        jQuery('#ken_burn_slot_example').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:'center center',\r\n                            backgroundSize:'cover',\r\n                            backgroundColor:\"transparent\"}).data('src',bgimg);\r\n                        t.updateKenBurnExampleValues();\r\n                        jQuery('.mainbg-sub-kenburns-selector').hide();\r\n                        jQuery('.mainbg-sub-parallax-selector').show();\r\n                        jQuery('.mainbg-sub-settings-selector').show();\r\n                        jQuery('#button_change_image').appendTo(jQuery('#vimeo-image-picker'));\r\n                        jQuery('#button_change_image_objlib').appendTo(jQuery('#vimeo-image-picker'));\r\n                        jQuery('#video-settings').show();\r\n                        jQuery('#bg-setting-wrap').hide();\r\n                        jQuery('#vid-rev-vimeo-options').show();\r\n                        jQuery('.video_volume_wrapper').show();\r\n                        break;\r\n                    case \"streaminstagram\":\r\n                    case \"streaminstagramboth\":\r\n                        jQuery('#streamvideo_cover').show();\r\n                        jQuery('#streamvideo_cover_both').show();\r\n                        bgimg = rs_plugin_url+'public/assets/assets/sources/ig.png';\r\n                    case \"html5\":\r\n                        nextsh.find('.defaultimg, .slotslidebg').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:'center center',\r\n                            backgroundSize:'cover',\r\n                            backgroundColor:\"transparent\"});\r\n                        jQuery('#ken_burn_slot_example').css({\r\n                            backgroundImage:(\"url(\"+bgimg+\")\"),\r\n                            backgroundPosition:'center center',\r\n                            backgroundSize:'cover',\r\n                            backgroundColor:\"transparent\"}).data('src',bgimg);\r\n                        t.updateKenBurnExampleValues();\r\n                        jQuery('.mainbg-sub-kenburns-selector').hide();\r\n                        jQuery('.mainbg-sub-parallax-selector').show();\r\n                        jQuery('.mainbg-sub-settings-selector').show();\r\n                        jQuery('#button_change_image').appendTo(jQuery('#html5video-image-picker'));\r\n                        jQuery('#button_change_image_objlib').appendTo(jQuery('#html5video-image-picker'));\r\n                        jQuery('#video-settings').show();\r\n                        jQuery('#bg-setting-wrap').hide();\r\n\r\n                        break;\r\n                }\r\n                if (bbggtt != \"solid\" && bbggtt!=\"trans\")\r\n                    jQuery('#slide_selector .list_slide_links li.selected .slide-media-container ').css(\"background-image\",\"url(\"+bgimg+\")\");\r\n                jQuery('#divbgholder').css({background:\"none\",backgroundImage:\"none\",backgroundColor:\"transparent\"});\r\n\r\n                // Use Admin Thumbnail if Selected\r\n                if (jQuery('#thumb_for_admin').attr('checked')==\"checked\") {\r\n                    var tbgimg = jQuery('#slide_thumb_button_preview div').css(\"background-image\");\r\n                    jQuery('#slide_selector .list_slide_links li.selected .slide-media-container').css({\"background-image\":tbgimg, backgroundSize:\"cover\",backgroundPosition:\"center center\"});\r\n                }\r\n                u.resetSlideAnimations(false);\r\n            }\r\n\r\n\r\n            var initDisallowCaptionsOnClick = function(){\r\n\r\n                jQuery('.slide_layer.tp-caption a').on('click', function(){\r\n                    return false;\r\n                });\r\n\r\n            }\r\n\r\n\r\n            function initSliderMainOptions(jQueryObj){\r\n\r\n                var t=jQueryObj;\r\n                jQuery('.bgsrcchanger-div').each(function() {\r\n                    if (jQuery(this).attr('id') !=\"tp-bgimagesettings\" || (jQuery(this).attr('id') ==\"tp-bgimagesettings\" && t.data('imgsettings')!=\"on\")) {\r\n                        if (jQuery(this).attr('id') ==\"tp-bgimagesettings\")\r\n                            jQuery(this).slideUp(200);\r\n                        else\r\n                            jQuery(this).css({display:\"none\"});\r\n                    }\r\n                });\r\n                jQuery('#'+t.data('callid')).css({display:\"inline-block\"});\r\n                if (t.data('imgsettings')==\"on\")\r\n                    jQuery('#tp-bgimagesettings').slideDown(200);\r\n\r\n                if(jQuery('input[name=\"background_type\"]:checked').val() == 'image'){\r\n                    jQuery('.rs-img-source-size').show();\r\n                    jQuery('#alt_option').show();\r\n                    jQuery('#title_option').show();\r\n                    if(jQuery('#alt_option option:selected').val() == 'custom'){\r\n                        jQuery('#alt_attr').show();\r\n                    }else{\r\n                        jQuery('#alt_attr').hide();\r\n                    }\r\n                    if(jQuery('#title_option option:selected').val() == 'custom'){\r\n                        jQuery('#title_attr').show();\r\n                    }else{\r\n                        jQuery('#title_attr').hide();\r\n                    }\r\n                }else{\r\n                    jQuery('#alt_option').hide();\r\n                    jQuery('#title_option').hide();\r\n                    jQuery('#alt_attr').show();\r\n                    jQuery('#title_attr').hide();\r\n                    jQuery('.rs-img-source-size').hide();\r\n                }\r\n\r\n                if(jQuery('input[name=\"background_type\"]:checked').val() == 'external'){\r\n                    jQuery('.ext_setting').show();\r\n                }else{\r\n                    jQuery('.ext_setting').hide();\r\n                }\r\n\r\n            }\r\n\r\n\r\n            /*! ALIGN TABLE HANDLING */\r\n            /**\r\n             * init the align table\r\n             */\r\n            var initAlignTable = function(){\r\n\r\n                jQuery('.rs-new-align-button').click(function(){\r\n                    var obj = jQuery(this);\r\n                    if(jQuery(obj).parent().hasClass('table_disabled')) return(false);\r\n\r\n                    var inpX = jQuery(\"#layer_left_text\"),\r\n                        inpY = jQuery(\"#layer_top_text\"),\r\n                        alignHor = obj.data('hor'),\r\n                        alignVert = obj.data('ver');\r\n\r\n                    if(alignVert === undefined){ //we are in horizontal\r\n                        jQuery('#rs-align-wrapper').find('.selected').removeClass(\"selected\");\r\n                        switch(alignHor){\r\n                            case \"left\":\r\n                                inpX.html(inpX.data(\"textnormal\")).css(\"width\",\"auto\");\r\n                                jQuery(\"#layer_left\").val(\"10\");\r\n                                break;\r\n                            case \"right\":\r\n                                inpX.html(inpX.data(\"textoffset\")).css(\"width\",\"42px\");\r\n                                jQuery(\"#layer_left\").val(\"10\");\r\n                                break;\r\n                            case \"center\":\r\n                                inpX.html(inpX.data(\"textoffset\")).css(\"width\",\"42px\");\r\n                                jQuery(\"#layer_left\").val(\"0\");\r\n                                break;\r\n                        }\r\n\r\n                        jQuery(\"#layer_align_hor\").val(alignHor);\r\n\r\n                    }else{ //we are in vertical\r\n                        jQuery('#rs-align-wrapper-ver').find('.selected').removeClass(\"selected\");\r\n                        switch(alignVert){\r\n                            case \"top\":\r\n                                inpY.html(inpY.data(\"textnormal\")).css(\"width\",\"auto\");\r\n                                jQuery(\"#layer_top\").val(\"10\");\r\n                                break;\r\n                            case \"bottom\":\r\n                                inpY.html(inpY.data(\"textoffset\")).css(\"width\",\"42px\");\r\n                                jQuery(\"#layer_top\").val(\"10\");\r\n                                break;\r\n                            case \"middle\":\r\n                                inpY.html(inpY.data(\"textoffset\")).css(\"width\",\"42px\");\r\n                                jQuery(\"#layer_top\").val(\"0\");\r\n                                break;\r\n                        }\r\n                        jQuery(\"#layer_align_vert\").val(alignVert);\r\n                    }\r\n\r\n                    var objLayer = t.getLayer(t.selectedLayerSerial);\r\n                    if (objLayer.type===\"row\") {\r\n                        switch (alignVert) {\r\n                            case \"top\":\r\n                                document.getElementById(\"row-zone-top\").appendChild(objLayer.references.htmlLayer[0]);\r\n                                break;\r\n                            case \"middle\":\r\n                                document.getElementById(\"row-zone-middle\").appendChild(objLayer.references.htmlLayer[0]);\r\n                                break;\r\n                            case \"bottom\":\r\n                                document.getElementById(\"row-zone-bottom\").appendChild(objLayer.references.htmlLayer[0]);\r\n                                break;\r\n                        }\r\n                        objLayer = t.setVal(objLayer,\"align_vert\",alignVert,true,null,true);\r\n                        t.checkRowZoneContents();\r\n                    }\r\n                    obj.addClass('selected');\r\n                    t.updateLayerFromFields();\r\n                    t.toolbarInPos();\r\n                    t.setMiddleRowZone(100);\r\n                });\r\n            }\r\n\r\n\r\n            /**\r\n             * init general events\r\n             */\r\n            var initMainEvents = function(){\r\n                //unselect layers on container click\r\n                container.click(function(event) {\r\n                    if (!layerresized) {\r\n\r\n                        if(event.target == this || jQuery(event.target).hasClass(\"slide_layers_border\")) u.checkMultipleSelectedItems(true);\r\n                        unselectLayers();\r\n                        jQuery('#quick-layers-wrapper').slideUp(300);\r\n                        jQuery('.current-active-main-toolbar').removeClass(\"opened\");\r\n                        jQuery('#button_show_all_layer i').removeClass(\"eg-icon-up\").addClass(\"eg-icon-menu\");\r\n\r\n                    }\r\n                    else\r\n                        layerresized=false;\r\n                });\r\n            }\r\n\r\n\r\n            /**\r\n             * show / hide offset row accorging the slide link value\r\n             */\r\n            var showHideLinkActions = function(v, updatetimelines){\r\n\r\n                var li = v.closest('li'),\r\n                    value = v.val();\r\n\r\n                li.find('.action-link-wrapper').hide();\r\n                li.find('.action-jump-to-slide').hide();\r\n                li.find('.action-scrollofset').hide();\r\n                li.find('.action-speed-wrapper').hide();\r\n                li.find('.action-easing-wrapper').hide();\r\n                li.find('.action-target-layer').hide();\r\n                li.find('.action-callback').hide();\r\n                li.find('.action-toggle_layer').hide();\r\n                li.find('.action-toggleclass').hide();\r\n                li.find('.action-delay-wrapper').show();\r\n\r\n\r\n                switch (value) {\r\n                    case \"none\":\r\n                        li.find('.action-delay-wrapper').hide();\r\n                        break;\r\n                    case \"link\":\r\n                        li.find('.action-link-wrapper').show();\r\n                        break;\r\n                    case \"jumpto\":\r\n                        li.find('.action-jump-to-slide').show();\r\n                        break;\r\n                    case \"scroll_under\":\r\n                        li.find('.action-scrollofset').show();\r\n                        li.find('.action-speed-wrapper').show();\r\n                        li.find('.action-easing-wrapper').show();\r\n                        break;\r\n                    case \"callback\":\r\n                        li.find('.action-callback').show();\r\n                        break;\r\n\r\n                    case \"start_in\":\r\n                    case \"start_out\":\r\n                    case \"start_video\":\r\n                    case \"stop_video\":\r\n                    case \"mute_video\":\r\n                    case \"unmute_video\":\r\n                    case \"toggle_video\":\r\n                    case \"toggle_mute_video\":\r\n                        li.find('.action-target-layer').show();\r\n                        break;\r\n                    case \"toggle_layer\":\r\n                        li.find('.action-target-layer').show();\r\n                        li.find('.action-toggle_layer').show();\r\n                        break;\r\n\r\n                    case \"simulate_click\":\r\n                        li.find('.action-target-layer').show();\r\n                        break;\r\n                    case \"toggle_class\":\r\n                        li.find('.action-target-layer').show();\r\n                        li.find('.action-toggleclass').show();\r\n                        break;\r\n                }\r\n\r\n                switch (value) {\r\n                    case 'start_in':\r\n                    case 'start_out':\r\n                    case 'toggle_layer':\r\n                        li.find('.action-triggerstates').show();\r\n                        break;\r\n                    default:\r\n                        li.find('.action-triggerstates').hide();\r\n                        break;\r\n                }\r\n                switch (value) {\r\n                    case \"toggle_video\":\r\n                    case \"mute_video\":\r\n                    case \"unmute_video\":\r\n                    case \"toggle_global_mute_video\":\r\n                    case \"toggle_mute_video\":\r\n                    case \"start_video\":\r\n                    case \"stop_video\":\r\n                        li.find('.action-target-layer').find('select[name=\"layer_target[]\"] option').each(function(){\r\n                            if(jQuery(this).data('mytype') !== 'video' && jQuery(this).data('mytype') !== 'video-special' && jQuery(this).data('mytype') !== 'audio'){\r\n                                if(jQuery(this).data('mytype') === 'all'){\r\n                                    jQuery(this).show(); //show if all\r\n                                }else{\r\n                                    jQuery(this).hide();\r\n                                }\r\n                            }else{\r\n                                jQuery(this).show();\r\n                            }\r\n                        });\r\n                        break;\r\n                    default:\r\n                        li.find('.action-target-layer').find('select[name=\"layer_target[]\"] option').each(function(){\r\n                            if(jQuery(this).data('mytype') !== 'video-special'){\r\n                                jQuery(this).show();\r\n                            }else{\r\n                                if(jQuery(this).data('mytype') === 'all'){\r\n                                    jQuery(this).show(); //show if all\r\n                                }else{\r\n                                    jQuery(this).hide();\r\n                                }\r\n                            }\r\n                        });\r\n                        break;\r\n                }\r\n\r\n                if (updatetimelines) u.updateAllLayerTimeline();\r\n            }\r\n\r\n            var showHideToolTip = function(){\r\n                var value = jQuery(\"#layer_tooltip_event\").val(),\r\n                    tpat = jQuery(\".tooltip-parrent-part\"),\r\n                    tchi = jQuery('.tooltip-child-part');\r\n\r\n                switch (value) {\r\n                    case \"none\":\r\n                        tpat.hide();\r\n                        tchi.hide();\r\n                        break;\r\n                    case \"parrent\":\r\n                        tpat.show();\r\n                        tchi.hide();\r\n                        break;\r\n                    case \"child\":\r\n                        tpat.hide();\r\n                        tchi.show();\r\n                        break;\r\n                }\r\n            }\r\n\r\n            // SET SUFFIX FOR INPUT FIELD OR LEAVE THE CURRENT VALUE\r\n            var specOrVal = function(putin,possiblevalues,forcesuffix,suffix) {\r\n                var n = parseFloat(putin),\r\n                    newsuffix = suffix===undefined && n!==undefined && jQuery.isNumeric(n) && !jQuery.isNumeric(putin) ?\r\n                        putin.replace(n,\"\")\r\n                        : suffix === undefined ?\r\n                            forcesuffix===undefined ?\r\n                                \"\"\r\n                                : forcesuffix\r\n                            : suffix;\r\n\r\n                result = jQuery.inArray(putin,possiblevalues)>=0 ? putin : putin===undefined || !jQuery.isNumeric(parseInt(putin)) || putin.length===0 ? \"\" : parseInt(putin)+newsuffix;\r\n                return result;\r\n            }\r\n\r\n            t.check_the_font_bold = function(font){\r\n                var variants = ['100','200','300','400','500','600','700','800','900'];\r\n\r\n                for(var key in initArrFontTypes) if (initArrFontTypes.hasOwnProperty(key)) {\r\n                    if(initArrFontTypes[key].label == font){\r\n                        if(typeof(initArrFontTypes[key].variants) !== 'undefined'){\r\n                            variants = initArrFontTypes[key].variants;\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                var fws = jQuery('select[name=\"font_weight_static\"]');\r\n                var sel = fws.find('option:selected').val();\r\n                fws.html('');\r\n\r\n                for(var key in variants) if (variants.hasOwnProperty(key)) {\r\n                    if(variants[key].indexOf('italic') > -1) continue;\r\n                    fws.append('<option value=\"'+variants[key]+'\">'+variants[key]+'</option>');\r\n                }\r\n                fws.find('option[value=\"'+sel+'\"]').attr('selected', 'selected');\r\n            }\r\n\r\n\r\n            t.do_google_font_loading = function(font){\r\n                var gfamilies  = [];\r\n                //check if this is a google font, if yes, then load the font with all stuff available\r\n                for(var key in initArrFontTypes) if (initArrFontTypes.hasOwnProperty(key)) {\r\n                    if(initArrFontTypes[key].label == font){\r\n                        if(initArrFontTypes[key].type == 'googlefont'){\r\n                            //load font now!, its google\r\n                            var gstring = '';\r\n                            for(var mkey in initArrFontTypes[key].variants) if (initArrFontTypes[key].variants.hasOwnProperty(mkey)) {\r\n                                if(mkey > 0) gstring += ',';\r\n                                gstring += initArrFontTypes[key].variants[mkey];\r\n                            }\r\n                            if(typeof(initArrFontTypes[key].subsets) !== 'undefined'){\r\n                                gstring += '&subset=';\r\n                                for(var mkey in initArrFontTypes[key].subsets) if (initArrFontTypes[key].subsets.hasOwnProperty(mkey)) {\r\n                                    if(mkey > 0) gstring += ',';\r\n                                    gstring += initArrFontTypes[key].subsets[mkey];\r\n                                }\r\n                            }\r\n                            fontclass = font.replace(/\\ /g,'-');\r\n                            font = font.replace(/\\ /g,'+');\r\n\r\n                            if(jQuery('.rev-css-'+fontclass).length == 0){\r\n                                gfamilies.push(font+\":\"+gstring);\r\n                                jQuery('body').append('<div style=\"display:none\" class=\"rev-css-'+fontclass+'\">RevSliderFont</div>');\r\n\r\n                                if(sgfamilies.indexOf(font) == -1){\r\n                                    sgfamilies.push(font);\r\n                                }\r\n\r\n                                if (gfamilies!==null && gfamilies.length>0)\r\n                                    tpWebFont.load({\r\n                                        google:{\r\n                                            families:gfamilies\r\n                                        },\r\n                                        loading:function() {\r\n                                            showWaitAMinute({fadeIn:300,text:font+\" is Loading...\"});\r\n                                        },\r\n                                        active:function() {\r\n                                            setTimeout(function() {\r\n                                                showWaitAMinute({fadeOut:300});\r\n                                            },300);\r\n                                            u.allLayerToIdle({type:\"text\"});\r\n                                        },\r\n                                        inactive:function() {\r\n                                            setTimeout(function() {\r\n                                                showWaitAMinute({fadeOut:300});\r\n                                            },300);\r\n                                            u.allLayerToIdle({type:\"text\"});\r\n                                        }\r\n                                    })\r\n                            }//else already loaded\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                t.sortFontTypesByUsage();\r\n            }\r\n\r\n\r\n            /*****************************************************\r\n             INIT HTML FIELDS\r\n             init events (update) for html properties change.\r\n             *****************************************************/\r\n            var initHtmlFields = function(){\r\n\r\n                //show / hide slide link offset\r\n\r\n                jQuery('body').on('change', 'select[name=\"layer_action[]\"], select[name=\"no_layer_action[]\"]',function() {\r\n                    showHideLinkActions(jQuery(this));\r\n                });\r\n\r\n                jQuery('body').on('click','#kenburn-playpause-wrapper', function() {\r\n                    var pb = jQuery('#kenburn-playpause-wrapper'),\r\n                        tl = jQuery('#ken_burn_example').data('kbtl');\r\n\r\n                    if (pb.hasClass(\"playing\")) {\r\n                        pb.html('<i class=\"eg-icon-play\"></i><span>PLAY</span>');\r\n                        pb.removeClass(\"playing\");\r\n                        tl.pause();\r\n                    } else {\r\n                        pb.html('<i class=\"eg-icon-pause\"></i><span>PAUSE</span>');\r\n                        pb.addClass(\"playing\");\r\n                        tl.play();\r\n                    }\r\n                });\r\n\r\n                jQuery('body').on('click','#kenburn-backtoidle',function() {\r\n                    var tl = jQuery('#ken_burn_example').data('kbtl');\r\n                    tl.progress(0);\r\n                });\r\n\r\n                jQuery('.kb_input_values').change(t.updateKenBurnExampleValues);\r\n\r\n\r\n                jQuery('#layer_tooltip_event').change(showHideToolTip);\r\n\r\n\r\n                //set layers autocompolete\r\n                jQuery(\"#layer_caption\").catcomplete({\r\n                    source: initArrCaptionClasses,\r\n                    minLength:0,\r\n                    appendTo:\"#tp-thelistofclasses\",\r\n                    open:function(event,ui) {\r\n                        if (jQuery('#tp-thelistofclasses ul').height()>450) {\r\n                            jQuery('#tp-thelistofclasses ul').perfectScrollbar(\"destroy\").perfectScrollbar({wheelPropagation:false, suppressScrollX:true});\r\n                        }\r\n\r\n                    },\r\n                    close: function(event, ui){\r\n                        var layer = t.getCurrentLayer();\r\n\r\n                        if(layer === false || layer == null){\r\n                            return false;\r\n                        }\r\n\r\n                        if(layer.style !== undefined && layer.style !== jQuery('#layer_caption').val()){\r\n                            layer.style = jQuery('#layer_caption').val();\r\n                            //update values that can be set without changing the class\r\n                            t.reset_to_default_static_styles(layer);\r\n                            // Reset Fields from Style Template\r\n                            updateSubStyleParameters(layer, true);\r\n                        }\r\n                        jQuery('#layer_caption').change();\r\n                        jQuery('#css_font-family').change();\r\n\r\n                        t.updateLayerFromFields();\r\n                    }/*,\r\n                     change: function(event,ui){\r\n                     if (ui.item==null){\r\n                     jQuery(\"#layer_caption\").val('');\r\n                     jQuery(\"#layer_caption\").focus();\r\n                     }\r\n                     }*/\r\n                }).data(\"customCatcomplete\")._renderItem = function(ul, item) {\r\n                    var listItem = jQuery(\"<li></li>\")\r\n                        .data(\"item.autocomplete\", item)\r\n                        .append(\"<a>\" + item.label + \"</a>\")\r\n                        .appendTo(ul);\r\n\r\n                    listItem.attr('original-title', item.value);\r\n                    return listItem;\r\n                };\r\n\r\n\r\n\r\n                //open the list on right button\r\n                jQuery( \"#layer_captions_down\" ).click(function(event){\r\n                    event.stopPropagation();\r\n\r\n                    jQuery('#css_font-family').catcomplete(\"close\");\r\n\r\n                    jQuery(\"#css_editor_expert\").hide();\r\n                    jQuery(\"#css_editor_wrap\").hide();\r\n\r\n                    //if opened - close autocomplete\r\n                    if(jQuery('#layer_caption').data(\"is_open\") == true)\r\n                        jQuery( \"#layer_caption\" ).catcomplete(\"close\");\r\n                    else   //else open autocomplete\r\n                    if(jQuery(this).hasClass(\"ui-state-active\"))\r\n                        jQuery( \"#layer_caption\" ).catcomplete( \"search\", \"\" ).data(\"customCatcomplete\")._renderItem = function(ul, item) {\r\n                            var listItem = jQuery(\"<li></li>\")\r\n                                .data(\"item.autocomplete\", item)\r\n                                .append(\"<a>\" + item.label + \"</a>\")\r\n                                .appendTo(ul);\r\n                            listItem.attr('original-title', item.value);\r\n                            return listItem;\r\n                        };\r\n                });\r\n\r\n                //handle autocomplete close\r\n                jQuery('#layer_caption').bind('catcompleteopen', function() {\r\n                    jQuery(this).data('is_open',true);\r\n\r\n                    //handle tooltip\r\n                    jQuery('.ui-autocomplete li').tipsy({\r\n                        delayIn: 70,\r\n                        //delayOut:100000,\r\n                        html: true,\r\n                        gravity:\"w\",\r\n                        //trigger:\"manual\",\r\n                        title: function(){\r\n                            setTimeout(function() {\r\n                                jQuery('.tp-present-caption-small').parent().addClass(\"tp-present-wrapper-small\");\r\n                                jQuery('.tp-present-caption-small').parent().parent().addClass(\"tp-present-wrapper-parent-small\");\r\n                            },10);\r\n                            return '<div class=\"tp-present-caption-small\"><div class=\"example-dark-blinker\"></div><div class=\"tp-caption '+this.getAttribute('original-title')+'\">example</div></div>';\r\n                        }\r\n                    });\r\n                });\r\n\r\n                jQuery('#layer_caption').bind('catcompleteclose', function() {\r\n                    jQuery(this).data('is_open',false);\r\n                });\r\n\r\n\r\n                t.setLayersAutoComplete();\r\n\r\n                //set layers autocompolete\r\n                jQuery('input[name=\"adbutton-fontfamily\"]').autocomplete({\r\n                    source: initArrFontTypes,\r\n                    minLength:0\r\n                });\r\n\r\n                //open the list on right button\r\n                jQuery(\"#css_fonts_down\").click(function(event){\r\n                    event.stopPropagation();\r\n\r\n                    jQuery('#layer_caption').catcomplete(\"close\");\r\n\r\n                    //if opened - close autocomplete\r\n                    if(jQuery('#css_font-family').data(\"is_open\") == true)\r\n                        jQuery('#css_font-family').catcomplete(\"close\");\r\n                    else   //else open autocomplete\r\n                    if(jQuery(this).hasClass(\"ui-state-active\"))\r\n                        jQuery('#css_font-family').catcomplete( \"search\", \"\" ).data(\"ui-autocomplete\");\r\n\r\n                });\r\n\r\n\r\n                jQuery(\"body\").click(function(){\r\n                    jQuery( \"#layer_caption\" ).catcomplete(\"close\");\r\n                    jQuery('#css_font-family').catcomplete(\"close\");\r\n                });\r\n\r\n                //set events:\r\n                jQuery('body').on('change', \".form_layers select, #layer_proportional_scale, #layer_auto_line_break, #layer_displaymode\", function(){\r\n                    t.updateLayerFromFields();\r\n                });\r\n\r\n                jQuery('#layer_proportional_scale, #layer_auto_line_break, #layer_displaymode').change(function(){\r\n                    if(jQuery(this)[0].checked)\r\n                        jQuery(this).parent().removeClass(\"notselected\")\r\n                    else\r\n                        jQuery(this).parent().addClass(\"notselected\")\r\n                });\r\n\r\n                var keyuprefresh;\r\n                // UPDATE LAYER TEXT FIELD\r\n                jQuery(\"#layer_text\").keyup(function(){\r\n                    clearTimeout(keyuprefresh);\r\n                    var v = jQuery(this).val();\r\n                    keyuprefresh = setTimeout(function() {\r\n                        updateLayerTextField(\"\",jQuery('.sortlist li.ui-state-hover'),v);\r\n                        t.toolbarInPos();\r\n                        t.updateLayerFromFields();\r\n                        u.updateCurrentLayerTimeline();\r\n                    },150);\r\n                });\r\n\r\n                jQuery(\"#layer_text_toggle\").keyup(function(){\r\n                    clearTimeout(keyuprefresh);\r\n                    var v = jQuery(this).val();\r\n                    keyuprefresh = setTimeout(function() {\r\n                        updateLayerTextField(\"\",jQuery('.sortlist li.ui-state-hover'),v);\r\n                        t.toolbarInPos();\r\n                        t.updateLayerFromFields();\r\n                    },150);\r\n                });\r\n\r\n                jQuery('.rev-visibility-on-sizes input').click(function(){\r\n                    t.updateLayerFromFields();\r\n                });\r\n\r\n                jQuery('body').on('blur', \".form_layers input, .form_layers textarea\", function(){\r\n                    //var cname = jQuery(this).attr('name');\r\n                    //if(cname == 'layer_action_delay[]' || cname == 'layer_image_link[]' || cname == 'layer_actioncallback[]' || cname == 'layer_scrolloffset[]' || cname == 'layer_toggleclass[]') return false; //layer actions deny the blur\r\n\r\n                    t.updateLayerFromFields();\r\n                });\r\n                jQuery('body').on('change', \".form_layers input, .form_layers textarea\", function(){\r\n                    t.updateLayerFromFields();\r\n                });\r\n                jQuery('body').on('keypress', \".form_layers input, .form_layers textarea\", function(event){\r\n                    if(event.keyCode == 13){\r\n                        t.updateLayerFromFields();\r\n                    }\r\n                });\r\n\r\n\r\n                jQuery(\"#delay\").keypress(function(event){\r\n                    if (Number(jQuery('#delay').val())>0) g_slideTime = jQuery('#delay').val();\r\n                });\r\n\r\n                jQuery(\"#delay\").blur(function(){\r\n                    if (Number(jQuery('#delay').val())>0) g_slideTime = jQuery('#delay').val();\r\n\r\n                    var w = g_slideTime/10;\r\n                    jQuery('#mastertimer-maxtime').css({left:(w)+\"px\"});\r\n                    jQuery('#mastertimer-maxcurtime').html(u.convToTime(w));\r\n                    jQuery('.slide-idle-section').css({left:w});\r\n                    jQuery('.mastertimer-slide .tl-fullanim').css({width:(w)+\"px\"});\r\n                    u.mainMaxTimeLeft = w;\r\n                    u.masterTimerPositionChange(true);\r\n                    u.compareLayerEndsVSSlideEnd();\r\n                });\r\n\r\n\r\n                jQuery('.form_layers input').on(\"click\",function() {\r\n                    jQuery(this).select();\r\n                })\r\n\r\n                // MIN, MAX VALUES - SUFFIX ADD ONS\r\n                jQuery('.form_layers input').on(\"change blur focus\",function(event) {\r\n\r\n                    var inp = jQuery(this),\r\n                        cv = parseFloat(inp.val()),\r\n                        min = parseFloat(inp.data(\"min\")),\r\n                        max = parseFloat(inp.data(\"max\")),\r\n                        lsuffix = inp.val().slice(-1) || \"\",\r\n                        ltsuffix = inp.val().slice(-2) || \"\",\r\n                        usuffix = inp.data('suffix'),\r\n                        asuffix = inp.data('suffixalt');\r\n\r\n                    lastchangedinput = inp.attr('id');\r\n\r\n                    if (usuffix!=undefined) {\r\n                        if (jQuery.isNumeric(cv) && cv > -9999999 && cv<9999999 ) {\r\n                            if (min!=undefined && cv<min) cv = min;\r\n                            if (min!=undefined && cv>max) cv = max;\r\n                            if (isNaN(cv)) cv = 0;\r\n                            cv = Math.round(cv*100)/100;\r\n\r\n                            if (asuffix==undefined)\r\n                                inp.val(cv+usuffix);\r\n                            else {\r\n                                if (lsuffix == asuffix)\r\n                                    inp.val(cv+lsuffix)\r\n                                else\r\n                                if (ltsuffix == asuffix)\r\n                                    inp.val(cv+ltsuffix)\r\n                                else\r\n                                    inp.val(cv+usuffix);\r\n                            }\r\n                        }\r\n                    }\r\n                    if (event.type===\"focus\") this.select();\r\n                });\r\n\r\n                jQuery('.form_layers select').on(\"change blur focus\",function() {\r\n\r\n                    lastchangedinput = jQuery(this).attr('id');\r\n                });\r\n\r\n\r\n                jQuery('#layer_speed, #layer_endspeed, #layer_splitdelay, #layer_endsplitdelay, #layer_split, #layer_endsplit').on(\"change blur\", function() {\r\n                    t.updateLayerFromFields();\r\n                    u.updateCurrentLayerTimeline();\r\n                });\r\n\r\n                jQuery('body').on('focus','#layer_text, #layer_text_toggle',function() {\r\n                    jQuery('#layer_text').removeClass(\"lasteditedlayertext\");\r\n                    jQuery('#layer_text_toggle').removeClass(\"lasteditedlayertext\");\r\n                    jQuery(this).addClass(\"lasteditedlayertext\")\r\n                })\r\n\r\n            }\r\n\r\n            t.nextNewLayerToPosition = function(c) {\r\n                t.newlayercoord.x = c.x;\r\n                t.newlayercoord.y = c.y;\r\n            }\r\n\r\n            t.setLayersAutoComplete = function(){\r\n\r\n                //set layers autocompolete\r\n                jQuery('#css_font-family').catcomplete({\r\n                    source: initArrFontTypes,\r\n                    appendTo:\"#tp-thelistoffonts\",\r\n                    open:function(event,ui) {\r\n                        if (jQuery('#tp-thelistoffonts ul').height()>450) {\r\n                            jQuery('#tp-thelistoffonts ul').perfectScrollbar(\"destroy\").perfectScrollbar({wheelPropagation:false, suppressScrollX:true});\r\n                            jQuery('#tp-thelistoffonts ul').scrollTop(0);\r\n                        }\r\n                    },\r\n                    minLength:0,\r\n                    close:t.updateLayerFromFields,\r\n                    select: function( event, ui ) {\r\n                        t.check_the_font_bold(ui.item.label);\r\n                        t.do_google_font_loading(ui.item.label);\r\n                    }\r\n                }).data(\"customCatcomplete\")._renderItem = function(ul, item) {\r\n                    var listItem = jQuery(\"<li></li>\")\r\n                        .data(\"item.autocomplete\", item)\r\n                        .append(\"<a>\" + item.label + \"</a>\");\r\n                    if (item.top) {\r\n                        listItem.prependTo(ul);\r\n                        listItem.insertAfter('#insert-google-font-after-me');\r\n                    }\r\n                    else {\r\n                        listItem.appendTo(ul);\r\n                    }\r\n\r\n                    if (item.label==\"Dont Show Me\") {\r\n                        listItem.css({display:\"block\",height:\"0px\",width:\"0px\",visibility:\"hidden\"});\r\n                        listItem.attr('id','insert-google-font-after-me');\r\n                    }\r\n\r\n                    listItem.attr('original-title', item.value);\r\n                    return listItem;\r\n                };\r\n\r\n                jQuery('#css_font-family').change(function(){\r\n                    var font = jQuery(this).val();\r\n                    t.check_the_font_bold(font);\r\n                    t.do_google_font_loading(font);\r\n                });\r\n\r\n                //handle autocomplete close\r\n                jQuery('#css_font-family').bind('catcompleteopen', function() {\r\n                    jQuery(this).data('is_open',true);\r\n                });\r\n\r\n                jQuery('#css_font-family').bind('catcompleteclose', function() {\r\n                    jQuery(this).data('is_open',false);\r\n                });\r\n\r\n            }\r\n\r\n            var switchLayerBackground = function(objData){\r\n\r\n                t.updateCurrentLayer(objData);\r\n                t.add_layer_change();\r\n                var objLayer = t.getCurrentLayer();\r\n                u.rebuildLayerIdleProgress(objLayer.references.htmlLayer);\r\n            }\r\n\r\n            /**\r\n             * init buttons actions\r\n             */\r\n            var initButtons = function(){\r\n\r\n                //set event buttons actions:\r\n                jQuery('#button_add_layer').click(function(){\r\n                    //ADDING NEW TEXT LAYER\r\n                    addLayerText(jQuery(this).data('isstatic') == true ? 'static' : null);\r\n                });\r\n\r\n                // add image layer\r\n                jQuery('#button_add_layer_image').click(function(){\r\n                    var targ = jQuery(this).data('isstatic') == true ? rev_lang.select_static_layer_image : rev_lang.select_layer_image,\r\n                        par = jQuery(this).data('isstatic') == true ? 'static' : null;\r\n\r\n                    UniteAdminRev.openAddImageDialog(targ,function(urlImage,imgid,imgwidth,imgheight){\r\n                        var imgobj = {imgurl: urlImage, imgid: imgid, imgwidth: imgwidth, imgheight: imgheight};\r\n                        addLayerImage(imgobj, par);\r\n                    });\r\n                });\r\n\r\n                //add youtube actions:\r\n                jQuery('#button_add_layer_video').click(function(){\r\n                    var gallery_type = jQuery('input[name=\"rs-gallery-type\"]').val();\r\n                    t.prepare_video_layer_add(gallery_type);\r\n                });\r\n\r\n\r\n                jQuery('#button_add_layer_audio').click(function(){\r\n                    t.prepare_video_layer_add('audio');\r\n                });\r\n\r\n                t.prepare_video_layer_add = function(gallery_type){\r\n\r\n                    jQuery('#video_dialog_form').trigger(\"reset\");\r\n                    jQuery('#reset_video_dialog_tab').click();\r\n\r\n                    //check if we are youtubestream or vimeostream. If yes, change what can be seen and edited\r\n                    switch(gallery_type){\r\n                        case 'youtube':\r\n                            jQuery('.rs-show-when-youtube-stream').show();\r\n                            jQuery('.rs-hide-when-youtube-stream').show();\r\n                            break;\r\n                        case 'vimeo':\r\n                            jQuery('.rs-show-when-vimeo-stream').show();\r\n                            jQuery('.rs-hide-when-vimeo-stream').show();\r\n                            break;\r\n                        case 'instagram':\r\n                            jQuery('.rs-show-when-instagram-stream').show();\r\n                            jQuery('.rs-hide-when-instagram-stream').show();\r\n                            break;\r\n                        case 'audio': //open as audio!\r\n\r\n                            break;\r\n                    }\r\n\r\n\r\n                    var par = jQuery(this).data('isstatic') == true ? 'static' : null;\r\n                    UniteAdminRev.openVideoDialog(function(videoData){\r\n                        addLayerVideo(videoData, par); //audio will be handled inside\r\n                    }, false, gallery_type);\r\n                }\r\n\r\n                jQuery('#button_add_layer_button').click(function(){\r\n                    setExampleButtons();\r\n                    jQuery('#dialog_addbutton').dialog({\r\n                        buttons:{'Close':function(){jQuery('#dialog_addbutton').dialog('close');}},\r\n                        minWidth: 830,\r\n                        minHeight: 500,\r\n                        modal: true,\r\n                        dialogClass: 'tpdialogs',\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                    });\r\n                });\r\n\r\n\r\n                jQuery('#button_add_layer_svg, #button_add_object_layer').click(function(){\r\n                    setExampleButtons();\r\n                    t.callObjectLibraryDialog(\"object\");\r\n                });\r\n\r\n                //change image actions\r\n                jQuery(\"#button_change_image_objlib\").click(function(){\r\n                    setExampleButtons();\r\n                    t.callObjectLibraryDialog(\"background\");\r\n                });    //change image click.\r\n\r\n                jQuery(\"#button_change_image_yt\").click(function(){\r\n                    var bgimg = \"https://img.youtube.com/vi/\"+jQuery('#slide_bg_youtube').val()+\"/maxresdefault.jpg\";\r\n                    switchYTBGObject(bgimg);\r\n                });\r\n\r\n                // SWITCH THE MAIN BG FROM OBJECT LIBRARY\r\n                function switchYTBGObject(urlImage) {\r\n\r\n\r\n                    //set visual image\r\n                    jQuery(\"#divbgholder\").css(\"background-image\",\"url(\"+urlImage+\")\");\r\n                    jQuery('#slide_selector .list_slide_links li.selected .slide-media-container ').css(\"background-image\",\"url(\"+urlImage+\")\")\r\n\r\n                    //update setting input\r\n                    jQuery(\"#image_url\").val(urlImage);\r\n                    jQuery(\"#image_id\").val(\"\");\r\n\r\n                    t.changeSlotBGs();\r\n\r\n                    jQuery('.bgsrcchanger:checked').click();\r\n\r\n                    if(jQuery('input[name=\"kenburn_effect\"]').is(':checked')){\r\n                        jQuery('input[name=\"kb_start_fit\"]').change();\r\n                    }\r\n                }\r\n\r\n                // SWITCH THE MAIN BG FROM OBJECT LIBRARY\r\n                function switchMainBGObject(urlImage) {\r\n\r\n                    var selectedBGType = jQuery('input[name=\"background_type\"]:checked').val();\r\n                    if (jQuery.inArray(selectedBGType,['trans','solid','external']!=-1)) {\r\n                        jQuery('#radio_back_image').attr('checked','checked').change().click();\r\n                    }\r\n                    //set visual image\r\n                    jQuery(\"#divbgholder\").css(\"background-image\",\"url(\"+urlImage+\")\");\r\n                    jQuery('#slide_selector .list_slide_links li.selected .slide-media-container ').css(\"background-image\",\"url(\"+urlImage+\")\")\r\n\r\n                    //update setting input\r\n                    jQuery(\"#image_url\").val(urlImage);\r\n                    jQuery(\"#image_id\").val(\"\");\r\n\r\n                    t.changeSlotBGs();\r\n\r\n                    jQuery('.bgsrcchanger:checked').click();\r\n\r\n                    if(jQuery('input[name=\"kenburn_effect\"]').is(':checked')){\r\n                        jQuery('input[name=\"kb_start_fit\"]').change();\r\n                    }\r\n                }\r\n\r\n\r\n\r\n\r\n                // LOAD THE OBJECT ORIGINAL IMAGE SINCE IT WAS NOT YET LOADED IN THE UPLOADS FOLDER\r\n                function getMediaObjectUrl(handle, par,size,change,target,addAsBg){\r\n                    UniteAdminRev.ajaxRequest('load_library_object', {'handle': handle, 'type': \"orig\"}, function(response){\r\n                        if(response.success){\r\n                            var imgobj = {imgurl: response.url, imglib:\"objectlibrary\", imgproportion:true, imgwidth: parseInt(response.width,0)*size, imgheight: parseInt(response.height,0)*size};\r\n                            if (target===\"object\" && !addAsBg) {\r\n                                if (!change) {\r\n                                    addLayerImage(imgobj, par);\r\n                                } else {\r\n                                    var objData = {};\r\n                                    objData.image_url = response.url;\r\n                                    objData.image_librarysize = {};\r\n                                    objData.image_librarysize.width = parseInt(response.width,0)*size;\r\n                                    objData.image_librarysize.height = parseInt(response.height,0)*size;\r\n                                    objData.scaleProportional = true;\r\n                                    t.updateCurrentLayer(objData);\r\n                                    resetCurrentElementSize();\r\n                                    redrawLayerHtml(t.selectedLayerSerial);\r\n\r\n                                    t.add_layer_change();\r\n\r\n                                }\r\n                            } else if(target === 'background') {\r\n                                switchMainBGObject(response.url);\r\n                            } else if(target === 'layer'){\r\n                                var objData = {};\r\n                                objData.bgimage_url = response.url;\r\n                                objData.image_librarysize = {};\r\n                                objData.image_librarysize.width = parseInt(response.width,0)*size;\r\n                                objData.image_librarysize.height = parseInt(response.height,0)*size;\r\n                                switchLayerBackground(objData);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n\r\n                jQuery('body').on('click','.layer-link-type-element',function() {\r\n                    var _ = jQuery(this),\r\n                        _p = _.closest('.list-of-layer-links'),\r\n                        _s = _p.find('.layer-link-type-element-cs'),\r\n                        objLayer = t.getLayerByUniqueId(_p.data('uniqueid')),\r\n                        objUpdate = {};\r\n                    objUpdate.groupLink = _.data('linktype');\r\n                    t.updateLayer(objLayer.serial,objUpdate);\r\n                    for (var i=0;i<6;i++) {\r\n                        _s.removeClass('layer-link-type-'+i);\r\n                        objLayer.references.htmlLayer.removeClass(\"ldles_\"+i);\r\n\r\n                    }\r\n                    objLayer.references.htmlLayer.addClass(\"ldles_\"+objUpdate.groupLink);\r\n                    _s.addClass(\"layer-link-type-\"+objUpdate.groupLink);\r\n                })\r\n\r\n                // CLICK ON THE \"ADD OBJECT\" ELEMENT AND ITS HANDLING\r\n                jQuery('body').on('click','.objadd-single-item, .obj-item-size-selector',function() {\r\n\r\n                    var so = jQuery(this);\r\n                    if (jQuery.inArray(so.data('type'),[1,2,\"1\",\"2\",\"img\"])!==-1) return;\r\n                    if (so.hasClass(\"obj-item-size-selector\")) {\r\n                        var size = \"1\";\r\n                        switch (so.data('s')) {\r\n                            case \"xs\": size = 0.1;break;\r\n                            case \"s\": size = 0.25;break;\r\n                            case \"m\": size = 0.50;break;\r\n                            case \"l\": size = 0.75;break;\r\n                            case \"o\": size = 1;break;\r\n                        };\r\n                        so = so.closest('.objadd-single-item');\r\n                    }\r\n\r\n                    //WHERE THE OBJECT LIBRARY WAS STARTED FROM (BG OR LAYER)\r\n                    var lastState = jQuery('#dialog_addobj').data('last_open_state'),\r\n                        addAsBg = jQuery('#obj-layer-bg-switcher').hasClass(\"addthisasbg\");\r\n\r\n                    addAsBg = so.data('type')===\"2\" || so.data('type')===2 ? addAsBg : false;\r\n                    addAsBg = lastState===\"layer\" ? false : addAsBg;\r\n\r\n                    switch (so.data('type')) {\r\n                        case \"img\":\r\n                        case \"1\":\r\n                        case \"2\":\r\n                        case 1:\r\n                        case 2:\r\n                            if(!rs_plugin_validated){ //load image only if activated\r\n                                show_premium_dialog('register-to-acess-object-library');\r\n                                jQuery('#dialog_addobj').dialog('close');\r\n                                return false;\r\n                            }\r\n\r\n                            var stat = jQuery('#button_add_layer_image').data('isstatic'),\r\n                                targ = stat == true ? rev_lang.select_static_layer_image : rev_lang.select_layer_image,\r\n                                par = stat ? 'static' : null,\r\n                                src = so.data('origsrc');\r\n\r\n                            if (src.indexOf(\"/\")!==-1) {\r\n                                if (jQuery('#dialog_addobj').data('changeimg')!==true) {\r\n                                    var imgobj = {imgurl: src, imglib:\"objectlibrary\", imgproportion:true, imgwidth: parseInt(so.data('mediawidth'),0)*size, imgheight: parseInt(so.data('mediaheight'),0)*size};\r\n                                    if (lastState===\"object\" && !addAsBg)\r\n                                        addLayerImage(imgobj, par);\r\n                                    else\r\n                                    if (lastState===\"background\" || addAsBg)\r\n                                        switchMainBGObject(src);\r\n                                    else\r\n                                    if (lastState===\"layer\") {\r\n                                        var objData = {};\r\n                                        objData.bgimage_url = src;\r\n                                        objData.image_librarysize = {};\r\n                                        objData.image_librarysize.width = parseInt(so.data('mediawidth'),0)*size;\r\n                                        objData.image_librarysize.height = parseInt(so.data('mediaheight'),0)*size;\r\n                                        switchLayerBackground(objData);\r\n                                    }\r\n\r\n                                } else {\r\n                                    if (lastState===\"object\" && !addAsBg) {\r\n                                        var objData = {};\r\n                                        objData.image_url = src;\r\n                                        objData.image_librarysize = {};\r\n                                        objData.image_librarysize.width = parseInt(so.data('mediawidth'),0)*size;\r\n                                        objData.image_librarysize.height = parseInt(so.data('mediaheight'),0)*size;\r\n                                        objData.scaleProportional = true;\r\n\r\n                                        t.updateCurrentLayer(objData);\r\n                                        resetCurrentElementSize();\r\n                                        redrawLayerHtml(t.selectedLayerSerial);\r\n                                        t.add_layer_change();\r\n                                    }\r\n                                    else\r\n                                    if (lastState===\"background\" || addAsBg)\r\n                                        switchMainBGObject(src);\r\n                                    else\r\n                                    if (lastState===\"layer\") {\r\n                                        var objData = {};\r\n                                        objData.bgimage_url = src;\r\n                                        objData.image_librarysize = {};\r\n                                        objData.image_librarysize.width = parseInt(so.data('mediawidth'),0)*size;\r\n                                        objData.image_librarysize.height = parseInt(so.data('mediaheight'),0)*size;\r\n                                        switchLayerBackground(objData);\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                //Lade Image \u00dcber Get Object URL\r\n                                getMediaObjectUrl(src,par,size,jQuery('#dialog_addobj').data('changeimg'),lastState,addAsBg);\r\n                            }\r\n                            jQuery('#dialog_addobj').data('changeimg',false);\r\n                            break;\r\n                        case \"svg\":\r\n                            var svg = so.find('svg');\r\n                            if (jQuery('#dialog_addobj').data('changesvg')!==true) {\r\n                                var data = {},\r\n                                    w = svg.attr('width'),\r\n                                    h = svg.attr('height');\r\n\r\n                                data['static_styles'] = {};\r\n                                data['static_styles'] = t.setVal(data['static_styles'], 'color', \"#000000\", true);\r\n                                data['deformation'] = {};\r\n                                data['deformation-hover'] = {};\r\n                                data.text = ' ';\r\n                                data.alias = 'SVG';\r\n                                data.type = 'svg';\r\n                                data.style = '';\r\n                                data.svg = {};\r\n                                data.svg.src = jQuery(this).data('src');\r\n                                data = t.setVal(data, 'max_width', w, true);\r\n                                data = t.setVal(data, 'max_height', h, true);\r\n                                data.createdOnInit = false;\r\n                                addLayer(data);\r\n                            } else {\r\n                                var src = jQuery(this).data('src'),\r\n                                    w = svg.attr('width'),\r\n                                    h = svg.attr('height');\r\n\r\n                                serial = jQuery('#dialog_addobj').data('changesvgserial')\r\n                                jQuery.get(src, function(data) {\r\n                                    jQuery(\"#slide_layer_\"+serial+\" .innerslide_layer.tp-caption\").first().html(\"\");\r\n                                    jQuery(\"#slide_layer_\"+serial+\" .innerslide_layer.tp-caption\").first()[0].innerHTML = new XMLSerializer().serializeToString(data.documentElement);\r\n                                    u.rebuildLayerIdle(jQuery(\"#slide_layer_\"+serial));\r\n                                    var objLayer = t.getLayer(serial),\r\n                                        curw = parseInt(t.getVal(objLayer,'max_width'),0),\r\n                                        curh = parseInt(t.getVal(objLayer,'max_height'),0);\r\n\r\n                                    h = (curw / w) * h;\r\n                                    w = curw;\r\n\r\n                                    objLayer.svg.src = src;\r\n                                    objLayer = t.setVal(objLayer, 'max_width', w, true);\r\n                                    objLayer = t.setVal(objLayer, 'max_height', h, true);\r\n                                });\r\n                                t.add_layer_change();\r\n                                jQuery('#dialog_addobj').data('changesvg',false);\r\n                            }\r\n                            break;\r\n                        case \"icon\":\r\n                            addLayerText(jQuery(this).data('isstatic') == true ? 'static' : null, '<i class=\"'+so.data('src')+'\"></i>',50);\r\n                            break;\r\n                    }\r\n                    jQuery('#dialog_addobj').dialog('close');\r\n                });\r\n\r\n\r\n\r\n                jQuery('#button_add_layer_shape').click(function(){\r\n                    setExampleShape();\r\n                    jQuery('#dialog_addshape').dialog({\r\n                        buttons:{\r\n                            'Add':function(){\r\n                                //get values for shape\r\n                                var data = {};\r\n                                data['static_styles'] = {};\r\n                                data['deformation'] = {};\r\n                                data['deformation-hover'] = {};\r\n                                data.text = ' ';\r\n                                data.alias = 'Shape';\r\n                                data.type = 'shape';\r\n                                //data.style = 'tp-shape tp-shapewrapper';\r\n                                data.style = '';\r\n\r\n                                data.internal_class = 'tp-shape tp-shapewrapper';\r\n\r\n                                data.autolinebreak = false;\r\n\r\n                                data['deformation']['background-color'] = jQuery('input[name=\"adshape-color-1\"]').val();\r\n                                data['deformation']['background-transparency'] = jQuery('input[name=\"adshape-opacity-1\"]').val();\r\n                                data['deformation']['border-color'] = jQuery('input[name=\"adshape-border-color\"]').val();\r\n                                data['deformation']['border-opacity'] = jQuery('input[name=\"adshape-border-opacity\"]').val();\r\n                                data['deformation']['border-transparency'] = jQuery('input[name=\"adshape-border-opacity\"]').val();\r\n                                data['deformation']['border-width'] = jQuery('input[name=\"adshape-border-width\"]').val();\r\n                                data['deformation']['border-style'] = 'solid';\r\n                                data['deformation']['border-radius'] = [jQuery('.example-shape').css('borderTopLeftRadius'),jQuery('.example-shape').css('borderTopRightRadius'),jQuery('.example-shape').css('borderBottomRightRadius'),jQuery('.example-shape').css('borderBottomLeftRadius')];\r\n\r\n                                if(jQuery('input[name=\"shape_fullwidth\"]')[0].checked){\r\n                                    data['max_width'] = '100%';\r\n                                    data['cover_mode'] = 'fullwidth';\r\n                                }else{\r\n                                    data['max_width'] = jQuery('input[name=\"shape_width\"]').val();\r\n                                }\r\n\r\n                                if(jQuery('input[name=\"shape_fullheight\"]')[0].checked){\r\n                                    data['max_height'] = '100%';\r\n                                    data['cover_mode'] = 'fullheight';\r\n                                }else{\r\n                                    data['max_height'] = jQuery('input[name=\"shape_height\"]').val();\r\n                                }\r\n\r\n                                if(jQuery('input[name=\"shape_fullheight\"]')[0].checked && jQuery('input[name=\"shape_fullwidth\"]')[0].checked){\r\n                                    data['cover_mode'] = 'cover';\r\n                                }\r\n\r\n                                //if(jQuery('input[name=\"shape_fullwidth\"]')[0].checked && jQuery('input[name=\"shape_fullheight\"]')[0].checked){\r\n                                //    data['deformation']['padding'] = [jQuery('.example-shape').css('paddingTop'), jQuery('.example-shape').css('paddingRight'), jQuery('.example-shape').css('paddingBottom'), jQuery('.example-shape').css('paddingLeft')];\r\n                                //}\r\n\r\n                                data.createdOnInit = false;\r\n                                addLayer(data);\r\n\r\n                                jQuery('#dialog_addshape').dialog('close');\r\n\r\n                            },'Close':function(){jQuery('#dialog_addshape').dialog('close');}\r\n                        },\r\n                        minWidth: 830,\r\n                        minHeight: 500,\r\n                        modal: true,\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                        dialogClass: 'tpdialogs'\r\n                    });\r\n                });\r\n\r\n\r\n                jQuery('#button_add_layer_import').click(function(){\r\n                    t.reset_import_layer();\r\n\r\n                    jQuery('#dialog_addimport').dialog({\r\n                        minWidth: 830,\r\n                        minHeight: 500,\r\n                        modal: true,\r\n                        dialogClass: 'tpdialogs',\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                    });\r\n                });\r\n\r\n                jQuery('#button_add_layer_group, #add_new_group').click(function(){\r\n                    addLayerGroup(jQuery(this).data('isstatic') == true ? 'static' : null);\r\n                });\r\n\r\n                jQuery('#add_new_row').click(function(){\r\n                    addLayerRow(jQuery(this).data('isstatic') == true ? 'static' : null);\r\n                });\r\n\r\n                /**\r\n                 * get slides plus layers of the selected slider\r\n                 *\r\n                 **/\r\n                jQuery('#rs-import-layer-slider').change(function(){\r\n                    var im_slider_id = jQuery(this).val();\r\n                    if(im_slider_id == '-'){\r\n                        t.reset_import_layer();\r\n                        return false;\r\n                    }else{\r\n                        if(typeof(import_slides[im_slider_id]) == 'undefined'){ //get data for the im_slider_id\r\n                            UniteAdminRev.ajaxRequest('get_import_slides_data', im_slider_id, function(response){\r\n                                if(typeof(response.slides) !== 'undefined'){\r\n                                    import_slides[im_slider_id] = response.slides;\r\n                                    t.do_clear_layer_import();\r\n                                    t.do_clear_slide_import();\r\n                                    t.do_add_slide_import();\r\n                                    t.do_show_sliders_import();\r\n                                    return true;\r\n                                }else{\r\n                                    alert(rev_lang.empty_data_retrieved_for_slider);\r\n                                    t.reset_import_layer();\r\n                                    return false;\r\n                                }\r\n                            });\r\n                            return false;\r\n                        }\r\n                        t.do_clear_layer_import();\r\n                        t.do_clear_slide_import();\r\n                        t.do_add_slide_import();\r\n                        t.do_show_sliders_import();\r\n                    }\r\n                });\r\n\r\n                jQuery('#rs-import-layer-type').change(function(){\r\n                    t.do_clear_layer_import();\r\n                    t.do_show_sliders_import();\r\n                });\r\n\r\n                jQuery('#rs-import-layer-slide').change(function(){\r\n                    t.do_clear_layer_import();\r\n                    t.do_show_sliders_import();\r\n                });\r\n\r\n                jQuery('body').on('click', '#rs-import-layer-holder li .import-layer-now', function(){\r\n                    if(confirm(rev_lang.import_selected_layer)){\r\n                        //import selected layer with the unique id clicked\r\n                        var btn = jQuery(this),\r\n                            li = btn.closest('li'),\r\n                            slider_id = li.data('sliderid'),\r\n                            slide_id = li.data('slideid'),\r\n                            unique_layer = li.data('id'),\r\n                            action_dependencies = li.data('actiondep');\r\n\r\n                        if(typeof(import_slides[slider_id]) == 'undefined') return false;\r\n                        if(typeof(import_slides[slider_id][slide_id]) == 'undefined') return false;\r\n\r\n                        var layers_to_add = t.get_layers_to_add_through_actions(import_slides[slider_id][slide_id]['layers'], unique_layer);\r\n\r\n                        //get the data, then use it to add a new layer\r\n                        if(layers_to_add!==null && layers_to_add.length > 0){\r\n                            if(layers_to_add.length > 1 && confirm(rev_lang.import_all_layer_from_actions)){\r\n                                var dependencies = [];\r\n                                dependencies = t.get_action_dependencies(li, slide_id, dependencies);\r\n\r\n                                for(var lta in layers_to_add) if (layers_to_add.hasOwnProperty(lta)) {\r\n                                    layers_to_add[lta].createdOnInit = false;\r\n                                    addLayer(layers_to_add[lta], true);\r\n\r\n                                    li.addClass(\"layerimported\");\r\n                                    btn.find('i').addClass(\"eg-icon-ok\").removeClass(\"eg-icon-plus\");\r\n\r\n                                    for(var dkey in dependencies) if (dependencies.hasOwnProperty(dkey)) {\r\n                                        var cli = jQuery('#to-import-layer-id-'+slide_id+'-'+dependencies[dkey]);\r\n                                        if(!cli.hasClass('layerimported')){\r\n                                            cli.addClass('layerimported');\r\n                                            cli.find('.import-layer-now i').addClass(\"eg-icon-ok\").removeClass(\"eg-icon-plus\");\r\n                                        }\r\n                                    }\r\n\r\n                                }\r\n                            }else{ //just need to add one layer, so take the first one\r\n                                for(var lta in layers_to_add) if (layers_to_add.hasOwnProperty(lta)) {\r\n                                    //remove actions of first layer that are connected to other layers\r\n                                    layers_to_add[lta] = t.remove_import_layer_actions(layers_to_add[lta]);\r\n                                    layers_to_add[lta].createdOnInit = false;\r\n                                    layers_to_add[lta]['p_uid'] = -1;\r\n                                    addLayer(layers_to_add[lta], true);\r\n                                    li.addClass(\"layerimported\");\r\n                                    btn.find('i').addClass(\"eg-icon-ok\").removeClass(\"eg-icon-plus\");\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n                t.object_library_loaded = false;\r\n                t.callObjectLibraryDialog = function(type) {\r\n\r\n                    if(!t.object_library_loaded){\r\n\r\n\r\n                        UniteAdminRev.ajaxRequest('load_object_library', {}, function(response){\r\n                            if(response.success){\r\n                                //add data['list'] and data['html']\r\n                                for(var key in response.data['html']) if (response.data['html'].hasOwnProperty(key)) {\r\n\r\n                                    if(response.data['html'][key]['type'] == 'tag'){\r\n\r\n                                        jQuery('.object-tag-list').append('<span class=\"obj_library_cats\" id=\"obj_library_cats_'+response.data['html'][key]['handle']+'\" data-tag=\"'+response.data['html'][key]['handle']+'\">'+response.data['html'][key]['name']+'</span>');\r\n                                    }else if(response.data['html'][key]['type'] == 'inner'){\r\n                                        jQuery('#object_library_results-inner').append('<div style=\"display:none\" class=\"rs-obj-library\"></div>');\r\n                                    }\r\n                                }\r\n\r\n                                for(var key in response.data['list']) if (response.data['list'].hasOwnProperty(key)) {\r\n                                    var obj = { handle:key, list: []};\r\n                                    for(var l in response.data['list'][key]) if (response.data['list'][key].hasOwnProperty(l)) {\r\n                                        obj.list.push(response.data['list'][key][l]);\r\n                                    }\r\n                                    obj_libraries.push(obj);\r\n                                }\r\n\r\n                                push_objects_to_library();\r\n\r\n                                t.object_library_loaded = true;\r\n                                t.call_object_dialog(type);\r\n                            }\r\n                        });\r\n                    }else{\r\n                        t.call_object_dialog(type);\r\n                    }\r\n                }\r\n\r\n                t.call_object_dialog = function(type){\r\n\r\n                    jQuery('#dialog_addobj').dialog({\r\n                        width:jQuery(window).width(),\r\n                        height:jQuery(window).height(),\r\n                        modal: true,\r\n                        dialogClass: 'tpdialogs fullscreen-dialog-window objectlibrary_dialog',\r\n                        create:function(event,ui) {\r\n                            var title = jQuery(event.target).parent().find('.ui-dialog-titlebar');\r\n                            title.addClass(\"tp-slider-new-dialog-title\");\r\n                            title.prepend('<span class=\"revlogo-mini\" style=\"margin-right:15px;\"></span>');\r\n\r\n                        },\r\n                        hide:{effect:\"\",delay:250},\r\n                        open:function(event) {\r\n                            var holder = jQuery(event.target).parent();\r\n                            setTimeout(function() {\r\n                                holder.addClass(\"show\");\r\n                            },200);\r\n                            if (jQuery('#dialog_addobj').data('last_open_state') !== type) {\r\n                                jQuery('#dialog_addobj').data('last_open_state',type);\r\n\r\n                                var title = holder.find('.ui-dialog-titlebar .ui-dialog-title');\r\n                                if (type===\"background\") {\r\n                                    jQuery('.obj_library_cats_filter').hide();\r\n                                    jQuery('#object_library_results').addClass(\"backgrounds\");\r\n                                    jQuery('#obj_lib_main_cat_filt_bgimage').show().click();\r\n                                    title.html(\"Add Background Image\");\r\n                                } else if(type==='object') {\r\n                                    jQuery('#object_library_results').removeClass(\"backgrounds\");\r\n                                    jQuery('.obj_library_cats_filter').show();\r\n                                    jQuery('#obj_lib_main_cat_filt_all').show().click();\r\n                                    title.html(\"Add Object Layer\");\r\n                                } else if(type==='layer') {\r\n                                    jQuery('.obj_library_cats_filter').hide();\r\n                                    jQuery('#object_library_results').addClass(\"backgrounds\");\r\n                                    jQuery('#obj_lib_main_cat_filt_bgimage').show();\r\n                                    jQuery('#obj_lib_main_cat_filt_image').show();\r\n                                    jQuery('#obj_lib_main_cat_filt_allimages').click();\r\n                                    title.html(\"Add Image as Layer Background\");\r\n                                }\r\n                            }\r\n                            jQuery('#object_library_results-inner').perfectScrollbar(\"update\");\r\n                            if (jQuery('.obj_library_cats.selected').length==0)\r\n                                jQuery('.obj_library_cats').first().click();\r\n                            //ui is not available !?\r\n                            var ui = jQuery('#dialog_addobj').closest('.ui-dialog');\r\n                            ui.addClass(\"visible-fullscreen-dialog\");\r\n                            t.setObjectLibraryHeight();\r\n                        },\r\n                        beforeClose:function(event) {\r\n                            jQuery(event.target).parent().removeClass(\"show\");\r\n                        },\r\n                        close:function(event) {\r\n\r\n                            var ui = jQuery('#dialog_addobj').closest('.ui-dialog');\r\n                            ui.removeClass(\"visible-fullscreen-dialog\");\r\n                        }\r\n                    });\r\n                }\r\n\r\n\r\n                t.setObjectLibraryHeight = function() {\r\n                    var das = jQuery('#dialog_addobj');\r\n                    if (das.is(\":visible\")) {\r\n                        var    ol = jQuery('#object_library_results'),\r\n                            wh = jQuery(window).height(),\r\n                            hh = jQuery('#addobj-dialog-header').height(),\r\n                            th = das.parent().find('.tp-slider-new-dialog-title').height(),\r\n                            newh = wh-(hh+th+100);\r\n                        das.height(wh-th);\r\n                        ol.height(newh);\r\n                    }\r\n                }\r\n\r\n                t.get_action_dependencies = function(li, slide_id, dependencies){\r\n                    var action_dependencies = li.data('actiondep');\r\n                    if(action_dependencies !== ''){\r\n                        action_dependencies = action_dependencies.toString().split(',');\r\n\r\n                        for(var adkey in action_dependencies) if (action_dependencies.hasOwnProperty(adkey)) {\r\n                            if(action_dependencies[adkey] !== 'backgroundvideo' && action_dependencies[adkey] !== 'firstvideo' && jQuery.inArray(action_dependencies[adkey], dependencies) == -1){\r\n\r\n                                dependencies.push(action_dependencies[adkey]);\r\n\r\n                                var new_dep = t.get_action_dependencies(jQuery('#to-import-layer-id-'+slide_id+'-'+action_dependencies[adkey]), slide_id, dependencies);\r\n\r\n                                for(var key in new_dep) if (new_dep.hasOwnProperty(key)) {\r\n                                    if(jQuery.inArray(new_dep[key], dependencies) == -1) dependencies.push(new_dep[key]);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return dependencies;\r\n                }\r\n\r\n                t.remove_import_layer_actions = function(layer){\r\n                    var attr = ['tooltip_event', 'action', 'image_link', 'link_open_in', 'jump_to_slide', 'scrollunder_offset', 'actioncallback', 'layer_target', 'action_delay', 'link_type', 'toggle_layer_type', 'toggle_class'];\r\n\r\n                    if(typeof(layer['layer_action']) !== 'undefined' && typeof(layer['layer_action']['action']) !== 'undefined' && layer['layer_action']['action'].length > 0){\r\n                        for(var lkey in layer['layer_action']['action']) if (layer['layer_action']['action'].hasOwnProperty(lkey)) {\r\n                            switch(layer['layer_action']['action'][lkey]){\r\n                                case 'start_in':\r\n                                case 'start_out':\r\n                                case 'toggle_layer':\r\n                                case 'start_video':\r\n                                case 'stop_video':\r\n                                case 'toggle_video':\r\n                                case 'mute_video':\r\n                                case 'unmute_video':\r\n                                case 'toggle_global_mute_video':\r\n                                case 'toggle_mute_video':\r\n                                case 'simulate_click':\r\n                                case 'toggle_class':\r\n                                    for(var akey in attr) if (attr.hasOwnProperty(akey)) {\r\n                                        if(typeof(layer['layer_action'][attr[akey]]) !== 'undefined' && typeof(layer['layer_action'][attr[akey]][lkey]) !== 'undefined') delete(layer['layer_action'][attr[akey]][lkey]);\r\n                                    }\r\n                                    break;\r\n                            }\r\n                        }\r\n                    }\r\n                    return layer;\r\n                }\r\n\r\n                t.get_layers_to_add_through_actions = function(layers, unique_id){\r\n                    var layers_to_add = [];\r\n\r\n                    layers_to_add = t.add_layer_to_queue_by_unique_id(layers, unique_id, layers_to_add);\r\n\r\n                    layers_to_add = t.check_actions_change_unique_ids(layers_to_add);\r\n\r\n                    return layers_to_add;\r\n                }\r\n\r\n                t.add_layer_to_queue_by_unique_id = function(layers, unique_id, layers_to_add){\r\n                    for(var key in layers) if (layers.hasOwnProperty(key)) {\r\n                        if(layers[key]['unique_id'] == unique_id){\r\n                            //remove the unique ID here, we need a new one\r\n\r\n                            layers_to_add.push(UniteAdminRev.duplicateObject(layers[key]));\r\n\r\n                            if(typeof(layers[key]['layer_action']) !== 'undefined' && typeof(layers[key]['layer_action']['action']) !== 'undefined' && layers[key]['layer_action']['action'].length > 0){\r\n                                var actions = layers[key]['layer_action'];\r\n                                for(var lkey in actions['action']) if (actions['action'].hasOwnProperty(lkey)) {\r\n                                    switch(actions['action'][lkey]){\r\n                                        case 'start_in':\r\n                                        case 'start_out':\r\n                                        case 'toggle_layer':\r\n                                        case 'start_video':\r\n                                        case 'stop_video':\r\n                                        case 'toggle_video':\r\n                                        case 'mute_video':\r\n                                        case 'unmute_video':\r\n                                        case 'toggle_mute_video':\r\n                                        case 'toggle_global_mute_video':\r\n                                        case 'simulate_click':\r\n                                        case 'toggle_class':\r\n                                            //check layers\r\n                                            if(actions['layer_target'][lkey]){\r\n                                                var do_add = true;\r\n                                                for(var l in layers_to_add) if (layers_to_add.hasOwnProperty(l)) {\r\n                                                    if(layers_to_add[l]['unique_id'] == actions['layer_target'][lkey]){\r\n                                                        do_add = false;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                                if(do_add){\r\n                                                    for(var akey in layers) if (layers.hasOwnProperty(akey)) {\r\n                                                        if(layers[akey]['unique_id'] == actions['layer_target'][lkey]){\r\n                                                            t.add_layer_to_queue_by_unique_id(layers, layers[akey]['unique_id'], layers_to_add);\r\n                                                            //layers_to_add.push(UniteAdminRev.duplicateObject(layers[akey]));\r\n                                                            break;\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                            break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return layers_to_add;\r\n                }\r\n\r\n                t.check_actions_change_unique_ids = function(layers){\r\n                    //map the old layer ids with the new one they get now\r\n                    var map = {};\r\n\r\n                    for(var key in layers) if (layers.hasOwnProperty(key)) {\r\n                        unique_layer_id++;\r\n                        map[layers[key]['unique_id']] = unique_layer_id;\r\n                        layers[key]['unique_id'] = unique_layer_id;\r\n                    }\r\n\r\n                    //now change action layers connections to the new IDs\r\n                    //remove the go to slide actions\r\n                    for(var key in layers) if (layers.hasOwnProperty(key)) {\r\n                        if(typeof(layers[key]['layer_action']) !== 'undefined' && typeof(layers[key]['layer_action']['action']) !== 'undefined' && layers[key]['layer_action']['action'].length > 0){\r\n                            for(var lkey in layers[key]['layer_action']['layer_target']) if (layers[key]['layer_action']['layer_target'].hasOwnProperty(lkey)) {\r\n                                for(var l in map) if (map.hasOwnProperty(l)) {\r\n                                    if(l == layers[key]['layer_action']['layer_target'][lkey]){\r\n                                        layers[key]['layer_action']['layer_target'][lkey] = map[l];\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                            for(var lkey in layers[key]['layer_action']['jump_to_slide']) if (layers[key]['layer_action']['jump_to_slide'].hasOwnProperty(lkey)) {\r\n                                layers[key]['layer_action']['jump_to_slide'][lkey] = '-1';\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return layers;\r\n                }\r\n\r\n                t.reset_import_layer = function(){\r\n                    jQuery('#rs-import-layer-slider option[value=\"-\"]').attr('selected', true);\r\n                    jQuery('#rs-import-layer-slide option[value=\"-\"]').attr('selected', true);\r\n                    jQuery('#rs-import-layer-type option[value=\"-\"]').attr('selected', true);\r\n                }\r\n\r\n                /**\r\n                 * add slides to dropdown\r\n                 **/\r\n                t.do_add_slide_import = function(){\r\n                    var im_slider_id = jQuery('#rs-import-layer-slider option:selected').val();\r\n                    if(im_slider_id == '-' || typeof(import_slides[im_slider_id]) == 'undefined') return false;\r\n\r\n                    for(var key in import_slides[im_slider_id]) if (import_slides[im_slider_id].hasOwnProperty(key)) {\r\n                        jQuery('#rs-import-layer-slide').append(jQuery('<option></option>').val(key).text('Slide: '+import_slides[im_slider_id][key]['params']['title']));\r\n                    }\r\n                }\r\n\r\n                t.do_clear_slide_import = function(){\r\n                    jQuery('#rs-import-layer-slide option').each(function(){\r\n                        if(jQuery(this).val() !== 'all' && jQuery(this).val() !== '-') jQuery(this).remove();\r\n                    });\r\n                }\r\n\r\n                t.do_clear_layer_import = function(){\r\n                    jQuery('#rs-import-layer-holder').html('');\r\n                }\r\n\r\n                t.do_show_sliders_import = function(){\r\n                    var im_slider_id = jQuery('#rs-import-layer-slider option:selected').val();\r\n                    var im_slide_id = jQuery('#rs-import-layer-slide option:selected').val();\r\n                    var im_slide_type = jQuery('#rs-import-layer-type option:selected').val();\r\n\r\n                    if(im_slider_id == '-') return false;\r\n\r\n                    if(typeof(import_slides[im_slider_id]) == 'undefined') return false;\r\n                    for(var key in import_slides[im_slider_id]) if (import_slides[im_slider_id].hasOwnProperty(key)) {\r\n                        if(im_slide_id == 'all' || im_slide_id == '-' || im_slide_id == key){\r\n                            if (import_slides[im_slider_id][key]['layers'].length>0)\r\n                                jQuery('#rs-import-layer-holder').append('<li class=\"layer-import-slide-seperator\">Slide Title - '+import_slides[im_slider_id][key].params.title+'</li>')\r\n\r\n                            for(var lkey in import_slides[im_slider_id][key]['layers']) if (import_slides[im_slider_id][key]['layers'].hasOwnProperty(lkey)) {\r\n\r\n                                if(im_slide_type == 'all' || im_slide_type == '-' || im_slide_type == import_slides[im_slider_id][key]['layers'][lkey]['type']){\r\n\r\n                                    var action_string = [];\r\n                                    action_string = t.get_action_string_dependencies(import_slides[im_slider_id][key]['layers'][lkey], im_slide_id, action_string, import_slides[im_slider_id][key]['layers']);\r\n\r\n                                    var has_action = 'off';\r\n                                    if(typeof(import_slides[im_slider_id][key]['layers'][lkey]['layer_action']) !== 'undefined' && typeof(import_slides[im_slider_id][key]['layers'][lkey]['layer_action']['action']) !== 'undefined' && import_slides[im_slider_id][key]['layers'][lkey]['layer_action']['action'].length > 0){\r\n                                        for(var akey in import_slides[im_slider_id][key]['layers'][lkey]['layer_action']['action']) if (import_slides[im_slider_id][key]['layers'][lkey]['layer_action']['action'].hasOwnProperty(akey)) {\r\n                                            switch(import_slides[im_slider_id][key]['layers'][lkey]['layer_action']['action'][akey]){\r\n                                                case 'start_in':\r\n                                                case 'start_out':\r\n                                                case 'toggle_layer':\r\n                                                case 'start_video':\r\n                                                case 'stop_video':\r\n                                                case 'toggle_video':\r\n                                                case 'mute_video':\r\n                                                case 'unmute_video':\r\n                                                case 'toggle_mute_video':\r\n                                                case 'toggle_global_mute_video':\r\n                                                case 'simulate_click':\r\n                                                case 'toggle_class':\r\n                                                    action_string.push(import_slides[im_slider_id][key]['layers'][lkey]['layer_action']['layer_target'][akey]);\r\n                                                    break;\r\n                                            }\r\n                                        }\r\n                                        has_action = 'on';\r\n                                    }\r\n\r\n                                    var content = global_layer_import_template({\r\n                                        'withaction': has_action,\r\n                                        'action_layers': action_string,\r\n                                        'type': import_slides[im_slider_id][key]['layers'][lkey]['type'],\r\n                                        'alias': import_slides[im_slider_id][key]['layers'][lkey]['alias'],\r\n                                        'width': import_slides[im_slider_id][key]['layers'][lkey]['width'],\r\n                                        'height': import_slides[im_slider_id][key]['layers'][lkey]['height'],\r\n                                        'unique_id': import_slides[im_slider_id][key]['layers'][lkey]['unique_id'],\r\n                                        'slider_id': im_slider_id,\r\n                                        'slide_id': key\r\n                                    });\r\n\r\n                                    jQuery('#rs-import-layer-holder').append(content);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }\r\n\r\n\r\n                t.get_action_string_dependencies = function(layer, slide_id, action_string, layers){\r\n\r\n                    if(typeof(layer['layer_action']) !== 'undefined' && typeof(layer['layer_action']['action']) !== 'undefined' && layer['layer_action']['action'].length > 0){\r\n                        for(var akey in layer['layer_action']['action']) if (layer['layer_action']['action'].hasOwnProperty(akey)) {\r\n                            switch(layer['layer_action']['action'][akey]){\r\n                                case 'start_in':\r\n                                case 'start_out':\r\n                                case 'toggle_layer':\r\n                                case 'start_video':\r\n                                case 'stop_video':\r\n                                case 'toggle_video':\r\n                                case 'mute_video':\r\n                                case 'unmute_video':\r\n                                case 'toggle_mute_video':\r\n                                case 'toggle_global_mute_video':\r\n                                case 'simulate_click':\r\n                                case 'toggle_class':\r\n                                    if(typeof(layer['layer_action']['layer_target']) !== 'undefined' && typeof(layer['layer_action']['layer_target'][akey]) !== 'undefined' && layer['layer_action']['layer_target'][akey] !== 'backgroundvideo' && layer['layer_action']['layer_target'][akey] !== 'firstvideo' && jQuery.inArray(layer['layer_action']['layer_target'][akey], action_string) == -1){\r\n                                        action_string.push(layer['layer_action']['layer_target'][akey]);\r\n\r\n                                        for(var lkey in layers) if (layers.hasOwnProperty(lkey)) {\r\n                                            if(layers[lkey]['unique_id'] == layer['layer_action']['layer_target'][akey]){\r\n\r\n                                                var new_action = t.get_action_string_dependencies(layers[lkey], slide_id, action_string, layers);\r\n                                                for(var key in new_action) if (new_action.hasOwnProperty(key)) {\r\n                                                    if(jQuery.inArray(new_action[key], action_string) == -1) action_string.push(new_action[key]);\r\n                                                }\r\n                                                break;\r\n                                            }\r\n                                        }\r\n\r\n                                    }\r\n                                    break;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    return action_string;\r\n                }\r\n\r\n                jQuery('body').on('click', '.addbutton-examples-wrapper a.rev-btn', function(){\r\n                    //get values for buttons\r\n                    var data = {};\r\n                    data['static_styles'] = {};\r\n                    data['inline'] = {'idle':{}, 'hover':{}};\r\n                    data['deformation'] = {};\r\n                    data['deformation-hover'] = {};\r\n                    data.text = jQuery('input[name=\"adbutton-text\"]').val();\r\n                    data.type = 'button';\r\n                    data.subtype = 'roundbutton'; //no_edit\r\n                    data.specialsettings = {};\r\n\r\n                    data.alias = 'Button';\r\n                    data.style = '';//'rev-btn';//jQuery(this).attr('class');\r\n\r\n                    data.internal_class = jQuery(this).data('needclass');\r\n\r\n                    //missing class needs to be added here as some special!\r\n\r\n                    data['resize-full'] = false;\r\n                    data['resizeme'] = false;\r\n\r\n                    data['static_styles']['color'] = jQuery('input[name=\"adbutton-color-2\"]').val();\r\n                    data['static_styles']['font-size'] = jQuery(this).css('font-size');\r\n                    data['static_styles']['line-height'] = jQuery(this).css('font-size');\r\n                    //data['static_styles']['line-height'] = jQuery(this).css('line-height');\r\n                    data['static_styles']['font-weight'] = jQuery(this).css('font-weight');\r\n\r\n                    data['max_width'] = 'auto';\r\n                    data['max_height'] = 'auto';\r\n\r\n                    data['autolinebreak'] = false;\r\n\r\n                    data['deformation']['padding'] = [jQuery(this).css('paddingTop'), jQuery(this).css('paddingRight'), jQuery(this).css('paddingBottom'), jQuery(this).css('paddingLeft')];\r\n\r\n                    data['deformation']['font-family'] = jQuery('input[name=\"adbutton-fontfamily\"]').val();\r\n                    data['deformation']['background-color'] = jQuery('input[name=\"adbutton-color-1\"]').val();\r\n                    data['deformation']['background-transparency'] = jQuery('input[name=\"adbutton-opacity-1\"]').val();\r\n                    data['deformation']['color-transparency'] = jQuery('input[name=\"adbutton-opacity-2\"]').val();\r\n                    data['deformation']['border-radius'] = [jQuery(this).css('borderTopLeftRadius'),jQuery(this).css('borderTopRightRadius'),jQuery(this).css('borderBottomRightRadius'),jQuery(this).css('borderBottomLeftRadius')];\r\n                    data['deformation']['border-color'] = jQuery('input[name=\"adbutton-border-color\"]').val();\r\n                    data['deformation']['border-transparency'] = jQuery('input[name=\"adbutton-border-opacity\"]').val();\r\n                    data['deformation']['border-opacity'] = jQuery('input[name=\"adbutton-border-opacity\"]').val();\r\n                    data['deformation']['border-width'] = [jQuery('input[name=\"adbutton-border-width\"]').val(),jQuery('input[name=\"adbutton-border-width\"]').val(),jQuery('input[name=\"adbutton-border-width\"]').val(),jQuery('input[name=\"adbutton-border-width\"]').val()];\r\n                    data['deformation']['border-style'] = 'solid';\r\n\r\n                    if(jQuery(this).hasClass('rev-withicon')){\r\n                        data['deformation']['icon-class'] = jQuery('.addbutton-icon i').attr('class'); //needs to be added\r\n                        data.text += '<i class=\"' + data['deformation']['icon-class'] + '\"></i>';\r\n                    }else{\r\n                        data['deformation']['icon-class'] = '';\r\n                    }\r\n\r\n                    data['hover'] = true;\r\n                    data['deformation-hover']['background-color'] = jQuery('input[name=\"adbutton-color-1-h\"]').val();\r\n                    data['deformation-hover']['background-transparency'] = jQuery('input[name=\"adbutton-opacity-1-h\"]').val();\r\n                    data['deformation-hover']['color'] = jQuery('input[name=\"adbutton-color-2-h\"]').val();\r\n                    data['deformation-hover']['color-transparency'] = jQuery('input[name=\"adbutton-opacity-2-h\"]').val();\r\n                    data['deformation-hover']['border-radius'] = [jQuery(this).css('borderTopLeftRadius'),jQuery(this).css('borderTopRightRadius'),jQuery(this).css('borderBottomRightRadius'),jQuery(this).css('borderBottomLeftRadius')];\r\n                    data['deformation-hover']['border-color'] = jQuery('input[name=\"adbutton-border-color-h\"]').val();\r\n                    data['deformation-hover']['border-transparency'] = jQuery('input[name=\"adbutton-border-opacity-h\"]').val();\r\n                    data['deformation-hover']['border-opacity'] = jQuery('input[name=\"adbutton-border-opacity-h\"]').val();\r\n                    data['deformation-hover']['border-width'] = [jQuery('input[name=\"adbutton-border-width-h\"]').val(),jQuery('input[name=\"adbutton-border-width-h\"]').val(),jQuery('input[name=\"adbutton-border-width-h\"]').val(),jQuery('input[name=\"adbutton-border-width-h\"]').val()];\r\n                    data['deformation-hover']['border-style'] = 'solid';\r\n\r\n                    if(jQuery(this).hasClass('rev-hiddenicon')){\r\n                        data['deformation-hover']['icon-class'] = jQuery('.addbutton-icon i').attr('class'); //needs to be added\r\n                        data.text += ' <i class=\"' + data['deformation-hover']['icon-class'] + '\"></i>';\r\n                    }else{\r\n                        data['deformation-hover']['icon-class'] = '';\r\n                    }\r\n\r\n\r\n                    //add stylings depending on classes it has\r\n                    if(jQuery(this).hasClass('rev-btn')){\r\n                        data['deformation']['text-decoration'] = 'none';\r\n                        data['deformation-hover']['css_cursor'] = 'pointer';\r\n\t\t\t\tdata['deformation-hover']['pointer_events'] = 'auto';\r\n                        data['inline']['idle']['outline'] = 'none';\r\n                        data['inline']['idle']['box-shadow'] = 'none';\r\n                        data['inline']['idle']['box-sizing'] = 'border-box';\r\n                        data['inline']['idle']['-moz-box-sizing'] = 'border-box';\r\n                        data['inline']['idle']['-webkit-box-sizing'] = 'border-box';\r\n                    }\r\n\r\n                    if(jQuery(this).hasClass('rev-uppercase')){\r\n                        data['inline']['idle']['text-transform'] = 'uppercase';\r\n                        data['inline']['idle']['letter-spacing'] = '1px';\r\n                    }\r\n\r\n                    data.createdOnInit = false;\r\n                    addLayer(data);\r\n\r\n                    jQuery('#dialog_addbutton').dialog('close');\r\n\r\n                });\r\n\r\n                var addSpecialButton = function(btn) {\r\n                    //get values for buttons\r\n                    var data = {};\r\n                    data['static_styles'] = {};\r\n                    data['inline'] = {'idle':{}, 'hover':{}};\r\n                    data['deformation'] = {};\r\n                    data['deformation-hover'] = {};\r\n                    data.text = btn.html();\r\n                    data.type = 'button'; //no_edit\r\n\r\n                    data.specialsettings = {};\r\n\r\n\r\n                    data.style = ''; //jQuery(this).attr('class');\r\n                    data.internal_class = btn.data('needclass');\r\n\r\n                    data['resize-full'] = false;\r\n                    data['resizeme'] = false;\r\n\r\n                    data['max_width'] = btn.css('width');\r\n                    data['max_height'] = btn.css('height');\r\n\r\n                    data['deformation']['padding'] = [btn.css('paddingTop'), btn.css('paddingRight'), btn.css('paddingBottom'), btn.css('paddingLeft')];\r\n\r\n                    data['deformation']['background-color'] = UniteAdminRev.rgb2hex(btn.css('backgroundColor'));\r\n                    var bgOpacity = UniteAdminRev.getTransparencyFromRgba(btn.css('backgroundColor'));\r\n                    bgOpacity = bgOpacity === false ? 1 : bgOpacity;\r\n                    if(bgOpacity == 0) data['deformation']['background-color'] = 'transparent';\r\n\r\n                    data['deformation']['background-opacity'] = bgOpacity;\r\n                    data['deformation']['background-transparency'] = bgOpacity;\r\n\r\n\r\n                    data['deformation']['border-color'] = UniteAdminRev.rgb2hex(btn.css('borderTopColor'));\r\n                    var borOpacity = UniteAdminRev.getTransparencyFromRgba(btn.css('borderTopColor'));\r\n                    borOpacity = borOpacity === false ? 1 : borOpacity;\r\n                    if(borOpacity == 0) data['deformation']['border-color'] = 'transparent';\r\n\r\n                    data['deformation']['border-opacity'] = borOpacity;\r\n                    data['deformation']['border-transparency'] = borOpacity;\r\n\r\n\r\n                    data['deformation']['border-radius'] = [btn.css('borderTopLeftRadius'),btn.css('borderTopRightRadius'),btn.css('borderBottomRightRadius'),btn.css('borderBottomLeftRadius')];\r\n\r\n                    data['deformation']['border-width'] = [btn.css('borderTopWidth'),btn.css('borderRightWidth'),btn.css('borderBottomWidth'),btn.css('borderLeftWidth')];\r\n                    data['deformation']['border-style'] = btn.css('borderTopStyle');\r\n\r\n                    data['deformation-hover']['css_cursor'] = btn.css('cursor');\r\n                    data['deformation-hover']['pointer_events'] = btn.css('pointer-events') || 'auto';            \r\n        \r\n                    data['inline']['idle']['box-sizing'] = 'border-box';\r\n                    data['inline']['idle']['-moz-box-sizing'] = 'border-box';\r\n                    data['inline']['idle']['-webkit-box-sizing'] = 'border-box';\r\n\r\n                    return data;\r\n                }\r\n\r\n\r\n                jQuery('body').on('click', '.addbutton-examples-wrapper div.rev-burger', function(){\r\n                    var data = addSpecialButton(jQuery(this));\r\n                    data.alias = 'Burger Button';\r\n                    data.subtype = 'burgerbutton'; //no_edit\r\n                    //add actions here\r\n                    data['layer_action'] = {};\r\n                    data['layer_action'].tooltip_event = [];\r\n                    data['layer_action'].tooltip_event.push('click');\r\n                    data['layer_action'].action = [];\r\n                    data['layer_action'].action.push('toggle_class');\r\n                    data['layer_action'].layer_target = [];\r\n                    data['layer_action'].layer_target.push('self');\r\n                    data['layer_action'].action_delay = [];\r\n                    data['layer_action'].action_delay.push(0);\r\n                    data['layer_action'].toggle_class = [];\r\n                    data['layer_action'].toggle_class.push('open');\r\n                    data.createdOnInit = false;\r\n                    addLayer(data);\r\n                    jQuery('#dialog_addbutton').dialog('close');\r\n                });\r\n\r\n                jQuery('body').on('click', '.addbutton-examples-wrapper span.rev-control-btn', function(){\r\n                    var data = addSpecialButton(jQuery(this));\r\n                    data.alias = 'Control Button';\r\n                    data.subtype = 'controlbutton';\r\n\r\n                    if(data['static_styles'] === undefined) data['static_styles'] = {};\r\n\r\n                    data['static_styles']['font-size'] = jQuery(this).css('font-size');\r\n                    data['static_styles']['line-height'] = jQuery(this).css('line-height');\r\n                    data['static_styles']['font-weight'] = jQuery(this).css('font-weight');\r\n                    data['static_styles']['color'] = UniteAdminRev.rgb2hex(jQuery(this).css('color'));\r\n\r\n                    data['deformation']['font-family'] = jQuery(this).css('font-family');\r\n                    data['text-align'] = jQuery(this).css('text-align');\r\n                    data['deformation']['vertical-align'] = jQuery(this).css('vertical-align');\r\n\r\n\r\n\r\n                    data.createdOnInit = false;\r\n                    addLayer(data);\r\n                    jQuery('#dialog_addbutton').dialog('close');\r\n                });\r\n\r\n\r\n                jQuery('body').on('click', '.addbutton-examples-wrapper span.rev-scroll-btn', function(){\r\n                    var data = addSpecialButton(jQuery(this));\r\n                    data.subtype = 'scrollbutton'; //no_edit\r\n                    data.alias = 'Scroll Button';\r\n                    data.createdOnInit = false;\r\n                    addLayer(data);\r\n                    jQuery('#dialog_addbutton').dialog('close');\r\n                });\r\n\r\n\r\n\r\n\r\n\r\n                //insert button link - open the dialog\r\n                jQuery(\"#linkInsertTemplate\").click(function(){\r\n                    if(jQuery(this).hasClass(\"disabled\"))\r\n                        return(false);\r\n\r\n                    add_meta_into = '';\r\n\r\n                    var buttons = {\"Cancel\":function(){jQuery(\"#dialog_template_insert\").dialog(\"close\")}}\r\n                    jQuery(\"#dialog_template_insert\").dialog({\r\n                        buttons:buttons,\r\n                        minWidth:700,\r\n                        dialogClass:\"tpdialogs\",\r\n                        modal:true,\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                    });\r\n\r\n                });\r\n\r\n                //insert button link - open the dialog\r\n                jQuery(\".rs-param-meta-open\").click(function(){\r\n\r\n                    add_meta_into = 'params_'+jQuery(this).data('curid');\r\n\r\n                    var buttons = {\"Cancel\":function(){jQuery(\"#dialog_template_insert\").dialog(\"close\")}}\r\n                    jQuery(\"#dialog_template_insert\").dialog({\r\n                        buttons:buttons,\r\n                        minWidth:700,\r\n                        dialogClass:\"tpdialogs\",\r\n                        modal:true,\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                    });\r\n\r\n                });\r\n\r\n                jQuery('#rs-undo-handler').click(function(){\r\n                    t.undo_redo_layer('undo');\r\n                });\r\n\r\n                jQuery('#rs-redo-handler').click(function(){\r\n                    t.undo_redo_layer('redo');\r\n                });\r\n\r\n\r\n                jQuery('body').on('click', '.rs-undo-step', function(){\r\n                    var step = jQuery(this).data('gotokey');\r\n                    t.undo_redo_layer('undo', step);\r\n                });\r\n\r\n                jQuery('body').on('click', '.rs-redo-step', function(){\r\n                    var step = jQuery(this).data('gotokey');\r\n                    t.undo_redo_layer('redo', step);\r\n                });\r\n            }\r\n\r\n            //======================================================\r\n            //\t\tInit Function End\r\n            //======================================================\r\n\r\n\r\n            /**\r\n             * get the values of custom animation dialog\r\n             */\r\n            var createNewAnimObj = function(what){\r\n\r\n                var customAnim = new Object;\r\n                if(what == 'start'){\r\n                    customAnim['movex'] = jQuery('input[name=\"layer_anim_xstart\"]').val();\r\n                    customAnim['movey'] = jQuery('input[name=\"layer_anim_ystart\"]').val();\r\n                    customAnim['mask'] = jQuery('#masking-start')[0].checked;\r\n                    customAnim['movez'] = jQuery('input[name=\"layer_anim_zstart\"]').val();\r\n                    customAnim['rotationx'] = jQuery('input[name=\"layer_anim_xrotate\"]').val();\r\n                    customAnim['rotationy'] = jQuery('input[name=\"layer_anim_yrotate\"]').val();\r\n                    customAnim['rotationz'] = jQuery('input[name=\"layer_anim_zrotate\"]').val();\r\n                    customAnim['scalex'] = jQuery('input[name=\"layer_scale_xstart\"]').val();\r\n                    customAnim['scaley'] = jQuery('input[name=\"layer_scale_ystart\"]').val();\r\n                    customAnim['skewx'] = jQuery('input[name=\"layer_skew_xstart\"]').val();\r\n                    customAnim['skewy'] = jQuery('input[name=\"layer_skew_ystart\"]').val();\r\n                    customAnim['captionopacity'] = jQuery('input[name=\"layer_opacity_start\"]').val();\r\n                    customAnim['blurfilter'] = jQuery('input[name=\"blurfilter_start\"]').val();\r\n                    customAnim['grayscalefilter'] = jQuery('input[name=\"grayscalefilter_start\"]').val();\r\n                    customAnim['mask'] = jQuery('#masking-start')[0].checked;\r\n                    customAnim['mask_x'] = jQuery('input[name=\"mask_anim_xstart\"]').val();\r\n                    customAnim['mask_y'] = jQuery('input[name=\"mask_anim_ystart\"]').val();\r\n                    customAnim['mask_ease'] = jQuery('input[name=\"mask_easing\"]').val();\r\n                    customAnim['mask_speed'] = jQuery('input[name=\"mask_speed\"]').val();\r\n                    customAnim['easing'] = jQuery('select[name=\"layer_easing\"] option:selected').val();\r\n                    customAnim['speed'] = jQuery('input[name=\"layer_speed\"]').val();\r\n                    customAnim['split'] = jQuery('select[name=\"layer_split\"] option:selected').val();\r\n                    customAnim['splitdelay'] = jQuery('input[name=\"layer_splitdelay\"]').val();\r\n\r\n                    customAnim['movex_reverse'] = jQuery('#layer_anim_xstart_reverse')[0].checked;\r\n                    customAnim['movey_reverse'] = jQuery('#layer_anim_ystart_reverse')[0].checked;\r\n                    customAnim['rotationx_reverse'] = jQuery('#layer_anim_xrotate_reverse')[0].checked;\r\n                    customAnim['rotationy_reverse'] = jQuery('#layer_anim_yrotate_reverse')[0].checked;\r\n                    customAnim['rotationz_reverse'] = jQuery('#layer_anim_zrotate_reverse')[0].checked;\r\n                    customAnim['scalex_reverse'] = jQuery('#layer_scale_xstart_reverse')[0].checked;\r\n                    customAnim['scaley_reverse'] = jQuery('#layer_scale_ystart_reverse')[0].checked;\r\n                    customAnim['skewx_reverse'] = jQuery('#layer_skew_xstart_reverse')[0].checked;\r\n                    customAnim['skewy_reverse'] = jQuery('#layer_skew_ystart_reverse')[0].checked;\r\n                    customAnim['mask_x_reverse'] = jQuery('#mask_anim_xstart_reverse')[0].checked;\r\n                    customAnim['mask_y_reverse'] = jQuery('#mask_anim_ystart_reverse')[0].checked;\r\n\r\n                }else{\r\n                    customAnim['movex'] = jQuery('#layer_anim_xend').val();\r\n                    customAnim['movey'] = jQuery('#layer_anim_yend').val();\r\n                    customAnim['movez'] = jQuery('#layer_anim_zend').val();\r\n                    customAnim['rotationx'] = jQuery('#layer_anim_xrotate_end').val();\r\n                    customAnim['rotationy'] = jQuery('#layer_anim_yrotate_end').val();\r\n                    customAnim['rotationz'] = jQuery('#layer_anim_zrotate_end').val();\r\n                    customAnim['scalex'] = jQuery('#layer_scale_xend').val();\r\n                    customAnim['scaley'] = jQuery('#layer_scale_yend').val();\r\n                    customAnim['skewx'] = jQuery('#layer_skew_xend').val();\r\n                    customAnim['skewy'] = jQuery('#layer_skew_yend').val();\r\n                    customAnim['captionopacity'] = jQuery('#layer_opacity_end').val();\r\n                    customAnim['mask'] = jQuery('#masking-end')[0].checked;\r\n                    customAnim['mask_x'] = jQuery('#mask_anim_xend').val();\r\n                    customAnim['mask_y'] = jQuery('#mask_anim_yend').val();\r\n                    //customAnim['mask_ease'] = jQuery('input[name=\"mask_easing_end\"]').val();\r\n                    //customAnim['mask_speed'] = jQuery('input[name=\"mask_speed_end\"]').val();\r\n                    customAnim['easing'] = jQuery('#layer_endeasing option:selected').val();\r\n                    customAnim['speed'] = jQuery('#layer_endspeed').val();\r\n                    customAnim['split'] = jQuery('#layer_endsplit option:selected').val();\r\n                    customAnim['splitdelay'] = jQuery('#layer_endsplitdelay').val();\r\n\r\n                    customAnim['movex_reverse'] = jQuery('#layer_anim_xend_reverse')[0].checked;\r\n                    customAnim['movey_reverse'] = jQuery('#layer_anim_yend_reverse')[0].checked;\r\n                    customAnim['rotationx_reverse'] = jQuery('#layer_anim_xrotate_end_reverse')[0].checked;\r\n                    customAnim['rotationy_reverse'] = jQuery('#layer_anim_yrotate_end_reverse')[0].checked;\r\n                    customAnim['rotationz_reverse'] = jQuery('#layer_anim_zrotate_end_reverse')[0].checked;\r\n                    customAnim['scalex_reverse'] = jQuery('#layer_scale_xend_reverse')[0].checked;\r\n                    customAnim['scaley_reverse'] = jQuery('#layer_scale_yend_reverse')[0].checked;\r\n                    customAnim['skewx_reverse'] = jQuery('#layer_skew_xend_reverse')[0].checked;\r\n                    customAnim['skewy_reverse'] = jQuery('#layer_skew_yend_reverse')[0].checked;\r\n                    customAnim['mask_x_reverse'] = jQuery('#mask_anim_xend_reverse')[0].checked;\r\n                    customAnim['mask_y_reverse'] = jQuery('#mask_anim_xend_reverse')[0].checked;\r\n                }\r\n                return customAnim;\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * set the values of custom animation dialog\r\n             */\r\n            var setNewAnimFromObj = function(what, obj_v){\r\n\r\n                if(obj_v == undefined) return true;\r\n\r\n                if(what == 'start'){\r\n                    if(obj_v['movex'] !== undefined) { jQuery('input[name=\"layer_anim_xstart\"]').val(obj_v['movex']); }else{ jQuery('input[name=\"layer_anim_xstart\"]').val(0); }\r\n                    if(obj_v['movey'] !== undefined) { jQuery('input[name=\"layer_anim_ystart\"]').val(obj_v['movey']); }else{ jQuery('input[name=\"layer_anim_ystart\"]').val(0); }\r\n                    if(obj_v['movez'] !== undefined) { jQuery('input[name=\"layer_anim_zstart\"]').val(obj_v['movez']); }else{ jQuery('input[name=\"layer_anim_zstart\"]').val(0); }\r\n                    if(obj_v['rotationx'] !== undefined) { jQuery('input[name=\"layer_anim_xrotate\"]').val(obj_v['rotationx']); }else{ jQuery('input[name=\"layer_anim_xrotate\"]').val(0); }\r\n                    if(obj_v['rotationy'] !== undefined) { jQuery('input[name=\"layer_anim_yrotate\"]').val(obj_v['rotationy']); }else{ jQuery('input[name=\"layer_anim_yrotate\"]').val(0); }\r\n                    if(obj_v['rotationz'] !== undefined) { jQuery('input[name=\"layer_anim_zrotate\"]').val(obj_v['rotationz']); }else{ jQuery('input[name=\"layer_anim_zrotate\"]').val(0); }\r\n                    if(obj_v['scalex'] !== undefined) { jQuery('input[name=\"layer_scale_xstart\"]').val(obj_v['scalex']); }else{ jQuery('input[name=\"layer_scale_xstart\"]').val(0); }\r\n                    if(obj_v['scaley'] !== undefined) { jQuery('input[name=\"layer_scale_ystart\"]').val(obj_v['scaley']); }else{ jQuery('input[name=\"layer_scale_ystart\"]').val(0); }\r\n                    if(obj_v['skewx'] !== undefined) { jQuery('input[name=\"layer_skew_xstart\"]').val(obj_v['skewx']); }else{ jQuery('input[name=\"layer_skew_xstart\"]').val(0); }\r\n                    if(obj_v['skewy'] !== undefined) { jQuery('input[name=\"layer_skew_ystart\"]').val(obj_v['skewy']); }else{ jQuery('input[name=\"layer_skew_ystart\"]').val(0); }\r\n                    if(obj_v['captionopacity'] !== undefined) { jQuery('input[name=\"layer_opacity_start\"]').val(obj_v['captionopacity']); }else{ jQuery('input[name=\"layer_opacity_start\"]').val(0); }\r\n                    if(obj_v['blurfilter'] !== undefined) { jQuery('input[name=\"blurfilter_start\"]').val(obj_v['blurfilter']); }else{ jQuery('input[name=\"blurfilter_start\"]').val(0); }\r\n                    if(obj_v['grayscalefilter'] !== undefined) { jQuery('input[name=\"grayscalefilter_start\"]').val(obj_v['grayscalefilter']); }else{ jQuery('input[name=\"grayscalefilter_start\"]').val(0); }\r\n                    if(obj_v['mask'] !== undefined && (obj_v['mask'] == 'true' || obj_v['mask'] == true)) { jQuery('#masking-start').attr('checked', true); }else{ jQuery('#masking-start').attr('checked', false); }\r\n                    if(obj_v['mask_x'] !== undefined) { jQuery('input[name=\"mask_anim_xstart\"]').val(obj_v['mask_x']); }else{ jQuery('input[name=\"mask_anim_xstart\"]').val(0); }\r\n                    if(obj_v['mask_y'] !== undefined) { jQuery('input[name=\"mask_anim_ystart\"]').val(obj_v['mask_y']); }else{ jQuery('input[name=\"mask_anim_ystart\"]').val(0); }\r\n                    if(obj_v['mask_ease'] !== undefined) { jQuery('input[name=\"mask_easing\"]').val(obj_v['mask_ease']); }else{ jQuery('input[name=\"mask_easing\"]').val(0); }\r\n                    if(obj_v['mask_speed'] !== undefined) { jQuery('input[name=\"mask_speed\"]').val(obj_v['mask_speed']); }else{ jQuery('input[name=\"mask_speed\"]').val(0); }\r\n\r\n                    if(obj_v['easing'] !== undefined) { jQuery('select[name=\"layer_easing\"] option[value=\"'+obj_v['easing']+'\"]').attr('selected', 'selected'); }\r\n                    if(obj_v['speed'] !== undefined) { jQuery('input[name=\"layer_speed\"]').val(obj_v['speed']); }\r\n                    if(obj_v['split'] !== undefined) { jQuery('select[name=\"layer_split\"] option[value=\"'+obj_v['split']+'\"]').attr('selected', 'selected'); }\r\n                    if(obj_v['splitdelay'] !== undefined) { jQuery('input[name=\"layer_splitdelay\"]').val(obj_v['splitdelay']); }\r\n\r\n\r\n                    if(obj_v['movex_reverse'] !== undefined && (obj_v['movex_reverse'] == 'true' || obj_v['movex_reverse'] == true)) { jQuery('#layer_anim_xstart_reverse').attr('checked', true); }else{ jQuery('#layer_anim_xstart_reverse').attr('checked', false); }\r\n                    if(obj_v['movey_reverse'] !== undefined && (obj_v['movey_reverse'] == 'true' || obj_v['movey_reverse'] == true)) { jQuery('#layer_anim_ystart_reverse').attr('checked', true); }else{ jQuery('#layer_anim_ystart_reverse').attr('checked', false); }\r\n                    if(obj_v['rotationx_reverse'] !== undefined && (obj_v['rotationx_reverse'] == 'true' || obj_v['rotationx_reverse'] == true)) { jQuery('input[name=\"layer_anim_xrotate_start_reverse\"]').attr('checked', true); }else{ jQuery('input[name=\"layer_anim_xrotate_start_reverse\"]').attr('checked', false); }\r\n                    if(obj_v['rotationy_reverse'] !== undefined && (obj_v['rotationy_reverse'] == 'true' || obj_v['rotationy_reverse'] == true)) { jQuery('input[name=\"layer_anim_yrotate_start_reverse\"]').attr('checked', true); }else{ jQuery('input[name=\"layer_anim_yrotate_start_reverse\"]').attr('checked', false); }\r\n                    if(obj_v['rotationz_reverse'] !== undefined && (obj_v['rotationz_reverse'] == 'true' || obj_v['rotationz_reverse'] == true)) { jQuery('input[name=\"layer_anim_zrotate_start_reverse\"]').attr('checked', true); }else{ jQuery('input[name=\"layer_anim_zrotate_start_reverse\"]').attr('checked', false); }\r\n                    if(obj_v['scalex_reverse'] !== undefined && (obj_v['scalex_reverse'] == 'true' || obj_v['scalex_reverse'] == true)) { jQuery('#layer_scale_xstart_reverse').attr('checked', true); }else{ jQuery('#layer_scale_xstart_reverse').attr('checked', false); }\r\n                    if(obj_v['scaley_reverse'] !== undefined && (obj_v['scaley_reverse'] == 'true' || obj_v['scaley_reverse'] == true)) { jQuery('#layer_scale_ystart_reverse').attr('checked', true); }else{ jQuery('#layer_scale_ystart_reverse').attr('checked', false); }\r\n                    if(obj_v['skewx_reverse'] !== undefined && (obj_v['skewx_reverse'] == 'true' || obj_v['skewx_reverse'] == true)) { jQuery('#layer_skew_xstart_reverse').attr('checked', true); }else{ jQuery('#layer_skew_xstart_reverse').attr('checked', false); }\r\n                    if(obj_v['skewy_reverse'] !== undefined && (obj_v['skewy_reverse'] == 'true' || obj_v['skewy_reverse'] == true)) { jQuery('#layer_skew_ystart_reverse').attr('checked', true); }else{ jQuery('#layer_skew_ystart_reverse').attr('checked', false); }\r\n                    if(obj_v['mask_x_reverse'] !== undefined && (obj_v['mask_x_reverse'] == 'true' || obj_v['mask_x_reverse'] == true)) { jQuery('#mask_anim_xstart_reverse').attr('checked', true); }else{ jQuery('#mask_anim_xstart_reverse').attr('checked', false); }\r\n                    if(obj_v['mask_y_reverse'] !== undefined && (obj_v['mask_y_reverse'] == 'true' || obj_v['mask_y_reverse'] == true)) { jQuery('#mask_anim_ystart_reverse').attr('checked', true); }else{ jQuery('#mask_anim_ystart_reverse').attr('checked', false); }\r\n\r\n                }else{\r\n                    if(obj_v['movex'] !== undefined) { jQuery('#layer_anim_xend').val(obj_v['movex']); }else{ jQuery('#layer_anim_xend').val(0); }\r\n                    if(obj_v['movey'] !== undefined) { jQuery('#layer_anim_yend').val(obj_v['movey']); }else{ jQuery('#layer_anim_yend').val(0); }\r\n                    if(obj_v['movez'] !== undefined) { jQuery('#layer_anim_zend').val(obj_v['movez']); }else{ jQuery('#layer_anim_zend').val(0); }\r\n                    if(obj_v['rotationx'] !== undefined) { jQuery('#layer_anim_xrotate_end').val(obj_v['rotationx']); }else{ jQuery('#layer_anim_xrotate_end').val(0); }\r\n                    if(obj_v['rotationy'] !== undefined) { jQuery('#layer_anim_yrotate_end').val(obj_v['rotationy']); }else{ jQuery('#layer_anim_yrotate_end').val(0); }\r\n                    if(obj_v['rotationz'] !== undefined) { jQuery('#layer_anim_zrotate_end').val(obj_v['rotationz']); }else{ jQuery('#layer_anim_zrotate_end').val(0); }\r\n                    if(obj_v['scalex'] !== undefined) { jQuery('#layer_scale_xend').val(obj_v['scalex']); }else{ jQuery('#layer_scale_xend').val(0); }\r\n                    if(obj_v['scaley'] !== undefined) { jQuery('#layer_scale_yend').val(obj_v['scaley']); }else{ jQuery('#layer_scale_yend').val(0); }\r\n                    if(obj_v['skewx'] !== undefined) { jQuery('#layer_skew_xend').val(obj_v['skewx']); }else{ jQuery('#layer_skew_xend').val(0); }\r\n                    if(obj_v['skewy'] !== undefined) { jQuery('#layer_skew_yend').val(obj_v['skewy']); }else{ jQuery('#layer_skew_yend').val(0); }\r\n                    if(obj_v['captionopacity'] !== undefined) { jQuery('#layer_opacity_end').val(obj_v['captionopacity']); }else{ jQuery('#layer_opacity_end').val(0); }\r\n                    if(obj_v['mask'] !== undefined && (obj_v['mask'] == 'true' || obj_v['mask'] == true)) { jQuery('#masking-end').attr('checked', true); }else{ jQuery('#masking-end').attr('checked', false); }\r\n                    if(obj_v['mask_x'] !== undefined) { jQuery('#mask_anim_xend').val(obj_v['mask_x']); }else{ jQuery('#mask_anim_xend').val(0); }\r\n                    if(obj_v['mask_y'] !== undefined) { jQuery('#mask_anim_yend').val(obj_v['mask_y']); }else{ jQuery('#mask_anim_yend').val(0); }\r\n                    //if(obj_v['mask_ease'] !== undefined) { jQuery('input[name=\"mask_easing_end\"]').val(obj_v['mask_ease']); }else{ jQuery('input[name=\"mask_easing_end\"]').val(0); }\r\n                    //if(obj_v['mask_speed'] !== undefined) { jQuery('input[name=\"mask_speed_end\"]').val(obj_v['mask_speed']); }else{ jQuery('input[name=\"mask_speed_end\"]').val(0); }\r\n\r\n                    if(obj_v['easing'] !== undefined) { jQuery('#layer_endeasing option[value=\"'+obj_v['easing']+'\"]').attr('selected', 'selected'); }\r\n                    if(obj_v['speed'] !== undefined) { jQuery('#layer_endspeed').val(obj_v['speed']); }\r\n                    if(obj_v['split'] !== undefined) { jQuery('#layer_endsplit option[value=\"'+obj_v['split']+'\"]').attr('selected', 'selected'); }\r\n                    if(obj_v['splitdelay'] !== undefined) { jQuery('#layer_endsplitdelay').val(obj_v['splitdelay']); }\r\n\r\n                    if(obj_v['movex_reverse'] !== undefined && (obj_v['movex_reverse'] == 'true' || obj_v['movex_reverse'] == true)) { jQuery('#layer_anim_xend_reverse').attr('checked', true); }else{ jQuery('#layer_anim_xend_reverse').attr('checked', false); }\r\n                    if(obj_v['movey_reverse'] !== undefined && (obj_v['movey_reverse'] == 'true' || obj_v['movey_reverse'] == true)) { jQuery('#layer_anim_yend_reverse').attr('checked', true); }else{ jQuery('#layer_anim_yend_reverse').attr('checked', false); }\r\n                    if(obj_v['rotationx_reverse'] !== undefined && (obj_v['rotationx_reverse'] == 'true' || obj_v['rotationx_reverse'] == true)) { jQuery('#layer_anim_xrotate_end_reverse').attr('checked', true); }else{ jQuery('#layer_anim_xrotate_end_reverse').attr('checked', false); }\r\n                    if(obj_v['rotationy_reverse'] !== undefined && (obj_v['rotationy_reverse'] == 'true' || obj_v['rotationy_reverse'] == true)) { jQuery('#layer_anim_yrotate_end_reverse').attr('checked', true); }else{ jQuery('#layer_anim_yrotate_end_reverse').attr('checked', false); }\r\n                    if(obj_v['rotationz_reverse'] !== undefined && (obj_v['rotationz_reverse'] == 'true' || obj_v['rotationz_reverse'] == true)) { jQuery('#layer_anim_zrotate_end_reverse').attr('checked', true); }else{ jQuery('#layer_anim_zrotate_end_reverse').attr('checked', false); }\r\n                    if(obj_v['scalex_reverse'] !== undefined && (obj_v['scalex_reverse'] == 'true' || obj_v['scalex_reverse'] == true)) { jQuery('#layer_scale_xend_reverse').attr('checked', true); }else{ jQuery('#layer_scale_xend_reverse').attr('checked', false); }\r\n                    if(obj_v['scaley_reverse'] !== undefined && (obj_v['scaley_reverse'] == 'true' || obj_v['scaley_reverse'] == true)) { jQuery('#layer_scale_yend_reverse').attr('checked', true); }else{ jQuery('#layer_scale_yend_reverse').attr('checked', false); }\r\n                    if(obj_v['skewx_reverse'] !== undefined && (obj_v['skewx_reverse'] == 'true' || obj_v['skewx_reverse'] == true)) { jQuery('#layer_skew_xend_reverse').attr('checked', true); }else{ jQuery('#layer_skew_xend_reverse').attr('checked', false); }\r\n                    if(obj_v['skewy_reverse'] !== undefined && (obj_v['skewy_reverse'] == 'true' || obj_v['skewy_reverse'] == true)) { jQuery('#layer_skew_yend_reverse').attr('checked', true); }else{ jQuery('#layer_skew_yend_reverse').attr('checked', false); }\r\n                    if(obj_v['mask_x_reverse'] !== undefined && (obj_v['mask_x_reverse'] == 'true' || obj_v['mask_x_reverse'] == true)) { jQuery('#mask_anim_xend_reverse').attr('checked', true); }else{ jQuery('#mask_anim_xend_reverse').attr('checked', false); }\r\n                    if(obj_v['mask_y_reverse'] !== undefined && (obj_v['mask_y_reverse'] == 'true' || obj_v['mask_y_reverse'] == true)) { jQuery('#mask_anim_yend_reverse').attr('checked', true); }else{ jQuery('#mask_anim_yend_reverse').attr('checked', false); }\r\n\r\n                }\r\n\r\n                if(typeof(obj_v['mask']) !== 'undefined' && (obj_v['mask'] == 'true' || obj_v['mask'] == true)){\r\n                    jQuery('.mask-start-settings').show();\r\n                }else{\r\n                    jQuery('.mask-start-settings').hide();\r\n                }\r\n\r\n                RevSliderSettings.onoffStatus(jQuery('#masking-start'));\r\n                RevSliderSettings.onoffStatus(jQuery('#masking-end'));\r\n\r\n                t.updateReverseList();\r\n\r\n            }\r\n\r\n\r\n            var checkMaskingAvailabity = function() {\r\n\r\n                if (jQuery('#layer__scalex').val()!=1 || jQuery('#layer__scaley').val()!=1 ||\r\n                    parseInt(jQuery('#layer__skewx').val(),0)!=0 || parseInt(jQuery('#layer__skewy').val(),0)!=0 ||\r\n                    parseInt(jQuery('#layer__xrotate').val(),0)!=0 || parseInt(jQuery('#layer__yrotate').val(),0)!=0 || parseInt(jQuery('#layer_2d_rotation').val(),0)!=0) {\r\n                    jQuery('.mask-not-available').show();\r\n                    jQuery('.mask-is-available').hide();\r\n                    jQuery('#masking-start').prop(\"checked\",false);\r\n                    jQuery('#masking-end').prop(\"checked\",false);\r\n                    jQuery('.mask-start-settings').hide();\r\n                    jQuery('.mask-end-settings').hide();\r\n                    jQuery('.tp-showmask').removeClass('tp-showmask');\r\n                    RevSliderSettings.onoffStatus(jQuery('#masking-start'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#masking-end'));\r\n                    u.rebuildLayerIdle(getjQueryLayer());\r\n\r\n                    t.updateLayerFromFields();\r\n\r\n                } else {\r\n\r\n                    jQuery('.mask-not-available').hide();\r\n                    jQuery('.mask-is-available').show();\r\n                }\r\n\r\n\r\n            }\r\n\r\n            /**\r\n             * check if anim handle already exists\r\n             */\r\n            var checkIfAnimExists = function(handle){\r\n\r\n                if(typeof initLayerAnims === 'object' && !jQuery.isEmptyObject(initLayerAnims)){\r\n                    for(var key in initLayerAnims) if (initLayerAnims.hasOwnProperty(key)) {\r\n                        if(initLayerAnims[key]['handle'] == handle) return initLayerAnims[key]['id'];\r\n                    }\r\n                }\r\n\r\n                return false;\r\n\r\n            }\r\n\r\n\r\n            var checkIfAnimIsEditable = function(handle){\r\n\r\n                if(typeof initLayerAnims === 'object' && !jQuery.isEmptyObject(initLayerAnims)){\r\n                    for(var key in initLayerAnims) if (initLayerAnims.hasOwnProperty(key)) {\r\n                        if(initLayerAnims[key]['handle'] == handle) return initLayerAnims[key]['id'];\r\n                    }\r\n                }\r\n\r\n                return false;\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * update animation in database\r\n             */\r\n            var deleteAnimInDb = function(handle){\r\n\r\n                UniteAdminRev.setErrorMessageID(\"dialog_error_message\");\r\n                handle = jQuery.trim(handle);\r\n                if(handle != ''){\r\n                    var animSelect = (currentAnimationType == 'customin') ? jQuery('#layer_animation option') : jQuery('#layer_endanimation option');\r\n\r\n                    UniteAdminRev.ajaxRequest(\"delete_custom_anim\",handle,function(response){\r\n\r\n                        if(jQuery('#layer_animation option:selected') == handle || jQuery('#layer_animation option:selected') == handle.replace('customout', 'customin')){\r\n                            jQuery('#layer_animation option[value=\"tp-fade\"]').attr('selected', true);\r\n                        }\r\n                        if(jQuery('#layer_endanimation option:selected') == handle || jQuery('#layer_endanimation option:selected') == handle.replace('customin', 'customout')){\r\n                            jQuery('#layer_endanimation option[value=\"tp-fade\"]').attr('selected', true);\r\n                        }\r\n\r\n                        //update html select (got from response)\r\n                        t.updateInitLayerAnim(response.customfull);\r\n                        updateLayerAnimsInput(response.customin, 'customin');\r\n                        updateLayerAnimsInput(response.customout, 'customout');\r\n\r\n                    });\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * rename animation in database\r\n             */\r\n            var renameAnimInDb = function(id, new_name){\r\n\r\n                var data = {};\r\n                data['id'] = id;\r\n                data['handle'] = new_name;\r\n\r\n                UniteAdminRev.ajaxRequest(\"update_custom_anim_name\",data,function(response){\r\n                    //update html select (got from response)\r\n                    t.updateInitLayerAnim(response.customfull);\r\n                    updateLayerAnimsInput(response.customin, 'customin');\r\n                    updateLayerAnimsInput(response.customout, 'customout');\r\n\r\n                    selectLayerAnim(new_name);\r\n                });\r\n            }\r\n\r\n\r\n            /**\r\n             * update animation in database\r\n             */\r\n            var updateAnimInDb = function(handle, animObj, id){\r\n\r\n                UniteAdminRev.setErrorMessageID(\"dialog_error_message\");\r\n                animObj['handle'] = handle;\r\n\r\n                if(id === false){ //create new\r\n                    //insert in database\r\n                    UniteAdminRev.ajaxRequest(\"insert_custom_anim\",animObj,function(response){\r\n                        //update html select (got from response)\r\n                        t.updateInitLayerAnim(response.customfull);\r\n                        updateLayerAnimsInput(response.customin, 'customin');\r\n                        updateLayerAnimsInput(response.customout, 'customout');\r\n\r\n                        selectLayerAnim(handle);\r\n                    });\r\n\r\n                }else{ //update existing\r\n\r\n                    //update to database\r\n                    UniteAdminRev.ajaxRequest(\"update_custom_anim\",animObj,function(response){\r\n\r\n                        //update html select (got from response)\r\n                        t.updateInitLayerAnim(response.customfull);\r\n                        updateLayerAnimsInput(response.customin, 'customin');\r\n                        updateLayerAnimsInput(response.customout, 'customout');\r\n\r\n                        selectLayerAnim(handle);\r\n\r\n                        var raw_handle = handle.replace('customin-', '').replace('customout-', '');\r\n\r\n                        for(var key in t.arrLayers) if (t.arrLayers.hasOwnProperty(key)) {\r\n\r\n                            if(t.arrLayers[key].frames.frame_999.animation == 'customout-'+raw_handle){\r\n                                t.arrLayers[key].x_end = animObj['params']['movex'];\r\n                                t.arrLayers[key].y_end = animObj['params']['movey'];\r\n                                t.arrLayers[key].z_end = animObj['params']['movez'];\r\n                                t.arrLayers[key].x_rotate_end = animObj['params']['rotationx'];\r\n                                t.arrLayers[key].y_rotate_end = animObj['params']['rotationy'];\r\n                                t.arrLayers[key].z_rotate_end = animObj['params']['rotationz'];\r\n                                t.arrLayers[key].scale_x_end = animObj['params']['scalex'];\r\n                                t.arrLayers[key].scale_y_end = animObj['params']['scaley'];\r\n                                t.arrLayers[key].opacity_end = animObj['params']['captionopacity'];\r\n                                t.arrLayers[key].skew_x_end = animObj['params']['skewx'];\r\n                                t.arrLayers[key].skew_y_end = animObj['params']['skewy'];\r\n                                t.arrLayers[key].mask_end = animObj['params']['mask'];\r\n                                t.arrLayers[key].mask_x_end = animObj['params']['mask_x'];\r\n                                t.arrLayers[key].mask_y_end = animObj['params']['mask_y'];\r\n                                t.arrLayers[key].mask_ease_end = animObj['params']['mask_ease'];\r\n                                t.arrLayers[key].mask_speed_end = animObj['params']['mask_speed'];\r\n\r\n                                t.arrLayers[key].x_end_reverse = animObj['params']['movex_reverse'];\r\n                                t.arrLayers[key].y_end_reverse = animObj['params']['movey_reverse'];\r\n\r\n                                t.arrLayers[key].x_rotate_end_reverse = animObj['params']['rotationx_reverse'];\r\n                                t.arrLayers[key].y_rotate_end_reverse = animObj['params']['rotationy_reverse'];\r\n                                t.arrLayers[key].z_rotate_end_reverse = animObj['params']['rotationz_reverse'];\r\n                                t.arrLayers[key].scale_x_end_reverse = animObj['params']['scalex_reverse'];\r\n                                t.arrLayers[key].scale_y_end_reverse = animObj['params']['scaley_reverse'];\r\n                                t.arrLayers[key].skew_x_end_reverse = animObj['params']['skewx_reverse'];\r\n                                t.arrLayers[key].skew_y_end_reverse = animObj['params']['skewy_reverse'];\r\n                                t.arrLayers[key].mask_x_end_reverse = animObj['params']['mask_x_reverse'];\r\n                                t.arrLayers[key].mask_y_end_reverse = animObj['params']['mask_y_reverse'];\r\n\r\n                                t.arrLayers[key].frames.frame_999.easing = animObj['params']['easing'];\r\n                                t.arrLayers[key].frames.frame_999.split = animObj['params']['split'];\r\n                                t.arrLayers[key].frames.frame_999.splitdelay = animObj['params']['splitdelay'];\r\n                                t.arrLayers[key].frames.frame_999.speed = animObj['params']['speed'];\r\n                            }else if(t.arrLayers[key].frames.frame_0.animation == 'customin-'+raw_handle){\r\n                                t.arrLayers[key].x_start = animObj['params']['movex'];\r\n                                t.arrLayers[key].y_start = animObj['params']['movey'];\r\n                                t.arrLayers[key].z_start = animObj['params']['movez'];\r\n                                t.arrLayers[key].x_rotate_start = animObj['params']['rotationx'];\r\n                                t.arrLayers[key].y_rotate_start = animObj['params']['rotationy'];\r\n                                t.arrLayers[key].z_rotate_start = animObj['params']['rotationz'];\r\n                                t.arrLayers[key].scale_x_start = animObj['params']['scalex'];\r\n                                t.arrLayers[key].scale_y_start = animObj['params']['scaley'];\r\n                                t.arrLayers[key].opacity_start = animObj['params']['captionopacity'];\r\n                                t.arrLayers[key].blurfilter_start = animObj['params']['blurfilter'];\r\n                                t.arrLayers[key].grayscalefilter_start = animObj['params']['grayscalefilter'];\r\n                                t.arrLayers[key].skew_x_start = animObj['params']['skewx'];\r\n                                t.arrLayers[key].skew_y_start = animObj['params']['skewy'];\r\n                                t.arrLayers[key].mask_start = animObj['params']['mask'];\r\n                                t.arrLayers[key].mask_x_start = animObj['params']['mask_x'];\r\n                                t.arrLayers[key].mask_y_start = animObj['params']['mask_y'];\r\n                                t.arrLayers[key].mask_ease_start = animObj['params']['mask_ease'];\r\n                                t.arrLayers[key].mask_speed_start = animObj['params']['mask_speed'];\r\n\r\n                                t.arrLayers[key].x_start_reverse = animObj['params']['movex_reverse'];\r\n                                t.arrLayers[key].y_start_reverse = animObj['params']['movey_reverse'];\r\n\r\n                                t.arrLayers[key].x_rotate_start_reverse = animObj['params']['rotationx_reverse'];\r\n                                t.arrLayers[key].y_rotate_start_reverse =  animObj['params']['rotationy_reverse'];\r\n                                t.arrLayers[key].z_rotate_start_reverse = animObj['params']['rotationz_reverse'];\r\n                                t.arrLayers[key].scale_x_start_reverse = animObj['params']['scalex_reverse'];\r\n                                t.arrLayers[key].scale_y_start_reverse = animObj['params']['scaley_reverse'];\r\n                                t.arrLayers[key].skew_x_start_reverse = animObj['params']['skewx_reverse'];\r\n                                t.arrLayers[key].skew_y_start_reverse = animObj['params']['skewy_reverse'];\r\n                                t.arrLayers[key].mask_x_start_reverse = animObj['params']['mask_x_reverse'];\r\n                                t.arrLayers[key].mask_y_start_reverse = animObj['params']['mask_y_reverse'];\r\n\r\n                                t.arrLayers[key].frames.frame_0.easing = animObj['params']['easing'];\r\n                                t.arrLayers[key].frames.frame_0.split = animObj['params']['split'];\r\n                                t.arrLayers[key].frames.frame_0.splitdelay = animObj['params']['splitdelay'];\r\n                                t.arrLayers[key].frames.frame_0.speed = animObj['params']['speed'];\r\n                            }\r\n\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            /**\r\n             * update the layer animation inputs\r\n             */\r\n            var selectLayerAnim = function(handle){\r\n\r\n                var animSelectOption = (currentAnimationType == 'customin') ? jQuery('#layer_animation option') : jQuery('#layer_endanimation option');\r\n                animSelectOption.each(function(){\r\n                    if(jQuery(this).text() == handle || jQuery(this).val() == handle)\r\n                        jQuery(this).prop('selected', true);\r\n                    else\r\n                        jQuery(this).prop('selected', false);\r\n                });\r\n                var animSelect = (currentAnimationType == 'customin') ? jQuery('#layer_animation option:selected') : jQuery('#layer_endanimation option:selected');\r\n                animSelect.change();\r\n            }\r\n\r\n            /**\r\n             * update the layer animation inputs\r\n             */\r\n            var updateLayerAnimsInput = function(customAnim, type){\r\n\r\n                if(type == 'customin'){\r\n                    var animSelect = jQuery('#layer_animation');\r\n                    var animOption = jQuery('#layer_animation option');\r\n                    var current = jQuery('#layer_animation option:selected').val();\r\n                }else{\r\n                    var animSelect = jQuery('#layer_endanimation');\r\n                    var animOption = jQuery('#layer_endanimation option');\r\n                    var current = jQuery('#layer_endanimation option:selected').val();\r\n                }\r\n\r\n                animOption.each(function(){\r\n                    if(jQuery(this).val().indexOf(type) > -1){\r\n                        jQuery(this).remove();\r\n                    }\r\n                });\r\n\r\n                if(typeof customAnim === 'object' && !jQuery.isEmptyObject(customAnim)){\r\n                    for(key in customAnim) if (customAnim.hasOwnProperty(key)) {\r\n                        animSelect.append(new Option(customAnim[key], key));\r\n                    }\r\n                }\r\n                animSelect.val(current);\r\n                animSelect.change();\r\n            }\r\n\r\n\r\n\r\n\r\n\r\n            /**\r\n             * get the first style from the styles list (from autocomplete)\r\n             */\r\n            var getFirstStyle = function(){\r\n\r\n                var arrClasses = jQuery( \"#layer_caption\" ).catcomplete(\"option\",\"source\");\r\n                var firstStyle = \"\";\r\n\r\n                if(arrClasses == null || arrClasses.length == 0)\r\n                    return(\"\");\r\n\r\n                var firstStyle = arrClasses[0]['label'];\r\n                return(firstStyle);\r\n            }\r\n\r\n\r\n            /**\r\n             * clear layer html fields, and disable buttons\r\n             */\r\n            var disableFormFields = function(){\r\n\r\n\r\n                //clear html form\r\n                jQuery(\".form_layers\")[0].reset();\r\n                jQuery(\".form_layers input, .form_layers select, .form_layers textarea\").attr(\"disabled\", \"disabled\").addClass(\"setting-disabled\");\r\n\r\n                jQuery(\"#button_delete_layer\").addClass(\"button-now-disabled\");\r\n                jQuery(\"#button_duplicate_layer\").addClass(\"button-now-disabled\");\r\n\r\n                jQuery(\".form_layers label, .form_layers .setting_text, .form_layers .setting_unit\").addClass(\"text-disabled\");\r\n\r\n                jQuery(\"#layer_captions_down\").removeClass(\"ui-state-active\").addClass(\"ui-state-default\");\r\n                jQuery(\"#css_fonts_down\").removeClass(\"ui-state-active\").addClass(\"ui-state-default\");\r\n\r\n\r\n                jQuery(\"#linkInsertTemplate\").addClass(\"disabled\");\r\n\r\n\r\n                jQuery(\"#rs-align-wrapper\").addClass(\"table_disabled\");\r\n                jQuery(\"#rs-align-wrapper-ver\").addClass(\"table_disabled\");\r\n\r\n                if(!jQuery('#preview_looper').hasClass(\"deactivated\")) jQuery('#preview_looper').click();\r\n\r\n                layerGeneralParamsStatus = false;\r\n            }\r\n\r\n            /**\r\n             * enable buttons and form fields.\r\n             */\r\n            var enableFormFields = function(){\r\n\r\n                jQuery(\".form_layers input, .form_layers select, .form_layers textarea\").not(\".rs_disabled_field\").prop(\"disabled\",false).removeClass(\"setting-disabled\");\r\n\r\n                jQuery(\"#button_delete_layer\").removeClass(\"button-now-disabled\");\r\n                jQuery(\"#button_duplicate_layer\").removeClass(\"button-now-disabled\");\r\n\r\n                jQuery(\".form_layers label, .form_layers .setting_text, .form_layers .setting_unit\").removeClass(\"text-disabled\");\r\n\r\n                jQuery(\"#layer_captions_down\").removeClass(\"ui-state-default\").addClass(\"ui-state-active\");\r\n                jQuery(\"#css_fonts_down\").removeClass(\"ui-state-default\").addClass(\"ui-state-active\");\r\n\r\n\r\n                jQuery(\"#linkInsertTemplate\").removeClass(\"disabled\");\r\n\r\n                jQuery(\"#rs-align-wrapper\").removeClass(\"table_disabled\");\r\n                jQuery(\"#rs-align-wrapper-ver\").removeClass(\"table_disabled\");\r\n\r\n                if(jQuery('#preview_looper').hasClass(\"deactivated\")) jQuery('#preview_looper').click();\r\n\r\n                layerGeneralParamsStatus = true;\r\n            }\r\n\r\n\r\n\r\n\r\n            /**\r\n             * get layers array\r\n             */\r\n            t.getLayers = function(){\r\n\r\n                if(t.selectedLayerSerial != -1){\r\n                    t.updateLayerFromFields();\r\n                }\r\n                //update sizes in images\r\n                updateLayersImageSizes();\r\n                return(t.arrLayers);\r\n            }\r\n\r\n\r\n            /**\r\n             * get only layers array\r\n             */\r\n            t.getSimpleLayers = function(){\r\n                return(t.arrLayers);\r\n            }\r\n\r\n\r\n            /**\r\n             * update image sizes\r\n             */\r\n            var updateLayersImageSizes = function(){\r\n\r\n                for (serial in t.arrLayers) if (t.arrLayers.hasOwnProperty(serial)) {\r\n                    var layer = t.arrLayers[serial];\r\n                    if(layer.type == \"image\"){\r\n                        var htmlLayer = layer.references.htmlLayer;\r\n                        var objUpdate = {};\r\n                        objUpdate = t.setVal(objUpdate, 'width', htmlLayer.width());\r\n                        objUpdate = t.setVal(objUpdate, 'height', htmlLayer.height());\r\n                        t.updateLayer(serial,objUpdate);\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n            t.clickInsideElement = function( e, className ) {\r\n                var el = e.srcElement || e.target;\r\n                if ( el.classList.contains(className) ) {\r\n                    return el;\r\n                } else {\r\n                    while ( el = el.parentNode ) {\r\n                        if ( el.classList && el.classList.contains(className) ) {\r\n                            return el;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return false;\r\n            }\r\n\r\n\r\n            var unselectAllFocusedGroup = function() {\r\n                jQuery('.slide_layer_type_group.inwork').removeClass(\"inwork\");\r\n                jQuery('#focusongroup').removeClass(\"inwork\");\r\n            }\r\n\r\n            /*! LAYER EVENTS */\r\n\r\n            /**\r\n             * refresh layer events\r\n             */\r\n            var refreshEvents = function(serial){\r\n                var layer = t.getHtmlLayerFromSerial(serial),\r\n                    grid_size = jQuery('#rs-grid-sizes option:selected').val();\r\n\r\n                //update layer events.\r\n                var connect_to_sortable = layer[0].classList.contains(\"slide_layer_type_row\") ? \"#row-zone-top, #row-zone-middle, #row-zone-bottom\" :  layer[0].classList.contains(\"slide_layer_type_column\") || layer[0].classList.contains(\"slide_layer_type_group\") ? \"\" : \".slide_layer_type_column .tp_layer_group_inner_wrapper\",\r\n                    handle_item = layer[0].classList.contains(\"slide_layer_type_row\") ? \".row_moveme\" : false;\r\n\r\n                layer.draggable({\r\n                    handle:handle_item,\r\n                    start:onLayerDragStart,\r\n                    refreshPositions:true,\r\n                    drag: t.onLayerDrag,                //set ondrag event\r\n                    connectToSortable: connect_to_sortable,\r\n                    cancel:\" textbox, #layer_text, .layer_on_lock\",\r\n                    grid: [grid_size,grid_size],\r\n                    stop: onLayerDragEnd\r\n                });\r\n\r\n                jQuery('#focusongroup').click(unselectAllFocusedGroup);\r\n\r\n                jQuery('body').on('dblclick','.inlaydecor',function(event) {\r\n                    jQuery(this).closest('.slide_layer_type_group').addClass(\"inwork\");\r\n                    jQuery('#focusongroup').addClass(\"inwork\");\r\n                });\r\n\r\n                layer.click(function(event){\r\n\r\n                    var context = t.clickInsideElement( event, 'groupinfo');\r\n                    if (context!==false) {\r\n                        jQuery(context).closest('.slide_layer_type_group').addClass(\"inwork\");\r\n                        jQuery('#focusongroup').addClass(\"inwork\");\r\n                        return false;\r\n                    }\r\n\r\n                    if(event.metaKey || (navigator.platform.toUpperCase().indexOf('WIN')!==-1 && event.ctrlKey)) {\r\n                        var objLayer = t.getLayer(serial),\r\n                            inp = jQuery('input#lots_id_'+objLayer.unique_id);\r\n\r\n                        if (inp.attr('checked')==\"checked\")\r\n                            inp.prop(\"checked\",false);\r\n                        else\r\n                            inp.attr('checked','checked');\r\n                        u.checkMultipleSelectedItems();\r\n                    } else {\r\n                        cm.toggleMenuOff();\r\n                        if (jQuery(':focus').attr('id')===\"rs-row-layout\") return false;\r\n                        jQuery(':focus').blur();\r\n                        t.setLayerSelected(serial);\r\n                        var objLayer = t.getLayer(serial),\r\n                            inp = jQuery('input#lots_id_'+objLayer.unique_id);\r\n\r\n                        if (jQuery.inArray(objLayer.unique_id,t.selectedLayers)==-1) u.checkMultipleSelectedItems(true);\r\n                        inp.attr('checked','checked');\r\n                        t.setLayerSelected(serial);\r\n\r\n                        if (layer.hasClass(\"slide_layer_type_row\")) {\r\n                            var objLayer = t.getCurrentLayer();\r\n\r\n\r\n                            if ((event.srcElement!==undefined && (event.srcElement.className==='eg-icon-menu' || event.srcElement.className==='row_editor')) || (event.target!=undefined && (event.target.className==='eg-icon-menu' || event.target.className==='row_editor'))) {\r\n                                var btn = layer.find('.row_editor'),\r\n                                    row_composer = jQuery('#rs-layout-row-composer');\r\n                                jQuery('.row_editor.open_re').removeClass(\"open_re\");\r\n                                btn.addClass(\"open_re\");\r\n                                row_composer.show();\r\n                                jQuery('.rs-row-break-selector').removeClass(\"selected\");\r\n                                jQuery('.rs-row-break-selector.rs-slide-ds-'+jQuery('#column_break_at option:selected').val()).addClass(\"selected\")\r\n                                //row_composer.appendTo(btn.closest('.row_toolbar'));\r\n                            } else\r\n                            if ((event.srcElement!=undefined && (event.srcElement.className==='eg-icon-cancel' || event.srcElement.className==='row_editor')) || (event.target!=undefined && (event.target.className==='eg-icon-cancel' || event.target.className==='row_editor'))) {\r\n                                var btn = layer.find('.row_editor'),\r\n                                    row_composer = jQuery('#rs-layout-row-composer');\r\n                                jQuery('.row_editor.open_re').removeClass(\"open_re\");\r\n                                row_composer.hide();\r\n                                //row_composer.appendTo(jQuery('#divLayers'));\r\n                            } else\r\n                            if ((event.srcElement!=undefined && (event.srcElement.className==='eg-icon-droplet' || event.srcElement.className==='row_config')) || (event.target!=undefined && (event.target.className==='eg-icon-droplet' || event.target.className==='row_config'))) {\r\n                                var morestyle = jQuery('#style-morestyle');\r\n                                if (!morestyle.hasClass(\"showmore\")) morestyle.click();\r\n                            }\r\n                        }\r\n\r\n                        event.stopPropagation();\r\n                        // IF ANIMATION TAB IS VISIBLE, AND PLAY IS SELECTED, WE CAN ALLOW TO ANIMATE THE SINGLE LAYER\r\n                        if (u.checkAnimationTab()) {\r\n                            u.stopAllLayerAnimation();\r\n                            u.animateCurrentSelectedLayer(0);\r\n                        }\r\n                        else\r\n                        if (u.checkLoopTab()) {\r\n                            u.stopAllLayerAnimation();\r\n                            u.callCaptionLoops();\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n\r\n            /**\r\n             * get layer serial from id\r\n             */\r\n            t.getSerialFromID = function(layerID){\r\n\r\n                if (layerID == undefined) return false;\r\n                var layerSerial = layerID.replace(\"slide_layer_\",\"\").replace(\"demo_layer_\",\"\");\r\n                return(layerSerial);\r\n            }\r\n\r\n            /**\r\n             * get serial from sortID\r\n             */\r\n            t.getSerialFromSortID = function(sortID){\r\n\r\n\r\n                var layerSerial = sortID.replace(\"layer_sort_time_\",\"\");\r\n\r\n                layerSerial = layerSerial.replace(\"layer_sort_\",\"\");\r\n                layerSerial = layerSerial.replace(\"layer_quicksort_\",\"\");\r\n                return(layerSerial);\r\n            }\r\n\r\n\r\n            /**\r\n             * hide in html and sortbox\r\n             */\r\n            t.lockAllLayers = function(serial){\r\n\r\n                for (serial in t.arrLayers) if (t.arrLayers.hasOwnProperty(serial))\r\n                    u.lockLayer(serial);\r\n            }\r\n\r\n\r\n            /**\r\n             * show layer in html and sortbox\r\n             */\r\n            t.unlockAllLayers = function(serial){\r\n\r\n                for (serial in t.arrLayers) if (t.arrLayers.hasOwnProperty(serial))\r\n                    u.unlockLayer(serial);\r\n            }\r\n\r\n            /**\r\n             * show all layers\r\n             */\r\n            t.showAllLayers = function(except_serial){\r\n                for (var i in t.arrLayers) if (t.arrLayers.hasOwnProperty(i)) {\r\n                    if (except_serial!==t.arrLayers[i].serial)\r\n                        u.showLayer(t.arrLayers[i],true);\r\n                }\r\n            }\r\n\r\n            /**\r\n             * hide all layers\r\n             */\r\n            t.hideAllLayers = function(except_serial){\r\n                for (var i in t.arrLayers) if (t.arrLayers.hasOwnProperty(i)) {\r\n                    if (except_serial!==t.arrLayers[i].serial)\r\n                        u.hideLayer(t.arrLayers[i],true);\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * get html layer from serial\r\n             */\r\n            t.getHtmlLayerFromSerial = function(serial, isDemo){\r\n\r\n                if(!isDemo)\r\n                    isDemo = false;\r\n\r\n                if(!isDemo)\r\n                    var htmlLayer = jQuery(\"#slide_layer_\"+serial);\r\n                else\r\n                    var htmlLayer = jQuery(\"#demo_layer_\"+serial);\r\n\r\n                if(htmlLayer!==null && htmlLayer.length == 0)\r\n                    UniteAdminRev.showErrorMessage(\"Html Layer with serial: \"+serial+\" not found!\");\r\n\r\n                return(htmlLayer);\r\n            }\r\n\r\n\r\n            /**\r\n             * get layer object by the new Unique Id\r\n             */\r\n            t.getLayerByUniqueId = function(uid){\r\n                for(var key in t.arrLayers) if (t.arrLayers.hasOwnProperty(key)) {\r\n                    if(t.arrLayers[key]['unique_id'] == uid) return t.getLayer(key);\r\n                }\r\n\r\n                for(var key in t.arrLayersDemo) if (t.arrLayersDemo.hasOwnProperty(key)) {\r\n                    if(t.arrLayersDemo[key]['unique_id'] == uid) return t.getLayer(key);\r\n                }\r\n\r\n                return false;\r\n            }\r\n\r\n            /**\r\n             * get layer object by the new Unique Id\r\n             */\r\n            t.getLayerIdByUniqueId = function(uid){\r\n                for(var key in t.arrLayers) if (t.arrLayers.hasOwnProperty(key)) {\r\n                    if(t.arrLayers[key]['unique_id'] == uid) return key;\r\n                }\r\n\r\n                for(var key in t.arrLayersDemo) if (t.arrLayersDemo.hasOwnProperty(key)) {\r\n                    if(t.arrLayersDemo[key]['unique_id'] == uid) return key;\r\n                }\r\n\r\n                return false;\r\n            }\r\n\r\n\r\n            /**\r\n             * get unique ID by layer\r\n             */\r\n            t.getUniqueIdByLayer = function(serial){\r\n                for(var key in t.arrLayers) if (t.arrLayers.hasOwnProperty(key)) {\r\n                    if(key == serial) return t.arrLayers[key]['unique_id'];\r\n                }\r\n\r\n                return false;\r\n            }\r\n\r\n\r\n\r\n            /**\r\n             * get layer object by id\r\n             */\r\n            t.getLayer = function(serial, isDemo){\r\n\r\n                if(isDemo){\r\n                    var layer = t.arrLayersDemo[serial];\r\n                }else{\r\n                    var layer = t.arrLayers[serial];\r\n                }\r\n                if(!layer){ //check if still maybe demo layer\r\n                    var layer = t.arrLayersDemo[serial];\r\n                }\r\n\r\n                if(!layer){\r\n                    return false;\r\n                    //UniteAdminRev.showErrorMessage(\"getLayer error, Layer with serial: \"+serial+\" not found\");\r\n                }else{\r\n                    //modify some data\r\n                    layer.frames.frame_0.speed = Number(layer.frames.frame_0.speed);\r\n                    layer.frames.frame_999.speed = Number(layer.frames.frame_999.speed);\r\n                    return layer;\r\n                }\r\n                return false;\r\n            }\r\n\r\n            /**\r\n             * get current layer object\r\n             */\r\n            t.getCurrentLayer = function(){\r\n                if(t.selectedLayerSerial == -1){\r\n                    return false;\r\n                }\r\n                return t.getLayer(t.selectedLayerSerial);\r\n            }\r\n\r\n\r\n\r\n            /*! MAKE HTML LAYER */\r\n\r\n            /**\r\n             * make layer html, with params from the object\r\n             */\r\n            t.makeLayerHtml = function(serial,objLayer,isDemo){\r\n\r\n                if(!isDemo)\r\n                    isDemo = false;\r\n\r\n                var type = \"text\";\r\n                if(objLayer.type)\r\n                    type = objLayer.type;\r\n\r\n\r\n                var zIndex = Number(objLayer.order)+100,\r\n                    style = \"z-index:\"+zIndex+\";position:absolute;\",\r\n                    stylerot =\"\",\r\n                    contaddon = \"\",\r\n                    precont = \"\",\r\n                    subcont = \"\";\r\n\r\n\r\n                if(t.getVal(objLayer, 'max_width') !== 'auto')\r\n                    style += ' width: '+t.getVal(objLayer, 'max_width')+';';\r\n\r\n\r\n                if(t.getVal(objLayer, 'max_height') !== 'auto')\r\n                    style += ' height: '+t.getVal(objLayer, 'max_height')+';';\r\n\r\n                //if(objLayer.whitespace !== 'normal')\r\n                style += ' white-space: '+t.getVal(objLayer, 'whitespace')+';';\r\n\r\n                var static_class = '';\r\n\r\n                if(typeof objLayer.special_type !== 'undefined' && objLayer.special_type == 'static') static_class = ' static_layer';\r\n\r\n                var internal_class = '';\r\n                if(typeof objLayer.type !== 'undefined' && (objLayer.type == 'button' || objLayer.type == 'shape')) internal_class = ' '+objLayer.internal_class; // || objLayer.type == 'no_edit'\r\n\r\n\r\n                var linkgroup = objLayer.groupLink;\r\n                linkgroup = linkgroup === undefined ? 0 : linkgroup;\r\n                linkgroup = 'ldles_'+linkgroup;\r\n                if(type == \"image\") style += \"line-height:0;\";\r\n                if (type==\"column\") {\r\n                    precont = '<div class=\"slide_layer_col_sizer\">';\r\n                    subcont = '</div>';\r\n\r\n                    contaddon = '<div class=\"column_background\"></div>';\r\n                }\r\n\r\n                if(!isDemo){\r\n                    var html = '<div id=\"slide_layer_' + serial + '\" data-uniqueid=\"'+objLayer.unique_id+'\" data-serial=\"'+serial+'\" data-type=\"'+type+'\" style=\"' + style + '\"               class=\"slide_layer_type_'+type+' slide_layer '+linkgroup+'\">'+contaddon+precont+'<div style=\"'+stylerot+'\" class=\"innerslide_layer tp-caption '+objLayer.style+static_class+internal_class+'\" >';\r\n                }else{\r\n                    if(rev_adv_resp_sizes === true){\r\n\r\n                    }\r\n                    if(objLayer['static_styles'] != undefined){\r\n                        style += ' font-size: '+t.getVal(objLayer['static_styles'],'font-size')+';';\r\n                        style += ' line-height: '+t.getVal(objLayer['static_styles'],'line-height')+';';\r\n                        style += ' font-weight: '+t.getVal(objLayer['static_styles'],'font-weight')+';';\r\n                        style += ' color: '+t.getVal(objLayer['static_styles'],'color')+';';\r\n                        style += ' letter-spacing: '+t.getVal(objLayer['static_styles'],'letter-spacing')+';';\r\n                    }\r\n                    var html = '<div id=\"demo_layer_' + serial + '\" data-uniqueid=\"'+objLayer.unique_id+'\" data-serial=\"'+serial+'\"  data-type=\"'+type+'\" style=\"' + style + '\" class=\"invisible_demolayer demo_layer_type_'+type+' demo_layer demo_layer_'+curDemoSlideID+' slide_layer\" >'+contaddon+precont+'<div style=\"'+stylerot+'\" class=\"innerslide_layer tp-caption '+objLayer.style+static_class+internal_class+'\" >';\r\n                }\r\n\r\n                //add layer specific html\r\n                switch(type){\r\n                    case \"image\":\r\n                        var addStyle = '';\r\n                        html += '<img src=\"'+objLayer.image_url+'\" alt=\"'+objLayer.alt+'\" style=\"'+addStyle+'\"></img>';\r\n                        break;\r\n                    default:\r\n                    case \"text\":\r\n                    case \"button\":\r\n                        //case 'no_edit':\r\n                        html += objLayer.text;\r\n\r\n                        break;\r\n                    case \"group\":\r\n                        html += '<div class=\"inlaydecor\"></div><div class=\"groupinfo\"><i class=\"fa-icon-object-group\"></i><span class=\"group_info_text\">Edit Group Layers</span></div><div class=\"tp_layer_group_inner_wrapper\"></div>';\r\n                        break;\r\n                    case \"column\":\r\n                        html += '<div class=\"tp_layer_group_inner_wrapper\"></div>';\r\n                        break;\r\n                    case \"row\":\r\n                        html += '<div class=\"tp_layer_group_inner_wrapper\"></div>';\r\n                        if (!isDemo) html +='<div class=\"row_toolbar\"><div class=\"row_editor\"><i class=\"eg-icon-menu\"></i><i class=\"eg-icon-cancel\"></i></div><div class=\"row_moveme\"><i class=\"eg-icon-arrow-combo\"></i></div><div class=\"row_config\"><i class=\"eg-icon-droplet\"></i></div></div>';\r\n                        break;\r\n                    case \"video\":\r\n                        var styleVideo = \"width:100%;height:100%\";\r\n                        if(typeof (objLayer.video_data) !== \"undefined\"){\r\n                            var useImage = (jQuery.trim(objLayer.video_data.previewimage) != '') ? objLayer.video_data.previewimage : objLayer.video_image_url;\r\n                        }else{\r\n                            var useImage = objLayer.video_image_url;\r\n                        }\r\n\r\n                        var videoIcon = objLayer.video_type;\r\n\r\n                        switch(objLayer.video_type){\r\n                            case \"youtube\":\r\n                            case \"vimeo\":\r\n                                styleVideo += \";background-image:url(\"+useImage+\");\";\r\n                                break;\r\n                            case \"html5\":\r\n                                if(useImage !== undefined && useImage != \"\")\r\n                                    styleVideo += \";background-image:url(\"+useImage+\");\";\r\n                                break;\r\n                            case 'streamyoutube':\r\n                                videoIcon = 'youtube';\r\n                                break;\r\n                            case 'streamvimeo':\r\n                                videoIcon = 'vimeo';\r\n                                break;\r\n                            case 'streaminstagram':\r\n                                videoIcon = 'html5';\r\n                                break;\r\n                        }\r\n\r\n                        html += \"<div class='slide_layer_video' style='\"+styleVideo+\"'><div class='video-layer-inner video-icon-\"+videoIcon+\"'>\";\r\n                        html += \"<div class='layer-video-title'>\" + objLayer.video_title + \"</div>\";\r\n                        html += \"</div></div>\";\r\n                        break;\r\n                    case 'audio':\r\n                        var styleAudio = '';\r\n                        var audioIcon = '';\r\n                        html += \"<div class='slide_layer_audio' style='\"+styleAudio+\"'><div class='video-layer-inner video-icon-\"+audioIcon+\"'>\";\r\n                        html += '<div class=\"slide_layer_audio_c_wrapper\">';\r\n                        html += '<audio controls src=\"'+objLayer.video_data.urlAudio+'\"></audio>';\r\n                        html += '<div class=\"tp-video-controls\">'+\r\n                            '<div class=\"tp-video-button-wrap\"><button type=\"button\" class=\"tp-video-button tp-vid-play-pause\">Play</button></div>'+\r\n                            '<div class=\"tp-video-seek-bar-wrap\"><input  type=\"range\" class=\"tp-seek-bar\" value=\"0\"></div>'+\r\n                            '<div class=\"tp-video-button-wrap\"><button  type=\"button\" class=\"tp-video-button tp-vid-mute\">Mute</button></div>'+\r\n                            '<div class=\"tp-video-vol-bar-wrap\"><input  type=\"range\" class=\"tp-volume-bar\" min=\"0\" max=\"1\" step=\"0.1\" value=\"1\"></div>'+\r\n                            '</div>';\r\n                        html += '<div class=\"slide_layer_audio_c_cover\"></div>';\r\n                        html += '</div>';\r\n                        html += \"<div class='layer-audio-title'><i class='rs-icon-layeraudio_n'></i>\" + objLayer.audio_title + \"</div>\";\r\n                        html += \"</div></div>\";\r\n                        break;\r\n                    case 'svg':\r\n                        if (objLayer.svg!=undefined && objLayer.svg.src!=undefined)\r\n                            jQuery.get(objLayer.svg.src, function(data) {\r\n                                var pref = !isDemo ? \"#slide_layer_\" : \"#demo_layer_\"\r\n                                jQuery(pref+serial+\" .innerslide_layer.tp-caption\").first().html(\"\");\r\n                                jQuery(pref+serial+\" .innerslide_layer.tp-caption\").first()[0].innerHTML = new XMLSerializer().serializeToString(data.documentElement);\r\n                                u.rebuildLayerIdle(jQuery(pref+serial));\r\n                            });\r\n\r\n                        break;\r\n                }\r\n\r\n                html +=\"</div>\"+subcont;\r\n\r\n                //add cross icon:\r\n                html += \"<div class='icon_cross'></div>\";\r\n                html += '</div>';\r\n                return(html);\r\n            }\r\n\r\n\r\n            /**\r\n             * Reset values that can be set without changing the class to default\r\n             */\r\n            t.reset_to_default_static_styles = function(layer, exclude, devices){\r\n\r\n                if(layer.style !== undefined){\r\n                    //get css styles from choosen class\r\n                    var foundstyles = UniteCssEditorRev.getStyleSettingsByHandle(layer.style);\r\n\r\n                    if(foundstyles !== false){\r\n\r\n                        if(foundstyles.params['font-size'] !== undefined){\r\n                            if(exclude !== undefined && devices !== undefined){\r\n                                if(jQuery.inArray('font-size', exclude) !== -1){\r\n                                    //set for specific devices now\r\n                                    layer['static_styles'] = t.setVal(layer['static_styles'], 'font-size', foundstyles.params['font-size'], false, devices);\r\n\r\n                                    if(jQuery.inArray(layout, devices) !== -1){\r\n                                        jQuery('#layer_font_size_s').val(foundstyles.params['font-size']);\r\n                                    }\r\n                                }\r\n                            }else{\r\n                                jQuery('#layer_font_size_s').val(foundstyles.params['font-size']);\r\n                            }\r\n                        }\r\n\r\n                        if(foundstyles.params['line-height'] !== undefined){\r\n                            if(exclude !== undefined && devices !== undefined){\r\n                                if(jQuery.inArray('line-height', exclude) !== -1){\r\n                                    //set for specific devices now\r\n                                    layer['static_styles'] = t.setVal(layer['static_styles'], 'line-height', foundstyles.params['line-height'], false, devices);\r\n\r\n                                    if(jQuery.inArray(layout, devices) !== -1){\r\n                                        jQuery('#layer_line_height_s').val(foundstyles.params['line-height']);\r\n                                    }\r\n                                }\r\n                            }else{\r\n                                jQuery('#layer_line_height_s').val(foundstyles.params['line-height']);\r\n                            }\r\n                        }\r\n\r\n                        if(foundstyles.params['letter-spacing'] !== undefined){\r\n                            if(exclude !== undefined && devices !== undefined){\r\n                                if(jQuery.inArray('letter-spacing', exclude) !== -1){\r\n                                    //set for specific devices now\r\n                                    layer['static_styles'] = t.setVal(layer['static_styles'], 'letter-spacing', foundstyles.params['letter-spacing'], false, devices);\r\n\r\n                                    if(jQuery.inArray(layout, devices) !== -1){\r\n                                        jQuery('#letter_spacing_s').val(foundstyles.params['letter-spacing']);\r\n                                    }\r\n                                }\r\n                            }else{\r\n                                jQuery('#letter_spacing_s').val(foundstyles.params['letter-spacing']);\r\n                            }\r\n                        }\r\n\r\n                        if(foundstyles.params['font-weight'] !== undefined){\r\n                            if(exclude !== undefined && devices !== undefined){\r\n                                if(jQuery.inArray('font-weight', exclude) !== -1){\r\n                                    //set for specific devices now\r\n                                    layer['static_styles'] = t.setVal(layer['static_styles'], 'font-weight', foundstyles.params['font-weight'], false, devices);\r\n\r\n                                    if(jQuery.inArray(layout, devices) !== -1){\r\n                                        jQuery('#layer_font_weight_s option[value=\"'+foundstyles.params['font-weight']+'\"]').attr('selected', true);\r\n                                    }\r\n                                }\r\n                            }else{\r\n                                jQuery('#layer_font_weight_s option[value=\"'+foundstyles.params['font-weight']+'\"]').attr('selected', true);\r\n                            }\r\n                        }\r\n\r\n                        if(foundstyles.params['color'] !== undefined){\r\n                            if(exclude !== undefined && devices !== undefined){\r\n                                if(jQuery.inArray('color', exclude) !== -1){\r\n                                    //set for specific devices now\r\n                                    layer['static_styles'] = t.setVal(layer['static_styles'], 'color', UniteAdminRev.rgb2hex(foundstyles.params['color']), false, devices);\r\n                                }\r\n                                if(jQuery.inArray(layout, devices) !== -1){\r\n                                    jQuery('#layer_color_s').val(UniteAdminRev.rgb2hex(foundstyles.params['color']));\r\n                                    //trigger color change on the colorpicker\r\n                                    jQuery('.wp-color-result').each(function(){\r\n                                        jQuery(this).css('backgroundColor', jQuery(this).parent().find('.my-color-field').val());\r\n                                    });\r\n                                }\r\n                            }else{\r\n                                jQuery('#layer_color_s').val(UniteAdminRev.rgb2hex(foundstyles.params['color']));\r\n                                //trigger color change on the colorpicker\r\n                                jQuery('.wp-color-result').each(function(){\r\n                                    jQuery(this).css('backgroundColor', jQuery(this).parent().find('.my-color-field').val());\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * update layer by data object\r\n             */\r\n            t.updateLayer = function(serial,objData,del_certain,ignoreCallUndo){\r\n\r\n\r\n                var layer = t.getLayer(serial);\r\n                if(!layer){\r\n                    return(false);\r\n                }\r\n\r\n                var do_reset_static = false;\r\n\r\n                if(objData.style !== undefined && objData.style !== layer['style'] && jQuery('#dialog-change-style-from-css').css('display') == 'none'){ //check if dialog is open, if yes then do not change static\r\n                    //update values that can be set without changing the class\r\n                    do_reset_static = true;\r\n                }\r\n\r\n\r\n                if(del_certain !== undefined){\r\n                    for(var key in del_certain) if (del_certain.hasOwnProperty(key)) {\r\n                        delete layer[del_certain[key]];\r\n                    }\r\n                }\r\n\r\n\r\n                for(var key in objData) if (objData.hasOwnProperty(key)) {\r\n                    if(typeof(objData[key]) === 'object'){\r\n                        for(var okey in objData[key]) if (objData[key].hasOwnProperty(okey)) {\r\n                            if(typeof(layer[key]) === 'object'){\r\n                                if(typeof(layer[key][okey]) === 'object'){\r\n                                    for(var mk in objData[key][okey]) if (objData[key][okey].hasOwnProperty(mk)) {\r\n                                        layer[key][okey][mk] = objData[key][okey][mk];\r\n                                    }\r\n                                }else{\r\n                                    layer[key][okey] = objData[key][okey];\r\n                                }\r\n                            }else{\r\n                                layer[key] = {};\r\n                                layer[key][okey] = objData[key][okey];\r\n                            }\r\n                        }\r\n                    }else{\r\n                        layer[key] = objData[key];\r\n                    }\r\n                }\r\n\r\n                if(do_reset_static){\r\n                    t.reset_to_default_static_styles(layer);\r\n                    // Reset Fields from Style Template\r\n                    updateSubStyleParameters(layer);\r\n                }\r\n\r\n                if(!t.arrLayers[serial]){\r\n                    UniteAdminRev.showErrorMessage(\"setLayer error, Layer with ID: \"+serial+\" not found\");\r\n                    return(false);\r\n                }\r\n\r\n                if (!ignoreCallUndo)\r\n                    if(update_layer_changes){\r\n                        t.add_layer_change(serial, objData);\r\n                    }\r\n\r\n                t.arrLayers[serial] = jQuery.extend({},layer);\r\n\r\n                t.updateReverseList();\r\n\r\n            }\r\n\r\n\r\n            /********************************************************************************************************/\r\n            /*                         -        UNDO / REDO FUNCTION     -                                                */\r\n            /********************************************************************************************************/\r\n\r\n            // UNDO - REDO FUNCTIONS DUE ALL LAYERS\r\n            t.cloneArrLayers = function() {\r\n                t.arrLayersClone = UniteAdminRev.duplicateObject(t.arrLayers);\r\n            }\r\n\r\n\r\n            function checkKeyGroups(chain) {\r\n\r\n                //Check if any History exists\r\n                var c_chain_group = t.arrLayersChanges[\"undo\"] && t.arrLayersChanges[\"undo\"].length>0 ? t.arrLayersChanges[\"undo\"][t.arrLayersChanges[\"undo\"].length-1].undogroup : \"\",\r\n                    c_serial = t.arrLayersChanges[\"undo\"] && t.arrLayersChanges[\"undo\"].length>0 ? t.arrLayersChanges[\"undo\"][t.arrLayersChanges[\"undo\"].length-1].serial : -77,\r\n                    serial = chain.split(\".\")[0],\r\n                    obj = {},\r\n                    ai = -1;\r\n\r\n                chain = chain.substring(chain.indexOf(\".\")+1);\r\n                obj.addtoarray = false;\r\n                obj.serial = serial;\r\n\r\n                var laction = chain.indexOf('layer_action')>=0,\r\n                    searchfor = laction ? \"layer_action\" : chain;\r\n\r\n                jQuery.each(t.attributegroups, function(i,gob) {\r\n                    if (jQuery.inArray(searchfor,gob.keys)!=-1) {\r\n                        obj.undogroup = gob.groupname;\r\n                        obj.icon = gob.icon;\r\n                        obj.id = gob.id;\r\n                    }\r\n                });\r\n\r\n                if (obj.serial == c_serial || (obj.id==30 && c_chain_group==\"Order\")) {\r\n                    if (obj.undogroup != c_chain_group)\r\n                        obj.addtoarray = true;\r\n                    else\r\n                        obj.addtoarray=\"samegroup\";\r\n                } else {\r\n                    obj.addtoarray = true\r\n                }\r\n\r\n                // FOR FURTHER DEBUGS\r\n                if (obj.undogroup==undefined) {\r\n                    obj.addtoarray = false;\r\n                }\r\n\r\n                return obj;\r\n            }\r\n\r\n\r\n            // REKURSIVE COMPARING OBJECTS\r\n            function objRek (a, b, chain,found) {\r\n                chain = chain===undefined ? \"\" : chain;\r\n                jQuery.each(a, function(key,val) {\r\n                    if (found) return true;\r\n                    if (key!==\"references\")\r\n                        if (val instanceof(Object)) {\r\n                            var originalchain = chain;\r\n                            chain = chain.length==0 ? key : chain+\".\"+key;\r\n                            found = objRek(val,b[key],chain,found);\r\n                            chain = originalchain;\r\n                        } else {\r\n                            var originalchain = chain;\r\n                            chain = chain == undefined || chain.length==0 ? key : chain+\".\"+key;\r\n                            // CHECK IF THE VALUES ARE DIFFERENT\r\n\r\n                            if (b!==undefined && ((val!==b[key] && parseInt(val,0) != parseInt(b[key],0) && val!=undefined && b[key]!=undefined) && key!=\"renderedData\"))    {\r\n\r\n                                if ((t.arrLayersChanges[\"undo\"] && t.arrLayersChanges[\"undo\"].length==0) ||  t.arrLayersChanges[\"undo\"][t.arrLayersChanges[\"undo\"].length-1].chain != chain) {\r\n                                    var obj = checkKeyGroups(chain);\r\n                                    if (obj.addtoarray===true) {\r\n                                        t.arrLayersChanges[\"redo\"].splice(0,t.arrLayersChanges[\"redo\"].length);\r\n                                        t.arrLayersChanges[\"undo\"].push({amount:0, backup:UniteAdminRev.duplicateObject(t.arrLayersClone),restore:UniteAdminRev.duplicateObject(t.arrLayers),icon:obj.icon, id:obj.id, undogroup:obj.undogroup,serial:obj.serial, key:key, chain:chain, oldval:val, newval:b[key]});\r\n                                        t.set_save_needed(true);\r\n                                        found = true;\r\n                                    } else {\r\n                                        if (obj.addtoarray==\"samegroup\") {\r\n                                            t.arrLayersChanges[\"redo\"].splice(0,t.arrLayersChanges[\"redo\"].length);\r\n                                            t.arrLayersChanges[\"undo\"][t.arrLayersChanges[\"undo\"].length-1].amount++;\r\n                                            t.set_save_needed(true);\r\n                                            found = true;\r\n                                        }\r\n                                    }\r\n                                } else {\r\n                                    if (t.arrLayersChanges[\"undo\"][t.arrLayersChanges[\"undo\"].length-1].chain === chain) {\r\n                                        t.arrLayersChanges[\"redo\"].splice(0,t.arrLayersChanges[\"redo\"].length);\r\n                                        t.arrLayersChanges[\"undo\"][t.arrLayersChanges[\"undo\"].length-1].amount++;\r\n                                        t.set_save_needed(true);\r\n                                        found = true;\r\n                                    }\r\n                                }\r\n                            }\r\n                            chain = originalchain;\r\n                        }\r\n                })\r\n                return found;\r\n            }\r\n\r\n            // CHECK IF ANY CHANGES HAPPEND SINCE LAST ARRAY CLONE\r\n            t.add_layer_change = function() {\r\n                if (t.ignorAllUndoRedoLogs) return;\r\n                if (t.arrLayersChanges[\"undo\"].length-1 > 27)\r\n                    var removed = t.arrLayersChanges[\"undo\"].splice(0,1);\r\n                objRek(t.arrLayersClone,t.arrLayers,\"\");\r\n                if (t.arrLayersChanges[\"redo\"].length==0 && t.arrLayersChanges[\"undo\"].length>0)\r\n                    t.arrLayersChanges[\"undo\"][t.arrLayersChanges[\"undo\"].length-1].restore = UniteAdminRev.duplicateObject(t.arrLayers);\r\n\r\n                t.cloneArrLayers();\r\n\r\n                t.update_undo_redo_list();\r\n\r\n            }\r\n\r\n            t.oneStepUndo = function() {\r\n                if (t.arrLayersChanges[\"undo\"].length-1 >=0)\r\n                    t.undo_redo_layer(\"undo\",t.arrLayersChanges[\"undo\"].length-1);\r\n            }\r\n\r\n            t.oneStepRedo = function() {\r\n                if (t.arrLayersChanges[\"redo\"].length-1 >=0)\r\n                    t.undo_redo_layer(\"redo\",0);\r\n            }\r\n\r\n            t.update_undo_redo_list = function(){\r\n\r\n                if (jQuery('#rs-undo-list').length==0) {\r\n                    jQuery('#layer-settings-toolbar-bottom').append('<div id=\"rs-undo-list\"><div id=\"undo-redo-wrapper\"></div></div>');\r\n                    jQuery('body').on('click','.undostep',function() {\r\n                        t.undo_redo_layer(\"undo\",jQuery(this).data('undoindex'));\r\n                    });\r\n                    jQuery('body').on('click','.redostep',function() {\r\n                        t.undo_redo_layer(\"redo\",jQuery(this).data('redoindex'));\r\n                    });\r\n\r\n                    jQuery('body').on('click','#undo-last-action',function() {\r\n                        if (t.arrLayersChanges[\"undo\"].length-1 >=0)\r\n                            t.undo_redo_layer(\"undo\",t.arrLayersChanges[\"undo\"].length-1);\r\n                    });\r\n\r\n                    jQuery('body').on('click','#showhide_undolist',function() {\r\n                        var c = jQuery('#rs-undo-list');\r\n\r\n                        if (!c.hasClass(\"inactive\")) {\r\n                            c.slideDown(200).addClass(\"inactive\");\r\n                            jQuery('#showhide_undolist i').addClass(\"eg-icon-down-open\").removeClass('eg-icon-menu');\r\n                        }\r\n                        else {\r\n                            c.slideUp(200).removeClass(\"inactive\");\r\n                            jQuery('#showhide_undolist i').removeClass(\"eg-icon-down-open\").addClass('eg-icon-menu');\r\n                            setTimeout(function() {\r\n                                var udl = jQuery('#undo-redo-wrapper');\r\n                                udl.scrollTop(udl.prop(\"scrollHeight\"));\r\n                                udl.perfectScrollbar(\"update\");\r\n                            },250);\r\n                        }\r\n                    });\r\n\r\n                    jQuery('#undo-redo-wrapper').perfectScrollbar({wheelPropagation:true, suppressScrollX:true});\r\n\r\n                }\r\n\r\n                var udl = jQuery('#undo-redo-wrapper');\r\n\r\n                udl.find('.undoredostep').remove();\r\n\r\n\r\n                jQuery.each(t.arrLayersChanges[\"undo\"],function(i,obj) {\r\n                    var quicksb = '<div data-undoindex=\"'+i+'\" class=\"undoredostep undostep\">',\r\n                        name = t.arrLayers[obj.serial].alias,\r\n                        type = t.arrLayers[obj.serial].type;\r\n\r\n                    switch (type) {\r\n                        case \"text\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layerfont_n\"></i></span>';\r\n                            break;\r\n                        case \"shape\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layershape_n\"></i></span>';\r\n\r\n                            break;\r\n                        case \"button\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layerbutton_n\"></i></span>';\r\n\r\n                            break;\r\n                        case \"image\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layerimage_n\"></i></span>';\r\n\r\n                            break;\r\n                        case \"video\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layervideo_n\"></i></span>';\r\n\r\n                            break;\r\n                        case \"audio\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layeraudio_n\"></i></span>';\r\n                            break;\r\n                        case \"svg\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layersvg_n\"></i></span>';\r\n                            break;\r\n                        case \"row\":\r\n                        case \"group\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"fa-icon-object-group\"></i></span>';\r\n                            break;\r\n                        case \"column\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layercolumn_n\"></i></span>';\r\n                            break;\r\n                    }\r\n                    var suf = \"\";\r\n                    if (obj.amount >0) suf = ' ('+obj.amount+')';\r\n                    if (i==t.arrLayersChanges[\"undo\"].length-1)\r\n                        jQuery('#quick-undo .single-undo-action').html('<span class=\"undo-name\">'+name+'</span><span class=\"undo-action\"><i class=\"eg-icon-'+obj.icon+'\"></i>'+obj.undogroup+suf+'</span>');\r\n\r\n                    quicksb += '<span class=\"undo-name\">'+name+'</span><span class=\"undo-action\"><i class=\"eg-icon-'+obj.icon+'\"></i>'+obj.undogroup+suf+'</span><i class=\"eg-icon-cw\"></i>';\r\n                    quicksb += '</div>';\r\n                    udl.append(quicksb);\r\n                });\r\n\r\n                if (t.arrLayersChanges[\"undo\"].length-1<0)\r\n                    jQuery('#quick-undo .single-undo-action').html('<span class=\"undo-name\">'+jQuery(\".single-undo-action\").data(\"origtext\")+'</span>');\r\n\r\n                jQuery.each(t.arrLayersChanges[\"redo\"],function(i,obj) {\r\n                    var quicksb = '<div data-redoindex=\"'+i+'\" class=\"undoredostep redostep\">',\r\n                        name = t.arrLayers[obj.serial] ===undefined ?  obj[\"backup\"][obj.serial].alias : t.arrLayers[obj.serial].alias;\r\n                    type = t.arrLayers[obj.serial] ===undefined ?  obj[\"backup\"][obj.serial].type : t.arrLayers[obj.serial].type;\r\n\r\n\r\n                    switch (type) {\r\n                        case \"text\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layerfont_n\"></i></span>';\r\n                            break;\r\n                        case \"shape\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layershape_n\"></i></span>';\r\n\r\n                            break;\r\n                        case \"button\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layerbutton_n\"></i></span>';\r\n\r\n                            break;\r\n                        case \"image\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layerimage_n\"></i></span>';\r\n\r\n                            break;\r\n                        case \"video\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layervideo_n\"></i></span>';\r\n\r\n                            break;\r\n                        case \"audio\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layeraudio_n\"></i></span>';\r\n                            break;\r\n                        case \"svg\":\r\n                            quicksb += '<span class=\"layer-title-with-icon\"><i class=\"rs-icon-layersvg_n\"></i></span>';\r\n                            break;\r\n                    }\r\n                    var suf = \"\";\r\n                    if (obj.amount >0) suf = ' ('+obj.amount+')';\r\n                    quicksb += '<span class=\"undo-name\">'+name+'</span><span class=\"undo-action\"><i class=\"eg-icon-'+obj.icon+'\"></i>'+obj.undogroup+suf+'</span><i class=\"eg-icon-cw\"></i>';\r\n                    quicksb += '</div>';\r\n                    udl.append(quicksb);\r\n                });\r\n\r\n\r\n                if (udl.data('steps') != (t.arrLayersChanges[\"redo\"].length+t.arrLayersChanges[\"undo\"].length)) {\r\n                    udl.scrollTop(udl.prop(\"scrollHeight\"));\r\n                    udl.data('steps',(t.arrLayersChanges[\"redo\"].length+t.arrLayersChanges[\"undo\"].length));\r\n                }\r\n\r\n                udl.perfectScrollbar(\"update\");\r\n\r\n\r\n            }\r\n\r\n            function _len(a) {\r\n                var r = 0;\r\n                jQuery.each(a,function(i) { r++;});\r\n                return r;\r\n            }\r\n\r\n\r\n            function forceShowHideLayer(objLayer,todo) {\r\n\r\n                if (objLayer===undefined || objLayer === false) return;\r\n\r\n                if (todo==\"hide\") {\r\n                    objLayer.references.htmlLayer.addClass(\"layer-deleted\");\r\n                    if (objLayer.references.sorttable!=undefined) {\r\n                        objLayer.references.sorttable.layer.addClass(\"layer-deleted\");\r\n                        objLayer.references.sorttable.timeline.addClass(\"layer-deleted\");\r\n                        objLayer.references.quicklayer.addClass(\"layer-deleted\");\r\n                    }\r\n\r\n                } else {\r\n                    objLayer.references.htmlLayer.removeClass(\"layer-deleted\");\r\n                    if (objLayer.references.sorttable!=undefined) {\r\n                        objLayer.references.sorttable.layer.removeClass(\"layer-deleted\");\r\n                        objLayer.references.sorttable.timeline.removeClass(\"layer-deleted\");\r\n                        objLayer.references.quicklayer.removeClass(\"layer-deleted\");\r\n                    }\r\n                }\r\n\r\n                u.timeLineTableDimensionUpdate();\r\n            }\r\n\r\n            function showHideDeletedLayers(force) {\r\n                jQuery.each(t.arrLayers,function(i,objLayer) {\r\n                    if (objLayer.layer_unavailable || objLayer.deleted===true)\r\n                        forceShowHideLayer(objLayer,\"hide\");\r\n                    else\r\n                        forceShowHideLayer(objLayer,\"show\");\r\n                });\r\n            }\r\n\r\n            function checkInvisibleRedoItems() {\r\n                jQuery.each(t.arrLayersChanges[\"redo\"],function(i,change){\r\n                    jQuery.each(change.backup,function(i,objLayer){\r\n                        if (objLayer.layer_unavailable) {\r\n                            forceShowHideLayer(objLayer,\"hide\");\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n\r\n\r\n\r\n            function checkChangedSources(d) {\r\n                function ccs_intern_check(change,direction) {\r\n                    if (change.id==12 || change.id==9 || change.id==29) {\r\n                        jQuery.each(change[d],function(i,objLayer){\r\n                            if ((change.id==12 && (objLayer.type==\"svg\" || objLayer.type==\"image\")) ||\r\n                                (change.id==29 && (objLayer.type==\"audio\" || objLayer.type==\"video\")) ||\r\n                                (change.id==9 && objLayer.type==\"text\"))\r\n                                redrawLayerHtml(objLayer.serial);\r\n                            if (change.id==29 && (objLayer.type==\"audio\")) {\r\n                                u.drawAudioMap(objLayer);\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n                jQuery.each(t.arrLayersChanges[\"redo\"],function(i,change){\r\n                    ccs_intern_check(change,d);\r\n                });\r\n                jQuery.each(t.arrLayersChanges[\"undo\"],function(i,change){\r\n                    ccs_intern_check(change,d);\r\n                });\r\n            }\r\n\r\n\r\n\r\n\r\n            t.undo_redo_layer = function(type, step){\r\n                t.set_save_needed(true);\r\n                jQuery('.layer-on-timeline-selector').each(function() {\r\n                    this.checked = false;\r\n                });\r\n                t.selectedLayers=[];\r\n                if (type==\"undo\") {\r\n                    t.arrLayers = UniteAdminRev.duplicateObject(t.arrLayersChanges[\"undo\"][step].backup);\r\n                    showHideDeletedLayers();\r\n                    var j = t.arrLayersChanges[\"undo\"].length-step;\r\n                    for (var i=0;i<j;i++) {\r\n                        t.arrLayersChanges[\"redo\"].unshift(t.arrLayersChanges[\"undo\"].pop())\r\n\r\n                    }\r\n                    checkInvisibleRedoItems();\r\n                    checkChangedSources(\"backup\");\r\n                } else\r\n\r\n                if (type==\"redo\") {\r\n                    t.arrLayers = UniteAdminRev.duplicateObject(t.arrLayersChanges[\"redo\"][step].restore);\r\n\r\n                    showHideDeletedLayers();\r\n                    for (var i=0;i<=step;i++) {\r\n                        t.arrLayersChanges[\"undo\"].push(t.arrLayersChanges[\"redo\"].shift());\r\n                    }\r\n                    checkChangedSources(\"restore\");\r\n                }\r\n\r\n                t.recreateLayerReferences();\r\n                u.redrawSortbox();\r\n                unselectLayers();\r\n                t.cloneArrLayers();\r\n                updateHtmlLayersFromObject();\r\n                u.allLayerToIdle();\r\n                u.stopAllLayerAnimation();\r\n                u.organiseGroupsAndLayer();\r\n                setTimeout(function() {\r\n                    t.update_undo_redo_list();\r\n                    u.updateAllLayerTimeline();\r\n                },10);\r\n            }\r\n\r\n\r\n            /********************************************************************************************************/\r\n\r\n            t.recreateLayerReferences = function() {\r\n\r\n                for (var i in t.arrLayers) if (t.arrLayers.hasOwnProperty(i)) {\r\n                    var objLayer = t.arrLayers[i];\r\n                    objLayer.references = objLayer.references === undefined ? {} : objLayer.references;\r\n                    objLayer.references.htmlLayer = jQuery(document.getElementById('slide_layer_'+objLayer.serial));\r\n                    objLayer.references.sorttable.layer = jQuery(document.getElementById('layer_sort_'+objLayer.serial));\r\n                    objLayer.references.sorttable.timeline = jQuery(document.getElementById('layer_sort_time_'+objLayer.serial));\r\n                    objLayer.references.quicklayer = jQuery(document.getElementById('layer_quicksort_'+objLayer.serial));\r\n                }\r\n\r\n                for (var i in t.arrLayersDemo) if (t.arrLayersDemo.hasOwnProperty(i)) {\r\n                    var objLayer = t.arrLayersDemo[i];\r\n                    objLayer.references = objLayer.references === undefined ? {} : objLayer.references;\r\n                    objLayer.references.htmlLayer = jQuery(document.getElementById('demo_layer_'+objLayer.serial));\r\n                    objLayer.references.sorttable.layer = jQuery(document.getElementById('demo_sort_'+objLayer.serial));\r\n                    objLayer.references.sorttable.timeline = jQuery(document.getElementById('demo_sort_time_'+objLayer.serial));\r\n                    objLayer.references.quicklayer = jQuery(document.getElementById('demo_quicksort_'+objLayer.serial));\r\n                }\r\n            }\r\n\r\n            t.updateReverseList = function() {\r\n                clearTimeout(updateRevTimer);\r\n                updateRevTimer =  setTimeout(function() {\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_xstart_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_ystart_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_xrotate_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_yrotate_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_zrotate_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_scale_xstart_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_scale_ystart_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_skew_xstart_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_skew_ystart_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#mask_anim_xstart_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#mask_anim_ystart_reverse'));\r\n\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_xend_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_yend_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_xrotate_end_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_yrotate_end_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_anim_zrotate_end_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_scale_xend_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_scale_yend_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_skew_xend_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#layer_skew_yend_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#mask_anim_xend_reverse'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#mask_anim_yend_reverse'));\r\n                },100);\r\n            }\r\n\r\n            /**\r\n             * update current layer\r\n             */\r\n            t.updateCurrentLayer = function(objData,del_certain){\r\n\r\n                if(!t.arrLayers[t.selectedLayerSerial]){\r\n                    UniteAdminRev.showErrorMessage(\"error! the layer with serial: \"+t.selectedLayerSerial+\" doesn't exists\");\r\n                    return(false);\r\n                }\r\n\r\n                t.updateLayer(t.selectedLayerSerial,objData,del_certain);\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * add image layer\r\n             */\r\n            var addLayerImage = function(imgobj, special_type){\r\n\r\n                objLayer = {\r\n                    style: \"\",\r\n                    text: \"Image \" + (id_counter+1),\r\n                    type: \"image\",\r\n                    image_url: imgobj.imgurl\r\n                };\r\n\r\n                //Add Library Relevant Informations\r\n                if (imgobj.imglib!==undefined) {\r\n                    objLayer.image_library = imgobj.imglib;\r\n                    objLayer.image_librarysize = {}\r\n                    objLayer.image_librarysize.width = imgobj.imgwidth;\r\n                    objLayer.image_librarysize.height = imgobj.imgheight;\r\n\r\n                }\r\n\r\n                objLayer.scaleProportional = true;\r\n\r\n                objLayer = t.setVal(objLayer, 'scaleX', imgobj.imgwidth, true);\r\n                objLayer = t.setVal(objLayer, 'scaleY', imgobj.imgheight, true);\r\n\r\n                objLayer = t.setVal(objLayer, 'originalWidth', imgobj.imgwidth, true);\r\n                objLayer = t.setVal(objLayer, 'originalHeight', imgobj.imgheight, true);\r\n\r\n                if(typeof special_type !== 'undefined')\r\n                    objLayer['special_type'] = special_type;\r\n\r\n                objLayer.createdOnInit = false;\r\n                addLayer(objLayer);\r\n\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * get video layer object from video data\r\n             */\r\n            var getVideoObjLayer = function(videoData, adding){\r\n\r\n                var objLayer = {\r\n                    type:\"video\",\r\n                    style : \"\",\r\n                    video_type: videoData.video_type,\r\n                    video_data:videoData\r\n                };\r\n\r\n                objLayer.video_data.autoplayonlyfirsttime = false; //needed for v5 as prior to v4, this was existing and is now in autoplay\r\n\r\n                if(typeof(adding) !== 'undefined'){\r\n                    objLayer.video_width = videoData.video_width;\r\n                    objLayer.video_height = videoData.video_height;\r\n                }\r\n\r\n                if(objLayer.video_type == \"youtube\" || objLayer.video_type == \"vimeo\"){\r\n                    objLayer.video_id = videoData.id;\r\n                    objLayer.video_title = videoData.title;\r\n                    objLayer.video_image_url = videoData.thumb_medium.url;\r\n                    objLayer.video_args = videoData.args;\r\n                }\r\n\r\n                //set sortbox text\r\n                switch(objLayer.video_type){\r\n                    case \"youtube\":\r\n                        objLayer.text = \"Youtube: \" + videoData.title;\r\n                        break;\r\n                    case \"vimeo\":\r\n                        objLayer.text = \"Vimeo: \" + videoData.title;\r\n                        break;\r\n                    case \"streamyoutube\":\r\n                        objLayer.text = \"YouTube Stream\";\r\n                        objLayer.video_title = objLayer.text;\r\n                        objLayer.video_image_url = \"\";\r\n                        if(videoData.urlPoster != \"\")\r\n                            objLayer.video_image_url = videoData.urlPoster;\r\n                        break;\r\n                    case \"streamvimeo\":\r\n                        objLayer.text = \"Vimeo Stream\";\r\n                        objLayer.video_title = objLayer.text;\r\n                        objLayer.video_image_url = \"\";\r\n                        if(videoData.urlPoster != \"\")\r\n                            objLayer.video_image_url = videoData.urlPoster;\r\n                        break;\r\n                    case \"streaminstagram\":\r\n                        objLayer.text = \"Instagram Stream\";\r\n                        objLayer.video_title = objLayer.text;\r\n                        objLayer.video_image_url = \"\";\r\n                        if(videoData.urlPoster != \"\")\r\n                            objLayer.video_image_url = videoData.urlPoster;\r\n                        break;\r\n                    case \"html5\":\r\n                        objLayer.text = \"Html5 Video\";\r\n                        objLayer.video_title = objLayer.text;\r\n                        objLayer.video_image_url = \"\";\r\n\r\n                        if(videoData.urlPoster != \"\")\r\n                            objLayer.video_image_url = videoData.urlPoster;\r\n\r\n                        break;\r\n                    case 'audio':\r\n                        objLayer.text = \"Audio Layer\";\r\n                        objLayer.audio_title = objLayer.text;\r\n                        objLayer.audio_image_url = \"\";\r\n\r\n                        if(videoData.urlPoster != \"\")\r\n                            objLayer.audio_image_url = videoData.urlPoster;\r\n\r\n                        objLayer.type = 'audio';\r\n                        break;\r\n                }\r\n                return(objLayer);\r\n            }\r\n\r\n\r\n            /**\r\n             * add video layer\r\n             */\r\n            var addLayerVideo = function(videoData, special_type){\r\n\r\n                var objLayer = getVideoObjLayer(videoData, true);\r\n\r\n                if(typeof special_type !== 'undefined'){\r\n                    objLayer['special_type'] = special_type;\r\n\r\n                }\r\n                objLayer.createdOnInit = false;\r\n                addLayer(objLayer);\r\n\r\n                if(typeof special_type !== 'undefined'){\r\n                    if(special_type == 'audio'){\r\n                        var mcurrent_layer = t.getCurrentLayer();\r\n                        if(mcurrent_layer !== false) {\r\n                            u.drawAudioMap(mcurrent_layer);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * add text layer\r\n             */\r\n            var addLayerText = function(special_type,content){\r\n                content = content===undefined ? initText + (id_counter+1) : content;\r\n\r\n                var objLayer = {\r\n                    text:content,\r\n                    type:\"text\"\r\n                };\r\n\r\n                if(typeof special_type !== 'undefined')\r\n                    objLayer['special_type'] = special_type;\r\n\r\n                objLayer.createdOnInit = false;\r\n                addLayer(objLayer);\r\n\r\n                setTimeout(function() {\r\n                    t.showHideContentEditor(true);\r\n                    jQuery('#layer_text').data('new_content',true);\r\n                    jQuery('#layer_text').focus();\r\n                },50);\r\n            }\r\n\r\n\r\n\r\n\r\n            /**\r\n             * add Layer Group\r\n             */\r\n            var addLayerGroup = function(special_type) {\r\n                var objLayer = {\r\n                        type:\"group\",\r\n                        text:initGroupName + (id_counter +1),\r\n                        createdOnInit: false,\r\n                        grouptype:\"logical\",\r\n\r\n                    },\r\n                    c_objLayer =  {};\r\n\r\n                if(typeof special_type !== 'undefined')\r\n                    objLayer['special_type'] = special_type;\r\n\r\n                //get group unique ID to add it to the columns for reference\r\n                var layer_id = addLayer(objLayer);\r\n                t.makeRowSortableDroppable();\r\n            }\r\n\r\n\r\n            /**\r\n             * add Layer Row\r\n             */\r\n            var addLayerRow = function(special_type) {\r\n                var objLayer = {\r\n                        type:\"row\",\r\n                        text:initRowName + (id_counter +1),\r\n                        createdOnInit: false\r\n                    },\r\n                    c_objLayer =  {};\r\n\r\n                if(typeof special_type !== 'undefined')\r\n                    objLayer['special_type'] = special_type;\r\n\r\n                //get group unique ID to add it to the columns for reference\r\n                var layer_id = addLayer(objLayer);\r\n                var ml = t.getLayer(layer_id);\r\n                var groupid = ml.unique_id;\r\n\r\n                for (var i=0;i<2;i++) {\r\n                    c_objLayer = {\r\n                        type:\"column\",\r\n                        text:initColumnName + (id_counter +1),\r\n                        ref_group:groupid,\r\n                        p_uid:groupid,\r\n                        column_size:\"1/2\",\r\n                        createdOnInit: false\r\n                    }\r\n                    addLayer(c_objLayer);\r\n                }\r\n\r\n                //jump to the group tab and open it\r\n                t.makeRowSortableDroppable();\r\n                t.setLayerSelected(layer_id);\r\n            }\r\n\r\n\r\n            /*! ADD LAYER */\r\n            /**\r\n             * add layer\r\n             */\r\n                ///////////////////////////\r\n                // ADD ONE SINGLE LAYER  //\r\n                ///////////////////////////\r\n            var addLayer = function(objLayer, isInit, isDemo, skipScroller){\r\n\r\n                    // UPDATE FROM PRE VERSION 5.3 TO VERSION 5.3+\r\n                    if (objLayer.version===undefined) {\r\n                        if (objLayer.endtime !== undefined && objLayer.endspeed!==undefined) {\r\n                            if (jQuery.isNumeric(objLayer.endtime))\r\n                                objLayer.endtime = objLayer.endtime - objLayer.endspeed;\r\n                        }\r\n\r\n                        // UPDATE FROM PREVERSION 4.x TO Max. 5.2.x\r\n                        if (objLayer.realEndTime && objLayer.realEndTime!=\"undefined\" && objLayer.realEndTime!=undefined) {\r\n                            objLayer.endtime = objLayer.realEndTime;\r\n\r\n                            delete objLayer.realEndTime;\r\n                            delete objLayer.endTimeFinal;\r\n                            delete objLayer.endSpeedFinal;\r\n                        }\r\n                    }\r\n\r\n                    objLayer.version=t.core+\"\"+t.sub+\"\"+t.subsub;\r\n\r\n                    if (objLayer.frames===undefined) objLayer.frames = {};\r\n\r\n                    isInit = isInit || false;\r\n                    isDemo = isDemo || false;\r\n\r\n                    var do_style_reset = false;\r\n\r\n                    if(objLayer.subtype == undefined)\r\n                        objLayer.subtype = '';\r\n\r\n                    if(objLayer.specialsettings == undefined)\r\n                        objLayer.specialsettings = {};\r\n\r\n                    if(objLayer.order == undefined)\r\n                        objLayer.order = (id_counter);\r\n\r\n                    objLayer.order = Number(objLayer.order);\r\n\r\n                    if(isInit == false && !isDemo){ //add unique layer ID only if not init and not demo\r\n                        unique_layer_id++;\r\n                        objLayer.unique_id = unique_layer_id;\r\n                    }\r\n\r\n                    if (objLayer.unique_id===undefined) {\r\n                        unique_layer_id++;\r\n                        objLayer.unique_id = unique_layer_id;\r\n                    }\r\n\r\n                    if (jQuery.inArray(objLayer.unique_id,alluniqueids)>=0) {\r\n                        objLayer.unique_id = objLayer.unique_id+Math.round(Math.random()*100+100);\r\n                        unique_layer_id = objLayer.unique_id;\r\n                    }\r\n\r\n                    if (unique_layer_id<objLayer.unique_id)\r\n                        unique_layer_id = objLayer.unique_id+1;\r\n\r\n                    if (!isDemo) alluniqueids.push(objLayer.unique_id);\r\n\r\n                    var _x = objLayer.type === \"video\" ? initLeftVideo : initLeft,\r\n                        _y = objLayer.type === \"video\" ? initTopVideo : initTop;\r\n\r\n                    _x = t.newlayercoord.x!==-1 ? t.newlayercoord.x : _x;\r\n                    _y = t.newlayercoord.y!==-1 ? t.newlayercoord.y : _y;\r\n\r\n                    //set init position\r\n                    objLayer = t.getVal(objLayer, 'left') == undefined ? t.setVal(objLayer, 'left', _x, true) : typeof(objLayer.left) !== 'object' ? t.setVal(objLayer, 'left', objLayer.left, true) : objLayer;\r\n                    objLayer = t.getVal(objLayer, 'top') == undefined ? t.setVal(objLayer, 'top', _y, true) : typeof(objLayer.top) !== 'object' ? t.setVal(objLayer, 'top', objLayer.top, true) : objLayer;\r\n\r\n                    if(objLayer.type == \"video\") objLayer = checkUpdateFullwidthVideo(objLayer);\r\n\r\n                    t.newlayercoord.x = -1;\r\n                    t.newlayercoord.y = -1;\r\n\r\n                    objLayer.isDemo = isDemo;\r\n\r\n                    if(objLayer['layer_action'] !== undefined){ //check for each action if layer is set to self, if yes, change it to objLayer.unique_id\r\n                        if(objLayer['layer_action'].layer_target !== undefined){\r\n                            for(var key in objLayer['layer_action'].layer_target) if (objLayer['layer_action'].layer_target.hasOwnProperty(key)) {\r\n                                if(objLayer['layer_action'].layer_target[key] == 'self')\r\n                                    objLayer['layer_action'].layer_target[key] = objLayer.unique_id;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    objLayer.internal_class = objLayer.internal_class || '';\r\n\r\n                    // Enabled Hover ?\r\n                    objLayer['hover'] = objLayer['hover']!==undefined ? objLayer['hover'] : false;\r\n\r\n                    objLayer['alias'] = objLayer['alias']!==undefined ? objLayer['alias'] : u.getSortboxText(objLayer.text).toLowerCase();\r\n\r\n                    // PRESET DELETED INFO\r\n                    objLayer.layer_unavailable = false;\r\n                    objLayer.deleted = false;\r\n                    objLayer.createdOnInit = objLayer.createdOnInit != undefined ? objLayer.createdOnInit : isInit==true ? true : false;\r\n\r\n                    //background image settings for layer\r\n                    objLayer.layer_bg_position = objLayer.layer_bg_position!==undefined ? objLayer.layer_bg_position : \"center center\";\r\n                    objLayer.layer_bg_size = objLayer.layer_bg_size !== undefined ? objLayer.layer_bg_size : \"cover\";\r\n                    objLayer.layer_bg_repeat = objLayer.layer_bg_repeat !== undefined ? objLayer.layer_bg_repeat : \"no-repeat\";\r\n\r\n\r\n                    //set Loop Animations\r\n                    objLayer.loop_animation = objLayer.loop_animation!==undefined ? objLayer.loop_animation : \"none\";\r\n                    objLayer.loop_easing = objLayer.loop_easing!==undefined ? objLayer.loop_easing : \"linearEaseNone\";\r\n                    objLayer.loop_speed = objLayer.loop_speed != undefined ? objLayer.loop_speed :  2;\r\n                    objLayer.loop_startdeg = objLayer.loop_startdeg != undefined ? objLayer.loop_startdeg : -20;\r\n                    objLayer.loop_enddeg = objLayer.loop_enddeg != undefined ?     objLayer.loop_enddeg : 20;\r\n                    objLayer.loop_xorigin = objLayer.loop_xorigin != undefined ? objLayer.loop_xorigin : 50;\r\n                    objLayer.loop_yorigin = objLayer.loop_yorigin != undefined ? objLayer.loop_yorigin : 50;\r\n                    objLayer.loop_xstart = objLayer.loop_xstart != undefined ? objLayer.loop_xstart : 0;\r\n                    objLayer.loop_xend = objLayer.loop_xend != undefined ? objLayer.loop_xend : 0;\r\n                    objLayer.loop_ystart = objLayer.loop_ystart != undefined ? objLayer.loop_ystart : 0;\r\n                    objLayer.loop_yend = objLayer.loop_yend != undefined ? objLayer.loop_yend : 0;\r\n                    objLayer.loop_zoomstart = objLayer.loop_zoomstart != undefined ? objLayer.loop_zoomstart : 1;\r\n                    objLayer.loop_zoomend = objLayer.loop_zoomend != undefined ? objLayer.loop_zoomend : 1;\r\n                    objLayer.loop_angle = objLayer.loop_angle != undefined ? objLayer.loop_angle : 0;\r\n                    objLayer.loop_radius = objLayer.loop_radius != undefined ? objLayer.loop_radius : 10;\r\n\r\n                    objLayer.layer_blend_mode = objLayer.layer_blend_mode != undefined ? objLayer.layer_blend_mode : \"normal\";\r\n\r\n                    objLayer.html_tag = objLayer.html_tag!==undefined ? objLayer.html_tag :  \"div\";\r\n                    objLayer.parallax_layer_ddd_zlevel = objLayer.parallax_layer_ddd_zlevel !==undefined ? objLayer.parallax_layer_ddd_zlevel : \"front\";\r\n\r\n                    // set Mask Animation\r\n                    objLayer.mask_start = objLayer.mask_start !== undefined ? objLayer.mask_start : false;\r\n                    objLayer.mask_end = objLayer.mask_end !== undefined ? objLayer.mask_end : false;\r\n\r\n                    // Column Break At\r\n                    if (objLayer.type===\"row\")\r\n                        objLayer.column_break_at = objLayer.column_break_at!==undefined ? objLayer.column_break_at : \"mobile\";\r\n\r\n                    // Set Reverse Basics\r\n                    objLayer.x_start_reverse = objLayer.x_start_reverse!==undefined ? objLayer.x_start_reverse : false;\r\n                    objLayer.y_start_reverse = objLayer.y_start_reverse!==undefined ? objLayer.y_start_reverse : false;\r\n                    objLayer.x_end_reverse = objLayer.x_end_reverse!==undefined ? objLayer.x_end_reverse : false;\r\n                    objLayer.y_end_reverse = objLayer.y_end_reverse!==undefined ? objLayer.y_end_reverse : false;\r\n                    objLayer.x_rotate_start_reverse = objLayer.x_rotate_start_reverse!==undefined ? objLayer.x_rotate_start_reverse : false;\r\n                    objLayer.y_rotate_start_reverse = objLayer.y_rotate_start_reverse!==undefined ? objLayer.y_rotate_start_reverse : false;\r\n                    objLayer.z_rotate_start_reverse = objLayer.z_rotate_start_reverse!==undefined ? objLayer.z_rotate_start_reverse : false;\r\n                    objLayer.x_rotate_end_reverse = objLayer.x_rotate_end_reverse!==undefined ? objLayer.x_rotate_end_reverse : false;\r\n                    objLayer.y_rotate_end_reverse = objLayer.y_rotate_end_reverse!==undefined ? objLayer.y_rotate_end_reverse : false;\r\n                    objLayer.z_rotate_end_reverse = objLayer.z_rotate_end_reverse!==undefined ? objLayer.z_rotate_end_reverse : false;\r\n                    objLayer.scale_x_start_reverse = objLayer.scale_x_start_reverse!==undefined ? objLayer.scale_x_start_reverse : false;\r\n                    objLayer.scale_y_start_reverse = objLayer.scale_y_start_reverse!==undefined ? objLayer.scale_y_start_reverse : false;\r\n                    objLayer.scale_x_end_reverse = objLayer.scale_x_end_reverse!==undefined ? objLayer.scale_x_end_reverse : false;\r\n                    objLayer.scale_y_end_reverse = objLayer.scale_y_end_reverse!==undefined ? objLayer.scale_y_end_reverse : false;\r\n                    objLayer.skew_x_start_reverse = objLayer.skew_x_start_reverse!==undefined ? objLayer.skew_x_start_reverse : false;\r\n                    objLayer.skew_y_start_reverse = objLayer.skew_y_start_reverse!==undefined ? objLayer.skew_y_start_reverse : false;\r\n                    objLayer.skew_x_end_reverse = objLayer.skew_x_end_reverse!==undefined ? objLayer.skew_x_end_reverse : false;\r\n                    objLayer.skew_y_end_reverse = objLayer.skew_y_end_reverse!==undefined ? objLayer.skew_y_end_reverse : false;\r\n                    objLayer.mask_x_start_reverse = objLayer.mask_x_start_reverse!==undefined ? objLayer.mask_x_start_reverse : false;\r\n                    objLayer.mask_y_start_reverse = objLayer.mask_y_start_reverse!==undefined ? objLayer.mask_y_start_reverse : false;\r\n                    objLayer.mask_x_end_reverse = objLayer.mask_x_end_reverse!==undefined ? objLayer.mask_x_end_reverse : false;\r\n                    objLayer.mask_y_end_reverse = objLayer.mask_y_end_reverse!==undefined ? objLayer.mask_y_end_reverse : false;\r\n\r\n                    objLayer.mask_x_start = objLayer.mask_x_start !==undefined ? objLayer.mask_x_start : 0;\r\n                    objLayer.mask_y_start = objLayer.mask_y_start !==undefined ? objLayer.mask_y_start : 0;\r\n                    objLayer.mask_speed_start = objLayer.mask_speed_start !==undefined ? objLayer.mask_speed_start : \"inherit\";\r\n                    objLayer.mask_ease_start = objLayer.mask_ease_start !==undefined ? objLayer.mask_ease_start : \"inherit\";\r\n\r\n                    objLayer.mask_x_end = objLayer.mask_x_end !==undefined ? objLayer.mask_x_end : 0;\r\n                    objLayer.mask_y_end = objLayer.mask_y_end !==undefined ? objLayer.mask_y_end : 0;\r\n                    objLayer.mask_speed_end = objLayer.mask_speed_end !==undefined ? objLayer.mask_speed_end : \"inherit\";\r\n                    objLayer.mask_ease_end = objLayer.mask_ease_end !==undefined ? objLayer.mask_ease_end : \"inherit\";\r\n\r\n                    objLayer.alt_option = objLayer.alt_option !==undefined ? objLayer.alt_option : 'media_library';\r\n                    objLayer.alt = objLayer.alt !==undefined ? objLayer.alt : '';\r\n\r\n                    // Layer Action\r\n                    objLayer.layer_action = objLayer.layer_action !== undefined ?  objLayer.layer_action : {};\r\n                    objLayer.layer_action.tooltip_event = objLayer.layer_action.tooltip_event !== undefined ? objLayer.layer_action.tooltip_event : [];\r\n                    objLayer.layer_action.action = objLayer.layer_action.action !== undefined ? objLayer.layer_action.action : [];\r\n                    objLayer.layer_action.image_link = objLayer.layer_action.image_link !== undefined ? objLayer.layer_action.image_link : [];\r\n                    objLayer.layer_action.link_open_in = objLayer.layer_action.link_open_in !== undefined ? objLayer.layer_action.link_open_in : [];\r\n                    objLayer.layer_action.jump_to_slide = objLayer.layer_action.jump_to_slide !== undefined ? objLayer.layer_action.jump_to_slide : [];\r\n                    objLayer.layer_action.scrollunder_offset = objLayer.layer_action.scrollunder_offset !== undefined ? objLayer.layer_action.scrollunder_offset : [];\r\n                    objLayer.layer_action.actioncallback = objLayer.layer_action.actioncallback !== undefined ? objLayer.layer_action.actioncallback : [];\r\n                    objLayer.layer_action.layer_target = objLayer.layer_action.layer_target !== undefined ? objLayer.layer_action.layer_target : [];\r\n                    objLayer.layer_action.link_type = objLayer.layer_action.link_type !== undefined ? objLayer.layer_action.link_type : [];\r\n                    objLayer.layer_action.action_delay = objLayer.layer_action.action_delay !== undefined ? objLayer.layer_action.action_delay : [];\r\n                    objLayer.layer_action.toggle_layer_type = objLayer.layer_action.toggle_layer_type !== undefined ? objLayer.layer_action.toggle_layer_type : [];\r\n                    objLayer.layer_action.toggle_class = objLayer.layer_action.toggle_class !== undefined ? objLayer.layer_action.toggle_class : [];\r\n\r\n\r\n                    objLayer = t.getVal(objLayer, 'min_height') == undefined ?\r\n                        t.setVal(objLayer, 'min_height', \"40\", true) :\r\n                        typeof(objLayer.min_height) !== 'object' ?\r\n                            t.setVal(objLayer, 'min_height', objLayer.min_height, true) :\r\n                            objLayer;\r\n\r\n\r\n                    objLayer = t.getVal(objLayer, 'max_height') == undefined ?\r\n                        t.setVal(objLayer, 'max_height', \"auto\", true) :\r\n                        typeof(objLayer.max_height) !== 'object' ?\r\n                            t.setVal(objLayer, 'max_height', objLayer.max_height, true) :\r\n                            objLayer;\r\n\r\n                    if(t.getVal(objLayer, 'max_width') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'max_width', \"auto\", true);\r\n                    }else{\r\n                        if(typeof(objLayer.max_width) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'max_width', objLayer.max_width, true);\r\n                        }\r\n                    }\r\n\r\n                    if (objLayer.type === \"group\" && t.getVal(objLayer, 'max_height') == \"auto\") {\r\n                        objLayer = t.setVal(objLayer, 'max_width', \"200\", true);\r\n                        objLayer = t.setVal(objLayer, 'max_height', \"200\", true);\r\n                    }\r\n\r\n                    if(objLayer.type == 'video' && typeof(objLayer.video_width) == 'undefined' && typeof(objLayer.video_data.width) !== 'undefined') objLayer.video_width = objLayer.video_data.width; //fallback to RS video prior 5.0\r\n                    if(t.getVal(objLayer, 'video_width') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'video_width', 480, true);\r\n                    }else{\r\n                        if(typeof(objLayer.video_width) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'video_width', objLayer.video_width, true);\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer.type == 'video' && typeof(objLayer.video_height) == 'undefined' && typeof(objLayer.video_data.height) !== 'undefined') objLayer.video_height = objLayer.video_data.height; //fallback to RS video prior 5.0\r\n                    if(t.getVal(objLayer, 'video_height') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'video_height', 360, true);\r\n                    }else{\r\n                        if(typeof(objLayer.video_height) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'video_height', objLayer.video_height, true);\r\n                        }\r\n                    }\r\n\r\n                    // ORIGIN AND 2D ROTATION\r\n                    objLayer['2d_rotation'] = objLayer['2d_rotation'] == undefined && isInit ? 0 : objLayer['2d_rotation'];\r\n                    objLayer['2d_origin_x'] = objLayer['2d_origin_x'] != undefined ? objLayer['2d_origin_x'] : 50;\r\n                    objLayer['2d_origin_y'] = objLayer['2d_origin_y'] != undefined ?  objLayer['2d_origin_y'] : 50;\r\n\r\n\r\n                    if(t.getVal(objLayer, 'whitespace') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'whitespace', jQuery(\"#layer_whitespace option:selected\").val(), true);\r\n                    }else{\r\n                        if(typeof(objLayer.whitespace) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'whitespace', objLayer.whitespace, true);\r\n                        }\r\n                    }\r\n\r\n                    if(t.getVal(objLayer, 'display') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'display', jQuery(\"#layer_display option:selected\").val(), true);\r\n                    }else{\r\n                        if(typeof(objLayer.display) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'display', objLayer.display, true);\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer.static_start == undefined)\r\n                        objLayer.static_start = jQuery(\"#layer_static_start option:selected\").val();\r\n\r\n                    if(objLayer.static_end == undefined)\r\n                        objLayer.static_end = 'last';\r\n\r\n\r\n                    if(t.getVal(objLayer, 'align_hor') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'align_hor', 'left', true);\r\n                    }else{\r\n                        if(typeof(objLayer.align_hor) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'align_hor', objLayer.align_hor, true);\r\n                        }\r\n                    }\r\n                    if(t.getVal(objLayer, 'align_vert') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'align_vert', 'top', true);\r\n                    }else{\r\n                        if(typeof(objLayer.align_vert) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'align_vert', objLayer.align_vert, true);\r\n                        }\r\n                    }\r\n\r\n                    //set animation:\r\n                    objLayer.hiddenunder = (objLayer.hiddenunder !== undefined) ? objLayer.hiddenunder : false;\r\n                    objLayer.resizeme = (objLayer.resizeme !== undefined) ? objLayer.resizeme : true;\r\n                    objLayer['seo-optimized'] = (objLayer['seo-optimized'] !== undefined) ? objLayer['seo-optimized'] : false;\r\n\r\n                    //set image link\r\n                    objLayer.link = (objLayer.link !== undefined) ? objLayer.link : \"\";\r\n\r\n                    //set image link open in\r\n                    objLayer.link_open_in = (objLayer.link_open_in !== undefined) ? objLayer.link_open_in : \"same\";\r\n\r\n                    //set slide link:\r\n                    objLayer.link_slide = (objLayer.link_slide !== undefined) ? objLayer.link_slide : \"nothing\";\r\n\r\n                    //set scroll under offset\r\n                    objLayer.scrollunder_offset = (objLayer.scrollunder_offset !== undefined) ? objLayer.scrollunder_offset : \"\";\r\n\r\n\r\n                    //set style, if empty, add first style from the list\r\n                    objLayer.style = (objLayer.style !== undefined) ? objLayer.style : '';\r\n\r\n\r\n\r\n\r\n                    objLayer['visible-desktop'] = (objLayer['visible-desktop']===undefined) ? true : objLayer['visible-desktop'];\r\n                    objLayer['visible-notebook'] = (objLayer['visible-notebook']===undefined) ? true : objLayer['visible-notebook'];\r\n                    objLayer['visible-tablet'] = (objLayer['visible-tablet']===undefined) ? true : objLayer['visible-tablet'];\r\n                    objLayer['visible-mobile'] = (objLayer['visible-mobile']===undefined) ? true : objLayer['visible-mobile'];\r\n\r\n                    objLayer['resize-full'] = objLayer['resize-full'] !== undefined ? objLayer['resize-full'] : true;\r\n                    objLayer['hiddenunder'] = objLayer['hiddenunder'] !== undefined ? objLayer['hiddenunder'] : false;\r\n                    objLayer['show-on-hover'] = objLayer['show-on-hover'] !== undefined ? objLayer['show-on-hover'] : false;\r\n                    objLayer.basealign = (objLayer.basealign !== undefined) ? objLayer.basealign : 'grid';\r\n                    objLayer.responsive_offset = objLayer.responsive_offset!==undefined ? objLayer.responsive_offset : true;\r\n                    objLayer.style = jQuery.trim(objLayer.style);\r\n\r\n\r\n                    if(isInit == false && objLayer.type == \"text\" && (!objLayer.style || objLayer.style == \"\"))    do_style_reset = true;\r\n\r\n                    objLayer['lazy-load'] = (objLayer['lazy-load'] !== undefined) ? objLayer['lazy-load'] : 'auto';\r\n                    objLayer['image-size'] = (objLayer['image-size'] !== undefined) ? objLayer['image-size'] : 'auto';\r\n\r\n                    objLayer['css-position'] = (objLayer['css-position'] !== undefined) ? objLayer['css-position'] : 'relative';\r\n\r\n                    //add time\r\n\r\n\r\n                    // FIRST FRAME ANIMATION UPDATE\r\n                    if (objLayer.time!==undefined) {\r\n                        objLayer.frames.frame_0 = {time:Number(objLayer.time), delay:0, split:objLayer.split, split_extratime: 0, splitdelay:objLayer.splitdelay, speed:objLayer.speed,animation:objLayer.animation, easing:objLayer.easing };\r\n                        delete objLayer.time;\r\n                        delete objLayer.splitdelay;\r\n                        delete objLayer.speed;\r\n                        delete objLayer.split;\r\n                        delete objLayer.easing;\r\n                        delete objLayer.animation;\r\n                    }\r\n\r\n                    // LAST FRAME ANIMATION UPDATE\r\n                    if (objLayer.endtime!==undefined) {\r\n                        objLayer.frames.frame_999 = {time:objLayer.endtime, delay:0,split:objLayer.endsplit, split_extratime:0, splitdelay:objLayer.endsplitdelay, speed:objLayer.endspeed!=undefined ? objLayer.endspeed : initSpeed, animation:objLayer.endanimation, easing:objLayer.endeasing};\r\n                        delete objLayer.endtime;\r\n                        delete objLayer.endsplitdelay;\r\n                        delete objLayer.endspeed;\r\n                        delete objLayer.endeasing;\r\n                        delete objLayer.endsplit;\r\n                        delete objLayer.endanimation;\r\n                    }\r\n\r\n\r\n                    if (objLayer.frames.frame_0===undefined)  objLayer.frames.frame_0 = {time:0, delay:0, split:\"none\", splitdelay:10, split_extratime:0, speed:300,animation:\"tp-fade\", easing:\"Power3.easeInOut\"};\r\n                    if (objLayer.frames.frame_999===undefined) objLayer.frames.frame_999 = {time:g_slideTime, delay:0, split:\"none\", splitdelay:10, split_extratime:0, speed:300,animation:\"tp-fade\", easing:\"Power3.easeInOut\"};\r\n\r\n                    objLayer.frames.frame_0.time =  objLayer.frames.frame_0.time===undefined ? 10 : objLayer.frames.frame_0.time;\r\n                    objLayer.frames.frame_0.delay =  objLayer.frames.frame_0.delay===undefined ? 0 : objLayer.frames.frame_0.delay;\r\n                    objLayer.frames.frame_0.split =  objLayer.frames.frame_0.split===undefined ? \"none\" : objLayer.frames.frame_0.split;\r\n                    objLayer.frames.frame_0.splitdelay =  objLayer.frames.frame_0.splitdelay===undefined ? 10 : objLayer.frames.frame_0.splitdelay;\r\n                    objLayer.frames.frame_0.split_extratime =  objLayer.frames.frame_0.split_extratime===undefined ? 0 : objLayer.frames.frame_0.split_extratime;\r\n                    objLayer.frames.frame_0.speed =  objLayer.frames.frame_0.speed===undefined ? 300 : objLayer.frames.frame_0.speed;\r\n                    objLayer.frames.frame_0.animation =  objLayer.frames.frame_0.animation===undefined ? \"tp-fade\" : objLayer.frames.frame_0.animation;\r\n                    objLayer.frames.frame_0.easing =  objLayer.frames.frame_0.easing===undefined ? \"Power3.easeInOut\" : objLayer.frames.frame_0.easing;\r\n\r\n                    objLayer.frames.frame_999.time =  objLayer.frames.frame_999.time===undefined ? 10 : objLayer.frames.frame_999.time;\r\n                    objLayer.frames.frame_999.delay =  objLayer.frames.frame_999.delay===undefined ? 0 : objLayer.frames.frame_999.delay;\r\n                    objLayer.frames.frame_999.split =  objLayer.frames.frame_999.split===undefined ? \"none\" : objLayer.frames.frame_999.split;\r\n                    objLayer.frames.frame_999.splitdelay =  objLayer.frames.frame_999.splitdelay===undefined ? 10 : objLayer.frames.frame_999.splitdelay;\r\n                    objLayer.frames.frame_999.split_extratime =  objLayer.frames.frame_999.split_extratime===undefined ? 0 : objLayer.frames.frame_999.split_extratime;\r\n                    objLayer.frames.frame_999.speed =  objLayer.frames.frame_999.speed===undefined ? 300 : objLayer.frames.frame_999.speed;\r\n                    objLayer.frames.frame_999.animation =  objLayer.frames.frame_999.animation===undefined ? \"tp-fade\" : objLayer.frames.frame_999.animation;\r\n                    objLayer.frames.frame_999.easing =  objLayer.frames.frame_999.easing===undefined ? \"Power3.easeInOut\" : objLayer.frames.frame_999.easing;\r\n\r\n\r\n\r\n                    if(t.getVal(objLayer, 'width') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'width', -1, true);\r\n                    }else{\r\n                        if(typeof(objLayer.width) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'width', objLayer.width, true);\r\n                        }\r\n                    }\r\n\r\n                    if(t.getVal(objLayer, 'height') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'height', -1, true);\r\n                    }else{\r\n                        if(typeof(objLayer.height) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'height', objLayer.height, true);\r\n                        }\r\n                    }\r\n\r\n                    if(t.getVal(objLayer, 'cover_mode') == undefined){\r\n                        objLayer = t.setVal(objLayer, 'cover_mode', 'custom', true);\r\n                    }\r\n\r\n                    if(objLayer['static_styles'] == undefined){\r\n                        objLayer['static_styles'] = {};\r\n                        t.reset_to_default_static_styles(objLayer);\r\n\r\n                        if(t.getVal(objLayer['static_styles'], 'font-size') == undefined){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'font-size', 20, true);\r\n                        }\r\n\r\n                        if(t.getVal(objLayer['static_styles'], 'line-height') == undefined){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'line-height', 22, true);\r\n                        }\r\n\r\n                        if(t.getVal(objLayer['static_styles'], 'font-weight') == undefined){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'font-weight', 400, true);\r\n                        }\r\n\r\n                        if(t.getVal(objLayer['static_styles'], 'color') == undefined){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'color', \"#ffffff\", true);\r\n                        }\r\n\r\n                        if(t.getVal(objLayer['static_styles'], 'letter-spacing') == undefined){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'letter-spacing', 0, true);\r\n                        }\r\n                    }else{\r\n                        if(typeof(objLayer['static_styles']['font-size']) !== 'object'){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'font-size', objLayer['static_styles']['font-size'], true);\r\n                        }\r\n                        if(typeof(objLayer['static_styles']['line-height']) !== 'object'){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'line-height', objLayer['static_styles']['line-height'], true);\r\n                        }\r\n                        if(typeof(objLayer['static_styles']['font-weight']) !== 'object'){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'font-weight', objLayer['static_styles']['font-weight'], true);\r\n                        }\r\n                        if(typeof(objLayer['static_styles']['color']) !== 'object'){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'color', objLayer['static_styles']['color'], true);\r\n                        }\r\n                        if(typeof(objLayer['static_styles']['letter-spacing']) !== 'object'){\r\n                            objLayer['static_styles'] = t.setVal(objLayer['static_styles'], 'letter-spacing', objLayer['static_styles']['letter-spacing'], true);\r\n                        }\r\n                    }\r\n\r\n\r\n                    if(objLayer['margin'] == undefined){\r\n                        objLayer['margin'] = {};\r\n                        var cur_mar = [];\r\n                        jQuery('input[name=\"css_margin[]\"]').each(function(){\r\n                            cur_mar.push(0);\r\n                        });\r\n\r\n                        objLayer = t.setVal(objLayer,'margin' ,cur_mar, true);\r\n                    }else{\r\n                        if(typeof(objLayer['margin']) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'margin', objLayer['margin'], true);\r\n                        }\r\n                    }\r\n                    if(objLayer['padding'] == undefined){\r\n                        //check if we have in deformation\r\n                        if(objLayer['deformation'] !== undefined && objLayer['deformation']['padding'] !== undefined){ //fallback\r\n                            objLayer = t.setVal(objLayer, 'padding', objLayer['deformation']['padding'], true);\r\n                        }else{\r\n                            objLayer['padding'] = {};\r\n                            var cur_pad = [];\r\n                            jQuery('input[name=\"css_padding[]\"]').each(function(){\r\n                                cur_pad.push(0);\r\n                            });\r\n                            objLayer = t.setVal(objLayer, 'padding' ,cur_pad, true);\r\n                        }\r\n                    }else{\r\n                        if(jQuery.type(objLayer['padding']) !== 'object'){\r\n                            var a = objLayer['padding'];\r\n                            delete(objLayer['padding']);\r\n                            objLayer = t.setVal(objLayer, 'padding', a, true);\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer['text-align'] == undefined){\r\n                        //check if we have in deformation\r\n                        if(objLayer['deformation'] !== undefined && objLayer['deformation']['text-align'] !== undefined){ //fallback\r\n                            objLayer = t.setVal(objLayer, 'text-align', objLayer['deformation']['text-align'], true);\r\n                        }else{\r\n                            objLayer = t.setVal(objLayer, 'text-align', 'inherit', true);\r\n                        }\r\n                    }else{\r\n                        if(jQuery.type(objLayer['text-align']) !== 'object'){\r\n                            objLayer = t.setVal(objLayer, 'text-align', objLayer['text-align'], true);\r\n                        }\r\n                    }\r\n\r\n\r\n                    //round position\r\n                    objLayer = t.setVal(objLayer, 'top', Math.round(t.getVal(objLayer, 'top')));\r\n                    objLayer = t.setVal(objLayer, 'left', Math.round(t.getVal(objLayer, 'left')));\r\n\r\n\r\n                    if(objLayer.x_start == undefined)\r\n                        objLayer.x_start = \"inherit\";\r\n\r\n                    if(objLayer.y_start == undefined)\r\n                        objLayer.y_start = \"inherit\";\r\n\r\n                    if(objLayer.z_start == undefined)\r\n                        objLayer.z_start = \"inherit\";\r\n\r\n                    if(objLayer.x_end == undefined)\r\n                        objLayer.x_end = \"inherit\";\r\n\r\n                    if(objLayer.y_end == undefined)\r\n                        objLayer.y_end = \"inherit\";\r\n\r\n                    if(objLayer.z_end == undefined)\r\n                        objLayer.z_end = \"inherit\";\r\n\r\n                    if(objLayer.opacity_start == undefined){\r\n                        if(isInit == false){\r\n                            objLayer.opacity_start = \"0\";\r\n                        }else{\r\n                            objLayer.opacity_start = \"inherit\";\r\n                        }\r\n                    }\r\n\r\n\r\n                    if(objLayer.opacity_end == undefined){\r\n                        if(isInit == false){\r\n                            objLayer.opacity_end = \"0\";\r\n                        }else{\r\n                            objLayer.opacity_end = \"inherit\";\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer.blurfilter_start == undefined){\r\n                        if(isInit == false){\r\n                            objLayer.blurfilter_start = \"0\";\r\n                        }else{\r\n                            objLayer.blurfilter_start = \"0\";\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer.blurfilter_end == undefined){\r\n                        if(isInit == false){\r\n                            objLayer.blurfilter_end = \"0\";\r\n                        }else{\r\n                            objLayer.blurfilter_end = \"0\";\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer.grayscalefilter_start == undefined){\r\n                        if(isInit == false){\r\n                            objLayer.grayscalefilter_start = \"0\";\r\n                        }else{\r\n                            objLayer.grayscalefilter_start = \"0\";\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer.grayscalefilter_end == undefined){\r\n                        if(isInit == false){\r\n                            objLayer.grayscalefilter_end = \"0\";\r\n                        }else{\r\n                            objLayer.grayscalefilter_end = \"0\";\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer.x_rotate_start == undefined)\r\n                        objLayer.x_rotate_start = \"inherit\";\r\n\r\n                    if(objLayer.y_rotate_start == undefined)\r\n                        objLayer.y_rotate_start = \"inherit\";\r\n\r\n                    if(objLayer.z_rotate_start == undefined)\r\n                        objLayer.z_rotate_start = \"inherit\";\r\n\r\n                    if(objLayer.x_rotate_end == undefined)\r\n                        objLayer.x_rotate_end = \"inherit\";\r\n\r\n                    if(objLayer.y_rotate_end == undefined)\r\n                        objLayer.y_rotate_end = \"inherit\";\r\n\r\n                    if(objLayer.z_rotate_end == undefined)\r\n                        objLayer.z_rotate_end = \"inherit\";\r\n\r\n                    if(objLayer.scale_x_start == undefined)\r\n                        objLayer.scale_x_start = \"inherit\";\r\n\r\n                    if(objLayer.scale_y_start == undefined)\r\n                        objLayer.scale_y_start = \"inherit\";\r\n\r\n                    if(objLayer.scale_x_end == undefined)\r\n                        objLayer.scale_x_end = \"inherit\";\r\n\r\n                    if(objLayer.scale_y_end == undefined)\r\n                        objLayer.scale_y_end = \"inherit\";\r\n\r\n                    if(objLayer.skew_x_start == undefined)\r\n                        objLayer.skew_x_start = \"inherit\";\r\n\r\n                    if(objLayer.skew_y_start == undefined)\r\n                        objLayer.skew_y_start = \"inherit\";\r\n\r\n                    if(objLayer.skew_x_end == undefined)\r\n                        objLayer.skew_x_end = \"inherit\";\r\n\r\n                    if(objLayer.skew_y_end == undefined)\r\n                        objLayer.skew_y_end = \"inherit\";\r\n\r\n\r\n                    if(objLayer.pers_start == undefined)\r\n                        objLayer.pers_start = \"inherit\";\r\n\r\n                    if(objLayer.pers_end == undefined)\r\n                        objLayer.pers_end = \"inherit\";\r\n\r\n\r\n                    // KRISZTAN  -  ( NEW LAYER GETS ADDED ) deformation part\r\n                    if(objLayer.deformation == undefined || jQuery.isEmptyObject(objLayer['deformation']))\r\n                        objLayer.deformation = {};\r\n\r\n                    if(objLayer['deformation']['font-family'] == undefined && (objLayer.type == 'text' || objLayer.type == 'button')){\r\n                        objLayer['deformation']['font-family'] = \"Open Sans\";\r\n                        sgfamilies.push('Open Sans');\r\n                    }else{\r\n                        if(objLayer['deformation']['font-family'] !== '' && sgfamilies.indexOf(objLayer['deformation']['font-family']) == -1){\r\n                            sgfamilies.push(objLayer['deformation']['font-family']);\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer['deformation']['font-style'] == undefined){\r\n                        objLayer['deformation']['font-style'] = 'normal'; // checkbox\r\n                    }\r\n\r\n                    if(objLayer['deformation']['color-transparency'] == undefined)\r\n                        objLayer['deformation']['color-transparency'] = 1;\r\n\r\n                    if(objLayer['deformation']['text-decoration'] == undefined)\r\n                        objLayer['deformation']['text-decoration'] = \"none\";\r\n\r\n                    if(objLayer['deformation']['vertical-align'] == undefined)\r\n                        objLayer['deformation']['vertical-align'] = \"top\";\r\n\r\n                    if(objLayer['deformation']['text-transform'] == undefined)\r\n                        objLayer['deformation']['text-transform'] = \"none\";\r\n\r\n                    if(objLayer['deformation']['background-color'] == undefined)\r\n                        objLayer['deformation']['background-color'] = \"transparent\";\r\n\r\n                    if(objLayer['deformation']['background-transparency'] == undefined)\r\n                        objLayer['deformation']['background-transparency'] = 1;\r\n\r\n                    if(objLayer['deformation']['border-color'] == undefined)\r\n                        objLayer['deformation']['border-color'] = \"transparent\";\r\n\r\n                    if(objLayer['deformation']['border-transparency'] == undefined)\r\n                        objLayer['deformation']['border-transparency'] = 1;\r\n\r\n                    if(objLayer['deformation']['border-style'] == undefined)\r\n                        objLayer['deformation']['border-style'] = \"none\";\r\n\r\n                    if(objLayer['deformation']['border-width'] == undefined)\r\n                        objLayer['deformation']['border-width'] = \"0\"\r\n\r\n                    if(objLayer['deformation']['border-width'] == undefined){\r\n                        var cur_bor = [];\r\n                        jQuery('input[name=\"css_border-width[]\"]').each(function(){\r\n                            cur_bor.push(0);\r\n                        });\r\n                        objLayer['deformation']['border-width'] = cur_bor; //4 []\r\n                    }else{ //fallback\r\n                        if(!jQuery.isArray(objLayer['deformation']['border-width'])){\r\n                            objLayer['deformation']['border-width'] = [objLayer['deformation']['border-width'],objLayer['deformation']['border-width'],objLayer['deformation']['border-width'],objLayer['deformation']['border-width']];\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer['deformation']['border-radius'] == undefined){\r\n                        var cur_bor = [];\r\n                        jQuery('input[name=\"css_border-radius[]\"]').each(function(){\r\n                            cur_bor.push(0);\r\n                        });\r\n                        objLayer['deformation']['border-radius'] = cur_bor; //4 []\r\n                    }\r\n\r\n                    if (objLayer.svg==undefined)\r\n                        objLayer.svg = {};\r\n\r\n                    if(objLayer.svg['svgstroke-color'] == undefined)\r\n                        objLayer.svg['svgstroke-color'] = \"transparent\";\r\n\r\n                    if(objLayer.svg['svgstroke-transparency'] == undefined)\r\n                        objLayer.svg['svgstroke-transparency'] = 1;\r\n\r\n                    if(objLayer.svg['svgstroke-dasharray'] == undefined)\r\n                        objLayer.svg['svgstroke-dasharray'] = \"0\";\r\n\r\n                    if(objLayer.svg['svgstroke-dashoffset'] == undefined)\r\n                        objLayer.svg['svgstroke-dashoffset'] = \"0\";\r\n\r\n                    if(objLayer.svg['svgstroke-width'] == undefined)\r\n                        objLayer.svg['svgstroke-width'] = \"0\"\r\n\r\n                    if(objLayer.svg['svgstroke-hover-color'] == undefined)\r\n                        objLayer.svg['svgstroke-hover-color'] = \"transparent\";\r\n\r\n                    if(objLayer.svg['svgstroke-hover-transparency'] == undefined)\r\n                        objLayer.svg['svgstroke-hover-transparency'] = 1;\r\n\r\n                    if(objLayer.svg['svgstroke-hover-dasharray'] == undefined)\r\n                        objLayer.svg['svgstroke-hover-dasharray'] = \"0\";\r\n\r\n                    if(objLayer.svg['svgstroke-hover-dashoffset'] == undefined)\r\n                        objLayer.svg['svgstroke-hover-dashoffset'] = \"0\";\r\n\r\n                    if(objLayer.svg['svgstroke-hover-width'] == undefined)\r\n                        objLayer.svg['svgstroke-hover-width'] = \"0\";\r\n\r\n                    if(objLayer['deformation']['x'] == undefined)\r\n                        objLayer['deformation']['x'] = 0;\r\n\r\n                    if(objLayer['deformation']['y'] == undefined)\r\n                        objLayer['deformation']['y'] = 0;\r\n\r\n                    if(objLayer['deformation']['z'] == undefined)\r\n                        objLayer['deformation']['z'] = 0;\r\n\r\n                    if(objLayer['deformation']['skewx'] == undefined)\r\n                        objLayer['deformation']['skewx'] = 0;\r\n\r\n                    if(objLayer['deformation']['skewy'] == undefined)\r\n                        objLayer['deformation']['skewy'] = 0;\r\n\r\n                    if(objLayer['deformation']['scalex'] == undefined)\r\n                        objLayer['deformation']['scalex'] = 1;\r\n\r\n                    if(objLayer['deformation']['scaley'] == undefined)\r\n                        objLayer['deformation']['scaley'] = 1;\r\n\r\n                    if(objLayer['deformation']['opacity'] == undefined)\r\n                        objLayer['deformation']['opacity'] = 1;\r\n\r\n                    if(objLayer['deformation']['xrotate'] == undefined)\r\n                        objLayer['deformation']['xrotate'] = 0;\r\n\r\n                    if(objLayer['deformation']['yrotate'] == undefined)\r\n                        objLayer['deformation']['yrotate'] = 0;\r\n\r\n                    if(objLayer['2d_rotation'] == undefined)\r\n                        objLayer['2d_rotation'] = 0;\r\n\r\n                    if(objLayer['deformation']['2d_origin_x'] == undefined)\r\n                        objLayer['deformation']['2d_origin_x'] = 50;\r\n\r\n                    if(objLayer['deformation']['2d_origin_y'] == undefined)\r\n                        objLayer['deformation']['2d_origin_y'] = 50;\r\n\r\n                    if(objLayer['deformation']['pers'] == undefined)\r\n                        objLayer['deformation']['pers'] = 600;\r\n\r\n                    if(objLayer['deformation']['corner_left'] == undefined)\r\n                        objLayer['deformation']['corner_left'] = 'nothing';\r\n\r\n                    if(objLayer['deformation']['corner_right'] == undefined)\r\n                        objLayer['deformation']['corner_right'] = 'nothing';\r\n\r\n                    if(objLayer['deformation']['parallax'] == undefined)\r\n                        objLayer['deformation']['parallax'] = '-';\r\n\r\n                    if (objLayer['deformation']['blurfilter'] == undefined) objLayer['deformation']['blurfilter'] = 0;\r\n                    if (objLayer['deformation']['grayscalefilter'] == undefined) objLayer['deformation']['grayscalefilter'] = 0;\r\n\r\n                    //deformation part end\r\n\r\n                    //deformation hover part start\r\n                    if(objLayer['deformation-hover'] == undefined || jQuery.isEmptyObject(objLayer['deformation-hover'])){\r\n                        objLayer['deformation-hover'] = {};\r\n                    }\r\n\r\n\r\n                    if (objLayer['deformation-hover']['blurfilter'] == undefined) objLayer['deformation-hover']['blurfilter'] = 0;\r\n                    if (objLayer['deformation-hover']['grayscalefilter'] == undefined) objLayer['deformation-hover']['grayscalefilter'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['color'] == undefined)\r\n                        objLayer['deformation-hover']['color'] = \"#ffffff\";\r\n\r\n                    if(objLayer['deformation-hover']['color-transparency'] == undefined)\r\n                        objLayer['deformation-hover']['color-transparency'] = \"1\";\r\n\r\n                    if(objLayer['deformation-hover']['text-decoration'] == undefined)\r\n                        objLayer['deformation-hover']['text-decoration'] = \"none\";\r\n\r\n                    if(objLayer['deformation-hover']['background-color'] == undefined)\r\n                        objLayer['deformation-hover']['background-color'] = \"transparent\";\r\n\r\n                    if(objLayer['deformation-hover']['background-transparency'] == undefined)\r\n                        objLayer['deformation-hover']['background-transparency'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['border-color'] == undefined)\r\n                        objLayer['deformation-hover']['border-color'] = \"transparent\";\r\n\r\n                    if(objLayer['deformation-hover']['border-transparency'] == undefined)\r\n                        objLayer['deformation-hover']['border-transparency'] = \"1\";\r\n\r\n                    if(objLayer['deformation-hover']['border-style'] == undefined)\r\n                        objLayer['deformation-hover']['border-style'] = \"none\";\r\n\r\n                    if(objLayer['deformation-hover']['border-width'] == undefined)\r\n                        objLayer['deformation-hover']['border-width'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['border-width'] == undefined){\r\n                        var cur_bor = [];\r\n                        jQuery('input[name=\"hover_css_border-width[]\"]').each(function(){\r\n                            cur_bor.push(0);\r\n                        });\r\n                        objLayer['deformation-hover']['border-width'] = cur_bor; //4 []\r\n                    }else{ //fallback\r\n                        if(!jQuery.isArray(objLayer['deformation-hover']['border-width'])){\r\n                            objLayer['deformation-hover']['border-width'] = [objLayer['deformation-hover']['border-width'],objLayer['deformation-hover']['border-width'],objLayer['deformation-hover']['border-width'],objLayer['deformation-hover']['border-width']];\r\n                        }\r\n                    }\r\n\r\n                    if(objLayer['deformation-hover']['border-radius'] == undefined){\r\n                        var cur_bor = [];\r\n                        jQuery('input[name=\"hover_css_border-radius[]\"]').each(function(){\r\n                            cur_bor.push(0);\r\n                        });\r\n                        objLayer['deformation-hover']['border-radius'] = cur_bor; //4 []\r\n                    }\r\n\r\n                    if (objLayer.svg != undefined) {\r\n                        if(objLayer.svg['svgstroke-hover-color'] == undefined)\r\n                            objLayer.svg['svgstroke-hover-color'] = \"transparent\";\r\n\r\n                        if(objLayer.svg['svgstroke-hover-transparency'] == undefined)\r\n                            objLayer.svg['svgstroke-hover-transparency'] = 1;\r\n\r\n                        if(objLayer.svg['svgstroke-hover-dasharray'] == undefined)\r\n                            objLayer.svg['svgstroke-hover-dasharray'] = \"0\";\r\n\r\n                        if(objLayer.svg['svgstroke-hover-dashoffset'] == undefined)\r\n                            objLayer.svg['svgstroke-hover-dashoffset'] = \"0\";\r\n\r\n                        if(objLayer.svg['svgstroke-hover-width'] == undefined)\r\n                            objLayer.svg['svgstroke-hover-width'] = \"0\"\r\n                    }\r\n\r\n                    if(objLayer['deformation-hover']['x'] == undefined)\r\n                        objLayer['deformation-hover']['x'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['y'] == undefined)\r\n                        objLayer['deformation-hover']['y'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['z'] == undefined)\r\n                        objLayer['deformation-hover']['z'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['skewx'] == undefined)\r\n                        objLayer['deformation-hover']['skewx'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['skewy'] == undefined)\r\n                        objLayer['deformation-hover']['skewy'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['scalex'] == undefined)\r\n                        objLayer['deformation-hover']['scalex'] = 1;\r\n\r\n                    if(objLayer['deformation-hover']['scaley'] == undefined)\r\n                        objLayer['deformation-hover']['scaley'] = 1;\r\n\r\n                    if(objLayer['deformation-hover']['opacity'] == undefined)\r\n                        objLayer['deformation-hover']['opacity'] = 1;\r\n\r\n                    if(objLayer['deformation-hover']['xrotate'] == undefined)\r\n                        objLayer['deformation-hover']['xrotate'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['yrotate'] == undefined)\r\n                        objLayer['deformation-hover']['yrotate'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['2d_rotation'] == undefined)\r\n                        objLayer['deformation-hover']['2d_rotation'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['2d_origin_x'] == undefined)\r\n                        objLayer['deformation-hover']['2d_origin_x'] = 50;\r\n\r\n                    if(objLayer['deformation-hover']['2d_origin_y'] == undefined)\r\n                        objLayer['deformation-hover']['2d_origin_y'] = 50;\r\n\r\n                    if(objLayer['deformation-hover']['speed'] == undefined)\r\n                        objLayer['deformation-hover']['speed'] = 0;\r\n\r\n                    if(objLayer['deformation-hover']['zindex'] == undefined)\r\n                        objLayer['deformation-hover']['zindex'] = \"auto\";\r\n\r\n                    if(objLayer['deformation-hover']['easing'] == undefined)\r\n                        objLayer['deformation-hover']['easing'] = 'Linear.easeNone';\r\n\r\n                    if(objLayer['deformation-hover']['css_cursor'] == undefined)\r\n                        objLayer['deformation-hover']['css_cursor'] = \"auto\";\r\n\t\t\r\n\t\tif(objLayer['deformation-hover']['pointer_events'] == undefined)\r\n\t\t\tobjLayer['deformation-hover']['pointer_events'] = \"auto\";\r\n                    //deformation hover part end\r\n\r\n                    if(objLayer['visible'] == undefined) objLayer['visible'] = true;\r\n\r\n                    if(objLayer.animation_overwrite == undefined)\r\n                        objLayer.animation_overwrite = 'wait';\r\n\r\n                    if(objLayer.trigger_memory == undefined)\r\n                        objLayer.trigger_memory = 'keep';\r\n\r\n                    objLayer.serial = id_counter;\r\n\r\n\r\n                    // HOOK FOR EXTERNAL ADDONS\r\n                    jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n\r\n                        var callback = callback_element[\"callback\"],\r\n                            env = callback_element[\"environment\"],\r\n                            env_sub = callback_element[\"function_position\"];\r\n\r\n                        if (env === \"add_layer_to_stage\" && env_sub==\"data_definition\")\r\n                            objLayer = callback(objLayer);\r\n                    });\r\n\r\n\r\n                    //add html\r\n\r\n                    objLayer.isDemo = isDemo;\r\n\r\n                    var htmlLayer = t.makeLayerHtml(id_counter,objLayer,isDemo);\r\n                    container.append(htmlLayer);\r\n\r\n                    objLayer.references = objLayer.references === undefined ? {} : objLayer.references;\r\n\r\n                    objLayer.references.htmlLayer = t.getHtmlLayerFromSerial(id_counter,isDemo);\r\n\r\n                    if(!isDemo){\r\n                        t.arrLayers[id_counter] = jQuery.extend({},objLayer);\r\n                    }else{\r\n                        t.arrLayersDemo[id_counter] = jQuery.extend({},objLayer);\r\n                    }\r\n\r\n\r\n                    //add layer to sortbox\r\n                    if(!isDemo) {\r\n                        u.addToSortbox(id_counter,objLayer);\r\n                        if (skipScroller!=true)\r\n                            u.timeLineTableDimensionUpdate();\r\n\r\n                    }\r\n\r\n\r\n                    if(objLayer['visible'] == false && !isDemo){\r\n                        u.hideLayer(objLayer);\r\n                    }\r\n\r\n\r\n                    //refresh draggables\r\n                    if(!isDemo)\r\n                        refreshEvents(id_counter);\r\n\r\n                    // UNDO / REDO FUNCTION \"Added Layer\"\r\n                    if (objLayer.createdOnInit===false) {\r\n                        if(!isDemo)\r\n                            t.arrLayers[id_counter].layer_unavailable = true;\r\n                        else\r\n                            t.arrLayersDemo[id_counter].layer_unavailable = true;\r\n\r\n                        t.cloneArrLayers();\r\n\r\n                        if(!isDemo)\r\n                            t.arrLayers[id_counter].layer_unavailable = false;\r\n                        else\r\n                            t.arrLayersDemo[id_counter].layer_unavailable = false;\r\n\r\n                        t.add_layer_change();\r\n                    }\r\n\r\n                    id_counter++;\r\n\r\n                    //enable \"delete all\" button, not event, but anyway :)\r\n                    jQuery(\"#button_delete_all\").removeClass(\"button-now-disabled\");\r\n                    u.rebuildLayerIdle(objLayer.references.htmlLayer,0,isDemo);\r\n\r\n\r\n                    //select the layer\r\n                    if(isInit == false && !isDemo){\r\n                        t.setLayerSelected(objLayer.serial);\r\n                        jQuery(\"#layer_text\").focus();\r\n                    }\r\n\r\n\r\n                    if(do_style_reset){ //trigger change event so that element gets first styles\r\n                        t.reset_to_default_static_styles(objLayer);\r\n                        // Reset Fields from Style Template\r\n                        updateSubStyleParameters(objLayer, true);\r\n                    }\r\n\r\n                    t.cloneArrLayers();\r\n\r\n                    u.timeLineTableDimensionUpdate();\r\n                    // CHANGE GROUP SORTS FOR LAYERS\r\n\r\n                    u.organiseGroupsAndLayer(false,false,true);\r\n                    // END OF GROUP SORTS\r\n\r\n                    return objLayer.serial;\r\n\r\n                }\r\n\r\n\r\n            /**\r\n             * delete all representation of some layer\r\n             */\r\n            t.deleteLayer = function(serial){\r\n\r\n                var objLayer = t.getLayer(serial);\r\n\r\n                objLayer.deleted = true;\r\n                forceShowHideLayer(objLayer,\"hide\")\r\n                t.add_layer_change();\r\n                u.timeLineTableDimensionUpdate();\r\n            }\r\n\r\n\r\n            /**\r\n             *\r\n             * call \"deleteLayer\" function with selected serial\r\n             */\r\n            var deleteCurrentLayer = function(){\r\n\r\n                if(t.selectedLayerSerial == -1) {\r\n                    return(false);\r\n                }\r\n\r\n                t.deleteLayer(t.selectedLayerSerial);\r\n\r\n                //set unselected\r\n                t.selectedLayerSerial = -1;\r\n\r\n                //clear form and disable buttons\r\n                disableFormFields();\r\n            }\r\n\r\n\r\n\r\n            /**\r\n             * call \"duplicateLayer\" function with selected serial\r\n             */\r\n            var duplicateLayerIntoNewGroup = function(obj) {\r\n                obj.order = undefined;\r\n                obj.time = undefined;\r\n                obj.createdOnInit = false;\r\n                unique_layer_id++;\r\n                obj.unique_id = unique_layer_id;\r\n                addLayer(obj, true);\r\n                u.timeLineTableDimensionUpdate();\r\n                return unique_layer_id;\r\n            }\r\n\r\n            var duplicateCurrentLayer = function(){\r\n                if(t.selectedLayerSerial == -1)\r\n                    return(false);\r\n\r\n                var obj = t.arrLayers[t.selectedLayerSerial];\r\n                var obj2 = UniteAdminRev.duplicateObject(obj);\r\n\r\n                obj2 = t.setVal(obj2, 'left', t.getVal(obj2, 'left')+5);\r\n                obj2 = t.setVal(obj2, 'top', t.getVal(obj2, 'top')+5);\r\n                obj2.order = undefined;\r\n                obj2.time = undefined;\r\n                obj2.createdOnInit = false;\r\n\r\n                //unique_id change as the true in addLayer is not triggering this\r\n                unique_layer_id++;\r\n                obj2.unique_id = unique_layer_id;\r\n\r\n                if (obj2.groupOrder!==undefined && obj2.type===\"row\")\r\n                    obj2.groupOrder = t.getHighestGroupOrder(t.getVal(obj2, 'align_vert'));\r\n\r\n                addLayer(obj2, true);\r\n                initDisallowCaptionsOnClick();\r\n                u.timeLineTableDimensionUpdate();\r\n\r\n                // DUPLICATE GROUP\r\n                if ((obj.type===\"group\") && t.getLayersInGroup(obj.unique_id).layers.length>0) {\r\n                    jQuery.each(t.getLayersInGroup(obj.unique_id).layers,function(j,layer) {\r\n                        var newobj = UniteAdminRev.duplicateObject(layer);\r\n                        newobj.p_uid = obj2.unique_id;\r\n                        duplicateLayerIntoNewGroup(newobj);\r\n                    });\r\n                    t.makeRowSortableDroppable();\r\n                }\r\n\r\n                // DUPLICATE COLUMN\r\n                if ((obj.type===\"row\") && t.getLayersInGroup(obj.unique_id).layers.length>0) {\r\n                    jQuery.each(t.getLayersInGroup(obj.unique_id).columns,function(j,column) {\r\n                        var newcolumn = UniteAdminRev.duplicateObject(column);\r\n                        newcolumn.p_uid = obj2.unique_id;\r\n                        newcolumn.ref_group = obj2.unique_id;\r\n                        var column_uid = duplicateLayerIntoNewGroup(newcolumn);\r\n                        jQuery.each(t.getLayersInGroup(column.unique_id).layers,function(j,layer) {\r\n                            var newobj = UniteAdminRev.duplicateObject(layer);\r\n                            newobj.p_uid = column_uid;\r\n                            duplicateLayerIntoNewGroup(newobj);\r\n                        });\r\n                    });\r\n                    t.makeRowSortableDroppable();\r\n                }\r\n\r\n\r\n                var key;\r\n                jQuery.each(t.getLayers(),function(k,layer) {\r\n                    key = k;\r\n                });\r\n\r\n                t.setLayerSelected(key);\r\n                if (obj2.p_uid!==-1 && t.getObjLayerType(obj2.p_uid)!==\"group\")\r\n                    t.setInnerGroupOrders(obj2.references.htmlLayer.parent());\r\n            }\r\n\r\n\r\n\r\n            /**\r\n             * update the corners\r\n             */\r\n            t.updateHtmlLayerCorners = function(objLayer){\r\n\r\n                htmlLayer = jQuery(objLayer.references.htmlLayer[0].getElementsByClassName('innerslide_layer')[0]);\r\n\r\n                var ncch = htmlLayer.outerHeight(),\r\n                    bgcol = htmlLayer.css('backgroundColor'),\r\n                    bgOpacity = UniteAdminRev.getTransparencyFromRgba(htmlLayer.css('backgroundColor'));\r\n                bgOpacity = bgOpacity === false ? 1 : bgOpacity;\r\n\r\n                htmlLayer.find('.frontcorner').remove();\r\n                htmlLayer.find('.frontcornertop').remove();\r\n                htmlLayer.find('.backcorner').remove();\r\n                htmlLayer.find('.backcornertop').remove();\r\n\r\n\r\n                if (objLayer==undefined || objLayer==false) return false;\r\n                switch(objLayer['deformation']['corner_left']){\r\n                    case \"curved\":\r\n\r\n                        htmlLayer.append(\"<div class='frontcorner'></div>\");\r\n                        break;\r\n                    case \"reverced\":\r\n                        htmlLayer.append(\"<div class='frontcornertop'></div>\");\r\n                        break;\r\n                }\r\n\r\n                switch(objLayer['deformation']['corner_right']){\r\n                    case \"curved\":\r\n                        htmlLayer.append(\"<div class='backcorner'></div>\");\r\n                        break;\r\n                    case \"reverced\":\r\n                        htmlLayer.append(\"<div class='backcornertop'></div>\");\r\n                        break;\r\n                }\r\n\r\n\r\n                htmlLayer.find(\".frontcorner\").css({\r\n                    'borderWidth':ncch+\"px\",\r\n                    'left':(0-ncch)+'px',\r\n                    'borderRight':'0px solid transparent',\r\n                    'borderTopColor':bgcol\r\n                });\r\n\r\n                htmlLayer.find(\".frontcornertop\").css({\r\n                    'borderWidth':ncch+\"px\",\r\n                    'left':(0-ncch)+'px',\r\n                    'borderRight':'0px solid transparent',\r\n                    'borderBottomColor':bgcol\r\n                });\r\n\r\n                htmlLayer.find('.backcorner').css({\r\n                    'borderWidth':ncch+\"px\",\r\n                    'right':(0-ncch)+'px',\r\n                    'borderLeft':'0px solid transparent',\r\n                    'borderBottomColor':bgcol\r\n                });\r\n\r\n                htmlLayer.find('.backcornertop').css({\r\n                    'borderWidth':ncch+\"px\",\r\n                    'right':(0-ncch)+'px',\r\n                    'borderLeft':'0px solid transparent',\r\n                    'borderTopColor':bgcol\r\n                });\r\n            }\r\n\r\n\r\n            // DELIVER THE SELECTED JQUERY OBJECT BASED ON SERIAL\r\n            var getjQueryLayer = function() {\r\n                return jQuery('#slide_layer_'+t.selectedLayerSerial);\r\n            }\r\n\r\n\r\n\r\n\r\n            // UPDATE LAYER TEXT ON WRITE && UPDATE TITLE OF LAYER\r\n            var updateLayerTextField = function(event,timerobj,txt) {\r\n                var jobj = getjQueryLayer();\r\n\r\n                if (t.selectedLayerSerial!=-1 && jobj.length>0) jobj[0].getElementsByClassName('innerslide_layer')[0].innerHTML = txt;\r\n                var li = timerobj.closest(\"li\");\r\n                txt = u.getSortboxText(txt);\r\n                if (li!=undefined) li[0].getElementsByClassName('timer-layer-text')[0].innerHTML = txt;\r\n            }\r\n\r\n            /**\r\n             * update the position of html cross\r\n             */\r\n            t.updateCrossIconPosition = function(objLayer){\r\n\r\n                var htmlCross = jQuery(objLayer.references.htmlLayer[0].getElementsByClassName(\"icon_cross\")[0]);\r\n                var crossWidth = htmlCross.width();\r\n                var crossHeight = htmlCross.height();\r\n                var totalWidth = objLayer.references.htmlLayer.outerWidth();\r\n                var totalHeight = objLayer.references.htmlLayer.outerHeight();\r\n                var crossHalfW = Math.round(crossWidth / 2);\r\n                var crossHalfH = Math.round(crossHeight / 2);\r\n\r\n                var posx = 0;\r\n                var posy = 0;\r\n                switch(t.getVal(objLayer, 'align_hor')){\r\n                    case \"left\":\r\n                        posx = - crossHalfW;\r\n                        break;\r\n                    case \"center\":\r\n                        posx = (totalWidth - crossWidth) / 2;\r\n                        break;\r\n                    case \"right\":\r\n                        posx = totalWidth - crossHalfW;\r\n                        break;\r\n                }\r\n\r\n                switch(t.getVal(objLayer, 'align_vert')){\r\n                    case \"top\":\r\n                        posy = - crossHalfH;\r\n                        break;\r\n                    case \"middle\":\r\n                        posy = (totalHeight - crossHeight) / 2;\r\n                        break;\r\n                    case \"bottom\":\r\n                        posy = totalHeight - crossHalfH;\r\n                        break;\r\n                }\r\n\r\n                htmlCross.css({\"left\":posx+\"px\",\"top\":posy+\"px\"});\r\n\r\n            }\r\n\r\n\r\n\r\n\r\n            /**\r\n             * check / update full width video position and size\r\n             */\r\n            var checkUpdateFullwidthVideo = function(objLayer){\r\n\r\n                if(objLayer.type != \"video\") {\r\n                    return(objLayer);\r\n                }\r\n\r\n                if(typeof (objLayer.video_data) !== \"undefined\"){\r\n                    if(objLayer.video_data && objLayer.video_data.fullwidth && objLayer.video_data.fullwidth == true){\r\n\r\n                        objLayer = t.setVal(objLayer, 'top', 0);\r\n                        objLayer = t.setVal(objLayer, 'left', 0);\r\n\r\n                        objLayer = t.setVal(objLayer, 'align_hor', 'left', true);\r\n                        objLayer = t.setVal(objLayer, 'align_vert', 'top', true);\r\n                        objLayer.video_width = container.width();\r\n                        objLayer.video_height = container.height();\r\n                    }\r\n                }\r\n                return(objLayer);\r\n            }\r\n\r\n            /*! UPDATE HTML LAYER */\r\n            /**\r\n             * update html layers from object\r\n             */\r\n            var updateHtmlLayersFromObject = function(serial,posresets,isDemo){\r\n\r\n                if(!serial) serial = t.selectedLayerSerial;\r\n\r\n                var objLayer = t.getLayer(serial, isDemo);\r\n\r\n                if(!objLayer) return(false);\r\n\r\n                var htmlLayer = objLayer.references.htmlLayer;\r\n\r\n                //set class name\r\n                var className = \"innerslide_layer tp-caption\";\r\n                if(serial == t.selectedLayerSerial) {\r\n                    htmlLayer.addClass(\"layer_selected\");\r\n                    htmlLayer.closest('.slide_layer_type_row').addClass('layerchild_selected');\r\n                    htmlLayer.closest('.slide_layer_type_column').addClass('layerchild_selected');\r\n                }\r\n\r\n                className += \" \"+objLayer.style;\r\n\r\n                switch(objLayer.type){\r\n                    case 'button':\r\n                    case 'shape':\r\n                        className += ' '+objLayer.internal_class;\r\n                        break;\r\n                }\r\n\r\n                htmlLayer[0].getElementsByClassName('innerslide_layer')[0].className = className;\r\n\r\n\r\n                //set html\r\n                var type = objLayer.type || \"text\";\r\n\r\n                //update layer by type:\r\n                switch(type){\r\n                    case \"image\":\r\n                        break;\r\n                    case \"video\":\t//update fullwidth position\r\n                        objLayer = checkUpdateFullwidthVideo(objLayer);\r\n                        break;\r\n                    case \"row\":\r\n                        break;\r\n                    case \"group\":\r\n                        break;\r\n                    case \"column\":\r\n                        break;\r\n                    default:\r\n                    case \"text\":\r\n                    case \"button\":\r\n                        htmlLayer[0].getElementsByClassName('innerslide_layer')[0].innerHTML = objLayer.text;\r\n                        t.makeCurrentLayerRotatable(serial);\r\n                        t.updateHtmlLayerCorners(objLayer);\r\n                        break;\r\n                    case \"svg\":\r\n                        objLayer.svg.renderedData = htmlLayer[0].getElementsByClassName('innerslide_layer')[0].innerHTML;\r\n                        t.makeCurrentLayerRotatable(serial);\r\n                        break;\r\n                    case 'audio':\r\n                        break;\r\n                }\r\n\r\n                u.rebuildLayerIdle(getjQueryLayer());\r\n            }\r\n\r\n            // MAKE THINGS ROTATABLE\r\n            t.makeCurrentLayerRotatable = function(serial) {\r\n\r\n                if (u.checkLoopTab() || u.checkAnimationTab()) {\r\n                    t.removeCurrentLayerRotatable();\r\n                    return false;\r\n                }\r\n\r\n                var el = document.getElementsByClassName('slide_layer layer_selected')[0];\r\n                el = el!=undefined ? jQuery(el.getElementsByClassName('innerslide_layer')[0]) : el;\r\n\r\n\r\n                if (el!=undefined && el!==null && el.length>0) {\r\n                    try{el.rotatable(\"destroy\");}\r\n                    catch(e) {}\r\n                    el.rotatable({\r\n                        angle:el.data('angle'),\r\n                        start:function(event,ui) {\r\n                        },\r\n                        rotate:function(event,ui) {\r\n                            jQuery('#layer_2d_rotation').val(getRotationDegrees(ui.element));\r\n                            ui.element.data('angle',ui.angle.current);\r\n                        },\r\n                        stop:function(event,ui) {\r\n                            t.updateLayerFromFields();\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            t.removeCurrentLayerRotatable = function() {\r\n\r\n                jQuery('.slide_layer .ui-rotatable-handle').each(function() {\r\n                    var el = jQuery(this);\r\n                    setTimeout(function() {\r\n                        try{el.parent().rotatable(\"destroy\");} catch(e) {}\r\n                        try{el.remove();} catch(e) {}\r\n                        try{el.parent().find('.ui-rotatable-handle').remove();} catch(e) {}\r\n                    },50);\r\n                })\r\n            }\r\n\r\n\r\n            /**\r\n             THE CHANGE OF POSITION FIELD TRIGGERS THE REPOSITIONINNG OF THE LAYER\r\n             **/\r\n            var positionChanged = function(force) {\r\n                jQuery(\"#layer_top, #layer_left\").change(function() {\r\n                    setTimeout(function() {\r\n                        updateHtmlLayersFromObject(t.getSerialFromID(jQuery('.layer_selected').attr('id')),true);\r\n                    },19);\r\n                });\r\n            }\r\n\r\n            var positionChanged_Core = function() {\r\n                try {\r\n                    jQuery.each(t.arrLayers,function(i,layer) {\r\n                        try {\r\n                            t.updateHtmlLayerPosition(false,layer,t.getVal(layer, 'top'),t.getVal(layer, 'left'),t.getVal(layer,'align_hor'),t.getVal(layer,'align_vert'));\r\n                        }  catch(e) {\r\n                            console.log(\"Position Changed Core Internal Function Error:\");\r\n                            console.log(e);\r\n                        }\r\n                    });\r\n                } catch(e) {\r\n                    console.log(\"Position Changed Core Function Error:\");\r\n                    console.log(e);\r\n                }\r\n            }\r\n\r\n\r\n            t.set_cover_mode = function(){\r\n                var objLayer = t.getLayer(t.selectedLayerSerial);\r\n\r\n                jQuery('#layer_scaleX').prop(\"disabled\",false);\r\n                jQuery('#layer_scaleY').prop(\"disabled\",false);\r\n                jQuery('#layer_max_width').prop(\"disabled\",false);\r\n                jQuery('#layer_max_height').prop(\"disabled\",false);\r\n\r\n                switch(objLayer.type) {\r\n                    case 'shape':\r\n                    case 'image':\r\n                        switch(jQuery('#layer_cover_mode option:selected').val()){\r\n                            case 'custom':\r\n                                //already removed disable\r\n                                break;\r\n                            case 'fullwidth':\r\n                                jQuery('#layer_scaleX').attr('disabled', 'disabled');\r\n                                jQuery('#layer_max_width').attr('disabled', 'disabled');\r\n                                break;\r\n                            case 'fullheight':\r\n                                jQuery('#layer_scaleY').attr('disabled', 'disabled');\r\n                                jQuery('#layer_max_height').attr('disabled', 'disabled');\r\n                                break;\r\n                            case 'cover':\r\n                            case 'cover-proportional':\r\n                                jQuery('#layer_scaleX').attr('disabled', 'disabled');\r\n                                jQuery('#layer_scaleY').attr('disabled', 'disabled');\r\n                                jQuery('#layer_max_width').attr('disabled', 'disabled');\r\n                                jQuery('#layer_max_height').attr('disabled', 'disabled');\r\n                        }\r\n                        break;\r\n                    default:\r\n                }\r\n            }\r\n\r\n            /**\r\n             * IF ONLY X/Y VALUE CHANGED BASED ON KEY UP'S, SHOULD BE A QUICKER MOVEMENT AVAILABLE\r\n             */\r\n            t.updateCurrentLayerPosition = function() {\r\n                var objUpdate = {};\r\n                objUpdate = t.setVal(objUpdate, 'top', Number(parseInt(jQuery(\"#layer_top\").val(),0)));\r\n                objUpdate = t.setVal(objUpdate, 'left', Number(parseInt(jQuery(\"#layer_left\").val(),0)));\r\n                t.updateCurrentLayer(objUpdate);\r\n                u.rebuildLayerIdle(jQuery('.slide_layer.layer_selected'));\r\n            }\r\n\r\n            /**\r\n             * update layer from html fields\r\n             */\r\n\r\n            t.updateLayerFromFields = function() {\r\n                //clearTimeout(t.ulff_core);\r\n                //t.ulff_core = setTimeout(function() {\r\n\r\n                t.updateLayerFromFields_Core();\r\n\r\n                //},350);\r\n            }\r\n\r\n            t.updateLayerFromFields_Core = function(){\r\n\r\n                var objUpdate = {};\r\n\r\n                // HOOK FOR EXTERNAL ADDONS\r\n                jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n                    var callback = callback_element[\"callback\"],\r\n                        env = callback_element[\"environment\"],\r\n                        env_sub = callback_element[\"function_position\"];\r\n                    if (env === \"updateLayerFromFields_Core\" && env_sub==\"start\")\r\n                        objUpdate = callback(objUpdate);\r\n\r\n                });\r\n\r\n\r\n                if(t.selectedLayerSerial == -1) return(false);\r\n                UniteCssEditorRev.compare_to_original(); //compare style changes and mark elements depending on state\r\n\r\n\r\n                objUpdate.style = document.getElementById(\"layer_caption\").value;\r\n                objUpdate['hover'] = document.getElementById(\"hover_allow\").checked;\r\n                //objUpdate['force_hover'] = document.getElementById(\"force_hover\").checked;\r\n\r\n                objUpdate['toggle'] = document.getElementById(\"toggle_allow\").checked;\r\n\r\n                objUpdate['toggle_use_hover'] = document.getElementById(\"toggle_use_hover\").checked;\r\n                objUpdate['toggle_inverse_content'] = document.getElementById(\"toggle_inverse_content\").checked;\r\n\r\n                objUpdate['visible-desktop'] = document.getElementById(\"visible-desktop\").checked;\r\n                objUpdate['visible-notebook'] = document.getElementById(\"visible-notebook\").checked;\r\n                objUpdate['visible-tablet'] = document.getElementById(\"visible-tablet\").checked;\r\n                objUpdate['visible-mobile'] = document.getElementById(\"visible-mobile\").checked;\r\n\r\n                objUpdate['show-on-hover'] = document.getElementById(\"layer_on_slider_hover\").checked;\r\n\r\n                objUpdate['css-position'] = jQuery(\"#layer-css-position option:selected\").val();\r\n\r\n                objUpdate['lazy-load'] = jQuery('#layer-lazy-loading option:selected').val();\r\n                objUpdate['image-size'] = jQuery('#layer-image-size option:selected').val();\r\n\r\n                objUpdate.text = document.getElementById(\"layer_text\").value;\r\n                objUpdate.texttoggle = document.getElementById(\"layer_text_toggle\").value || \"\";\r\n\r\n                objUpdate.alias = jQuery('#layer_sort_'+t.selectedLayerSerial+\">.layer_sort_inner_wrapper .timer-layer-text\").val();\r\n\r\n                // IF NEW CONTENT IS EDITED FIRST TIME, USE THE SAME CONTENT FOR LAYER DESCRIPTION\r\n                if (jQuery('#layer_text').data('new_content'))\r\n                    jQuery('#layer_sort_'+t.selectedLayerSerial+\">.layer_sort_inner_wrapper .timer-layer-text\").val(objUpdate.text);\r\n\r\n\r\n                jQuery('#layer_quicksort_'+t.selectedLayerSerial+\" .layer-title-in-list\").val(objUpdate.alias);\r\n                jQuery('#the_current-editing-layer-title').val(objUpdate.alias);\r\n                jQuery('#layer-short-toolbar').data('serial',t.selectedLayerSerial)\r\n\r\n\r\n                objUpdate = t.setVal(objUpdate, 'top', Number(parseInt(document.getElementById(\"layer_top\").value,0)));\r\n                objUpdate = t.setVal(objUpdate, 'left', Number(parseInt(document.getElementById(\"layer_left\").value,0)));\r\n\r\n\r\n                objUpdate = t.setVal(objUpdate, 'whitespace', jQuery(\"#layer_whitespace option:selected\").val());\r\n                objUpdate = t.setVal(objUpdate, 'display', jQuery(\"#layer_display option:selected\").val());\r\n                objUpdate = t.setVal(objUpdate, 'max_height', document.getElementById(\"layer_max_height\").value);\r\n                objUpdate = t.setVal(objUpdate, 'min_height', document.getElementById(\"layer_min_height\").value);\r\n                objUpdate = t.setVal(objUpdate, 'max_width', document.getElementById(\"layer_max_width\").value);\r\n\r\n                objUpdate = t.setVal(objUpdate, 'video_height', document.getElementById(\"layer_video_height\").value);\r\n                objUpdate = t.setVal(objUpdate, 'video_width', document.getElementById(\"layer_video_width\").value);\r\n\r\n\r\n                objUpdate = t.setVal(objUpdate, 'scaleX', document.getElementById(\"layer_scaleX\").value);\r\n                objUpdate = t.setVal(objUpdate, 'scaleY', document.getElementById(\"layer_scaleY\").value);\r\n\r\n                objUpdate = t.setVal(objUpdate, 'cover_mode', jQuery(\"#layer_cover_mode option:selected\").val());\r\n\r\n                objUpdate['2d_rotation'] =  parseInt(document.getElementById(\"layer_2d_rotation\").value,0);\r\n\r\n                objUpdate['2d_origin_x'] =  parseInt(document.getElementById(\"layer_2d_origin_x\").value,0);\r\n                objUpdate['2d_origin_y'] =  parseInt(document.getElementById(\"layer_2d_origin_y\").value,0);\r\n                objUpdate['static_start'] = jQuery(\"#layer_static_start option:selected\").val();\r\n                objUpdate['static_end'] = jQuery(\"#layer_static_end option:selected\").val();\r\n\r\n                objUpdate.layer_bg_position = jQuery(\"#layer_bg_position option:selected\").val();\r\n                objUpdate.layer_bg_size = jQuery(\"#layer_bg_size option:selected\").val();\r\n                objUpdate.layer_bg_repeat = jQuery(\"#layer_bg_repeat option:selected\").val();\r\n\r\n                //set Loop Animations\r\n                objUpdate.loop_animation = jQuery(\"#layer_loop_animation option:selected\").val();\r\n                objUpdate.loop_easing = document.getElementById(\"layer_loop_easing\").value;\r\n                objUpdate.loop_speed = document.getElementById(\"layer_loop_speed\").value;\r\n                objUpdate.loop_startdeg =  parseInt(document.getElementById(\"layer_loop_startdeg\").value,0);\r\n                objUpdate.loop_enddeg =  parseInt(document.getElementById(\"layer_loop_enddeg\").value,0);\r\n                objUpdate.loop_xorigin =  parseInt(document.getElementById(\"layer_loop_xorigin\").value,0);\r\n                objUpdate.loop_yorigin =  parseInt(document.getElementById(\"layer_loop_yorigin\").value,0);\r\n                objUpdate.loop_xstart =  parseInt(document.getElementById(\"layer_loop_xstart\").value,0);\r\n                objUpdate.loop_xend =  parseInt(document.getElementById(\"layer_loop_xend\").value,0);\r\n                objUpdate.loop_ystart =  parseInt(document.getElementById(\"layer_loop_ystart\").value,0);\r\n                objUpdate.loop_yend =  parseInt(document.getElementById(\"layer_loop_yend\").value,0);\r\n                objUpdate.loop_zoomstart = document.getElementById(\"layer_loop_zoomstart\").value;\r\n                objUpdate.loop_zoomend = document.getElementById(\"layer_loop_zoomend\").value;\r\n                objUpdate.loop_angle = document.getElementById(\"layer_loop_angle\").value;\r\n                objUpdate.loop_radius = document.getElementById(\"layer_loop_radius\").value;\r\n\r\n                objUpdate.html_tag = jQuery(\"#layer_html_tag option:selected\").val();\r\n                objUpdate.parallax_layer_ddd_zlevel = jQuery(\"#parallax_layer_ddd_zlevel option:selected\").val();\r\n\r\n                var layer = t.getHtmlLayerFromSerial(t.selectedLayerSerial);\r\n\r\n                if (document.getElementById(\"layer__scalex\").value!=1 || document.getElementById(\"layer__scaley\").value!=1 || parseInt(document.getElementById(\"layer__skewx\").value,0)!=0 || parseInt(document.getElementById(\"layer__skewy\").value,0)!=0 || parseInt(document.getElementById(\"layer__xrotate\").value,0)!=0 || parseInt(document.getElementById(\"layer__yrotate\").value,0)!=0 || parseInt(document.getElementById(\"layer_2d_rotation\").value,0)!=0) {\r\n                    jQuery(document.getElementsByClassName('mask-not-available')[0]).show();\r\n                    jQuery(document.getElementsByClassName('mask-is-available')[0]).hide();\r\n                    document.getElementById('masking-start').removeAttribute(\"checked\");\r\n                    document.getElementById('masking-end').removeAttribute(\"checked\");\r\n                    jQuery(document.getElementsByClassName('mask-start-settings')[0]).hide();\r\n                    jQuery(document.getElementsByClassName('mask-end-settings')[0]).hide();\r\n                    jQuery('.tp-showmask').removeClass('tp-showmask');\r\n                    RevSliderSettings.onoffStatus(jQuery('#masking-start'));\r\n                    RevSliderSettings.onoffStatus(jQuery('#masking-end'));\r\n                    layer.find('.tp-mask-wrap').css({overflow:\"visible\"});\r\n                } else {\r\n                    jQuery(document.getElementsByClassName('mask-not-available')[0]).hide();\r\n                    jQuery(document.getElementsByClassName('mask-is-available')[0]).show();\r\n                }\r\n\r\n                //set Mask Animations\r\n                objUpdate.mask_start = document.getElementById(\"masking-start\").checked;\r\n                objUpdate.mask_end = document.getElementById(\"masking-end\").checked;\r\n                objUpdate.mask_x_start = document.getElementById(\"mask_anim_xstart\").value;\r\n                objUpdate.mask_y_start =  document.getElementById(\"mask_anim_ystart\").value;\r\n                objUpdate.mask_x_end =  document.getElementById(\"mask_anim_xend\").value;\r\n                objUpdate.mask_y_end = document.getElementById(\"mask_anim_yend\").value;\r\n\r\n\r\n                objUpdate = t.setVal(objUpdate, 'align_hor', document.getElementById(\"layer_align_hor\").value);\r\n                objUpdate = t.setVal(objUpdate, 'align_vert', document.getElementById(\"layer_align_vert\").value);\r\n\r\n                objUpdate.hiddenunder = document.getElementById(\"layer_hidden\").checked;\r\n                objUpdate.resizeme = document.getElementById(\"layer_resizeme\").checked;\r\n                objUpdate['resize-full'] = document.getElementById(\"layer_resize-full\").checked;\r\n\r\n                objUpdate.basealign = document.getElementById(\"layer_align_base\").value;\r\n                objUpdate.responsive_offset = document.getElementById(\"layer_resp_offset\").checked;\r\n\r\n                objUpdate.frames={};\r\n                objUpdate.frames.frame_0 = {};\r\n                objUpdate.frames.frame_999 = {};\r\n\r\n                objUpdate.frames[\"frame_0\"].animation = jQuery(\"#layer_animation option:selected\").val();\r\n                objUpdate.frames[\"frame_0\"].speed = document.getElementById(\"layer_speed\").value;\r\n                objUpdate.frames[\"frame_0\"].easing = document.getElementById(\"layer_easing\").value;\r\n                objUpdate.frames[\"frame_0\"].split = document.getElementById(\"layer_split\").value;\r\n                objUpdate.frames[\"frame_0\"].splitdelay = document.getElementById(\"layer_splitdelay\").value;\r\n\r\n                objUpdate.frames[\"frame_999\"].split = document.getElementById(\"layer_endsplit\").value;\r\n                objUpdate.frames[\"frame_999\"].splitdelay = document.getElementById(\"layer_endsplitdelay\").value;\r\n                objUpdate.frames[\"frame_999\"].animation = document.getElementById(\"layer_endanimation\").value;\r\n                objUpdate.frames[\"frame_999\"].speed = document.getElementById(\"layer_endspeed\").value;\r\n                objUpdate.frames[\"frame_999\"].easing = document.getElementById(\"layer_endeasing\").value;\r\n\r\n                objUpdate.alt_option = jQuery(\"#layer_alt_option option:selected\").val();\r\n                objUpdate.alt = document.getElementById(\"layer_alt\").value;\r\n                objUpdate = t.setVal(objUpdate, 'scaleX', jQuery(\"#layer_scaleX\").val());\r\n                objUpdate = t.setVal(objUpdate, 'scaleY', jQuery(\"#layer_scaleY\").val());\r\n\r\n                objUpdate.x_start =  document.getElementById(\"layer_anim_xstart\").value;\r\n                objUpdate.y_start =  document.getElementById(\"layer_anim_ystart\").value;\r\n                objUpdate.z_start =  document.getElementById(\"layer_anim_zstart\").value;\r\n                objUpdate.x_end =  document.getElementById(\"layer_anim_xend\").value;\r\n                objUpdate.y_end =  document.getElementById(\"layer_anim_yend\").value;\r\n                objUpdate.z_end =  document.getElementById(\"layer_anim_zend\").value;\r\n                objUpdate.opacity_start = document.getElementById(\"layer_opacity_start\").value;\r\n                objUpdate.opacity_end = document.getElementById(\"layer_opacity_end\").value;\r\n                objUpdate.blurfilter_start = document.getElementById(\"blurfilter_start\").value;\r\n                objUpdate.blurfilter_end = document.getElementById(\"blurfilter_end\").value;\r\n                objUpdate.grayscalefilter_start = document.getElementById(\"grayscalefilter_start\").value;\r\n                objUpdate.grayscalefilter_end = document.getElementById(\"grayscalefilter_end\").value;\r\n                objUpdate.x_rotate_start =  document.getElementById(\"layer_anim_xrotate\").value;\r\n                objUpdate.y_rotate_start =  document.getElementById(\"layer_anim_yrotate\").value;\r\n                objUpdate.z_rotate_start =  document.getElementById(\"layer_anim_zrotate\").value;\r\n                objUpdate.x_rotate_end =  document.getElementById(\"layer_anim_xrotate_end\").value;\r\n                objUpdate.y_rotate_end =  document.getElementById(\"layer_anim_yrotate_end\").value;\r\n                objUpdate.z_rotate_end =  document.getElementById(\"layer_anim_zrotate_end\").value;\r\n                objUpdate.scale_x_start = document.getElementById(\"layer_scale_xstart\").value;\r\n                objUpdate.scale_y_start = document.getElementById(\"layer_scale_ystart\").value;\r\n                objUpdate.scale_x_end = document.getElementById(\"layer_scale_xend\").value;\r\n                objUpdate.scale_y_end = document.getElementById(\"layer_scale_yend\").value;\r\n                objUpdate.skew_x_start = document.getElementById(\"layer_skew_xstart\").value;\r\n                objUpdate.skew_y_start = document.getElementById(\"layer_skew_ystart\").value;\r\n                objUpdate.skew_x_end = document.getElementById(\"layer_skew_xend\").value;\r\n                objUpdate.skew_y_end = document.getElementById(\"layer_skew_yend\").value;\r\n\r\n                objUpdate.x_start_reverse =  document.getElementById('layer_anim_xstart_reverse').checked || false;\r\n                objUpdate.y_start_reverse =  document.getElementById('layer_anim_ystart_reverse').checked || false;\r\n                objUpdate.x_end_reverse =  document.getElementById('layer_anim_xend_reverse').checked || false;\r\n                objUpdate.y_end_reverse =  document.getElementById('layer_anim_yend_reverse').checked || false;\r\n                objUpdate.x_rotate_start_reverse =  document.getElementById('layer_anim_xrotate_reverse').checked || false;\r\n                objUpdate.y_rotate_start_reverse =  document.getElementById('layer_anim_yrotate_reverse').checked || false;\r\n                objUpdate.z_rotate_start_reverse =  document.getElementById('layer_anim_zrotate_reverse').checked || false;\r\n                objUpdate.x_rotate_end_reverse =  document.getElementById('layer_anim_xrotate_end_reverse').checked || false;\r\n                objUpdate.y_rotate_end_reverse =  document.getElementById('layer_anim_yrotate_end_reverse').checked || false;\r\n                objUpdate.z_rotate_end_reverse =  document.getElementById('layer_anim_zrotate_end_reverse').checked || false;\r\n                objUpdate.scale_x_start_reverse = document.getElementById('layer_scale_xstart_reverse').checked || false;\r\n                objUpdate.scale_y_start_reverse = document.getElementById('layer_scale_ystart_reverse').checked || false;\r\n                objUpdate.scale_x_end_reverse = document.getElementById('layer_scale_xend_reverse').checked || false;\r\n                objUpdate.scale_y_end_reverse = document.getElementById('layer_scale_yend_reverse').checked || false;\r\n                objUpdate.skew_x_start_reverse = document.getElementById('layer_skew_xstart_reverse').checked || false;\r\n                objUpdate.skew_y_start_reverse = document.getElementById('layer_skew_ystart_reverse').checked || false;\r\n                objUpdate.skew_x_end_reverse = document.getElementById('layer_skew_xend_reverse').checked || false;\r\n                objUpdate.skew_y_end_reverse = document.getElementById('layer_skew_yend_reverse').checked || false;\r\n                objUpdate.mask_x_start_reverse = document.getElementById('mask_anim_xstart_reverse').checked || false;\r\n                objUpdate.mask_y_start_reverse =  document.getElementById('mask_anim_ystart_reverse').checked || false;\r\n                objUpdate.mask_x_end_reverse =  document.getElementById('mask_anim_xend_reverse').checked || false;\r\n                objUpdate.mask_y_end_reverse =  document.getElementById('mask_anim_yend_reverse').checked || false;\r\n\r\n\r\n                objUpdate.autolinebreak = jQuery(\"#layer_auto_line_break\")[0].checked;\r\n\r\n                objUpdate.displaymode = jQuery('#layer_displaymode')[0].checked;\r\n\r\n                objUpdate.scaleProportional = jQuery(\"#layer_proportional_scale\")[0].checked;\r\n\r\n                objUpdate.attrID = document.getElementById(\"layer_id\").value;\r\n                objUpdate.attrWrapperID = document.getElementById(\"layer_wrapper_id\").value;\r\n                objUpdate.attrClasses = document.getElementById(\"layer_classes\").value;\r\n                objUpdate.attrWrapperClasses = document.getElementById(\"layer_wrapper_classes\").value;\r\n                objUpdate.attrTitle = document.getElementById(\"layer_title\").value;\r\n                objUpdate.attrTabindex = document.getElementById(\"layer_tabindex\").value;\r\n                objUpdate.attrRel = document.getElementById(\"layer_rel\").value;\r\n\r\n\r\n                objUpdate = t.setVal(objUpdate, 'scaleY', jQuery(\"#layer_scaleY\").val());\r\n\r\n\r\n                jQuery('#clayer_start_speed').val(objUpdate.speed);\r\n                jQuery('#clayer_end_speed').val(objUpdate.endspeed);\r\n\r\n\r\n\r\n                // CHECK IF THE INPUT FIELD NEED TO BE UPDATED FOR ALL DEVICE SIZES\r\n                var set_all_color = lastchangedinput == \"layer_color_s\",\r\n                    set_all_color_force = jQuery('#on_all_devices_color').attr(\"checked\")==\"checked\" || false,\r\n                    set_all_fontsize = lastchangedinput == \"layer_font_size_s\",\r\n                    set_all_fontsize_force =  jQuery('#on_all_devices_fontsize').attr(\"checked\")==\"checked\" || false,\r\n                    set_all_fontweight = lastchangedinput == \"layer_font_weight_s\",\r\n                    set_all_fontweight_force = jQuery('#on_all_devices_fontweight').attr(\"checked\")==\"checked\" || false,\r\n                    set_all_lineheight = lastchangedinput == \"layer_line_height_s\",\r\n                    set_all_lineheight_force = jQuery('#on_all_devices_lineheight').attr(\"checked\")==\"checked\" || false,\r\n                    set_all_letterspacing = lastchangedinput == \"letter_spacing_s\",\r\n                    set_all_letterspacing_force = jQuery('#on_all_devices_letterspacing').attr(\"checked\")==\"checked\" || false;\r\n\r\n                if(objUpdate['static_styles'] == undefined) objUpdate['static_styles'] = {};\r\n                objUpdate['static_styles'] = t.setVal(objUpdate['static_styles'], 'font-size', jQuery(\"#layer_font_size_s\").val(),set_all_fontsize,null,set_all_fontsize_force);\r\n                objUpdate['static_styles'] = t.setVal(objUpdate['static_styles'], 'line-height', jQuery(\"#layer_line_height_s\").val(),set_all_lineheight,null,set_all_lineheight_force);\r\n                objUpdate['static_styles'] = t.setVal(objUpdate['static_styles'], 'font-weight', jQuery(\"#layer_font_weight_s option:selected\").val(),set_all_fontweight,null,set_all_fontweight_force);\r\n                objUpdate['static_styles'] = t.setVal(objUpdate['static_styles'], 'color', jQuery(\"#layer_color_s\").val(),set_all_color,null,set_all_color_force);\r\n                objUpdate['static_styles'] = t.setVal(objUpdate['static_styles'], 'letter-spacing', jQuery(\"#letter_spacing_s\").val(),set_all_letterspacing,null,set_all_letterspacing_force);\r\n\r\n                //deformation part\r\n                if(objUpdate.deformation == undefined) objUpdate.deformation = {};\r\n\r\n                if (objUpdate[\"deformation\"][\"border-radius\"] == undefined) objUpdate[\"deformation\"][\"border-radius\"]=[\"0\",\"0\",\"0\",\"0\"];\r\n\r\n\r\n                objUpdate['layer-selectable'] = jQuery('#css_layer_selectable option:selected').val();\r\n\r\n                objUpdate['deformation']['font-style'] = (jQuery('#css_font-style')[0].checked) ? 'italic' : 'normal';\r\n                objUpdate['deformation']['font-family'] =  document.getElementById('css_font-family').value;\r\n\r\n\r\n                var cur_pad = [];\r\n                jQuery('input[name=\"css_padding[]\"]').each(function(i){\r\n                    cur_pad.push(jQuery(this).val());\r\n                });\r\n                objUpdate = t.setVal(objUpdate, 'padding', cur_pad, true);\r\n\r\n                var cur_mar = [];\r\n                jQuery('input[name=\"css_margin[]\"]').each(function(i){\r\n                    cur_mar.push(jQuery(this).val());\r\n                });\r\n                objUpdate = t.setVal(objUpdate, 'margin', cur_mar, true);\r\n\r\n                objUpdate = t.setVal(objUpdate, 'text-align', jQuery('#css_text-align option:selected').val());\r\n\r\n\r\n                objUpdate['deformation']['text-decoration'] = jQuery('#css_text-decoration option:selected').val();\r\n                objUpdate['deformation']['overflow'] = jQuery('#css_overflow option:selected').val();\r\n                objUpdate['column_break_at'] = jQuery('#column_break_at option:selected').val();\r\n                objUpdate['deformation']['vertical-align'] = jQuery('#css_vertical-align option:selected').val();\r\n\r\n                objUpdate['deformation']['text-transform'] = jQuery('#css_text-transform option:selected').val();\r\n                objUpdate['deformation']['background-color'] =  document.getElementById('css_background-color').value;\r\n                objUpdate['deformation']['border-color'] =  document.getElementById('css_border-color-show').value;\r\n                objUpdate['deformation']['border-style'] = jQuery('#css_border-style option:selected').val();\r\n\r\n                if(objUpdate.deformation['border-width'] == undefined) objUpdate.deformation['border-width'] = new Array();\r\n                jQuery('input[name=\"css_border-width[]\"]').each(function(i){ objUpdate['deformation']['border-width'][i] = jQuery(this).val();});\r\n\r\n                if(objUpdate.deformation['border-radius'] == undefined) objUpdate.deformation['border-radius'] = new Array();\r\n                jQuery('input[name=\"css_border-radius[]\"]').each(function(i){ objUpdate['deformation']['border-radius'][i] = jQuery(this).val();});\r\n\r\n                objUpdate['layer_blend_mode'] = jQuery('#layer_blend_mode option:selected').val();\r\n\r\n\r\n                objUpdate['deformation']['x'] = 0; //parseInt(jQuery('input[name=\"layer__x\"]').val(),0);\r\n                objUpdate['deformation']['y'] = 0; //parseInt(jQuery('input[name=\"layer__y\"]').val(),0);\r\n                objUpdate['deformation']['z'] = parseInt( document.getElementById('layer__z').value,0);\r\n                objUpdate['deformation']['skewx'] =  document.getElementById('layer__skewx').value;\r\n                objUpdate['deformation']['skewy'] =  document.getElementById('layer__skewy').value;\r\n                objUpdate['deformation']['scalex'] =  document.getElementById('layer__scalex').value;\r\n                objUpdate['deformation']['scaley'] =  document.getElementById('layer__scaley').value;\r\n                objUpdate['deformation']['opacity'] =  document.getElementById('layer__opacity').value;\r\n                objUpdate['deformation']['xrotate'] = parseInt( document.getElementById('layer__xrotate').value,0);\r\n                objUpdate['deformation']['yrotate'] = parseInt( document.getElementById('layer__yrotate').value,0);\r\n                objUpdate['2d_rotation'] = parseInt( document.getElementById('layer_2d_rotation').value,0);\r\n                objUpdate['deformation']['2d_origin_x'] =  document.getElementById('layer_2d_origin_x').value;\r\n                objUpdate['deformation']['2d_origin_y'] =  document.getElementById('layer_2d_origin_y').value;\r\n                objUpdate['deformation']['pers'] =  document.getElementById('layer__pers').value;\r\n                objUpdate['deformation']['corner_left'] = jQuery('#layer_cornerleft option:selected').val();\r\n                objUpdate['deformation']['corner_right'] = jQuery('#layer_cornerright option:selected').val();\r\n                objUpdate['deformation']['parallax'] = jQuery('#parallax_level option:selected').val();\r\n\r\n                //FILTERS\r\n                objUpdate['deformation']['blurfilter'] =  document.getElementById('blurfilter_idle').value;\r\n                objUpdate['deformation']['grayscalefilter'] =  document.getElementById('grayscalefilter_idle').value;\r\n                //objUpdate['deformation']['ds_x'] =  document.getElementById('ds_x_idle').value;\r\n                //objUpdate['deformation']['ds_y'] =  document.getElementById('ds_y_idle').value;\r\n                //objUpdate['deformation']['ds_blur'] =  document.getElementById('ds_blur_idle').value;\r\n                //objUpdate['deformation']['ds_color'] =  document.getElementById('ds_color_idle').value;\r\n                //objUpdate['deformation']['ds_opacity'] =  document.getElementById('ds_opacity_idle').value;\r\n\r\n\r\n\r\n                //deformation hover part start\r\n                if(objUpdate['deformation-hover'] == undefined || jQuery.isEmptyObject(objUpdate['deformation-hover'])) objUpdate['deformation-hover'] = {};\r\n                //objUpdate['deformation-hover']['shadow_hover'] = document.getElementById(\"shadow_hover\").checked;\r\n                objUpdate['deformation-hover']['color'] = document.getElementById('hover_layer_color_s').value;\r\n                objUpdate['deformation-hover']['text-decoration'] = jQuery('#hover_css_text-decoration option:selected').val();\r\n                objUpdate['deformation-hover']['background-color'] = document.getElementById('hover_css_background-color').value;\r\n\r\n                //FILTERS\r\n                objUpdate['deformation-hover']['blurfilter'] =  document.getElementById('blurfilter_hover').value;\r\n                objUpdate['deformation-hover']['grayscalefilter'] =  document.getElementById('grayscalefilter_hover').value;\r\n                objUpdate['deformation-hover']['brightnessfilter'] =  document.getElementById('brightnessfilter_hover').value;\r\n                //objUpdate['deformation-hover']['ds_x'] =  document.getElementById('ds_x_hover').value;\r\n                //objUpdate['deformation-hover']['ds_y'] =  document.getElementById('ds_y_hover').value;\r\n                //objUpdate['deformation-hover']['ds_blur'] =  document.getElementById('ds_blur_hover').value;\r\n                //objUpdate['deformation-hover']['ds_color'] =  document.getElementById('ds_color_hover').value;\r\n                //objUpdate['deformation-hover']['ds_opacity'] =  document.getElementById('ds_opacity_hover').value;\r\n\r\n\r\n                objUpdate['deformation-hover']['border-color'] = document.getElementById('hover_css_border-color-show').value;\r\n                objUpdate['deformation-hover']['border-style'] = jQuery('#hover_css_border-style option:selected').val();\r\n                if(objUpdate['deformation-hover']['border-width'] == undefined) objUpdate['deformation-hover']['border-width'] = new Array();\r\n                jQuery('input[name=\"hover_css_border-width[]\"]').each(function(i){ objUpdate['deformation-hover']['border-width'][i] = jQuery(this).val(); });\r\n                if(objUpdate['deformation-hover']['border-radius'] == undefined) objUpdate['deformation-hover']['border-radius'] = new Array();\r\n                jQuery('input[name=\"hover_css_border-radius[]\"]').each(function(i){ objUpdate['deformation-hover']['border-radius'][i] = jQuery(this).val(); });\r\n                objUpdate['deformation-hover']['skewx'] = document.getElementById('hover_layer__skewx').value;\r\n                objUpdate['deformation-hover']['skewy'] = document.getElementById('hover_layer__skewy').value;\r\n                objUpdate['deformation-hover']['scalex'] = document.getElementById('hover_layer__scalex').value;\r\n                objUpdate['deformation-hover']['scaley'] = document.getElementById('hover_layer__scaley').value;\r\n                objUpdate['deformation-hover']['opacity'] = document.getElementById('hover_layer__opacity').value;\r\n                objUpdate['deformation-hover']['xrotate'] = parseInt(document.getElementById('hover_layer__xrotate').value,0);\r\n                objUpdate['deformation-hover']['yrotate'] = parseInt(document.getElementById('hover_layer__yrotate').value,0);\r\n                objUpdate['deformation-hover']['2d_rotation'] = parseInt(document.getElementById('hover_layer_2d_rotation').value,0); //z rotate\r\n\r\n                objUpdate['deformation-hover']['speed'] = document.getElementById('hover_speed').value;\r\n                objUpdate['deformation-hover']['zindex'] = document.getElementById('hover_zindex').value;\r\n\t\tobjUpdate['deformation-hover']['pointer_events'] = document.getElementById('pointer_events').value;\r\n                objUpdate['deformation-hover']['easing'] = jQuery('#hover_easing option:selected').val();\r\n                objUpdate['deformation-hover']['css_cursor'] = jQuery('#css_cursor option:selected').val();\r\n\t\tobjUpdate['deformation-hover']['pointer_events'] = jQuery('#pointer_events option:selected').val();\r\n\r\n                // READ SVG BASED CONTENT\r\n                if (objUpdate['svg']==undefined) objUpdate['svg']={};\r\n                objUpdate['svg']['svgstroke-color'] = document.getElementById('css_svgstroke-color-show').value;\r\n                objUpdate['svg']['svgstroke-dasharray'] = document.getElementById('css_svgstroke-dasharray').value;\r\n                objUpdate['svg']['svgstroke-dashoffset'] = document.getElementById('css_svgstroke-dashoffset').value;\r\n                objUpdate['svg']['svgstroke-width'] = document.getElementById('css_svgstroke-width').value;\r\n                objUpdate['svg']['svgstroke-hover-color'] = document.getElementById('css_svgstroke-hover-color-show').value;\r\n                objUpdate['svg']['svgstroke-hover-dasharray'] = document.getElementById('css_svgstroke-hover-dasharray').value;\r\n                objUpdate['svg']['svgstroke-hover-dashoffset'] = document.getElementById('css_svgstroke-hover-dashoffset').value;\r\n                objUpdate['svg']['svgstroke-hover-width'] = document.getElementById('css_svgstroke-hover-width').value;\r\n\r\n\r\n\r\n                //deformation hover part end\r\n                if(objUpdate['layer_action'] == undefined || jQuery.isEmptyObject(objUpdate['layer_action'])) objUpdate['layer_action'] = {};\r\n\r\n                objUpdate['layer_action'].tooltip_event = [];\r\n                jQuery('select[name=\"layer_tooltip_event[]\"] option:selected').each(function(){\r\n                    objUpdate['layer_action'].tooltip_event.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].action = [];\r\n                jQuery('select[name=\"layer_action[]\"] option:selected').each(function(){\r\n                    objUpdate['layer_action'].action.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].image_link = [];\r\n                jQuery('input[name=\"layer_image_link[]\"]').each(function(){\r\n                    objUpdate['layer_action'].image_link.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].link_open_in = [];\r\n                jQuery('select[name=\"layer_link_open_in[]\"] option:selected').each(function(){\r\n                    objUpdate['layer_action'].link_open_in.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].jump_to_slide = [];\r\n                jQuery('select[name=\"jump_to_slide[]\"] option:selected').each(function(){\r\n                    objUpdate['layer_action'].jump_to_slide.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].scrollunder_offset = [];\r\n                jQuery('input[name=\"layer_scrolloffset[]\"]').each(function(){\r\n                    objUpdate['layer_action'].scrollunder_offset.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].action_easing = [];\r\n                jQuery('select[name=\"layer-action-easing[]\"] option:selected').each(function(){\r\n                    objUpdate['layer_action'].action_easing.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].action_speed = [];\r\n                jQuery('input[name=\"layer_action_speed[]\"]').each(function(){\r\n                    objUpdate['layer_action'].action_speed.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].actioncallback = [];\r\n                jQuery('input[name=\"layer_actioncallback[]\"]').each(function(){\r\n                    objUpdate['layer_action'].actioncallback.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].layer_target = [];\r\n                jQuery('select[name=\"layer_target[]\"] option:selected').each(function(){\r\n                    objUpdate['layer_action'].layer_target.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].link_type = [];\r\n                jQuery('select[name=\"layer_link_type[]\"] option:selected').each(function(){\r\n                    objUpdate['layer_action'].link_type.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].action_delay = [];\r\n                jQuery('input[name=\"layer_action_delay[]\"]').each(function(){\r\n                    objUpdate['layer_action'].action_delay.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].toggle_layer_type = [];\r\n                jQuery('select[name=\"toggle_layer_type[]\"] option:selected').each(function(){\r\n                    objUpdate['layer_action'].toggle_layer_type.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate['layer_action'].toggle_class = [];\r\n                jQuery('input[name=\"layer_toggleclass[]\"]').each(function(){\r\n                    objUpdate['layer_action'].toggle_class.push(jQuery(this).val());\r\n                });\r\n\r\n                objUpdate.animation_overwrite = jQuery('#layer-animation-overwrite option:selected').val();\r\n                objUpdate.trigger_memory = jQuery('#layer-tigger-memory option:selected').val();\r\n\r\n\r\n\r\n                // HOOK FOR EXTERNAL ADDONS\r\n                jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n                    var callback = callback_element[\"callback\"],\r\n                        env = callback_element[\"environment\"],\r\n                        env_sub = callback_element[\"function_position\"];\r\n                    if (env === \"updateLayerFromFields_Core\" && env_sub==\"end\"){\r\n                        objUpdate = callback(objUpdate);\r\n                    }\r\n                });\r\n\r\n                //update object - Write back changes in ObjArray\r\n                t.updateCurrentLayer(objUpdate, ['layer_action']);\r\n                t.showHideToggleContent(objUpdate);\r\n\r\n                //update html layers\r\n                updateHtmlLayersFromObject();\r\n\r\n                //update html sortbox\r\n                updateHtmlSortboxFromObject();\r\n\r\n                //event on element for href\r\n                initDisallowCaptionsOnClick();\r\n\r\n                u.rebuildLayerIdle(layer);\r\n\r\n                t.set_cover_mode();\r\n\r\n            }\r\n\r\n\r\n\r\n            /**\r\n             *\r\n             * update sortbox text from object\r\n             */\r\n            var updateHtmlSortboxFromObject = function(serial){\r\n\r\n                serial = serial!=undefined ? serial : t.selectedLayerSerial;\r\n\r\n                var objLayer = t.getLayer(serial),\r\n                    htmlSortItem = u.getHtmlSortItemFromSerial(serial);\r\n\r\n\r\n                if(!objLayer || !htmlSortItem) return(false);\r\n\r\n                var sortboxText = u.getSortboxText(objLayer.alias);\r\n\r\n                htmlSortItem.find(\">.layer_sort_inner_wrapper .timer-layer-text\").text(sortboxText);\r\n\r\n            }\r\n\r\n            /**\r\n             *\r\n             * redraw all Layer HTML\r\n             *\r\n             */\r\n            var redrawAllLayerHtml = function() {\r\n\r\n                jQuery.each(t.arrLayers,function(i,obj) {\r\n                    redrawLayerHtml(obj.serial);\r\n                });\r\n                jQuery.each(t.arrLayersDemo,function(i,obj) {\r\n                    redrawLayerHtml(obj.serial, true);\r\n                });\r\n                jQuery('.slide_layer').each(function() {\r\n                    u.rebuildLayerIdle(jQuery(this));\r\n                });\r\n                t.updateLayerFormFields(t.selectedLayerSerial);\r\n\r\n            }\r\n\r\n            /**\r\n             * redraw some layer html\r\n             */\r\n            var redrawLayerHtml = function(serial, isDemo){\r\n\r\n                if(isDemo == undefined) isDemo = false;\r\n\r\n                var objLayer = t.getLayer(serial, isDemo),\r\n                    html = t.makeLayerHtml(serial,objLayer, isDemo);\r\n\r\n                if (objLayer.type!=\"group\" && objLayer.type!=\"row\" && objLayer.type!=\"column\") {\r\n                    var htmlInner = jQuery(html).html();\r\n                    var htmlLayer = t.getHtmlLayerFromSerial(serial, isDemo);\r\n\r\n                    objLayer.references.htmlLayer.html(htmlInner);\r\n                }\r\n\r\n            }\r\n\r\n            /**\r\n             * check if there is value in the object, and it is defined\r\n             */\r\n            var nix = function(a) {\r\n                return (a===undefined || a.length==0);\r\n            }\r\n\r\n\r\n            /**\r\n             * Reset Fields of Styling based on current selected Template\r\n             */\r\n            var updateSubStyleParameters = function(objLayer, reset_full) {\r\n\r\n                var reset = (typeof(reset_full) !== 'undefined' && reset_full === true) ? true : false;\r\n\r\n                var fullstyles = UniteCssEditorRev.getStyleSettingsByHandle(objLayer[\"style\"]);\r\n\r\n                var styles = fullstyles.params,\r\n                    svgstyles = UniteCssEditorRev.getStyleSettingsByHandle(objLayer[\"svg\"]);\r\n                var hover_styles = fullstyles.hover;\r\n                if(hover_styles == undefined) hover_styles = {};\r\n\r\n                var is_hover = false;\r\n\r\n                try{\r\n                    is_hover = fullstyles!==undefined ? fullstyles.hasOwnProperty('settings') ? (typeof(fullstyles.settings) !== 'undefined' && typeof(fullstyles.settings.hover) !== undefined) ? fullstyles.settings.hover : false : false : false;\r\n                } catch(e) {\r\n                }\r\n\r\n\r\n                // INSERT STANDART SETTINGS FROM TEMPLATE STYLE\r\n                if(objLayer.deformation != undefined && styles !== undefined){\r\n                    // COLOR TRANSPARENCY\r\n                    if(nix(objLayer['deformation']['color-transparency']) || reset)\r\n                        objLayer['deformation']['color-transparency'] = !nix(styles[\"color-transparency\"]) ? styles[\"color-transparency\"] : \"1\";\r\n\r\n                    // FONT STYLE\r\n                    if(nix(objLayer['deformation']['font-style']) || reset)\r\n                        objLayer['deformation']['font-style'] = !nix(styles[\"font-style\"]) ? styles[\"font-style\"] : \"normal\";\r\n\r\n                    // FONT FAMILY\r\n                    if(nix(objLayer['deformation']['font-family']) || reset)\r\n                        objLayer['deformation']['font-family'] = !nix(styles[\"font-family\"]) ? styles[\"font-family\"] : \"Arial\"\r\n\r\n\r\n                    // PADDING SETTINGS\r\n                    if(nix(objLayer['padding']) || reset){\r\n                        if(!nix(styles[\"padding\"])){\r\n                            if(objLayer['padding'] != undefined){\r\n                                delete(objLayer['padding']);\r\n                            }\r\n\r\n                            if((typeof styles[\"padding\"] === \"object\") && (styles[\"padding\"] !== null)){\r\n                                objLayer['padding'] = styles[\"padding\"];\r\n                            }else{\r\n                                objLayer = t.setVal(objLayer, 'padding', styles[\"padding\"].split(' '), true);\r\n                            }\r\n                        }else{\r\n                            if(objLayer['padding'] == undefined){\r\n                                objLayer['padding'] = {};\r\n                                var cur_pad = [];\r\n                                jQuery('input[name=\"css_padding[]\"]').each(function(){\r\n                                    cur_pad.push(0);\r\n                                });\r\n                                objLayer = t.setVal(objLayer, 'padding', cur_pad, true);\r\n                            }else{\r\n                                if(typeof(objLayer['padding']) !== 'object'){\r\n                                    objLayer = t.setVal(objLayer, 'padding', objLayer['padding'], true);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if(nix(objLayer['margin']) || reset){\r\n                        if(!nix(styles[\"margin\"])){\r\n                            if(objLayer['margin'] != undefined){\r\n                                delete(objLayer['margin']);\r\n                            }\r\n\r\n                            if((typeof styles[\"margin\"] === \"object\") && (styles[\"margin\"] !== null)){\r\n                                objLayer['margin'] = styles[\"margin\"];\r\n                            }else{\r\n                                objLayer = t.setVal(objLayer, 'margin', styles['margin'].split(' '), true);\r\n                            }\r\n                        }else{\r\n                            if(objLayer['margin'] == undefined){\r\n                                objLayer['margin'] = {};\r\n                                var cur_pad = [];\r\n                                jQuery('input[name=\"css_margin[]\"]').each(function(){\r\n                                    cur_pad.push(0);\r\n                                });\r\n                                objLayer = t.setVal(objLayer, 'margin', cur_pad, true);\r\n                            }else{\r\n                                if(typeof(objLayer['margin']) !== 'object'){\r\n                                    objLayer = t.setVal(objLayer, 'margin', objLayer['margin'], true);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n\r\n                    //  DISPLAY\r\n                    if (nix(objLayer['deformation']['display']) || reset)\r\n                        objLayer['deformation']['display'] = !nix(styles[\"display\"]) ? styles[\"display\"] : \"block\";\r\n\r\n                    if(nix(objLayer['text-align']) || reset){\r\n                        if(!nix(styles[\"text-align\"])){\r\n                            if(objLayer['text-align'] != undefined){\r\n                                delete(objLayer['text-align']);\r\n                            }\r\n\r\n                            if((typeof styles[\"text-align\"] === \"object\") && (styles[\"text-align\"] !== null)){\r\n                                objLayer['text-align'] = styles[\"text-align\"];\r\n                            }else{\r\n                                objLayer = t.setVal(objLayer, 'text-align', styles['text-align'], true);\r\n                            }\r\n                        }else{\r\n                            if(objLayer['text-align'] == undefined){\r\n                                objLayer['text-align'] = {};\r\n                                var cur_pad = [];\r\n                                jQuery('input[name=\"css_text-align[]\"]').each(function(){\r\n                                    cur_pad.push(0);\r\n                                });\r\n                                objLayer = t.setVal(objLayer, 'text-align', cur_pad, true);\r\n                            }else{\r\n                                if(typeof(objLayer['text-align']) !== 'object'){\r\n                                    objLayer = t.setVal(objLayer, 'text-align', objLayer['text-align'], true);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // TEXT DECORATION\r\n                    if (nix(objLayer['deformation']['text-decoration']) || reset)\r\n                        objLayer['deformation']['text-decoration'] = !nix(styles[\"text-decoration\"]) ? styles[\"text-decoration\"] : \"none\";\r\n\r\n                    // TEXT ALIGNMENT\r\n                    if (nix(objLayer['deformation']['text-align']) || reset)\r\n                        objLayer['deformation']['text-align'] = !nix(styles[\"text-align\"]) ? styles[\"text-align\"] : \"left\";\r\n\r\n\r\n                    // BACKGROUND COLOR\r\n                    if (nix(objLayer['deformation']['background-color']) || reset) {\r\n                        var hex = !nix(styles['background-color']) ? UniteAdminRev.rgb2hex(styles['background-color']) : \"transparent\",\r\n                            transparency = !nix(styles['background-color']) ? UniteAdminRev.getTransparencyFromRgba(styles['background-color']) : 1;\r\n                        transparency = transparency==undefined || transparency == false || transparency == \"false\" ? 1 : transparency;\r\n\r\n                        if(!nix(styles['background-transparency'])) transparency = styles['background-transparency'];\r\n\r\n                        objLayer['deformation']['background-color'] = hex;\r\n                        objLayer['deformation']['background-transparency'] = transparency;\r\n                    }\r\n\r\n                    // BORDER COLOR\r\n                    if (nix(objLayer['deformation']['border-color']) || reset)\r\n                        objLayer['deformation']['border-color'] = !nix(styles['border-color']) ? UniteAdminRev.rgb2hex(styles['border-color']) : \"transparent\";\r\n\r\n                    // BORDER TRANSPARENCY\r\n                    if(nix(objLayer['deformation']['border-transparency']) || reset)\r\n                        objLayer['deformation']['border-transparency'] = !nix(styles[\"border-transparency\"]) ? styles[\"border-transparency\"] : \"1\";\r\n\r\n                    // BORDER STYLE\r\n                    if (nix(objLayer['deformation']['border-style']) || reset)\r\n                        objLayer['deformation']['border-style'] = !nix(styles['border-style']) ? styles['border-style'] : \"none\";\r\n\r\n                    // BORDER WIDTH\r\n                    if (nix(objLayer['deformation']['border-width']) || (nix(objLayer['deformation']['border-width'][0]) && nix(objLayer['deformation']['border-width'][1]) && nix(objLayer['deformation']['border-width'][2]) && nix(objLayer['deformation']['border-width'][3])) || reset) {\r\n\r\n                        var cor = !nix(styles['border-width']) ? typeof(styles['border-width']) !== 'object' ? styles['border-width'].split(\" \") : styles['border-width'] : [\"0px\",\"0px\",\"0px\",\"0px\"];\r\n                        objLayer['deformation']['border-width'] = [\"0\",\"0\",\"0\",\"0\"];\r\n\r\n                        jQuery(objLayer['deformation']['border-width']).each(function(i){\r\n                            objLayer['deformation']['border-width'][i] = cor.length<2 ? cor[0] : cor.length<4 ? i==0 || i==2 ? cor[0] : cor[1] : cor[i];\r\n                        });\r\n                    }\r\n\r\n\r\n                    // BORDER RADIUS\r\n                    if (nix(objLayer['deformation']['border-radius']) || (nix(objLayer['deformation']['border-radius'][0]) && nix(objLayer['deformation']['border-radius'][1]) && nix(objLayer['deformation']['border-radius'][2]) && nix(objLayer['deformation']['border-radius'][3])) || reset) {\r\n\r\n                        var cor = !nix(styles['border-radius']) ? typeof(styles['border-radius']) !== 'object' ? styles['border-radius'].split(\" \") : styles['border-radius'] : [\"0px\",\"0px\",\"0px\",\"0px\"];\r\n                        objLayer['deformation']['border-radius'] = [\"0\",\"0\",\"0\",\"0\"];\r\n\r\n                        jQuery(objLayer['deformation']['border-radius']).each(function(i){\r\n                            objLayer['deformation']['border-radius'][i] = cor.length<2 ? cor[0] : cor.length<4 ? i==0 || i==2 ? cor[0] : cor[1] : cor[i];\r\n                        });\r\n                    }\r\n\r\n                    // CORNER LEFT\r\n                    if (nix(objLayer['deformation']['corner_left']) || reset)\r\n                        objLayer['deformation']['corner_left'] = !nix(styles['corner_left']) ? styles['corner_left'] : \"nothing\";\r\n\r\n                    // CORNER RIGHT\r\n                    if (nix(objLayer['deformation']['corner_right']) || reset)\r\n                        objLayer['deformation']['corner_right'] = !nix(styles['corner_right']) ? styles['corner_right'] : \"nothing\";\r\n\r\n                    // PARALLAX\r\n                    if (nix(objLayer['deformation']['parallax']) || reset)\r\n                        objLayer['deformation']['parallax'] = !nix(styles['parallax']) ? styles['parallax'] : \"-\";\r\n\r\n                    if (nix(objLayer['deformation']['x']) || reset) objLayer['deformation']['x'] = !nix(styles['x']) ? styles['x'] : 0;\r\n                    if (nix(objLayer['deformation']['y']) || reset) objLayer['deformation']['y'] = !nix(styles['y']) ? styles['y'] : 0;\r\n                    if (nix(objLayer['deformation']['z']) || reset) objLayer['deformation']['z'] = !nix(styles['z']) ? styles['z'] : 0;\r\n                    if (nix(objLayer['deformation']['skewx']) || reset) objLayer['deformation']['skewx'] = !nix(styles['skewx']) ? styles['skewx'] : 0;\r\n                    if (nix(objLayer['deformation']['skewy']) || reset) objLayer['deformation']['skewy'] = !nix(styles['skewy']) ? styles['skewy'] : 0;\r\n                    if (nix(objLayer['deformation']['scalex']) || reset) objLayer['deformation']['scalex'] = !nix(styles['scalex']) ? styles['scalex'] : 1;\r\n                    if (nix(objLayer['deformation']['scaley']) || reset) objLayer['deformation']['scaley'] = !nix(styles['scaley']) ? styles['scaley'] : 1;\r\n                    if (nix(objLayer['deformation']['opacity']) || reset) objLayer['deformation']['opacity'] = !nix(styles['opacity']) ? styles['opacity'] : 1;\r\n                    if (nix(objLayer['deformation']['xrotate']) || reset) objLayer['deformation']['xrotate'] = !nix(styles['xrotate']) ? styles['xrotate'] : 0;\r\n                    if (nix(objLayer['deformation']['yrotate']) || reset) objLayer['deformation']['yrotate'] = !nix(styles['yrotate']) ? styles['yrotate'] : 0;\r\n                    if (nix(objLayer['2d_rotation']) || reset) objLayer['2d_rotation'] =  !nix(styles['2d_rotation']) ? styles['2d_rotation'] : 0;\r\n                    if (nix(objLayer['deformation']['2d_origin_x']) || reset) objLayer['deformation']['2d_origin_x'] = !nix(styles['2d_origin_x']) ? styles['2d_origin_x'] : 50;\r\n                    if (nix(objLayer['deformation']['2d_origin_y']) || reset) objLayer['deformation']['2d_origin_y'] = !nix(styles['2d_origin_y']) ? styles['2d_origin_y'] : 50;\r\n                    if (nix(objLayer['deformation']['pers']) || reset) objLayer['deformation']['pers'] = !nix(styles['pers']) ? styles['pers'] : 600;\r\n\r\n                    //FILTERS\r\n                    if (nix(objLayer['deformation']['blurfilter']) || reset) objLayer['deformation']['blurfilter'] =  !nix(styles['blurfilter']) ?  styles['blurfilter'] : 0;\r\n                    if (nix(objLayer['deformation']['grayscalefilter']) || reset) objLayer['deformation']['grayscalefilter'] =  !nix(styles['grayscalefilter']) ?  styles['grayscalefilter'] : 0;\r\n                    //if (nix(objLayer['deformation']['ds_x']) || reset) objLayer['deformation']['ds_x'] =  !nix(styles['ds_x']) ?  styles['ds_x'] : 0;\r\n                    //if (nix(objLayer['deformation']['ds_y']) || reset) objLayer['deformation']['ds_y'] =  !nix(styles['ds_y']) ?  styles['ds_y'] : 0;\r\n                    //if (nix(objLayer['deformation']['ds_blur']) || reset) objLayer['deformation']['ds_blur'] =  !nix(styles['ds_blur']) ?  styles['ds_blur'] : 0;\r\n                    //if (nix(objLayer['deformation']['ds_color']) || reset) objLayer['deformation']['ds_color'] =  !nix(styles['ds_color']) ?  styles['ds_color'] : 0;\r\n                    //if (nix(objLayer['deformation']['ds_opacity']) || reset) objLayer['deformation']['ds_opacity'] =  !nix(styles['ds_opacity']) ?  styles['ds_opacity'] : 0;\r\n\r\n\r\n                }\r\n\r\n                if (objLayer['svg']!=undefined && svgstyles!=undefined) {\r\n                    // SVG STROKE COLOR\r\n                    if (nix(objLayer['svg']['svgstroke-color']) || reset)\r\n                        objLayer['svg']['svgstroke-color'] = !nix(svgstyles['svgstroke-color']) ? UniteAdminRev.rgb2hex(svgstyles['svgstroke-color']) : \"transparent\";\r\n\r\n                    // SVG STROKE TRANSPARENCY\r\n                    if(nix(objLayer['svg']['svgstroke-transparency']) || reset)\r\n                        objLayer['svg']['svgstroke-transparency'] = !nix(svgstyles[\"svgstroke-transparency\"]) ? svgstyles[\"svgstroke-transparency\"] : \"1\";\r\n\r\n                    // SVG STROKE DASH ARRAY\r\n                    if (nix(objLayer['svg']['svgstroke-dasharray']) || reset)\r\n                        objLayer['svg']['svgstroke-dasharray'] = !nix(svgstyles['svgstroke-dasharray']) ? svgstyles['svgstroke-dasharray'] : \"0\";\r\n\r\n                    // SVG STROKE DASH OFFSET\r\n                    if (nix(objLayer['svg']['svgstroke-dashoffset']) || reset)\r\n                        objLayer['svg']['svgstroke-dashoffset'] = !nix(svgstyles['svgstroke-dashoffset']) ? svgstyles['svgstroke-dashoffset'] : \"0\";\r\n\r\n                    // SVG STROKE WIDTH\r\n                    if (nix(objLayer['svg']['svgstroke-width']) || reset)\r\n                        objLayer['svg']['svgstroke-width'] = !nix(svgstyles['svgstroke-width']) ? svgstyles['svgstroke-width'] : \"0\";\r\n\r\n                    // SVG STROKE COLOR\r\n                    if (nix(objLayer['svg']['svgstroke-hover-color']) || reset)\r\n                        objLayer['svg']['svgstroke-hover-color'] = !nix(svgstyles['svgstroke-hover-color']) ? UniteAdminRev.rgb2hex(svgstyles['svgstroke-hover-color']) : \"transparent\";\r\n\r\n                    // SVG STROKE TRANSPARENCY\r\n                    if(nix(objLayer['svg']['svgstroke-hover-transparency']) || reset)\r\n                        objLayer['svg']['svgstroke-hover-transparency'] = !nix(svgstyles[\"svgstroke-hover-transparency\"]) ? svgstyles[\"svgstroke-hover-transparency\"] : \"1\";\r\n\r\n                    // SVG STROKE DASH ARRAY\r\n                    if (nix(objLayer['svg']['svgstroke-hover-dasharray']) || reset)\r\n                        objLayer['svg']['svgstroke-hover-dasharray'] = !nix(svgstyles['svgstroke-hover-dasharray']) ? svgstyles['svgstroke-hover-dasharray'] : \"0\";\r\n\r\n                    // SVG STROKE DASH OFFSET\r\n                    if (nix(objLayer['svg']['svgstroke-hover-dashoffset']) || reset)\r\n                        objLayer['svg']['svgstroke-hover-dashoffset'] = !nix(svgstyles['svgstroke-hover-dashoffset']) ? svgstyles['svgstroke-hover-dashoffset'] : \"0\";\r\n\r\n                    // SVG STROKE WIDTH\r\n                    if (nix(objLayer['svg']['svgstroke-hover-width']) || reset)\r\n                        objLayer['svg']['svgstroke-hover-width'] = !nix(svgstyles['svgstroke-hover-width']) ? svgstyles['svgstroke-hover-width'] : \"0\";\r\n                }\r\n\r\n                if(reset){\r\n                    if(is_hover === 'true' || is_hover === true){\r\n                        jQuery('#hover_allow').attr('checked', true);\r\n                        jQuery('#idle-hover-swapper').show();\r\n                    }else{\r\n                        jQuery('#hover_allow').attr('checked', false);\r\n                        jQuery('#idle-hover-swapper').hide();\r\n                    }\r\n                }\r\n\r\n                RevSliderSettings.onoffStatus(jQuery('#hover_allow'));\r\n                RevSliderSettings.onoffStatus(jQuery('#toggle_allow'));\r\n                RevSliderSettings.onoffStatus(jQuery('#toggle_use_hover'));\r\n                RevSliderSettings.onoffStatus(jQuery('#toggle_inverse_content'));\r\n                //RevSliderSettings.onoffStatus(jQuery('#force_hover'));\r\n                //RevSliderSettings.onoffStatus(jQuery('#shadow_idle'));\r\n                //RevSliderSettings.onoffStatus(jQuery('#shadow_hover'));\r\n\r\n\r\n                jQuery('#css_layer_selectable option[value=\"'+objLayer['layer-selectable']+'\"]').attr('selected', true);\r\n\r\n                if(objLayer.deformation != undefined){\r\n                    jQuery('#css_font-family').val(objLayer['deformation']['font-family']);\r\n\r\n                    var cur_pad = t.getVal(objLayer, 'padding');\r\n                    if(cur_pad === undefined) cur_pad = objLayer['deformation']['padding'];\r\n                    if(cur_pad === undefined) cur_pad = [0,0,0,0];\r\n                    jQuery('input[name=\"css_padding[]\"]').each(function(i){\r\n                        jQuery(this).val(cur_pad[i]);\r\n                    });\r\n\r\n                    var cur_mar = t.getVal(objLayer, 'margin');\r\n                    if(cur_mar === undefined) cur_mar = objLayer['deformation']['margin'];\r\n                    if(cur_mar === undefined) cur_mar = [0,0,0,0];\r\n                    jQuery('input[name=\"css_margin[]\"]').each(function(i){\r\n                        jQuery(this).val(cur_mar[i]);\r\n                    });\r\n\r\n                    if(objLayer['deformation']['font-style'] == 'italic')\r\n                        jQuery('#css_font-style').attr('checked', true); // checkbox\r\n                    else\r\n                        jQuery('#css_font-style').attr('checked', false); // checkbox\r\n                    RevSliderSettings.onoffStatus(jQuery('#css_font-style'));\r\n\r\n                    jQuery('#css_text-align option[value=\"'+t.getVal(objLayer, 'text-align')+'\"]').attr('selected', true);\r\n\r\n\r\n                    jQuery('#css_font-transparency').val(objLayer['deformation']['color-transparency']);\r\n                    jQuery('#css_text-decoration option[value=\"'+objLayer['deformation']['text-decoration']+'\"]').attr('selected', true);\r\n                    jQuery('#css_overflow option[value=\"'+objLayer['deformation']['overflow']+'\"]').attr('selected', true);\r\n                    jQuery('#column_break_at option[value=\"'+objLayer['column_break_at']+'\"]').attr('selected', true);\r\n\r\n                    jQuery('#css_vertical-align option[value=\"'+objLayer['deformation']['vertical-align']+'\"]').attr('selected', true);\r\n\r\n                    jQuery('#css_text-transform option[value=\"'+objLayer['deformation']['text-transform']+'\"]').attr('selected', true);\r\n                    jQuery('#css_background-color').val(objLayer['deformation']['background-color']);\r\n                    jQuery('#css_background-transparency').val(objLayer['deformation']['background-transparency']);\r\n                    jQuery('#css_border-color-show').val(objLayer['deformation']['border-color']);\r\n                    jQuery('#css_border-transparency').val(objLayer['deformation']['border-transparency']);\r\n                    jQuery('#css_border-style option[value=\"'+objLayer['deformation']['border-style']+'\"]').attr('selected', true);\r\n                    jQuery('input[name=\"css_border-width[]\"]').each(function(i){ jQuery(this).val(objLayer['deformation']['border-width'][i]);});\r\n                    jQuery('input[name=\"css_border-radius[]\"]').each(function(i){ jQuery(this).val(objLayer['deformation']['border-radius'][i]);});\r\n                    jQuery('input[name=\"layer__x\"]').val(objLayer['deformation']['x']);\r\n                    jQuery('input[name=\"layer__y\"]').val(objLayer['deformation']['y']);\r\n                    jQuery('#layer__z').val(objLayer['deformation']['z']);\r\n                    jQuery('#layer__skewx').val(objLayer['deformation']['skewx']);\r\n                    jQuery('#layer__skewy').val(objLayer['deformation']['skewy']);\r\n                    jQuery('#layer__scalex').val(objLayer['deformation']['scalex']);\r\n                    jQuery('#layer__scaley').val(objLayer['deformation']['scaley']);\r\n                    jQuery('#layer__opacity').val(objLayer['deformation']['opacity']);\r\n                    jQuery('#layer__xrotate').val(objLayer['deformation']['xrotate']);\r\n                    jQuery('#layer__yrotate').val(objLayer['deformation']['yrotate']);\r\n                    jQuery('#layer_2d_rotation').val(objLayer['2d_rotation']);\r\n                    jQuery('#layer_2d_origin_x').val(objLayer['deformation']['2d_origin_x']);//\r\n                    jQuery('#layer_2d_origin_y').val(objLayer['deformation']['2d_origin_y']);//\r\n                    jQuery('#layer__pers').val(objLayer['deformation']['pers']);\r\n\r\n                    //FILTERS\r\n                    jQuery('#blurfilter_idle').val(objLayer['deformation']['blurfilter']);\r\n                    jQuery('#grayscalefilter_idle').val(objLayer['deformation']['grayscalefilter']);\r\n                    //jQuery('#ds_x_idle').val(objLayer['deformation']['ds_x']);\r\n                    //jQuery('#ds_y_idle').val(objLayer['deformation']['ds_y']);\r\n                    //jQuery('#ds_blur_idle').val(objLayer['deformation']['ds_blur']);\r\n                    //jQuery('#ds_color_idle').val(objLayer['deformation']['ds_color']);\r\n                    //jQuery('#ds_opacity_idle').val(objLayer['deformation']['ds_opacity']);\r\n\r\n                    //FILTERS\r\n                    jQuery('#blurfilter_hover').val(objLayer['deformation-hover']['blurfilter']);\r\n                    jQuery('#grayscalefilter_hover').val(objLayer['deformation-hover']['grayscalefilter']);\r\n                    //jQuery('#ds_x_hover').val(objLayer['deformation-hover']['ds_x']);\r\n                    //\tjQuery('#ds_y_hover').val(objLayer['deformation-hover']['ds_y']);\r\n                    //\tjQuery('#ds_blur_hover').val(objLayer['deformation-hover']['ds_blur']);\r\n                    //\tjQuery('#ds_color_hover').val(objLayer['deformation-hover']['ds_color']);\r\n                    //\tjQuery('#ds_opacity_hover').val(objLayer['deformation-hover']['ds_opacity']);\r\n\r\n\r\n                    jQuery('#layer_cornerleft option[value=\"'+objLayer['deformation']['corner_left']+'\"]').attr('selected', true);\r\n                    jQuery('#layer_blend_mode option[value=\"'+objLayer['layer_blend_mode']+'\"]').attr('selected', true);\r\n\r\n\r\n                    jQuery('#layer_cornerright option[value=\"'+objLayer['deformation']['corner_right']+'\"]').attr('selected', true);\r\n                    jQuery('#parallax_level option[value=\"'+objLayer['deformation']['parallax']+'\"]').attr('selected', true);\r\n\r\n\r\n\r\n\r\n                    if (nix(objLayer['deformation-hover']['border-width']) || (nix(objLayer['deformation-hover']['border-width'][0]) && nix(objLayer['deformation-hover']['border-width'][1]) && nix(objLayer['deformation-hover']['border-width'][2]) && nix(objLayer['deformation-hover']['border-width'][3])) || reset) {\r\n\r\n                        var cor = !nix(hover_styles['border-width']) ? typeof(hover_styles['border-width']) !== 'object' ? hover_styles['border-width'].split(\" \") : hover_styles['border-width'] : [\"0px\",\"0px\",\"0px\",\"0px\"];\r\n                        objLayer['deformation-hover']['border-width'] = [\"0\",\"0\",\"0\",\"0\"];\r\n\r\n                        jQuery(objLayer['deformation-hover']['border-width']).each(function(i){\r\n                            objLayer['deformation-hover']['border-width'][i] = cor.length<2 ? cor[0] : cor.length<4 ? i==0 || i==2 ? cor[0] : cor[1] : cor[i];\r\n                        });\r\n                    }\r\n\r\n                    if (nix(objLayer['deformation-hover']['color-transparency']) || reset)\r\n                        objLayer['deformation-hover']['color-transparency'] = !nix(hover_styles['color-transparency']) ? hover_styles['color-transparency'] : '1';\r\n\r\n                    if (nix(objLayer['deformation-hover']['text-decoration']) || reset)\r\n                        objLayer['deformation-hover']['text-decoration'] = !nix(hover_styles['text-decoration']) ? hover_styles['text-decoration'] : 'none';\r\n\r\n                    if (nix(objLayer['deformation-hover']['background-color']) || reset)\r\n                        objLayer['deformation-hover']['background-color'] = !nix(hover_styles['background-color']) ? hover_styles['background-color'] : 'transparent';\r\n\r\n                    if (nix(objLayer['deformation-hover']['background-transparency']) || reset)\r\n                        objLayer['deformation-hover']['background-transparency'] = !nix(hover_styles['background-transparency']) ? hover_styles['background-transparency'] : '1';\r\n\r\n                    if (nix(objLayer['deformation-hover']['border-color']) || reset)\r\n                        objLayer['deformation-hover']['border-color'] = !nix(hover_styles['border-color']) ? hover_styles['border-color'] : 'transparent';\r\n\r\n                    if (nix(objLayer['deformation-hover']['border-transparency']) || reset)\r\n                        objLayer['deformation-hover']['border-transparency'] = !nix(hover_styles['border-transparency']) ? hover_styles['border-transparency'] : '1';\r\n\r\n                    if (nix(objLayer['deformation-hover']['border-style']) || reset)\r\n                        objLayer['deformation-hover']['border-style'] = !nix(hover_styles['border-style']) ? hover_styles['border-style'] : 'none';\r\n\r\n                    if (nix(objLayer['deformation-hover']['border-width']) || reset)\r\n                        objLayer['deformation-hover']['border-width'] = !nix(hover_styles['border-width']) ? hover_styles['border-width'] : '0';\r\n\r\n\r\n                    if (nix(objLayer['deformation-hover']['border-radius']) || (nix(objLayer['deformation-hover']['border-radius'][0]) && nix(objLayer['deformation-hover']['border-radius'][1]) && nix(objLayer['deformation-hover']['border-radius'][2]) && nix(objLayer['deformation-hover']['border-radius'][3])) || reset) {\r\n\r\n                        var cor = !nix(hover_styles['border-radius']) ? typeof(hover_styles['border-radius']) !== 'object' ? hover_styles['border-radius'].split(\" \") : hover_styles['border-radius'] : [\"0px\",\"0px\",\"0px\",\"0px\"];\r\n                        objLayer['deformation-hover']['border-radius'] = [\"0\",\"0\",\"0\",\"0\"];\r\n\r\n                        jQuery(objLayer['deformation-hover']['border-radius']).each(function(i){\r\n                            objLayer['deformation-hover']['border-radius'][i] = cor.length<2 ? cor[0] : cor.length<4 ? i==0 || i==2 ? cor[0] : cor[1] : cor[i];\r\n                        });\r\n                    }\r\n\r\n                    if (nix(objLayer['deformation-hover']['skewx']) || reset)\r\n                        objLayer['deformation-hover']['skewx'] = !nix(hover_styles['skewx']) ? hover_styles['skewx'] : 0;\r\n                    if (nix(objLayer['deformation-hover']['skewy']) || reset)\r\n                        objLayer['deformation-hover']['skewy'] = !nix(hover_styles['skewy']) ? hover_styles['skewy'] : 0;\r\n                    if (nix(objLayer['deformation-hover']['scalex']) || reset)\r\n                        objLayer['deformation-hover']['scalex'] = !nix(hover_styles['scalex']) ? hover_styles['scalex'] : 1;\r\n                    if (nix(objLayer['deformation-hover']['scaley']) || reset)\r\n                        objLayer['deformation-hover']['scaley'] = !nix(hover_styles['scaley']) ? hover_styles['scaley'] : 1;\r\n                    if (nix(objLayer['deformation-hover']['opacity']) || reset)\r\n                        objLayer['deformation-hover']['opacity'] = !nix(hover_styles['opacity']) ? hover_styles['opacity'] : 1;\r\n                    if (nix(objLayer['deformation-hover']['xrotate']) || reset)\r\n                        objLayer['deformation-hover']['xrotate'] = !nix(hover_styles['xrotate']) ? hover_styles['xrotate'] : 0;\r\n                    if (nix(objLayer['deformation-hover']['yrotate']) || reset)\r\n                        objLayer['deformation-hover']['yrotate'] = !nix(hover_styles['yrotate']) ? hover_styles['yrotate'] : 0;\r\n                    if (nix(objLayer['deformation-hover']['2d_rotation']) || reset)\r\n                        objLayer['deformation-hover']['2d_rotation'] = !nix(hover_styles['2d_rotation']) ? hover_styles['2d_rotation'] : 0;\r\n                    if (nix(objLayer['deformation-hover']['css_cursor']) || reset)\r\n                        objLayer['deformation-hover']['css_cursor'] = !nix(hover_styles['css_cursor']) ? hover_styles['css_cursor'] : 'auto';\r\n\t\t\tif (nix(objLayer['deformation-hover']['pointer_events']) || reset)\r\n\t\t\t\tobjLayer['deformation-hover']['pointer_events'] = !nix(hover_styles['pointer_events']) ? hover_styles['pointer_events'] : 'auto';\r\n\r\n\r\n                    //FILTERS\r\n                    if (nix(objLayer['deformation-hover']['blurfilter']) || reset) objLayer['deformation-hover']['blurfilter'] =  !nix(hover_styles['blurfilter']) ?  hover_styles['blurfilter'] : 0;\r\n                    if (nix(objLayer['deformation-hover']['grayscalefilter']) || reset) objLayer['deformation-hover']['grayscalefilter'] =  !nix(hover_styles['grayscalefilter']) ?  hover_styles['grayscalefilter'] : 0;\r\n                    //if (nix(objLayer['deformation-hover']['ds_x']) || reset) objLayer['deformation-hover']['ds_x'] =  !nix(styles['ds_x']) ?  styles['ds_x'] : 0;\r\n                    //\tif (nix(objLayer['deformation-hover']['ds_y']) || reset) objLayer['deformation-hover']['ds_y'] =  !nix(styles['ds_y']) ?  styles['ds_y'] : 0;\r\n                    //if (nix(objLayer['deformation-hover']['ds_blur']) || reset) objLayer['deformation-hover']['ds_blur'] =  !nix(styles['ds_blur']) ?  styles['ds_blur'] : 0;\r\n                    //if (nix(objLayer['deformation-hover']['ds_color']) || reset) objLayer['deformation-hover']['ds_color'] =  !nix(styles['ds_color']) ?  styles['ds_color'] : 0;\r\n                    //if (nix(objLayer['deformation-hover']['ds_opacity']) || reset) objLayer['deformation-hover']['ds_opacity'] =  !nix(styles['ds_opacity']) ?  styles['ds_opacity'] : 0;\r\n\r\n\r\n\r\n                    /* not included yet, missing values */\r\n                    if (nix(objLayer['deformation-hover']['speed']) || reset)\r\n                        objLayer['deformation-hover']['speed'] = !nix(hover_styles['speed']) ? hover_styles['speed'] : '0';\r\n\r\n                    if (nix(objLayer['deformation-hover']['easing']) || reset)\r\n                        objLayer['deformation-hover']['easing'] = !nix(hover_styles['easing']) ? hover_styles['easing'] : 'Linear.easeNone';\r\n\r\n                    /* ENDE not included yet, missing values */\r\n\r\n                    if(objLayer['deformation-hover'] != undefined){\r\n                        jQuery('#hover_layer_color_s').val(objLayer['deformation-hover']['color']);\r\n                        jQuery('#hover_css_font-transparency').val(objLayer['deformation-hover']['color-transparency']);\r\n                        jQuery('#hover_css_text-decoration option[value=\"'+objLayer['deformation-hover']['text-decoration']+'\"]').attr('selected', true);\r\n                        jQuery('#hover_css_background-color').val(objLayer['deformation-hover']['background-color']);\r\n                        jQuery('#hover_css_background-transparency').val(objLayer['deformation-hover']['background-transparency']);\r\n                        jQuery('#hover_css_border-color-show').val(objLayer['deformation-hover']['border-color']);\r\n                        jQuery('#hover_css_border-transparency').val(objLayer['deformation-hover']['border-transparency']);\r\n                        jQuery('#hover_css_border-style option[value=\"'+objLayer['deformation-hover']['border-style']+'\"]').attr('selected', true);\r\n                        jQuery('input[name=\"hover_css_border-width[]\"]').each(function(i){ jQuery(this).val(objLayer['deformation-hover']['border-width'][i]); });\r\n                        jQuery('input[name=\"hover_css_border-radius[]\"]').each(function(i){ jQuery(this).val(objLayer['deformation-hover']['border-radius'][i]); });\r\n                        jQuery('#hover_layer__skewx').val(objLayer['deformation-hover']['skewx']);\r\n                        jQuery('#hover_layer__skewy').val(objLayer['deformation-hover']['skewy']);\r\n                        jQuery('#hover_layer__scalex').val(objLayer['deformation-hover']['scalex']);\r\n                        jQuery('#hover_layer__scaley').val(objLayer['deformation-hover']['scaley']);\r\n                        jQuery('#hover_layer__opacity').val(objLayer['deformation-hover']['opacity']);\r\n                        jQuery('#hover_layer__xrotate').val(objLayer['deformation-hover']['xrotate']);\r\n                        jQuery('#hover_layer__yrotate').val(objLayer['deformation-hover']['yrotate']);\r\n                        jQuery('#hover_layer_2d_rotation').val(objLayer['deformation-hover']['2d_rotation']); //z rotate\r\n                        jQuery('#css_cursor option[value=\"'+objLayer['deformation-hover']['css_cursor']+'\"]').attr('selected', true);\r\n\t\t\t\tjQuery('#pointer_events option[value=\"'+objLayer['deformation-hover']['pointer_events']+'\"]').attr('selected', true);\r\n                        jQuery('#hover_speed').val(objLayer['deformation-hover']['speed']);\r\n                        jQuery('#hover_zindex').val(objLayer['deformation-hover']['zindex']);\r\n                        jQuery('#hover_easing option[value=\"'+objLayer['deformation-hover']['easing']+'\"]').attr('selected', true);\r\n\r\n                    }\r\n                }\r\n\r\n                jQuery('.wp-color-result').each(function(){\r\n                    jQuery(this).css('backgroundColor', jQuery(this).parent().find('.my-color-field').val());\r\n                });\r\n\r\n\r\n                return objLayer;\r\n\r\n            }\r\n\r\n\r\n\r\n\r\n            /**\r\n             * update layer parameters from the object\r\n             */\r\n            t.updateLayerFormFields = function(serial){\r\n\r\n                var objLayer = t.arrLayers[serial];\r\n\r\n                // HOOK FOR EXTERNAL ADDONS\r\n                jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n                    var callback = callback_element[\"callback\"],\r\n                        env = callback_element[\"environment\"],\r\n                        env_sub = callback_element[\"function_position\"];\r\n                    if (env === \"updateLayerFormFields\" && env_sub==\"start\")\r\n                        objLayer = callback(objLayer);\r\n\r\n                });\r\n\r\n                if(typeof(objLayer) == 'undefined') return true;\r\n\r\n                jQuery('#internal_classes').val(objLayer.internal_class);\r\n\r\n                jQuery('.rs-internal-class-wrapper').text(objLayer.internal_class);\r\n\r\n                jQuery('#layer_caption').val(objLayer.style);\r\n\r\n                jQuery('#layer_text').val(UniteAdminRev.stripslashes(objLayer.text));\r\n\r\n                if (objLayer.texttoggle!=undefined)\r\n                    jQuery('#layer_text_toggle').val(UniteAdminRev.stripslashes(objLayer.texttoggle));\r\n                else\r\n                    jQuery('#layer_text_toggle').val(\"\");\r\n\r\n\r\n\r\n                jQuery('#layer_text').data('new_content',false)\r\n                jQuery('#layer_alt_option option[value=\"'+objLayer.alt_option+'\"]').attr('selected', 'selected');\r\n                jQuery('#layer_alt').val(objLayer.alt);\r\n\r\n                jQuery('#layer_alias_name').val(objLayer.alias);\r\n\r\n                if(objLayer['hover'] == 'true' || objLayer['hover'] == true){\r\n                    jQuery('#hover_allow').prop(\"checked\", true);\r\n                    jQuery('#idle-hover-swapper').show();\r\n                }else{\r\n                    jQuery('#hover_allow').prop(\"checked\", false);\r\n                    jQuery('#idle-hover-swapper').hide();\r\n                }\r\n\r\n                /*if (objLayer['force_hover'] == 'true' || objLayer['force_hover'] == true)\r\n                 jQuery('#force_hover').prop(\"checked\",true);\r\n                 else\r\n                 jQuery('#force_hover').prop(\"checked\",false);*/\r\n\r\n                /*if (objLayer['deformation']['shadow_idle'] == 'true' || objLayer['deformation']['shadow_idle'] == true)\r\n                 jQuery('#shadow_idle').prop(\"checked\",true);\r\n                 else\r\n                 jQuery('#shadow_idle').prop(\"checked\",false);\r\n\r\n                 if (objLayer['deformation-hover']['shadow_hover'] == 'true' || objLayer['deformation']['shadow_hover'] == true)\r\n                 jQuery('#shadow_hover').prop(\"checked\",true);\r\n                 else\r\n                 jQuery('#shadow_hover').prop(\"checked\",false);\r\n                 */\r\n\r\n                if(objLayer['toggle'] == 'true' || objLayer['toggle'] == true){\r\n                    jQuery('#toggle_allow').prop(\"checked\", true);\r\n                }else{\r\n                    jQuery('#toggle_allow').prop(\"checked\", false);\r\n                }\r\n\r\n                if(objLayer['toggle_use_hover'] == 'true' || objLayer['toggle_use_hover'] == true){\r\n                    jQuery('#toggle_use_hover').prop(\"checked\", true);\r\n                }else{\r\n                    jQuery('#toggle_use_hover').prop(\"checked\", false);\r\n                }\r\n\r\n                if(objLayer['toggle_inverse_content'] == 'true' || objLayer['toggle_inverse_content'] == true){\r\n                    jQuery('#toggle_inverse_content').prop(\"checked\", true);\r\n                }else{\r\n                    jQuery('#toggle_inverse_content').prop(\"checked\", false);\r\n                }\r\n\r\n\r\n\r\n                if(objLayer['visible-notebook'] == 'true' || objLayer['visible-notebook'] == true)\r\n                    jQuery('#visible-notebook').prop('checked',true);\r\n                else\r\n                    jQuery('#visible-notebook').prop('checked',false);\r\n\r\n                if(objLayer['visible-desktop'] == \"true\" || objLayer['visible-desktop'] == true)\r\n                    jQuery('#visible-desktop').prop('checked',true);\r\n                else\r\n                    jQuery('#visible-desktop').prop('checked',false);\r\n\r\n                if(objLayer['visible-tablet'] == \"true\" || objLayer['visible-tablet'] == true)\r\n                    jQuery('#visible-tablet').prop('checked',true);\r\n                else\r\n                    jQuery('#visible-tablet').prop('checked',false);\r\n\r\n                if(objLayer['visible-mobile'] == \"true\" || objLayer['visible-mobile'] == true)\r\n                    jQuery('#visible-mobile').prop('checked',true);\r\n                else\r\n                    jQuery('#visible-mobile').prop('checked',false);\r\n\r\n                if(objLayer['show-on-hover'] == \"true\" || objLayer['show-on-hover'] == true)\r\n                    jQuery('#layer_on_slider_hover').prop('checked',true);\r\n                else\r\n                    jQuery('#layer_on_slider_hover').prop('checked',false);\r\n\r\n                jQuery('#layer-lazy-loading option[value=\"'+objLayer['lazy-load']+'\"]').attr('selected', 'selected');\r\n                jQuery('#layer-image-size option[value=\"'+objLayer['image-size']+'\"]').attr('selected', 'selected');\r\n                jQuery('#layer-css-position option[value=\"'+objLayer['css-position']+'\"]').attr('selected', 'selected');\r\n\r\n                RevSliderSettings.onoffStatus(jQuery('#hover_allow'));\r\n                //RevSliderSettings.onoffStatus(jQuery('#force_hover'));\r\n                //RevSliderSettings.onoffStatus(jQuery('#shadow_idle'));\r\n                //RevSliderSettings.onoffStatus(jQuery('#shadow_hover'));\r\n                RevSliderSettings.onoffStatus(jQuery('#toggle_allow'));\r\n                RevSliderSettings.onoffStatus(jQuery('#toggle_use_hover'));\r\n                RevSliderSettings.onoffStatus(jQuery('#toggle_inverse_content'));\r\n                RevSliderSettings.onoffStatus(jQuery('#visible-desktop'));\r\n                RevSliderSettings.onoffStatus(jQuery('#visible-notebook'));\r\n                RevSliderSettings.onoffStatus(jQuery('#visible-tablet'));\r\n                RevSliderSettings.onoffStatus(jQuery('#visible-mobile'));\r\n                RevSliderSettings.onoffStatus(jQuery('#layer_on_slider_hover'));\r\n\r\n                jQuery(\"#layer_scaleX\").val(specOrVal(t.getVal(objLayer,'scaleX'),[\"auto\",'#1/1#','#1/2#','#1/3#','#1/4#','#1/5#','#1/6#','#2/3#','#3/4#','#2/5#','#3/5#','#4/5#','#4/6#','#5/6#'],\"px\"));\r\n                jQuery(\"#layer_scaleY\").val(specOrVal(t.getVal(objLayer,'scaleY'),[\"auto\",'#1/1#','#1/2#','#1/3#','#1/4#','#1/5#','#1/6#','#2/3#','#3/4#','#2/5#','#3/5#','#4/5#','#4/6#','#5/6#'],\"px\"));\r\n\r\n                jQuery('#layer_cover_mode option[value=\"'+objLayer['cover_mode']+'\"]').attr('selected', 'selected');\r\n\r\n                jQuery(\"#layer_max_height\").val(specOrVal(t.getVal(objLayer,'max_height'),[\"auto\",'#1/1#','#1/2#','#1/3#','#1/4#','#1/5#','#1/6#','#2/3#','#3/4#','#2/5#','#3/5#','#4/5#','#4/6#','#5/6#'],\"px\"));\r\n                jQuery(\"#layer_min_height\").val(specOrVal(t.getVal(objLayer,'min_height'),[\"auto\",'#1/1#','#1/2#','#1/3#','#1/4#','#1/5#','#1/6#','#2/3#','#3/4#','#2/5#','#3/5#','#4/5#','#4/6#','#5/6#'],\"px\"));\r\n                jQuery(\"#layer_max_width\").val(specOrVal(t.getVal(objLayer,'max_width'),[\"auto\",'#1/1#','#1/2#','#1/3#','#1/4#','#1/5#','#1/6#','#2/3#','#3/4#','#2/5#','#3/5#','#4/5#','#4/6#','#5/6#'],\"px\"));\r\n\r\n                jQuery(\"#layer_video_height\").val(specOrVal(t.getVal(objLayer,'video_height'),[\"auto\",'#1/1#','#1/2#','#1/3#','#1/4#','#1/5#','#1/6#','#2/3#','#3/4#','#2/5#','#3/5#','#4/5#','#4/6#','#5/6#'],\"px\"));\r\n                jQuery(\"#layer_video_width\").val(specOrVal(t.getVal(objLayer,'video_width'),[\"auto\",'#1/1#','#1/2#','#1/3#','#1/4#','#1/5#','#1/6#','#2/3#','#3/4#','#2/5#','#3/5#','#4/5#','#4/6#','#5/6#'],\"px\"));\r\n\r\n                jQuery(\"#layer_2d_rotation\").val(objLayer['2d_rotation']);\r\n                jQuery(\"#layer_2d_origin_x\").val(objLayer['2d_origin_x']);\r\n                jQuery(\"#layer_2d_origin_y\").val(objLayer['2d_origin_y']);\r\n\r\n                jQuery(\"#layer_static_start option[value='\"+objLayer.static_start+\"']\").attr('selected', 'selected');\r\n                changeEndStaticFunctions();\r\n                jQuery(\"#layer_static_end option[value='\"+objLayer.static_end+\"']\").attr('selected', 'selected');\r\n\r\n                jQuery(\"#layer_whitespace option[value='\"+t.getVal(objLayer, 'whitespace')+\"']\").attr('selected', 'selected');\r\n\r\n                jQuery(\"#layer_display option[value='\"+t.getVal(objLayer, 'display')+\"']\").attr('selected', 'selected');\r\n\r\n\r\n                if(objLayer.scaleProportional == \"true\" || objLayer.scaleProportional == true){\r\n                    jQuery('.rs-proportion-check').removeClass('notselected');\r\n                    jQuery(\"#layer_proportional_scale\").prop(\"checked\",true);\r\n                }else{\r\n                    jQuery(\"#layer_proportional_scale\").prop(\"checked\",false);\r\n                    jQuery('.rs-proportion-check').addClass('notselected');\r\n                }\r\n\r\n\r\n                if (t.getVal(objLayer, 'whitespace') ===\"normal\") {\r\n                    jQuery('.rs-linebreak-check').removeClass(\"notselected\");\r\n                    jQuery('#layer_auto_line_break').prop(\"checked\",true);\r\n                } else {\r\n                    jQuery('.rs-linebreak-check').addClass(\"notselected\");\r\n                    jQuery('#layer_auto_line_break').prop(\"checked\",false);\r\n                }\r\n\r\n                if (t.getVal(objLayer, 'display') ===\"block\") {\r\n                    jQuery('#layer-displaymode-wrapper').removeClass(\"notselected\");\r\n                    jQuery('#layer_displaymode').prop(\"checked\",true);\r\n                } else {\r\n                    jQuery('#layer-displaymode-wrapper').addClass(\"notselected\");\r\n                    jQuery('#layer_displaymode').prop(\"checked\",false);\r\n                }\r\n\r\n\r\n                RevSliderSettings.onoffStatus(jQuery('.rs-proportion-check'));\r\n                RevSliderSettings.onoffStatus(jQuery('.rs-linebreak-check'));\r\n\r\n                jQuery(\"#layer_top\").val(parseInt(t.getVal(objLayer, 'top'),0)+\"px\");\r\n                jQuery(\"#layer_left\").val(parseInt(t.getVal(objLayer, 'left'),0)+\"px\");\r\n\r\n                jQuery(\"#layer_bg_position option[value='\"+objLayer.layer_bg_position+\"']\").attr('selected', 'selected');\r\n                jQuery(\"#layer_bg_size option[value='\"+objLayer.layer_bg_size+\"']\").attr('selected', 'selected');\r\n                jQuery(\"#layer_bg_repeat option[value='\"+objLayer.layer_bg_repeat+\"']\").attr('selected', 'selected');\r\n\r\n\r\n                //set Loop Animations\r\n                jQuery(\"#layer_loop_animation option[value='\"+objLayer.loop_animation+\"']\").attr('selected', 'selected');\r\n                jQuery(\"#layer_loop_easing\").val(objLayer.loop_easing);\r\n                jQuery(\"#layer_loop_speed\").val(objLayer.loop_speed);\r\n                jQuery(\"#layer_loop_startdeg\").val(objLayer.loop_startdeg);\r\n                jQuery(\"#layer_loop_enddeg\").val(objLayer.loop_enddeg);\r\n                jQuery(\"#layer_loop_xorigin\").val(objLayer.loop_xorigin);\r\n                jQuery(\"#layer_loop_yorigin\").val(objLayer.loop_yorigin);\r\n                jQuery(\"#layer_loop_xstart\").val(objLayer.loop_xstart);\r\n                jQuery(\"#layer_loop_xend\").val(objLayer.loop_xend);\r\n                jQuery(\"#layer_loop_ystart\").val(objLayer.loop_ystart);\r\n                jQuery(\"#layer_loop_yend\").val(objLayer.loop_yend);\r\n                jQuery(\"#layer_loop_zoomstart\").val(objLayer.loop_zoomstart);\r\n                jQuery(\"#layer_loop_zoomend\").val(objLayer.loop_zoomend);\r\n                jQuery(\"#layer_loop_angle\").val(objLayer.loop_angle);\r\n                jQuery(\"#layer_loop_radius\").val(objLayer.loop_radius);\r\n\r\n                if (objLayer['svg']!=undefined) {\r\n                    jQuery('#css_svgstroke-color-show').val(objLayer['svg']['svgstroke-color']);\r\n                    jQuery('#css_svgstroke-transparency').val(objLayer['svg']['svgstroke-transparency']);\r\n                    jQuery('#css_svgstroke-dasharray').val(objLayer['svg']['svgstroke-dasharray']);\r\n                    jQuery('#css_svgstroke-dashoffset').val(objLayer['svg']['svgstroke-dashoffset']);\r\n                    jQuery('#css_svgstroke-width').val(objLayer['svg']['svgstroke-width']);\r\n                    jQuery('#css_svgstroke-hover-color-show').val(objLayer['svg']['svgstroke-hover-color']);\r\n                    jQuery('#css_svgstroke-hover-transparency').val(objLayer['svg']['svgstroke-hover-transparency']);\r\n                    jQuery('#css_svgstroke-hover-dasharray').val(objLayer['svg']['svgstroke-hover-dasharray']);\r\n                    jQuery('#css_svgstroke-hover-dashoffset').val(objLayer['svg']['svgstroke-hover-dashoffset']);\r\n                    jQuery('#css_svgstroke-hover-width').val(objLayer['svg']['svgstroke-hover-width']);\r\n                }\r\n\r\n                jQuery(\"#layer_html_tag option[value='\"+objLayer.html_tag+\"']\").attr('selected', 'selected');\r\n                jQuery(\"#parallax_layer_ddd_zlevel option[value='\"+objLayer.parallax_layer_ddd_zlevel+\"']\").attr('selected', 'selected');\r\n\r\n                if(objLayer.mask_start == \"true\" || objLayer.mask_start == true) {\r\n                    jQuery('#masking-start').prop(\"checked\",false);\r\n                    jQuery('.mask-start-settings').show();\r\n                }\r\n                else {\r\n                    jQuery('#masking-end').prop(\"checked\",false);\r\n                    jQuery('.mask-start-settings').hide();\r\n                }\r\n\r\n                if(objLayer.mask_end == \"true\" || objLayer.mask_end == true) {\r\n                    jQuery('#masking-end').attr(\"checked\", true);\r\n                    jQuery('.mask-end-settings').show();\r\n                }\r\n                else {\r\n                    jQuery('#masking-end').removeAttr(\"checked\");\r\n                    jQuery('.mask-end-settings').hide();\r\n                }\r\n\r\n                RevSliderSettings.onoffStatus(jQuery('#masking-start'));\r\n                RevSliderSettings.onoffStatus(jQuery('#masking-end'));\r\n\r\n                jQuery(\"#mask_anim_xstart\").val(objLayer.mask_x_start);\r\n                jQuery(\"#mask_anim_ystart\").val(objLayer.mask_y_start);\r\n                jQuery(\"#mask_speed\").val(objLayer.mask_speed_start);\r\n                jQuery(\"#mask_easing\").val(objLayer.mask_ease_start);\r\n\r\n                jQuery(\"#mask_anim_xend\").val(objLayer.mask_x_end);\r\n                jQuery(\"#mask_anim_yend\").val(objLayer.mask_y_end);\r\n\r\n                jQuery(\"#layer_animation option[value='\"+objLayer.frames[\"frame_0\"].animation+\"']\").attr('selected', 'selected');\r\n\r\n                jQuery(\"#layer_easing\").val(objLayer.frames[\"frame_0\"].easing);\r\n\r\n                jQuery(\"#layer_split\").val(objLayer.frames[\"frame_0\"].split);\r\n                jQuery(\"#layer_endsplit\").val(objLayer.frames[\"frame_999\"].split);\r\n                jQuery(\"#layer_splitdelay\").val(objLayer.frames[\"frame_0\"].splitdelay);\r\n                jQuery(\"#layer_endsplitdelay\").val(objLayer.frames[\"frame_999\"].splitdelay);\r\n\r\n\r\n                jQuery(\"#layer_speed\").val(objLayer.frames[\"frame_0\"].speed);\r\n\r\n                jQuery(\"#layer_align_hor\").val(t.getVal(objLayer,'align_hor'));\r\n                jQuery(\"#layer_align_vert\").val(t.getVal(objLayer,'align_vert'));\r\n\r\n                if(objLayer.hiddenunder == \"true\" || objLayer.hiddenunder == true)\r\n                    jQuery(\"#layer_hidden\").prop(\"checked\",true);\r\n                else\r\n                    jQuery(\"#layer_hidden\").prop(\"checked\",false);\r\n\r\n\r\n\r\n                if(objLayer.resizeme == \"true\" || objLayer.resizeme == true)\r\n                    jQuery(\"#layer_resizeme\").prop(\"checked\",true);\r\n                else\r\n                    jQuery(\"#layer_resizeme\").prop(\"checked\",false);\r\n\r\n                if(objLayer['seo-optimized'] == \"true\" || objLayer['seo-optimized'] == true)\r\n                    jQuery(\"#layer-seo-optimized\").prop(\"checked\",true);\r\n                else\r\n                    jQuery(\"#layer-seo-optimized\").prop(\"checked\",false);\r\n\r\n                if((objLayer['resize-full'] == \"true\" || objLayer['resize-full'] == true) && (objLayer.type!==\"row\" && objLayer.type!==\"column\")){\r\n                    jQuery(\"#layer_resize-full\").prop(\"checked\",true);\r\n                    if (objLayer.type===\"group\") {\r\n                        jQuery(\"#layer_resizeme\").prop(\"checked\",false);\r\n                        objLayer.resizeme = false; //remove checked state!\r\n                    }\r\n                }else{\r\n                    jQuery(\"#layer_resize-full\").prop(\"checked\",false);\r\n                    jQuery(\"#layer_resizeme\").prop(\"checked\",false);\r\n                    objLayer.resizeme = false; //remove checked state!\r\n                }\r\n\r\n                jQuery(\"#layer_align_base\").val(objLayer.basealign);\r\n\r\n                if(objLayer.responsive_offset == \"true\" || objLayer.responsive_offset == true)\r\n                    jQuery(\"#layer_resp_offset\").prop(\"checked\",true);\r\n                else\r\n                    jQuery(\"#layer_resp_offset\").prop(\"checked\",false);\r\n\r\n                RevSliderSettings.onoffStatus(jQuery(\"#layer_hidden\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#layer_resizeme\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#layer_resize-full\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#layer_resp_offset\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#layer-seo-optimized\"));\r\n\r\n                jQuery(\"#layer_image_link\").val(objLayer.link);\r\n                jQuery(\"#layer_link_open_in\").val(objLayer.link_open_in);\r\n                jQuery(\"#layer_link_id\").val(objLayer.link_id);\r\n                jQuery(\"#layer_link_class\").val(objLayer.link_class);\r\n                jQuery(\"#layer_link_title\").val(objLayer.link_title);\r\n                jQuery(\"#layer_link_rel\").val(objLayer.link_rel);\r\n\r\n                jQuery('#layer_auto_line_break').val(objLayer.autolinebreak);\r\n\r\n                jQuery('#layer_displaymode').val(objLayer.displaymode);\r\n\r\n\r\n                jQuery(\"#layer_endanimation\").val(objLayer.frames[\"frame_999\"].animation);\r\n                jQuery(\"#layer_endeasing\").val(objLayer.frames[\"frame_999\"].easing);\r\n                jQuery(\"#layer_endspeed\").val(objLayer.frames[\"frame_999\"].speed);\r\n\r\n                jQuery(\"#layer_anim_xstart\").val(objLayer.x_start);\r\n                jQuery(\"#layer_anim_ystart\").val(objLayer.y_start);\r\n                jQuery(\"#layer_anim_zstart\").val(objLayer.z_start);\r\n                jQuery(\"#layer_anim_xend\").val(objLayer.x_end);\r\n                jQuery(\"#layer_anim_yend\").val(objLayer.y_end);\r\n                jQuery(\"#layer_anim_zend\").val(objLayer.z_end);\r\n                jQuery(\"#layer_opacity_start\").val(objLayer.opacity_start);\r\n                jQuery(\"#layer_opacity_end\").val(objLayer.opacity_end);\r\n                jQuery(\"#blurfilter_start\").val(objLayer.blurfilter_start);\r\n                jQuery(\"#blurfilter_end\").val(objLayer.blurfilter_end);\r\n                jQuery(\"#grayscalefilter_start\").val(objLayer.grayscalefilter_start);\r\n                jQuery(\"#grayscalefilter_end\").val(objLayer.grayscalefilter_end);\r\n                jQuery(\"#layer_anim_xrotate\").val(objLayer.x_rotate_start);\r\n                jQuery(\"#layer_anim_yrotate\").val(objLayer.y_rotate_start);\r\n                jQuery(\"#layer_anim_zrotate\").val(objLayer.z_rotate_start);\r\n                jQuery(\"#layer_anim_xrotate_end\").val(objLayer.x_rotate_end);\r\n                jQuery(\"#layer_anim_yrotate_end\").val(objLayer.y_rotate_end);\r\n                jQuery(\"#layer_anim_zrotate_end\").val(objLayer.z_rotate_end);\r\n                jQuery(\"#layer_scale_xstart\").val(objLayer.scale_x_start);\r\n                jQuery(\"#layer_scale_ystart\").val(objLayer.scale_y_start);\r\n                jQuery(\"#layer_scale_xend\").val(objLayer.scale_x_end);\r\n                jQuery(\"#layer_scale_yend\").val(objLayer.scale_y_end);\r\n                jQuery(\"#layer_skew_xstart\").val(objLayer.skew_x_start);\r\n                jQuery(\"#layer_skew_ystart\").val(objLayer.skew_y_start);\r\n                jQuery(\"#layer_skew_xend\").val(objLayer.skew_x_end);\r\n                jQuery(\"#layer_skew_yend\").val(objLayer.skew_y_end);\r\n\r\n                jQuery(\"#layer_pers_start\").val(objLayer.pers_start);\r\n                jQuery(\"#layer_pers_end\").val(objLayer.pers_end);\r\n\r\n                jQuery(\"#blurfilter_start\").val(objLayer.blurfilter_start);\r\n                jQuery(\"#blurfilter_end\").val(objLayer.blurfilter_end);\r\n                jQuery(\"#grayscalefilter_start\").val(objLayer.grayscalefilter_start);\r\n                jQuery(\"#grayscalefilter_end\").val(objLayer.grayscalefilter_end);\r\n\r\n                if(typeof(objLayer['layer-selectable']) !== 'undefined'){\r\n                    jQuery('#css_layer_selectable option[value=\"'+objLayer['layer-selectable']+'\"]').attr('selected', true);\r\n                }else{\r\n                    jQuery('#css_layer_selectable option[value=\"default\"]').attr('selected', true);\r\n                }\r\n\r\n                if(typeof(objLayer.x_start_reverse) !== 'undefined' && (objLayer.x_start_reverse == \"true\" || objLayer.x_start_reverse == true)) { jQuery('#layer_anim_xstart_reverse').attr('checked',true); }else{ jQuery('#layer_anim_xstart_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.y_start_reverse) !== 'undefined' && (objLayer.y_start_reverse == \"true\" || objLayer.y_start_reverse == true)) { jQuery('#layer_anim_ystart_reverse').attr('checked',true); }else{ jQuery('#layer_anim_ystart_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.x_end_reverse) !== 'undefined' && (objLayer.x_end_reverse == \"true\" || objLayer.x_end_reverse == true)) { jQuery('#layer_anim_xend_reverse').attr('checked',true); }else{ jQuery('#layer_anim_xend_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.y_end_reverse) !== 'undefined' && (objLayer.y_end_reverse == \"true\" || objLayer.y_end_reverse == true)) { jQuery('#layer_anim_yend_reverse').attr('checked',true); }else{ jQuery('#layer_anim_yend_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.x_rotate_start_reverse) !== 'undefined' && (objLayer.x_rotate_start_reverse == \"true\" || objLayer.x_rotate_start_reverse == true)) { jQuery('#layer_anim_xrotate_reverse').attr('checked',true); }else{ jQuery('#layer_anim_xrotate_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.y_rotate_start_reverse) !== 'undefined' && (objLayer.y_rotate_start_reverse == \"true\" || objLayer.y_rotate_start_reverse == true)) { jQuery('#layer_anim_yrotate_reverse').attr('checked',true); }else{ jQuery('#layer_anim_yrotate_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.z_rotate_start_reverse) !== 'undefined' && (objLayer.z_rotate_start_reverse == \"true\" || objLayer.z_rotate_start_reverse == true)) { jQuery('#layer_anim_zrotate_reverse').attr('checked',true); }else{ jQuery('#layer_anim_zrotate_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.x_rotate_end_reverse) !== 'undefined' && (objLayer.x_rotate_end_reverse == \"true\" || objLayer.x_rotate_end_reverse == true)) { jQuery('#layer_anim_xrotate_end_reverse').attr('checked',true); }else{ jQuery('#layer_anim_xrotate_end_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.y_rotate_end_reverse) !== 'undefined' && (objLayer.y_rotate_end_reverse == \"true\" || objLayer.y_rotate_end_reverse == true)) { jQuery('#layer_anim_yrotate_end_reverse').attr('checked',true); }else{ jQuery('#layer_anim_yrotate_end_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.z_rotate_end_reverse) !== 'undefined' && (objLayer.z_rotate_end_reverse == \"true\" || objLayer.z_rotate_end_reverse == true)) { jQuery('#layer_anim_zrotate_end_reverse').attr('checked',true); }else{ jQuery('#layer_anim_zrotate_end_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.scale_x_start_reverse) !== 'undefined' && (objLayer.scale_x_start_reverse == \"true\" || objLayer.scale_x_start_reverse == true)) { jQuery('#layer_scale_xstart_reverse').attr('checked',true); }else{ jQuery('#layer_scale_xstart_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.scale_y_start_reverse) !== 'undefined' && (objLayer.scale_y_start_reverse == \"true\" || objLayer.scale_y_start_reverse == true)) { jQuery('#layer_scale_ystart_reverse').attr('checked',true); }else{ jQuery('#layer_scale_ystart_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.scale_x_end_reverse) !== 'undefined' && (objLayer.scale_x_end_reverse == \"true\" || objLayer.scale_x_end_reverse == true)) { jQuery('#layer_scale_xend_reverse').attr('checked',true); }else{ jQuery('#layer_scale_xend_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.scale_y_end_reverse) !== 'undefined' && (objLayer.scale_y_end_reverse == \"true\" || objLayer.scale_y_end_reverse == true)) { jQuery('#layer_scale_yend_reverse').attr('checked',true); }else{ jQuery('#layer_scale_yend_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.skew_x_start_reverse) !== 'undefined' && (objLayer.skew_x_start_reverse == \"true\" || objLayer.skew_x_start_reverse == true)) { jQuery('#layer_skew_xstart_reverse').attr('checked',true); }else{ jQuery('#layer_skew_xstart_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.skew_y_start_reverse) !== 'undefined' && (objLayer.skew_y_start_reverse == \"true\" || objLayer.skew_y_start_reverse == true)) { jQuery('#layer_skew_ystart_reverse').attr('checked',true); }else{ jQuery('#layer_skew_ystart_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.skew_x_end_reverse) !== 'undefined' && (objLayer.skew_x_end_reverse == \"true\" || objLayer.skew_x_end_reverse == true)) { jQuery('#layer_skew_xend_reverse').attr('checked',true); }else{ jQuery('#layer_skew_xend_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.skew_y_end_reverse) !== 'undefined' && (objLayer.skew_y_end_reverse == \"true\" || objLayer.skew_y_end_reverse == true)) { jQuery('#layer_skew_yend_reverse').attr('checked',true); }else{ jQuery('#layer_skew_yend_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.mask_x_start_reverse) !== 'undefined' && (objLayer.mask_x_start_reverse == \"true\" || objLayer.mask_x_start_reverse == true)) { jQuery('#mask_anim_xstart_reverse').attr('checked',true); }else{ jQuery('#mask_anim_xstart_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.mask_y_start_reverse) !== 'undefined' && (objLayer.mask_y_start_reverse == \"true\" || objLayer.mask_y_start_reverse == true)) { jQuery('#mask_anim_ystart_reverse').attr('checked',true); }else{ jQuery('#mask_anim_ystart_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.mask_x_end_reverse) !== 'undefined' && (objLayer.mask_x_end_reverse == \"true\" || objLayer.mask_x_end_reverse == true)) { jQuery('#mask_anim_xend_reverse').attr('checked',true); }else{ jQuery('#mask_anim_xend_reverse').prop(\"checked\",false); }\r\n                if(typeof(objLayer.mask_y_end_reverse) !== 'undefined' && (objLayer.mask_y_end_reverse == \"true\" || objLayer.mask_y_end_reverse == true)) { jQuery('#mask_anim_yend_reverse').attr('checked',true); }else{ jQuery('#mask_anim_yend_reverse').prop(\"checked\",false); }\r\n\r\n                t.updateReverseList();\r\n\r\n\r\n                //set advanced params\r\n\r\n                if(objLayer['static_styles'] != undefined){\r\n                    jQuery(\"#layer_font_size_s\").val(t.getVal(objLayer['static_styles'], 'font-size'));\r\n                    jQuery(\"#layer_line_height_s\").val(t.getVal(objLayer['static_styles'], 'line-height'));\r\n                    jQuery(\"#layer_font_weight_s option[value='\"+t.getVal(objLayer['static_styles'], 'font-weight')+\"']\").attr('selected', true);\r\n                    jQuery(\"#layer_color_s\").val(t.getVal(objLayer['static_styles'], 'color'));\r\n                    jQuery(\"#letter_spacing_s\").val(t.getVal(objLayer['static_styles'], 'letter-spacing'));\r\n                }\r\n\r\n\r\n                if(objLayer.animation_overwrite != undefined)\r\n                    jQuery('#layer-animation-overwrite option[value=\"'+objLayer.animation_overwrite+'\"]').attr('selected', true);\r\n                else\r\n                    jQuery('#layer-animation-overwrite option[value=\"wait\"]').attr('selected', true);\r\n\r\n\r\n                if(objLayer.trigger_memory != undefined)\r\n                    jQuery('#layer-tigger-memory option[value=\"'+objLayer.trigger_memory+'\"]').attr('selected', true);\r\n                else\r\n                    jQuery('#layer-tigger-memory option[value=\"keep\"]').attr('selected', true);\r\n\r\n                //deformation part\r\n\r\n\r\n                //remove all html actions first\r\n                t.remove_layer_actions();\r\n\r\n                t.add_layer_actions(objLayer);\r\n\r\n                // Reset Fields from Style Template\r\n                objLayer = updateSubStyleParameters(objLayer);\r\n                //KRISZTIAN ( UPDATE FIELDS VON LAYERS ON FOCUS) \"Further Changes\" From Deformations\r\n\r\n\r\n                var vaHor = t.getVal(objLayer,'align_hor'),\r\n                    vaVer = t.getVal(objLayer,'align_vert');\r\n\r\n                jQuery(\"#rs-align-wrapper a\").removeClass(\"selected\");\r\n                jQuery(\"#rs-align-wrapper-ver a\").removeClass(\"selected\");\r\n\r\n                jQuery(\"#rs-align-wrapper a[data-hor='\"+vaHor+\"']\").addClass(\"selected\");\r\n                jQuery(\"#rs-align-wrapper-ver a[data-ver='\"+vaVer+\"']\").addClass(\"selected\");\r\n\r\n                jQuery(\"#layer_id\").val(objLayer.attrID);\r\n                jQuery(\"#layer_wrapper_id\").val(objLayer.attrWrapperID);\r\n                jQuery(\"#layer_classes\").val(objLayer.attrClasses);\r\n                jQuery(\"#layer_wrapper_classes\").val(objLayer.attrWrapperClasses);\r\n\r\n                jQuery(\"#layer_title\").val(objLayer.attrTitle);\r\n                jQuery(\"#layer_tabindex\").val(objLayer.attrTabindex);\r\n                jQuery(\"#layer_rel\").val(objLayer.attrRel);\r\n\r\n                //show / hide go under slider offset row\r\n                jQuery('select[name=\"layer_action[]\"], select[name=\"no_layer_action[]\"]').each(function() {\r\n                    showHideLinkActions(jQuery(this));\r\n                });\r\n                showHideToolTip();\r\n                showHideLoopFunctions(); //has to be the last thing done to not interrupt settings\r\n\r\n                // HOOK FOR EXTERNAL ADDONS\r\n                jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n                    var callback = callback_element[\"callback\"],\r\n                        env = callback_element[\"environment\"],\r\n                        env_sub = callback_element[\"function_position\"];\r\n                    if (env === \"updateLayerFormFields\" && env_sub==\"end\")\r\n                        objLayer = callback(objLayer);\r\n\r\n                });\r\n            }\r\n\r\n\r\n            /**\r\n             * unselect all html layers\r\n             */\r\n            var unselectHtmlLayers = function(){\r\n\r\n                // HOOK FOR EXTERNAL ADDONS\r\n                jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n                    var callback = callback_element[\"callback\"],\r\n                        env = callback_element[\"environment\"],\r\n                        env_sub = callback_element[\"function_position\"];\r\n                    if (env === \"unselectHtmlLayers\" && env_sub==\"start\")\r\n                        callback();\r\n                });\r\n\r\n                var jcont = document.getElementById('divLayers'),\r\n                    resizables = jcont.getElementsByClassName('ui-resizable'),\r\n                    rotatables = jcont.getElementsByClassName('ui-rotatable-handle');\r\n\r\n                for (var a = 0; a<resizables.length-1;a++) {\r\n                    try{\r\n                        jQuery(resizables[a]).resizable(\"destroy\");\r\n                    } catch(e) {\r\n\r\n                    }\r\n                }\r\n                for (var a = 0; a<rotatables.length-1;a++) {\r\n                    try {\r\n                        jQuery(rotatables[a]).rotatable(\"destroy\");\r\n                    } catch(e) {}\r\n                }\r\n\r\n                jQuery(containerID + \" .slide_layer\").removeClass(\"layer_selected\");\r\n                jQuery('.layerrow_selected').removeClass(\"layerrow_selected\");\r\n                jQuery('.layerchild_selected').removeClass('layerchild_selected');\r\n                document.getElementById('id-esw').className=\"\";\r\n\r\n                // HOOK FOR EXTERNAL ADDONS\r\n                jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n                    var callback = callback_element[\"callback\"],\r\n                        env = callback_element[\"environment\"],\r\n                        env_sub = callback_element[\"function_position\"];\r\n                    if (env === \"unselectHtmlLayers\" && env_sub==\"end\")\r\n                        callback();\r\n                });\r\n\r\n            }\r\n\r\n            t.hideRowLayoutComposer = function() {\r\n                jQuery('#rs-layout-row-composer').hide(); //.appendTo(jQuery('#divLayers'));\r\n                var rowopeners = document.getElementsByClassName('row_editor open_re');\r\n                for (var i=0;i<rowopeners.length;i++) {\r\n                    rowopeners[i].className=\"row_editor\";\r\n                }\r\n            }\r\n\r\n            /**\r\n             * set all layers unselected\r\n             */\r\n            var unselectLayers = function(){\r\n\r\n                t.hideRowLayoutComposer();\r\n                unselectHtmlLayers();\r\n                jQuery('#timline-manual-dialog').appendTo(jQuery('#thelayer-editor-wrapper')).hide();\r\n                var lslist = document.getElementsByClassName('layerchild_selected');\r\n                for (var i=0;i<lslist.length-1;i++) {\r\n                    jQuery(lslist[i]).removeClass(\"layerchild_selected\");\r\n                }\r\n                jQuery('.quicksortlayer.selected').removeClass(\"selected\");\r\n                jQuery('.layerrow_selected').removeClass(\"layerrow_selected\");\r\n                u.unselectSortboxItems();\r\n                t.selectedLayerSerial = -1;\r\n                disableFormFields();\r\n\r\n                //reset elements\r\n\r\n                t.showHideContentEditor(false);\r\n\r\n                jQuery('.form_layers').addClass('notselected');\r\n\r\n                u.resetIdleSelector();\r\n\r\n                jQuery('#idle-hover-swapper').hide();\r\n\r\n                u.allLayerToIdle();\r\n\r\n                jQuery('#the_current-editing-layer-title').addClass(\"nolayerselectednow\").val(\"No Layers Selected\").attr(\"disabled\",\"disabled\");\r\n                jQuery('#layer-short-toolbar').data('serial',\"\");\r\n\r\n            }\r\n\r\n            t.toolbarInPos = function(objLayer) {\r\n                if (objLayer)\r\n                    switch (objLayer.type) {\r\n                        case \"image\":\r\n                            jQuery('#button_change_image_source').show();\r\n                            jQuery('#button_edit_layer').hide();\r\n                            jQuery('#button_reset_size').show();\r\n                            jQuery('#button_change_video_settings').hide();\r\n                            jQuery('#layer-short-tool-placeholder-a').hide();\r\n                            jQuery('#layer-short-tool-placeholder-b').hide();\r\n                            break;\r\n                        case \"text\":\r\n                        case \"button\":\r\n                            if (!jQuery('#layer_text_wrapper').hasClass(\"currently_editing_txt\")) {\r\n                                jQuery('#button_edit_layer').show();\r\n                                jQuery('#button_reset_size').show();\r\n                            } else {\r\n\r\n                                jQuery('#button_edit_layer').hide();\r\n                                jQuery('#button_reset_size').hide();\r\n                            }\r\n                            jQuery('#button_change_image_source').hide();\r\n                            jQuery('#button_change_video_settings').hide();\r\n                            jQuery('#layer-short-tool-placeholder-a').hide();\r\n                            jQuery('#layer-short-tool-placeholder-b').hide();\r\n                            break;\r\n                        case 'audio':\r\n                        case \"video\":\r\n                            jQuery('#button_edit_layer').hide();\r\n                            jQuery('#button_change_image_source').hide();\r\n                            jQuery('#button_reset_size').hide();\r\n                            jQuery('#button_change_video_settings').show();\r\n                            jQuery('#layer-short-tool-placeholder-a').show();\r\n                            jQuery('#layer-short-tool-placeholder-b').hide();\r\n                            break;\r\n                        case 'shape':\r\n                            jQuery('#button_change_image_source').hide();\r\n                            jQuery('#button_change_video_settings').hide();\r\n                            jQuery('#button_edit_layer').hide();\r\n                            jQuery('#button_reset_size').hide();\r\n                            jQuery('#layer-short-tool-placeholder-a').show();\r\n                            jQuery('#layer-short-tool-placeholder-b').show();\r\n                            break;\r\n                        /*case 'no_edit':\r\n                         jQuery('#button_change_image_source').hide();\r\n                         jQuery('#button_change_video_settings').hide();\r\n                         jQuery('#button_edit_layer').hide();\r\n                         jQuery('#button_reset_size').hide();\r\n                         break;*/\r\n                        case 'svg':\r\n                            jQuery('#button_change_image_source').hide();\r\n                            jQuery('#button_edit_layer').hide();\r\n                            jQuery('#button_reset_size').hide();\r\n                            jQuery('#button_change_video_settings').hide();\r\n                            jQuery('#layer-short-tool-placeholder-a').show();\r\n                            jQuery('#layer-short-tool-placeholder-b').hide();\r\n                            jQuery('#button_edit_layer').show();\r\n                            jQuery('#layer-short-tool-placeholder-b').hide();\r\n                            //show/hide elements depending\r\n                            break;\r\n                    }\r\n\r\n\r\n\r\n            }\r\n\r\n\r\n            t.remove_layer_actions = function(){\r\n\r\n                jQuery('.layer_action_wrap').each(function(){\r\n                    jQuery(this).remove();\r\n                });\r\n\r\n            }\r\n\r\n            /**\r\n             * check if the layer that is deleted, needs to be removed from any actions as well\r\n             **/\r\n            t.checkActionsOnLayers = function(layerserial){\r\n                var clayers = t.getSimpleLayers();\r\n\r\n                var unique_id = t.getUniqueIdByLayer(layerserial);\r\n\r\n                for(var key in clayers) if (clayers.hasOwnProperty(key)) {\r\n                    if(clayers[key]['layer_action'] !== undefined){\r\n                        for(var a in clayers[key]['layer_action']['action']) if (clayers[key]['layer_action']['action'].hasOwnProperty(a)) {\r\n                            switch(clayers[key]['layer_action']['action'][a]){\r\n                                case 'start_in':\r\n                                case 'start_out':\r\n                                case 'start_video':\r\n                                case 'stop_video':\r\n                                case 'toggle_layer':\r\n                                case 'toggle_video':\r\n                                case 'mute_video':\r\n                                case 'unmute_video':\r\n                                case 'toggle_mute_video':\r\n                                case 'toggle_global_mute_video':\r\n                                case 'simulate_click':\r\n                                case 'toggle_class':\r\n\r\n                                    var target_layer = clayers[key]['layer_action']['layer_target'][a];\r\n\r\n                                    if(unique_id == target_layer){\r\n                                        //remove that action from the layer\r\n                                        if(clayers[key]['layer_action']['action'] && clayers[key]['layer_action']['action'][a]) delete clayers[key]['layer_action']['action'][a];\r\n                                        if(clayers[key]['layer_action']['tooltip_event'] && clayers[key]['layer_action']['tooltip_event'][a]) delete clayers[key]['layer_action']['tooltip_event'][a];\r\n                                        if(clayers[key]['layer_action']['image_link'] && clayers[key]['layer_action']['image_link'][a]) delete clayers[key]['layer_action']['image_link'][a];\r\n                                        if(clayers[key]['layer_action']['link_open_in'] && clayers[key]['layer_action']['link_open_in'][a]) delete clayers[key]['layer_action']['link_open_in'][a];\r\n                                        if(clayers[key]['layer_action']['jump_to_slide'] && clayers[key]['layer_action']['jump_to_slide'][a]) delete clayers[key]['layer_action']['jump_to_slide'][a];\r\n                                        if(clayers[key]['layer_action']['scrolloffset'] && clayers[key]['layer_action']['scrolloffset'][a]) delete clayers[key]['layer_action']['scrolloffset'][a];\r\n                                        if(clayers[key]['layer_action']['actioncallback'] && clayers[key]['layer_action']['actioncallback'][a]) delete clayers[key]['layer_action']['actioncallback'][a];\r\n                                        if(clayers[key]['layer_action']['layer_target'] && clayers[key]['layer_action']['layer_target'][a]) delete clayers[key]['layer_action']['layer_target'][a];\r\n                                        if(clayers[key]['layer_action']['action_delay'] && clayers[key]['layer_action']['action_delay'][a]) delete clayers[key]['layer_action']['action_delay'][a];\r\n                                        if(clayers[key]['layer_action']['link_type'] && clayers[key]['layer_action']['link_type'][a]) delete clayers[key]['layer_action']['link_type'][a];\r\n                                        if(clayers[key]['layer_action']['toggle_layer_type'] && clayers[key]['layer_action']['toggle_layer_type'][a]) delete clayers[key]['layer_action']['toggle_layer_type'][a];\r\n                                        if(clayers[key]['layer_action']['toggle_class'] && clayers[key]['layer_action']['toggle_class'][a]) delete clayers[key]['layer_action']['toggle_class'][a];\r\n                                    }\r\n                                    break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            t.remove_action = function(o){\r\n                if(confirm(rev_lang.remove_this_action)){\r\n                    o.closest('li').remove();\r\n                    t.updateLayerFromFields();\r\n\r\n                    u.updateAllLayerTimeline();\r\n                }\r\n            }\r\n\r\n            t.checkLayerTriggered = function(objLayer) {\r\n                var clayers = t.getSimpleLayers(),\r\n                    has_trigger = {in:false,out:false};\r\n                for(var key in clayers) if (clayers.hasOwnProperty(key)) {\r\n                    if(clayers[key]['layer_action'] !== undefined){\r\n\r\n                        for(var a in clayers[key]['layer_action']['action']) if (clayers[key]['layer_action']['action'].hasOwnProperty(a)) {\r\n                            switch(clayers[key]['layer_action']['action'][a]){\r\n                                case 'start_in':\r\n                                case 'start_out':\r\n                                case 'start_video':\r\n                                case 'stop_video':\r\n                                case 'toggle_layer':\r\n                                case 'toggle_video':\r\n                                case 'simulate_click':\r\n                                case 'toggle_class':\r\n                                    var target_layer = clayers[key]['layer_action']['layer_target'][a];\r\n                                    if(objLayer.unique_id == target_layer){\r\n                                        switch(clayers[key]['layer_action']['action'][a]){\r\n                                            case 'start_in':\r\n                                                has_trigger.in=true;\r\n                                                break;\r\n                                            case 'start_out':\r\n                                                has_trigger.out=true;\r\n                                                break;\r\n                                            case 'toggle_layer':\r\n                                                has_trigger.in=true;\r\n                                                has_trigger.out=true;\r\n                                                break;\r\n                                        }\r\n                                    }\r\n                                    break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return has_trigger;\r\n            }\r\n\r\n            t.add_layer_actions = function(obj){\r\n\r\n                var clayers = t.getSimpleLayers();\r\n\r\n                if(obj === undefined){\r\n                    var content = global_action_template({'edit': true});\r\n\r\n                    jQuery('.layer_action_add_template').before(content);\r\n                    t.updateLayerFromFields();\r\n                }else{\r\n                    jQuery('#triggered-element-behavior').hide();\r\n\r\n                    //add all actions from other layers that are directed to the currentlayer\r\n                    var current_layer = t.getCurrentLayer();\r\n\r\n                    for(var key in clayers) if (clayers.hasOwnProperty(key)) {\r\n                        if(clayers[key]['layer_action'] !== undefined){\r\n                            var has_trigger = false;\r\n                            for(var a in clayers[key]['layer_action']['action']) if (clayers[key]['layer_action']['action'].hasOwnProperty(a)) {\r\n                                switch(clayers[key]['layer_action']['action'][a]){\r\n                                    case 'start_in':\r\n                                    case 'start_out':\r\n                                    case 'start_video':\r\n                                    case 'stop_video':\r\n                                    case 'toggle_layer':\r\n                                    case 'toggle_video':\r\n                                    case 'simulate_click':\r\n                                    case 'toggle_class':\r\n                                        var target_layer = clayers[key]['layer_action']['layer_target'][a];\r\n                                        if(current_layer.unique_id == target_layer){\r\n                                            switch(clayers[key]['layer_action']['action'][a]){\r\n                                                case 'start_in':\r\n                                                case 'start_out':\r\n                                                case 'toggle_layer':\r\n                                                    has_trigger = true;\r\n                                                    break;\r\n                                            }\r\n\r\n                                            var act = '';\r\n                                            switch(clayers[key]['layer_action']['action'][a]){\r\n                                                case 'start_in':\r\n                                                    act = rev_lang.start_layer_in;\r\n                                                    break;\r\n                                                case 'start_out':\r\n                                                    act = rev_lang.start_layer_out;\r\n                                                    break;\r\n                                                case 'start_video':\r\n                                                    act = rev_lang.start_video;\r\n                                                    break;\r\n                                                case 'stop_video':\r\n                                                    act = rev_lang.stop_video;\r\n                                                    break;\r\n                                                case 'toggle_layer':\r\n                                                    act = rev_lang.toggle_layer_anim;\r\n                                                    break;\r\n                                                case 'toggle_video':\r\n                                                    act = rev_lang.toggle_video;\r\n                                                    break;\r\n                                                case 'simulate_click':\r\n                                                    act = rev_lang.simulate_click;\r\n                                                    break;\r\n                                                case 'toggle_class':\r\n                                                    act = rev_lang.toggle_class;\r\n                                                    break;\r\n                                            }\r\n\r\n                                            jQuery('.layer_action_add_template').before('<li class=\"layer_is_triggered layer_action_wrap\">'+rev_lang.layer_action_by+' <a href=\"javascript:UniteLayersRev.setLayerSelected(\\''+key+'\\');void(0);\">'+clayers[key]['alias']+'</a> '+rev_lang.due_to_action+' '+act+'</li>');\r\n                                        }\r\n                                        break;\r\n                                }\r\n                            }\r\n\r\n                            if(has_trigger){\r\n                                jQuery('#triggered-element-behavior').show();\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                    jQuery('.rs_disabled_field').each(function(){\r\n                        jQuery(this).attr('disabled', 'disabled'); //Disable\r\n                    });\r\n                }\r\n\r\n\r\n                if(obj !== undefined && obj['layer_action'] !== undefined && obj['layer_action'].action !== undefined){\r\n\r\n                    for(var key in obj['layer_action'].action) if (obj['layer_action'].action.hasOwnProperty(key)) {\r\n                        var data = {};\r\n                        data.edit = true;\r\n                        data.tooltip_event = (obj['layer_action'].tooltip_event !== undefined && obj['layer_action'].tooltip_event[key] !== undefined) ? obj['layer_action'].tooltip_event[key] : 'click';\r\n                        data.action = (obj['layer_action'].action !== undefined && obj['layer_action'].action[key] !== undefined) ? obj['layer_action'].action[key] : 'none';\r\n                        data.image_link = (obj['layer_action'].image_link !== undefined && obj['layer_action'].image_link[key] !== undefined) ? obj['layer_action'].image_link[key] : '';\r\n                        data.link_open_in = (obj['layer_action'].link_open_in !== undefined && obj['layer_action'].link_open_in[key] !== undefined) ? obj['layer_action'].link_open_in[key] : 'same';\r\n                        data.jump_to_slide = (obj['layer_action'].jump_to_slide !== undefined && obj['layer_action'].jump_to_slide[key] !== undefined) ? obj['layer_action'].jump_to_slide[key] : '';\r\n                        data.scrolloffset = (obj['layer_action'].scrollunder_offset !== undefined && obj['layer_action'].scrollunder_offset[key] !== undefined) ? obj['layer_action'].scrollunder_offset[key] : '';\r\n                        data.action_easing = (obj['layer_action'].action_easing !== undefined && obj['layer_action'].action_easing[key] !== undefined) ? obj['layer_action'].action_easing[key] : 'Linear.easeNone';\r\n                        data.action_speed = (obj['layer_action'].action_speed !== undefined && obj['layer_action'].action_speed[key] !== undefined) ? obj['layer_action'].action_speed[key] : '300';\r\n                        data.actioncallback = (obj['layer_action'].actioncallback !== undefined && obj['layer_action'].actioncallback[key] !== undefined) ? obj['layer_action'].actioncallback[key] : '';\r\n                        data.layer_target = (obj['layer_action'].layer_target !== undefined && obj['layer_action'].layer_target[key] !== undefined) ? obj['layer_action'].layer_target[key] : '';\r\n                        data.action_delay = (obj['layer_action'].action_delay !== undefined && obj['layer_action'].action_delay[key] !== undefined) ? obj['layer_action'].action_delay[key] : '';\r\n                        data.link_type = (obj['layer_action'].link_type !== undefined && obj['layer_action'].link_type[key] !== undefined) ? obj['layer_action'].link_type[key] : 'jquery';\r\n                        data.toggle_layer_type = (obj['layer_action'].toggle_layer_type !== undefined && obj['layer_action'].toggle_layer_type[key] !== undefined) ? obj['layer_action'].toggle_layer_type[key] : 'visible';\r\n                        data.toggle_class = (obj['layer_action'].toggle_class !== undefined && obj['layer_action'].toggle_class[key] !== undefined) ? obj['layer_action'].toggle_class[key] : '';\r\n\r\n                        // HOOK FOR EXTERNAL ADDONS\r\n                        jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n\r\n                            var callback = callback_element[\"callback\"],\r\n                                env = callback_element[\"environment\"],\r\n                                env_sub = callback_element[\"function_position\"];\r\n\r\n                            if (env === \"add_layer_actions\" && env_sub==\"data_definition\")\r\n                                data = callback(data,obj,key);\r\n\r\n                        });\r\n\r\n                        var content = global_action_template(data);\r\n\r\n                        jQuery('.layer_action_add_template').before(content);\r\n\r\n                    }\r\n                }\r\n\r\n\r\n                //add Slides and Layer into select fields, set these values again\r\n                jQuery('select[name=\"jump_to_slide[]\"], select[name=\"no_jump_to_slide[]\"]').each(function(){\r\n                    jQuery(this).html('');\r\n                    for(var key in slideIDs) if (slideIDs.hasOwnProperty(key)) {\r\n                        for(var mkey in slideIDs[key]) if (slideIDs[key].hasOwnProperty(mkey))\r\n                            jQuery(this).append(jQuery('<option></option>').val(mkey).text('Slide: '+slideIDs[key][mkey]));\r\n                    }\r\n\r\n                    var do_sel = jQuery(this).data('selectoption');\r\n\r\n                    jQuery(this).find('option[value=\"'+do_sel+'\"]').attr('selected', true);\r\n\r\n                }); //slide\r\n\r\n                jQuery('select[name=\"layer_target[]\"], select[name=\"no_layer_target[]\"]').each(function(k){\r\n                    jQuery(this).html('');\r\n\r\n                    jQuery(this).append(jQuery('<option data-mytype=\"video-special\"></option>').val('backgroundvideo').text(rev_lang.background_video));\r\n                    jQuery(this).append(jQuery('<option data-mytype=\"video-special\"></option>').val('firstvideo').text(rev_lang.active_video));\r\n\r\n                    for(var key in clayers) if (clayers.hasOwnProperty(key)) {\r\n                        if (clayers[key].deleted!==true)\r\n                            jQuery(this).append(jQuery('<option data-mytype=\"'+clayers[key].type+'\"></option>').val(clayers[key]['unique_id']).text(clayers[key].alias));\r\n                    }\r\n\r\n                    if(initStaticLayers !== null && initStaticLayers.length > 0){\r\n                        jQuery(this).append(jQuery('<option data-mytype=\"all\" disabled=\"disabled\"></option>').text(rev_lang.static_layers));\r\n                        for(var key in initStaticLayers) if (initStaticLayers.hasOwnProperty(key)) {\r\n                            jQuery(this).append(jQuery('<option data-mytype=\"'+initStaticLayers[key].type+'\"></option>').val('static-'+initStaticLayers[key]['unique_id']).text(initStaticLayers[key].alias));\r\n                        }\r\n                    }\r\n\r\n                    var do_sel = jQuery(this).data('selectoption');\r\n\r\n                    jQuery(this).find('option[value=\"'+do_sel+'\"]').attr('selected', true);\r\n\r\n                    var dataAnim = t.getAnimTimingAndTrigger(do_sel);\r\n\r\n                    jQuery(this).closest('li').find('select[name=\"do-layer-animation-overwrite[]\"] option[value=\"'+dataAnim['animation_overwrite']+'\"]').attr('selected', true);\r\n                    jQuery(this).closest('li').find('select[name=\"do-layer-trigger-memory[]\"] option[value=\"'+dataAnim['trigger_memory']+'\"]').attr('selected', true);\r\n                }); //layer\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * set animation and trigger timings for actions\r\n             **/\r\n            t.getAnimTimingAndTrigger = function(cur_id){\r\n\r\n                var clayer = t.getLayerByUniqueId(cur_id);\r\n\r\n                return {'animation_overwrite': clayer.animation_overwrite,'trigger_memory': clayer.trigger_memory};\r\n\r\n            }\r\n\r\n            /**\r\n             * set animation and trigger timings for actions\r\n             **/\r\n            t.setAnimTimingAndTrigger = function(cur_id){\r\n\r\n                var clayer = t.getLayerByUniqueId(cur_id);\r\n\r\n                return {'animation_overwrite': clayer.animation_overwrite,'trigger_memory': clayer.trigger_memory};\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * SET THE LAYER RESIZABLE\r\n             **/\r\n            t.setLayerResizable = function(objLayer) {\r\n                var aspectratio = false,\r\n                    layer = objLayer.references.htmlLayer;\r\n                if(jQuery(\"#layer_proportional_scale\")[0].checked || objLayer.type===\"svg\") aspectratio = true;\r\n\r\n                try{  layer.resizable(\"destroy\"); } catch(e) { }\r\n\r\n                layer.resizable({\r\n                    aspectRatio:aspectratio,\r\n                    handles:\"all\",\r\n                    start:function(event,ui) {\r\n                        switch(objLayer.type){\r\n                            case \"img\":\r\n                            case \"audio\":\r\n                            case \"video\":\r\n                                var th = aspectratio ? \"auto\" : \"100%\";\r\n                                punchgs.TweenLite.set(ui.element,{width:ui.originalSize.width,height:ui.originalSize.height})\r\n                                punchgs.TweenLite.set(ui.element.find('img'),{width:\"100%\",height:th})\r\n                                punchgs.TweenLite.set(ui.element.find('.innerslide_layer').first(),{width:\"100%\",height:th})\r\n                                break;\r\n\r\n                            default:\r\n                                if (objLayer===\"svg\")\r\n                                    layer.find('.innerslide_layer.tp-caption').first().css({maxHeight:\"none\",minHeight:0,maxWidth:\"none\"});\r\n                                else {\r\n                                    var mw = layer.outerWidth(),\r\n                                        mh = objLayer.type===\"shape\" ? \"none\" : layer.outerHeight();\r\n                                    if (objLayer.type!==\"shape\") layer.css({height:\"auto\"});\r\n                                    punchgs.TweenLite.set(ui.element[0].getElementsByClassName('innerslide_layer')[0],{height:\"auto\",maxHeight:\"none\",minHeight:mh,maxWidth:mw});\r\n                                }\r\n                                break;\r\n                        }\r\n                    },\r\n                    resize:function(event,ui) {\r\n                        switch(objLayer.type){\r\n                            case \"audio\":\r\n                            case \"video\":\r\n                                jQuery('#layer_video_width').val(Math.round(ui.size.width)+\"px\");\r\n                                jQuery('#layer_video_height').val(Math.round(ui.size.height)+\"px\");\r\n                                var th = aspectratio ? \"auto\" : \"100%\";\r\n\r\n                                if (ui.element[0].getElementsByTagName(\"img\").length>0) punchgs.TweenLite.set(ui.element[0].getElementsByTagName(\"img\")[0],{width:\"100%\",height:th})\r\n                                punchgs.TweenLite.set(ui.element[0].getElementsByClassName(\"innerslide_layer\")[0],{maxWidth:\"none\",maxHeight:\"none\",width:\"100%\",height:\"100%\"});\r\n                                punchgs.TweenLite.set(ui.element[0].getElementsByClassName(\"slide_layer_video\")[0],{width:\"100%\",height:\"100%\"});\r\n                                break;\r\n                            case \"image\":\r\n                                jQuery('#layer_scaleX').val(Math.round(ui.size.width)+\"px\");\r\n                                jQuery('#layer_scaleY').val(Math.round(ui.size.height)+\"px\");\r\n                                var th = aspectratio ? \"auto\" : \"100%\";\r\n                                punchgs.TweenLite.set(ui.element,{width:Math.round(ui.size.width),height:Math.round(ui.size.height)})\r\n                                punchgs.TweenLite.set(ui.element[0].getElementsByTagName(\"img\")[0],{width:\"100%\",height:th})\r\n                                punchgs.TweenLite.set(ui.element[0].getElementsByClassName(\"innerslide_layer\")[0],{maxWidth:\"100%\", maxHeight:\"100%\",width:\"100%\",height:th})\r\n                                break;\r\n\r\n                            default:\r\n                                var il = ui.element[0].getElementsByClassName('innerslide_layer')[0],\r\n                                    ilj = jQuery(il),\r\n                                    minheight = ilj.outerHeight(),\r\n                                    ilwidth = ilj.outerWidth(),\r\n                                    maxheight = Math.round(ui.size.height)+1,\r\n                                    maxwidth = Math.round(ui.size.width)+1;\r\n\r\n                                if (objLayer.type!==\"shape\" && objLayer.type!==\"group\") {\r\n                                    maxheight = minheight>=maxheight ? \"auto\" : maxheight+\"px\";\r\n                                    punchgs.TweenLite.set(il,{maxWidth:maxwidth});\r\n                                } else {\r\n                                    punchgs.TweenLite.set(ilj,{maxWidth:maxwidth,maxHeight:maxheight,minHeight:\"none\",overwrite:\"auto\",height:\"100%\"});\r\n                                }\r\n\r\n\r\n                                jQuery('#layer_max_width').val(maxwidth+\"px\");\r\n                                jQuery('#layer_max_height').val(maxheight);\r\n                                break;\r\n                        }\r\n\r\n                        if (objLayer.type===\"group\") {\r\n                            jQuery.each(t.getLayersInGroup(objLayer.unique_id).layers,function(i,layer) {\r\n                                t.updateHtmlLayerPosition(false,layer,t.getVal(layer, 'top'),t.getVal(layer, 'left'),t.getVal(layer,'align_hor'),t.getVal(layer,'align_vert'));\r\n                            });\r\n                        }\r\n                    },\r\n                    stop:function(event,ui) {\r\n                        layerresized = true;\r\n                        setTimeout(function() {\r\n                            layerresized = false;\r\n                        },200);\r\n                        t.updateLayerFromFields();\r\n                    }\r\n                });\r\n\r\n            }\r\n\r\n            /* Set Style Layout based on Layer Style */\r\n            t.resetLayerSelected = function(objLayer) {\r\n                var layer = objLayer.references.htmlLayer;\r\n\r\n\r\n                jQuery(\"#layer_cornerleft_row\").hide();\r\n                jQuery(\"#layer_cornerright_row\").hide();\r\n                jQuery(\"#layer_resizeme_row\").hide();\r\n                jQuery(\"#layer_alt_row\").hide();\r\n                jQuery(\"#layer_max_widthheight_wrapper\").hide();\r\n                jQuery(\"#layer_video_widthheight_wrapper\").hide();\r\n                jQuery(\"#layer_scaleXY_wrapper\").hide();\r\n                jQuery(\"#layer_minwidthheight_wrapper\").hide();\r\n\r\n                var idesw = document.getElementById('id-esw'),\r\n                    incolumn = t.getObjLayerType(objLayer.p_uid)===\"column\";\r\n\r\n                idesw.className = 'slt-'+objLayer.type+'-w';\r\n\r\n                if (incolumn) idesw.className +=' sltic';\r\n\r\n\r\n\r\n                //do specific operations depends on type\r\n                switch(objLayer.type){\r\n                    case 'audio':\r\n                    case 'video':    //show edit video button\r\n                        jQuery(\"#linkInsertTemplate\").addClass(\"disabled\");\r\n                        jQuery(\"#layer_video_widthheight_wrapper\").show();\r\n                        t.showHideContentEditor(false);\r\n\r\n                        if (layer.width()>=jQuery('#divLayers').width() && layer.height()>=jQuery('#divLayers').height())\r\n                            layer.addClass(\"fullscreen-video-layer\");\r\n                        else\r\n                            layer.removeClass(\"fullscreen-video-layer\");\r\n                        break;\r\n                    case 'image':\r\n                        //disable the insert button\r\n                        jQuery(\"#layer_scaleXY_wrapper\").show();\r\n                        jQuery(\"#linkInsertTemplate\").addClass(\"disabled\");\r\n\r\n                        //show / hide some elements\r\n                        jQuery(\"#layer_alt_row\").show();\r\n\r\n\r\n                        jQuery('.rs-lazy-load-images-wrap').show();\r\n                        if(jQuery('#layer_alt_option option:selected').val() == 'custom'){\r\n                            jQuery('#layer_alt').show();\r\n                        } else {\r\n                            jQuery('#layer_alt').hide();\r\n                        }\r\n                        break;\r\n                    case 'svg':\r\n                        jQuery(\"#layer_max_widthheight_wrapper\").show();\r\n                        break;\r\n                    case 'shape':\r\n                        jQuery(\"#layer-covermode-wrapper\").show();\r\n                        jQuery('#layer_text_wrapper').removeClass('currently_editing_txt');\r\n                        jQuery(\"#layer_max_widthheight_wrapper\").show();\r\n                        break;\r\n                    case 'group':\r\n                        jQuery(\"#layer_max_widthheight_wrapper\").show();\r\n                        break;\r\n                    case 'row':\r\n                        jQuery(\"#layer_max_widthheight_wrapper\").show();\r\n                        break;\r\n                    case 'column':\r\n                        jQuery(\"#layer_minwidthheight_wrapper\").show();\r\n                        break;\r\n                    case 'text':\r\n                    case 'button':\r\n                    default:  //set layer text to default height\r\n                        jQuery('#layer_text_wrapper').addClass('currently_editing_txt');\r\n                        jQuery(\"#layer_cornerleft_row\").show();\r\n                        jQuery(\"#layer_cornerright_row\").show();\r\n                        jQuery(\"#layer_resizeme_row\").show();\r\n                        jQuery(\"#layer_max_widthheight_wrapper\").show();\r\n                        break;\r\n                }\r\n\r\n\r\n                if (objLayer.type!==\"row\" && objLayer.type!==\"column\") {\r\n                    t.setLayerResizable(objLayer);\r\n                    t.makeCurrentLayerRotatable();\r\n                }\r\n\r\n                if(jQuery('#hover_allow')[0].checked){\r\n                    jQuery('#idle-hover-swapper').show();\r\n                }else{\r\n                    jQuery('#idle-hover-swapper').hide();\r\n                }\r\n\r\n                //RevSliderSettings.onoffStatus(jQuery('#force_hover'));\r\n                //RevSliderSettings.onoffStatus(jQuery('#shadow_idle'));\r\n                //RevSliderSettings.onoffStatus(jQuery('#shadow_hover'));\r\n                RevSliderSettings.onoffStatus(jQuery('#hover_allow'));\r\n                RevSliderSettings.onoffStatus(jQuery('#toggle_allow'));\r\n                RevSliderSettings.onoffStatus(jQuery('#toggle_use_hover'));\r\n                RevSliderSettings.onoffStatus(jQuery('#toggle_inverse_content'));\r\n\r\n                //hide autocomplete\r\n                jQuery(\"#layer_caption\").catcomplete(\"close\");\r\n\r\n\r\n                //reset all color picker fields to the corresponding colors\r\n                jQuery('.wp-color-result').each(function(){\r\n                    jQuery(this).css('backgroundColor', jQuery(this).parent().find('.my-color-field').val());\r\n                });\r\n\r\n                u.rebuildLayerIdleProgress(layer);\r\n            }\r\n\r\n            /*! SET LAYER SELECTED */\r\n            /**\r\n             * set layer selected representation\r\n             */\r\n            t.setLayerSelected = function(serial,videoRefresh,infocus){\r\n\r\n                if(t.selectedLayerSerial == serial && !videoRefresh)\r\n                    return(false);\r\n\r\n                jQuery('#timline-manual-dialog').appendTo(jQuery('#thelayer-editor-wrapper')).hide();\r\n\r\n                t.hideRowLayoutComposer();\r\n                u.resetIdleSelector();\r\n\r\n                jQuery('.quicksortlayer.selected').removeClass(\"selected\");\r\n                jQuery('#layer_quicksort_'+serial).addClass(\"selected\");\r\n\r\n                if (!infocus) jQuery('.timer-layer-text:focus').blur();\r\n\r\n                t.remove_layer_actions();\r\n\r\n                var objLayer = t.getLayer(serial);\r\n\r\n\r\n                //add the correct bolds into the selectfield\r\n                if ((objLayer.type===\"text\" || objLayer.type===\"button\"))\r\n                    if(typeof(objLayer['deformation']) !== 'undefined' && typeof(objLayer['deformation']['font-family']) !== 'undefined'){\r\n                        t.check_the_font_bold(objLayer['deformation']['font-family']);\r\n                    }else{\r\n                        t.check_the_font_bold('');\r\n                    }\r\n\r\n                t.showHideContentEditor(false);\r\n                t.toolbarInPos(objLayer);\r\n\r\n                //unselect all other layers\r\n                unselectHtmlLayers();\r\n\r\n                // SOME TOOLBAR ACTION FOR SELECTED LAYER\r\n                var    layer = objLayer.references.htmlLayer,\r\n                    tbar = jQuery('#layer-short-toolbar'),\r\n                    tcelt = jQuery('#the_current-editing-layer-title');\r\n\r\n                tcelt.val(objLayer.alias).prop(\"disabled\",false).removeClass(\"nolayerselectednow\");\r\n                tbar.data('serial',serial);\r\n\r\n                if(u.isLayerLocked(layer)) {\r\n                    var b=tbar.find('.quick-layer-lock'),\r\n                        i=b.find('i');\r\n                    b.addClass(\"in-off\").removeClass(\"in-on\");\r\n                    i.removeClass(\"eg-icon-lock-open\").addClass(\"eg-icon-lock\");\r\n                } else {\r\n                    var b=tbar.find('.quick-layer-lock'),\r\n                        i=b.find('i');\r\n                    b.addClass(\"in-on\").removeClass(\"in-off\");\r\n                    i.removeClass(\"eg-icon-lock\").addClass(\"eg-icon-lock-open\");\r\n                }\r\n\r\n                if(u.isLayerVisible(layer)){\r\n                    var b=tbar.find('.quick-layer-view'),\r\n                        i=b.find('i');\r\n                    b.addClass(\"in-on\").removeClass(\"in-off\");\r\n                    i.removeClass(\"eg-icon-eye-off\").addClass(\"eg-icon-eye\");\r\n                }else{\r\n                    var b=tbar.find('.quick-layer-view'),\r\n                        i=b.find('i');\r\n                    b.addClass(\"in-off\").removeClass(\"in-on\");\r\n                    i.removeClass(\"eg-icon-eye\").addClass(\"eg-icon-eye-off\");\r\n                }\r\n\r\n                if (t.getVal(objLayer,\"display\")===\"block\")\r\n                    jQuery('#layer-displaymode-wrapper').removeClass(\"notselected\");\r\n                else\r\n                    jQuery('#layer-displaymode-wrapper').addClass(\"notselected\");\r\n\r\n                //set selected class\r\n                layer.addClass(\"layer_selected\");\r\n                layer.closest('.slide_layer_type_row').addClass('layerchild_selected');\r\n                layer.closest('.row-zone-container').addClass('layerrow_selected');\r\n                layer.closest('.slide_layer_type_column').addClass('layerchild_selected');\r\n\r\n                u.setSortboxItemSelected(serial);\r\n\r\n                //update selected serial var\r\n                t.selectedLayerSerial = serial;\r\n                //update bottom fields\r\n                t.updateLayerFormFields(serial);\r\n\r\n                //enable form fields\r\n                enableFormFields();\r\n\r\n                // HOOK FOR EXTERNAL ADDONS\r\n                jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n                    var callback = callback_element[\"callback\"],\r\n                        env = callback_element[\"environment\"],\r\n                        env_sub = callback_element[\"function_position\"];\r\n                    if (env === \"setLayerSelected\" && env_sub==\"start\")\r\n                        callback(serial);\r\n                });\r\n\r\n                jQuery('#layer_text_wrapper').removeClass('currently_editing_txt');\r\n\r\n                jQuery('.rs-lazy-load-images-wrap').hide();\r\n\r\n                t.resetLayerSelected(objLayer);\r\n\r\n                checkMaskingAvailabity();\r\n                u.rebuildLayerIdle(layer);\r\n                reAlignAndrePosition();\r\n\r\n                jQuery('.form_layers').removeClass('notselected');\r\n                t.set_cover_mode();\r\n\r\n                //change the style classes available depending on .type\r\n\r\n                UniteCssEditorRev.updateCaptionsInput(initArrCaptionClasses);\r\n                t.updateReverseList();\r\n                jQuery('#parallax_level').change();\r\n\r\n                // HOOK FOR EXTERNAL ADDONS\r\n                jQuery.each(t.addon_callbacks, function(i,callback_element) {\r\n                    var callback = callback_element[\"callback\"],\r\n                        env = callback_element[\"environment\"],\r\n                        env_sub = callback_element[\"envifunction_position\"];\r\n                    if (env === \"setLayerSelected\" && env_sub==\"end\")\r\n                        callback(serial);\r\n                });\r\n\r\n            }\r\n\r\n\r\n            var  getRotationDegrees = function(obj) {\r\n                var matrix = obj.css(\"-webkit-transform\") ||\r\n                    obj.css(\"-moz-transform\")    ||\r\n                    obj.css(\"-ms-transform\")     ||\r\n                    obj.css(\"-o-transform\")      ||\r\n                    obj.css(\"transform\");\r\n                if(matrix !== 'none') {\r\n                    var values = matrix.split('(')[1].split(')')[0].split(',');\r\n                    var a = values[0];\r\n                    var b = values[1];\r\n                    var angle = Math.round(Math.atan2(b, a) * (180/Math.PI));\r\n                } else { var angle = 0; }\r\n                return (angle < 0) ? angle +=360 : angle;\r\n            }\r\n\r\n            /**\r\n             *\r\n             * return if the layer is selected or not\r\n             */\r\n            var isLayerSelected = function(serial){\r\n                return(serial == t.selectedLayerSerial);\r\n            }\r\n\r\n\r\n\r\n            var reAlignAndrePosition = function() {\r\n\r\n            }\r\n\r\n\r\n\r\n            //======================================================\r\n            //\t\t\tTime Functions\r\n            //======================================================\r\n\r\n            /**\r\n             * get next available time\r\n             */\r\n            var getNextTime = function(){\r\n                var maxTime = 0;\r\n\r\n                //get max time\r\n                for (key in t.arrLayers) if (t.arrLayers.hasOwnProperty(key)) {\r\n                    var layer = t.arrLayers[key];\r\n\r\n                    layerTime = (layer.time)?Number(layer.time):0;\r\n\r\n                    if(layerTime > maxTime)\r\n                        maxTime = layerTime;\r\n                }\r\n\r\n                var outputTime;\r\n                if(maxTime == 0)\r\n                    outputTime = g_startTime;\r\n                else\r\n                    outputTime = Number(maxTime) + Number(g_stepTime);\r\n\r\n\r\n                if (outputTime>=g_slideTime) outputTime = g_slideTime / 2;\r\n                return(outputTime);\r\n            }\r\n\r\n\r\n            //======================================================\r\n            //\t\t\t\tTime Functions End\r\n            //======================================================\r\n\r\n\r\n\r\n            //======================================================\r\n            //\t\t\t\tHTML LAYER POSITION UPDATE\r\n            //======================================================\r\n            t.updateHtmlLayerPosition = function(isInit,objLayer,top,left,align_hor,align_vert){\r\n\r\n                if (objLayer===undefined || objLayer===false) return;\r\n                //update positions by align\r\n                var width = objLayer.references.htmlLayer.outerWidth(),\r\n                    height = objLayer.references.htmlLayer.outerHeight();\r\n\r\n\r\n                totalWidth = container.width();\r\n                totalHeight = container.height();\r\n\r\n                var _tw = totalWidth,\r\n                    _th = totalHeight;\r\n\r\n\r\n                if (objLayer.p_uid!==-1 && t.getObjLayerType(objLayer.p_uid)===\"group\") {\r\n                    _tw = t.getLayerByUniqueId(objLayer.p_uid).references.htmlLayer.width();\r\n                    _th = t.getLayerByUniqueId(objLayer.p_uid).references.htmlLayer.height();\r\n\r\n                }\r\n\r\n                //get sizes from saved if on get\r\n                if(isInit == true && objLayer.type == \"image\"){\r\n                    if(t.getVal(objLayer,'width') != -1)\r\n                        width = t.getVal(objLayer,'width');\r\n\r\n                    if(t.getVal(objLayer,'height') != -1)\r\n                        height = t.getVal(objLayer,'height');\r\n                }\r\n\r\n                var objCss = {};\r\n\r\n                switch (objLayer.type) {\r\n                    case \"row\":\r\n                        left = 0;\r\n                        top = 0;\r\n                        break;\r\n                    case \"column\":\r\n                        left = 0;\r\n                        top = 0;\r\n                        break;\r\n                }\r\n\r\n                var _makrerelative = objLayer.p_uid!==-1 && t.getObjLayerType(objLayer.p_uid)===\"column\";\r\n\r\n\r\n                objCss[\"position\"] = _makrerelative || objLayer.type===\"row\" ? \"relative\" : \"absolute\";\r\n\r\n\r\n\r\n                //handle horizontal\r\n                switch(align_hor){\r\n                    default:\r\n                    case \"left\":\r\n                        objCss[\"right\"] = \"auto\";\r\n                        objCss[\"left\"] = _makrerelative ? \"auto\" : left+\"px\";\r\n                        break;\r\n                    case \"right\":\r\n                        objCss[\"left\"] = \"auto\";\r\n                        objCss[\"right\"] = _makrerelative ? \"auto\" :  left+\"px\";\r\n                        break;\r\n                    case \"center\":\r\n                        var realLeft = (_tw - width)/2;\r\n                        realLeft = Math.round(realLeft) + left;\r\n                        objCss[\"left\"] = _makrerelative ? \"auto\" : realLeft + \"px\";\r\n                        objCss[\"right\"] = \"auto\";\r\n                        break;\r\n                }\r\n\r\n                //handle vertical\r\n                switch(align_vert){\r\n                    default:\r\n                    case \"top\":\r\n                        objCss[\"bottom\"] = \"auto\";\r\n                        objCss[\"top\"] = _makrerelative ? \"auto\" :  top+\"px\";\r\n                        break;\r\n                    case \"middle\":\r\n                        var realTop = (_th - height)/2;\r\n                        realTop = objLayer.type===\"row\" ? 0 : Math.round(realTop)+top;\r\n                        objCss[\"top\"] = _makrerelative ? \"auto\" :  realTop + \"px\";\r\n                        objCss[\"bottom\"] = \"auto\";\r\n                        break;\r\n                    case \"bottom\":\r\n                        objCss[\"top\"] = \"auto\";\r\n                        objCss[\"bottom\"] = _makrerelative ? \"auto\" :  top+\"px\";\r\n                        break;\r\n                }\r\n\r\n\r\n                punchgs.TweenLite.set(objLayer.references.htmlLayer,objCss);\r\n                // REFRESH POSITIONS OF CHILD NOW\r\n                if (objLayer.type===\"group\") {\r\n                    jQuery.each(t.getLayersInGroup(objLayer.unique_id).layers,function(i,layer) {\r\n                        t.updateHtmlLayerPosition(false,layer,t.getVal(layer, 'top'),t.getVal(layer, 'left'),t.getVal(layer,'align_hor'),t.getVal(layer,'align_vert'));\r\n                    });\r\n                }\r\n            }\r\n\r\n\r\n\r\n\r\n            //======================================================\r\n            //\t\t\t\tEvents Functions\r\n            //======================================================\r\n\r\n            /**\r\n             *\r\n             * on layer drag event - update layer position\r\n             */\r\n            var onLayerDragStart = function() {\r\n\r\n                t.justDropped = false;\r\n                t.showHideContentEditor(false);\r\n\r\n                jQuery('#divLayers').addClass(\"onelayerinmove\");\r\n\r\n\r\n                var layerSerial = t.getSerialFromID(this.id),\r\n                    htmlLayer = jQuery(this),\r\n                    objLayer = t.getLayer(layerSerial);\r\n\r\n                if (jQuery.inArray(objLayer.unique_id,t.selectedLayers)==-1) u.checkMultipleSelectedItems(true);\r\n\r\n                htmlLayer.closest('.slide_layer_type_group').addClass(\"dragfromgroup\");\r\n                htmlLayer.data('originalPosition',htmlLayer.position());\r\n                htmlLayer.addClass(\"draggable_toponall\")\r\n                selectedLayerWidth = htmlLayer.outerWidth();\r\n                selectedlayerHeight = htmlLayer.outerHeight();\r\n                totalWidth = container.width();\r\n                totalHeight = container.height();\r\n                htmlLayer.closest('.slide_layer_type_column').addClass(\"column_from_draggable\");\r\n                htmlLayer.closest('.slide_layer_type_row').css({zIndex:190});\r\n                jQuery('#layer_text_wrapper').removeClass(\"currently_editing_txt\");\r\n                t.setLayerSelected(layerSerial);\r\n                t.groupMove.x = 0;\r\n                t.groupMove.y = 0;\r\n                t.groupMove.sameGroup = t.getSameLinkedElements(objLayer);\r\n                //htmlLayer.css({width:(selectedLayerWidth+1)+\"px\"})\r\n\r\n            }\r\n\r\n            t.getSameLinkedElements = function(objLayer) {\r\n                var list = [];\r\n                for (var i in t.selectedLayers) if (t.selectedLayers.hasOwnProperty(i)) {\r\n                    var layer = t.getLayerByUniqueId(t.selectedLayers[i]);\r\n                    if (layer.unique_id !== objLayer.unique_id && layer.p_uid === objLayer.p_uid) {\r\n                        layer.positionCache = layer.references.htmlLayer.position();\r\n                        list.push(layer);\r\n                    }\r\n                }\r\n                return list;\r\n            }\r\n\r\n            t.getCurLinkedElements = function() {\r\n                var list = [];\r\n                for (var i in t.selectedLayers) if (t.selectedLayers.hasOwnProperty(i)) {\r\n                    var layer = t.getLayerByUniqueId(t.selectedLayers[i]);\r\n                    list.push(layer);\r\n\r\n                }\r\n                if (list.length===0) {\r\n                    var layer = t.getLayer(t.selectedLayerSerial);\r\n                    list.push(layer);\r\n                }\r\n                return list;\r\n            }\r\n\r\n            var onLayerDragEnd = function(event,ui) {\r\n\r\n                var layerSerial = t.getSerialFromID(this.id),\r\n                    htmlLayer = jQuery(this);\r\n                htmlLayer.removeClass(\"draggable_toponall\")\r\n                jQuery('.row-zone-container').removeClass(\"nowyouseeme\");\r\n                jQuery('.row-zone-container').removeClass('layerrow_selected');\r\n                jQuery('.column_from_draggable').removeClass(\"column_from_draggable\");\r\n                t.droppedContainerCheck(t.getLayer(layerSerial));\r\n                if (t.groupMove && t.groupMove.sameGroup && t.groupMove.sameGroup.length>0) {\r\n                    for (var k=0;k<t.groupMove.sameGroup.length;k++) {\r\n                        var sgl = t.groupMove.sameGroup[k];\r\n                        selectedLayerWidth = sgl.references.htmlLayer.outerWidth();\r\n                        selectedlayerHeight = sgl.references.htmlLayer.outerHeight();\r\n                        t.onLayerDrag(\"ende\",sgl.serial, sgl.references.htmlLayer);\r\n                    }\r\n                }\r\n                selectedLayerWidth = htmlLayer.outerWidth();\r\n                selectedlayerHeight = htmlLayer.outerHeight();\r\n                t.onLayerDrag(\"ende\",layerSerial,htmlLayer);\r\n\r\n                jQuery('.layer_selected').each(function() {\r\n                    var __ = jQuery(this),\r\n                        cs = __.data('serial');\r\n                    if (cs!=layerSerial && layerSerial!==undefined)\r\n                        __.removeClass(\"layer_selected\");\r\n\r\n                });\r\n\r\n                t.setLayerSelected(layerSerial);\r\n                jQuery('#divLayers').removeClass(\"onelayerinmove\");\r\n                jQuery('.dragfromgroup').removeClass(\"dragfromgroup\");\r\n            }\r\n\r\n            t.updateMovedLayers = function(forced) {\r\n                jQuery.each(t.keyboardmovedlayers,function(i,layer){\r\n                    if (layer.references!==undefined) {\r\n                        selectedLayerWidth = layer.references.htmlLayer.outerWidth();\r\n                        selectedlayerHeight = layer.references.htmlLayer.outerHeight();\r\n                        t.onLayerDrag(\"ende\",layer.serial, layer.references.htmlLayer,true);\r\n                    }\r\n                })\r\n            }\r\n\r\n            t.adjustSelectedLayerPositions = function(dir,dist) {\r\n                t.keyboardmovedlayers = t.getCurLinkedElements();\r\n                jQuery.each(t.keyboardmovedlayers,function(i,layer){\r\n                    if (layer.references!==undefined)\r\n                        if (dir==\"top\")\r\n                            punchgs.TweenLite.set(layer.references.htmlLayer,{top:Math.round(layer.references.htmlLayer.position().top)+dist});\r\n                        else\r\n                            punchgs.TweenLite.set(layer.references.htmlLayer,{left:Math.round(layer.references.htmlLayer.position().left)+dist});\r\n                });\r\n            }\r\n\r\n            t.onLayerDrag = function(ui,event,htmlLayer,ignoreorig){\r\n\r\n                htmlLayer = htmlLayer || jQuery(this);\r\n\r\n                var position = htmlLayer.position(),\r\n                    posTop = Math.round(position.top),\r\n                    posLeft = Math.round(position.left),\r\n                    updateY = 0,\r\n                    updateX = 0,\r\n                    objLayer = event.originapPosition===undefined ? t.getLayer(event) : t.getLayer(t.selectedLayerSerial),\r\n                    _tw = totalWidth,\r\n                    _th = totalHeight;\r\n\r\n\r\n                jQuery('#layer_text_wrapper').removeClass(\"currently_editing_txt\");\r\n                t.toolbarInPos(objLayer);\r\n\r\n                var old = objLayer.p_uid;\r\n\r\n                if (htmlLayer.parent().attr('id')===\"divLayers\")\r\n                    objLayer.p_uid = -1;\r\n\r\n                if (old!==-1 && objLayer.p_uid!==-1) {\r\n                    // NO NEED TO CHANGE THE LAYER POSITION AND STYLE\r\n                } else\r\n                if (old!=objLayer.p_uid) {\r\n                    if (objLayer.type===\"row\" || objLayer.p_uid!==-1 && t.getObjLayerType(objLayer.p_uid)===\"column\")\r\n                        punchgs.TweenLite.set(htmlLayer,{left:\"auto\",right:\"auto\",top:\"auto\",bottom:\"auto\",display:\"inline-block\",position:\"relative\"});\r\n                    else\r\n                        punchgs.TweenLite.set(htmlLayer,{display:\"block\",position:\"absolute\"});\r\n\r\n                }\r\n\r\n                if (objLayer.p_uid!==-1 && t.getObjLayerType(objLayer.p_uid)===\"group\") {\r\n                    _tw = t.getLayerByUniqueId(objLayer.p_uid).references.htmlLayer.width();\r\n                    _th = t.getLayerByUniqueId(objLayer.p_uid).references.htmlLayer.height();\r\n                }\r\n\r\n                if (ui.offsetX!==undefined && event.originalPosition!==undefined && t.groupMove.sameGroup.length>0) {\r\n                    var dif = {x:(event.originalPosition.left - event.position.left), y: (event.originalPosition.top - event.position.top)}\r\n                    for (var k=0;k<t.groupMove.sameGroup.length;k++) {\r\n                        var sgl = t.groupMove.sameGroup[k];\r\n                        punchgs.TweenLite.set(sgl.references.htmlLayer,{left:sgl.positionCache.left - dif.x, top:sgl.positionCache.top - dif.y});\r\n                    }\r\n                }\r\n\r\n\r\n                switch(t.getVal(objLayer,'align_hor')){\r\n                    case \"left\":\r\n                        updateX = posLeft;\r\n                        break;\r\n                    case \"right\":\r\n                        updateX = _tw - posLeft - selectedLayerWidth;\r\n                        break;\r\n                    case \"center\":\r\n                        updateX = posLeft - Math.round((_tw - selectedLayerWidth)/2);\r\n                        updateX = Math.round(updateX);\r\n                        break;\r\n                    case \"left\":\r\n                    default:\r\n                        updateX = posLeft;\r\n                        break;\r\n                }\r\n\r\n                switch(t.getVal(objLayer,'align_vert')){\r\n                    case \"bottom\":\r\n                        updateY = _th - posTop - selectedlayerHeight;\r\n                        break;\r\n                    case \"middle\":\r\n                        updateY = posTop - Math.round((_th - selectedlayerHeight)/2);\r\n                        updateY = Math.round(updateY);\r\n                        break;\r\n                    case \"top\":\r\n                    default:\r\n                        updateY = posTop;\r\n                        break;\r\n                }\r\n\r\n                if (objLayer.p_uid!==-1 && t.getObjLayerType(objLayer.p_uid)===\"column\") {\r\n                    updateX = 0;\r\n                    updateY = 0;\r\n                }\r\n\r\n\r\n\r\n                jQuery('#layer_left').val(updateX+\"px\");\r\n                jQuery('#layer_top').val(updateY+\"px\");\r\n\r\n                if (ui===\"ende\") {\r\n                    var objUpdate = {};\r\n                    objUpdate = t.setVal(objUpdate, 'left', updateX);\r\n                    objUpdate = t.setVal(objUpdate, 'top', updateY);\r\n                    objUpdate = t.setVal(objUpdate, 'width', selectedLayerWidth);\r\n                    objUpdate = t.setVal(objUpdate, 'height', selectedlayerHeight);\r\n\r\n                    // event == layerSerial !!\r\n\r\n                    t.updateLayer(event,objUpdate);\r\n                    t.updateHtmlLayerPosition(false,objLayer,t.getVal(objUpdate, 'top'),t.getVal(objUpdate, 'left'),t.getVal(objLayer,'align_hor'),t.getVal(objLayer,'align_vert'));\r\n\r\n                    if(isLayerSelected(event))\r\n                        t.updateLayerFormFields(event);\r\n\r\n                }\r\n\r\n            }\r\n\r\n            /**\r\n             * Get Object Layer  Type\r\n             */\r\n            t.getObjLayerType = function(unique_id) {\r\n                var o = t.getLayerByUniqueId(unique_id);\r\n                if (o.type)\r\n                    return o.type\r\n                else\r\n                    return false;\r\n            }\r\n\r\n\r\n\r\n\r\n            //======================================================\r\n            //\t\tEvents Functions End\r\n            //======================================================\r\n\r\n\r\n\r\n\r\n            //======================================================\r\n            //\tScale Functions\r\n            //======================================================\r\n            var scaleAndResetLayerInit = function(){\r\n\r\n                jQuery(\"#layer_scaleX\").change(function(){\r\n                    if(jQuery(\"#layer_proportional_scale\")[0].checked)\r\n                        scaleProportional(true);\r\n                    else\r\n                        scaleNormal();\r\n                });\r\n\r\n                jQuery(\"#layer_scaleY\").change(function(){\r\n                    if(jQuery(\"#layer_proportional_scale\")[0].checked)\r\n                        scaleProportional(false);\r\n                    else\r\n                        scaleNormal();\r\n                });\r\n\r\n                jQuery(\"#layer_video_width\").change(function(){\r\n\r\n                    if(jQuery(\"#layer_proportional_scale\")[0].checked)\r\n                        scaleProportionalVideo(true);\r\n                    else\r\n                        scaleNormalVideo();\r\n                });\r\n\r\n                jQuery(\"#layer_video_height\").change(function(){\r\n                    if(jQuery(\"#layer_proportional_scale\")[0].checked)\r\n                        scaleProportionalVideo(false);\r\n                    else\r\n                        scaleNormalVideo();\r\n                });\r\n\r\n                jQuery(\"#layer_proportional_scale\").click(function(){\r\n                    var objLayer = t.getLayer(t.selectedLayerSerial);\r\n                    if(this.checked){\r\n                        jQuery('#layer_cover_mode option[value=\"custom\"]').attr('selected', true);\r\n                        jQuery('.rs-proportion-check').removeClass('notselected');\r\n                        if (objLayer.type===\"video\" || objLayer.type===\"audio\")\r\n                            scaleProportionalVideo(false);\r\n                        else\r\n                        if (objLayer.type===\"image\") {\r\n                            scaleProportional(true);\r\n                        }\r\n\r\n                    }else{\r\n                        jQuery('.rs-proportion-check').addClass('notselected');\r\n                        if (objLayer.type===\"video\" || objLayer.type===\"audio\")\r\n                            scaleNormalVideo(false);\r\n                        else\r\n                        if (objLayer.type===\"image\")\r\n                            scaleNormal();\r\n\r\n                    }\r\n                    t.setLayerResizable(objLayer);\r\n                });\r\n\r\n\r\n                // AUTO LINE BREAK on/off\r\n                jQuery(\"#layer_auto_line_break\").click(function(){\r\n                    t.clickOnAutoLineBreak();\r\n                });\r\n\r\n\r\n                jQuery(\"#layer_displaymode\").click(function(){\r\n                    if(jQuery(this)[0].checked){\r\n                        jQuery(\"#layer_display option[value='block']\").attr('selected', 'selected');\r\n                    } else {\r\n                        jQuery(\"#layer_display option[value='inline-block']\").attr('selected', 'selected');\r\n                    }\r\n                });\r\n\r\n                jQuery('#layer_cover_mode').change(function(){\r\n                    t.set_cover_mode();\r\n                });\r\n\r\n                jQuery(\"#reset-scale, #button_reset_size\").click(resetCurrentElementSize);\r\n\r\n            }\r\n\r\n            t.clickOnAutoLineBreak = function() {\r\n\r\n                var serial = t.selectedLayerSerial;\r\n                var layer = jQuery(\"#slide_layer_\" + serial);\r\n                var objLayer = t.getLayer(t.selectedLayerSerial);\r\n\r\n                if(jQuery(\"#layer_auto_line_break\")[0].checked){\r\n                    jQuery('.rs-linebreak-check').removeClass('notselected');\r\n                    jQuery(\"#layer_whitespace option[value='normal']\").attr('selected', 'selected');\r\n\r\n                    var mw = layer.outerWidth()+1,\r\n                        mh = layer.outerHeight()+1;\r\n\r\n                    layer.css({height:\"auto\"});\r\n                    layer.find('.innerslide_layer.tp-caption').first().css({maxHeight:\"none\",minHeight:mh,maxWidth:mw});\r\n                    jQuery('#layer_max_width').val(mw+\"px\");\r\n                    jQuery('#layer_max_height').val(\"auto\");\r\n                }else{\r\n                    jQuery('.rs-linebreak-check').addClass('notselected');\r\n                    jQuery(\"#layer_whitespace option[value='nowrap']\").attr('selected', 'selected');\r\n                    jQuery('#layer_max_width').val(\"auto\");\r\n                    jQuery('#layer_max_height').val(\"auto\");\r\n                    layer.css({width:\"auto\"});\r\n                    layer.find('.innerslide_layer.tp-caption').first().css({maxHeight:\"none\",minHeight:\"none\",maxWidth:\"none\"});\r\n                }\r\n                t.updateLayerFromFields();\r\n            }\r\n\r\n            var resetCurrentElementSize = function() {\r\n\r\n                var objLayer = t.getLayer(t.selectedLayerSerial);\r\n\r\n                if (objLayer.type == \"shape\") {\r\n                    return false;\r\n                }else\r\n                if (objLayer.type == 'svg') {\r\n                    //reset svg size\r\n                    return false;\r\n                }else if (objLayer.type == 'audio') {\r\n                    return false;\r\n                }else if (objLayer.type==\"text\" || objLayer.type==\"button\") {\r\n                    var ww = jQuery('.slide_layer.layer_selected .innerslide_layer').first().outerWidth();\r\n                    if (parseInt(jQuery(\"#layer_max_width\").val(),0)>ww) {\r\n                        ww = ww === undefined ? \"auto\" : ww+\"px\"\r\n                        jQuery(\"#layer_max_width\").val(\"auto\");\r\n                    }\r\n                    jQuery(\"#layer_max_height\").val(\"auto\");\r\n\r\n\r\n                } else {\r\n                    if (objLayer.type == \"image\") {\r\n                        jQuery('#layer_cover_mode option[value=\"custom\"]').attr('selected', true);\r\n                    }\r\n\r\n                    var rsdimensions = resetImageDimensions();\r\n                    jQuery(\"#layer_proportional_scale\").attr('checked', true);\r\n\r\n                    jQuery(\"#layer_scaleX_text\").html(jQuery(\"#layer_scaleX_text\").data(\"textnormal\")).css(\"width\", \"10px\");\r\n\r\n                    var mwidth = objLayer.image_librarysize !=undefined ?  objLayer.image_librarysize.width : rsdimensions['width'],\r\n                        mheight = objLayer.image_librarysize !=undefined ?  objLayer.image_librarysize.height :rsdimensions['height'];\r\n\r\n\r\n                    jQuery(\"#layer_scaleX\").val(mwidth);\r\n                    jQuery(\"#layer_scaleY\").val(mheight);\r\n\r\n\r\n                    jQuery(\"#slide_layer_\" + t.selectedLayerSerial + \" img\").css(\"width\", mwidth);\r\n                    jQuery(\"#slide_layer_\" + t.selectedLayerSerial + \" img\").css(\"height\", mheight);\r\n                }\r\n\r\n                t.updateLayerFromFields();\r\n            }\r\n\r\n            var scaleProportional = function(useX){\r\n\r\n                var serial = t.selectedLayerSerial;\r\n\r\n                resetImageDimensions();\r\n\r\n                var imgObj = new Image(),\r\n                    x,y,suffixX,suffixY,v;\r\n\r\n                imgObj.src = jQuery(\"#slide_layer_\" + serial + \" img\").attr(\"src\");\r\n\r\n                if(useX){\r\n                    v = jQuery(\"#layer_scaleX\").val();\r\n                    x = parseFloat(v),\r\n                        suffixX = v.replace(x,\"\");\r\n                    if(isNaN(x))\r\n                        x = suffixX===\"%\" ? 100 : imgObj.width;\r\n                    y = suffixX===\"%\" ? \"auto\" : Math.round(100 / imgObj.width * x / 100 * imgObj.height, 0);\r\n                    suffixY = \"\";\r\n                }else{\r\n                    v = jQuery(\"#layer_scaleY\").val();\r\n                    y = parseFloat(v);\r\n                    suffixY = v.replace(y,\"\");\r\n                    if(isNaN(y))\r\n                        y = suffixY===\"%\" ? 100 : imgObj.height;\r\n                    x = suffixY===\"%\" ? \"auto\" : Math.round(100 / imgObj.height * y / 100 * imgObj.width, 0);\r\n                    suffixX = \"\";\r\n                }\r\n\r\n                jQuery(\"#slide_layer_\" + serial + \" img\").css(\"width\", x + suffixX);\r\n                jQuery(\"#slide_layer_\" + serial + \" img\").css(\"height\", y + suffixY);\r\n\r\n                jQuery(\"#slide_layer_\" + serial).css(\"width\", jQuery(\"#slide_layer_\" + serial + \" img\").width() + suffixX);\r\n                jQuery(\"#slide_layer_\" + serial).css(\"height\", jQuery(\"#slide_layer_\" + serial + \" img\").height() + suffixY);\r\n\r\n                jQuery(\"#slide_layer_\" + serial + \" img\").css(\"width\", \"100%\");\r\n                jQuery(\"#slide_layer_\" + serial + \" img\").css(\"height\", \"100%\");\r\n\r\n                jQuery(\"#layer_scaleX\").val(x+suffixX);\r\n                jQuery(\"#layer_scaleY\").val(y+suffixY);\r\n            }\r\n\r\n            var scaleNormal = function(){\r\n                var serial = t.selectedLayerSerial,\r\n                    imgdims = resetImageDimensions(),\r\n                    layer = jQuery(\"#slide_layer_\" + serial),\r\n                    ww = jQuery(\"#layer_scaleX\").val(),\r\n                    hh = jQuery(\"#layer_scaleY\").val();\r\n\r\n                ww = jQuery.isNumeric(ww) ? ww+\"px\" : ww;\r\n                hh = jQuery.isNumeric(hh) ? hh+\"px\" : hh;\r\n\r\n                punchgs.TweenLite.set(layer,{width:ww,height:hh});\r\n                punchgs.TweenLite.set(layer.find('.innerslide_layer').first(),{width:ww,height:hh});\r\n                punchgs.TweenLite.set(layer.find('img'),{width:ww,height:hh});\r\n            }\r\n\r\n            /**\r\n             * Scale Videos to the choosen proportion on width/height change\r\n             * @since: 5.0\r\n             **/\r\n            var scaleProportionalVideo = function(useX){\r\n\r\n                var serial = t.selectedLayerSerial,\r\n                    cur_video = jQuery(\"#slide_layer_\" + serial).find('.slide_layer_video');\r\n\r\n                if(useX){\r\n                    var x = parseInt(jQuery(\"#layer_video_width\").val());\r\n                    if(isNaN(x)) x = cur_video.width();\r\n                    var y = Math.round(100 / cur_video.width() * x / 100 * cur_video.height(), 0);\r\n                }else{\r\n                    var y = parseInt(jQuery(\"#layer_video_height\").val());\r\n                    if(isNaN(y)) y = cur_video.height();\r\n                    var x = Math.round(100 / cur_video.height() * y / 100 * cur_video.width(), 0);\r\n                }\r\n\r\n                cur_video.css(\"width\", x + \"px\");\r\n                cur_video.css(\"height\", y + \"px\");\r\n\r\n                jQuery(\"#slide_layer_\" + serial).css(\"width\", x + \"px\");\r\n                jQuery(\"#slide_layer_\" + serial).css(\"height\", y + \"px\");\r\n\r\n                jQuery(\"#layer_video_width\").val(x);\r\n                jQuery(\"#layer_video_height\").val(y);\r\n            }\r\n\r\n            var scaleNormalVideo = function(){\r\n\r\n                var serial = t.selectedLayerSerial,\r\n                    cur_video = jQuery(\"#slide_layer_\" + serial).find('.slide_layer_video'),\r\n                    ww = jQuery(\"#layer_video_width\").val(),\r\n                    hh = jQuery(\"#layer_video_height\").val();\r\n\r\n                ww = jQuery.isNumeric(ww) ? ww+\"px\" : ww;\r\n                hh = jQuery.isNumeric(hh) ? hh+\"px\" : hh;\r\n\r\n                cur_video.css(\"width\", ww);\r\n                cur_video.css(\"height\", hh);\r\n\r\n                jQuery(\"#slide_layer_\" + serial).css(\"width\", ww);\r\n                jQuery(\"#slide_layer_\" + serial).css(\"height\", hh);\r\n            }\r\n\r\n            var resetImageDimensions = function(){\r\n                var imgObj = new Image();\r\n                imgObj.src = jQuery(\"#slide_layer_\" + t.selectedLayerSerial + \" img\").attr(\"src\");\r\n                jQuery(\"#slide_layer_\" + t.selectedLayerSerial).css(\"width\", imgObj.width + \"px\");\r\n                jQuery(\"#slide_layer_\" + t.selectedLayerSerial).css(\"height\", imgObj.height + \"px\");\r\n\r\n                var imgdims = {width:imgObj.width, height:imgObj.height};\r\n                return imgdims;\r\n            }\r\n\r\n            //======================================================\r\n            //\tScale Functions End\r\n            //======================================================\r\n\r\n            t.getLayerGeneralParamsStatus = function(){\r\n                return layerGeneralParamsStatus;\r\n            }\r\n\r\n            //======================================================\r\n            //\tMain Background Image Functions\r\n            //======================================================\r\n\r\n\r\n\r\n\r\n\r\n            t.startKenBurn =  function(prgs) {\r\n\r\n                var l = jQuery('#ken_burn_example'),\r\n                    d = l.data(),\r\n                    i = l.find('.defaultimg'),\r\n                    s = d.lastsrc,\r\n                    i_a = d.owidth / d.oheight,\r\n                    cw = l.width(),\r\n                    ch = l.height(),\r\n                    c_a = cw / ch;\r\n\r\n\r\n                if (l.data('kbtl'))\r\n                    l.data('kbtl').kill();\r\n\r\n                prgs = prgs || 0;\r\n\r\n                if (s===undefined) return;\r\n\r\n                l.find('.tp-kbimg').remove();\r\n\r\n\r\n\r\n                // NO KEN BURN IMAGE EXIST YET\r\n                if (l.find('.tp-kbimg').length==0) {\r\n                    l.append('<div class=\"tp-kbimg-wrap\" style=\"z-index:2;width:100%;height:100%;top:0px;left:0px;position:absolute;\"><img class=\"tp-kbimg\" src=\"'+s+'\" style=\"position:absolute;\" width=\"'+d.owidth+'\" height=\"'+d.oheight+'\"></div>');\r\n                    l.data('kenburn',l.find('.tp-kbimg'));\r\n                }\r\n\r\n                var getKBSides = function(w,h,f,cw,ch,ho,vo) {\r\n                        var tw = w * f,\r\n                            th = h * f,\r\n                            hd = Math.abs(cw-tw),\r\n                            vd = Math.abs(ch-th),\r\n                            s = new Object();\r\n                        s.l = (0-ho)*hd;\r\n                        s.r = s.l + tw;\r\n                        s.t = (0-vo)*vd;\r\n                        s.b = s.t + th;\r\n                        s.h = ho;\r\n                        s.v = vo;\r\n\r\n\r\n                        return s;\r\n                    },\r\n\r\n                    getKBCorners = function(d,cw,ch,ofs,o) {\r\n\r\n                        var p = d.bgposition.split(\" \") || \"center center\",\r\n                            ho = p[0] == \"center\"  ? \"50%\" : p[0] == \"left\" || p [1] == \"left\" ? \"0%\" : p[0]==\"right\" || p[1] ==\"right\" ? \"100%\" : p[0],\r\n                            vo = p[1] == \"center\" ? \"50%\" : p[0] == \"top\" || p [1] == \"top\" ? \"0%\" : p[0]==\"bottom\" || p[1] ==\"bottom\" ? \"100%\" : p[1];\r\n\r\n                        ho = parseInt(ho,0)/100 || 0;\r\n                        vo = parseInt(vo,0)/100 || 0;\r\n\r\n\r\n                        var sides = new Object();\r\n\r\n\r\n                        sides.start = getKBSides(o.start.width,o.start.height,o.start.scale,cw,ch,ho,vo);\r\n                        sides.end = getKBSides(o.start.width,o.start.height,o.end.scale,cw,ch,ho,vo);\r\n\r\n                        return sides;\r\n                    },\r\n\r\n                    kcalcL = function(cw,ch,d) {\r\n                        var f=d.scalestart/100,\r\n                            fe=d.scaleend/100,\r\n                            ofs = d.offsetstart != undefined ? d.offsetstart.split(\" \") || [0,0] : [0,0],\r\n                            ofe = d.offsetend != undefined ? d.offsetend.split(\" \") || [0,0] : [0,0];\r\n                        d.bgposition = d.bgposition == \"center center\" ? \"50% 50%\" : d.bgposition;\r\n\r\n\r\n                        var o = new Object(),\r\n                            sw = cw*f,\r\n                            sh = sw/d.owidth * d.oheight,\r\n                            ew = cw*fe,\r\n                            eh = ew/d.owidth * d.oheight;\r\n\r\n\r\n\r\n\r\n                        o.start = new Object();\r\n                        o.starto = new Object();\r\n                        o.end = new Object();\r\n                        o.endo = new Object();\r\n\r\n                        o.start.width = cw;\r\n                        o.start.height = o.start.width / d.owidth * d.oheight;\r\n\r\n                        if (o.start.height<ch) {\r\n                            var newf = ch / o.start.height;\r\n                            o.start.height = ch;\r\n                            o.start.width = o.start.width*newf;\r\n                        }\r\n                        o.start.transformOrigin = d.bgposition;\r\n                        o.start.scale = f;\r\n                        o.end.scale = fe;\r\n\r\n                        o.start.rotation = d.rotatestart+\"deg\";\r\n                        o.end.rotation = d.rotateend+\"deg\";\r\n\r\n                        // MAKE SURE THAT OFFSETS ARE NOT TOO HIGH\r\n                        var c = getKBCorners(d,cw,ch,ofs,o);\r\n\r\n\r\n\r\n                        ofs[0] = parseFloat(ofs[0]) + c.start.l;\r\n                        ofe[0] = parseFloat(ofe[0]) + c.end.l;\r\n\r\n                        ofs[1] = parseFloat(ofs[1]) + c.start.t;\r\n                        ofe[1] = parseFloat(ofe[1]) + c.end.t;\r\n\r\n                        var iws = c.start.r - c.start.l,\r\n                            ihs    = c.start.b - c.start.t,\r\n                            iwe = c.end.r - c.end.l,\r\n                            ihe    = c.end.b - c.end.t;\r\n\r\n\r\n                        // X (HORIZONTAL)\r\n\r\n                        ofs[0] = ofs[0]>0 ? 0 : iws + ofs[0] < cw ? cw-iws : ofs[0];\r\n                        ofe[0] = ofe[0]>0 ? 0 : iwe + ofe[0] < cw ? cw-iwe : ofe[0];\r\n                        o.starto.x = ofs[0]+\"px\";\r\n                        o.endo.x = ofe[0]+\"px\";\r\n\r\n                        // Y (VERTICAL)\r\n                        ofs[1] = ofs[1]>0 ? 0 : ihs + ofs[1] < ch ? ch-ihs : ofs[1];\r\n                        ofe[1] = ofe[1]>0 ? 0 : ihe + ofe[1] < ch ? ch-ihe : ofe[1];\r\n                        o.starto.y = ofs[1]+\"px\";\r\n                        o.endo.y = ofe[1]+\"px\";\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n                        o.end.ease = o.endo.ease = d.ease;\r\n                        o.end.force3D = o.endo.force3D = true;\r\n                        return o;\r\n                    };\r\n\r\n                if (l.data('kbtl')!=undefined) {\r\n                    l.data('kbtl').kill();\r\n                    l.removeData('kbtl');\r\n                }\r\n\r\n                var k = l.data('kenburn'),\r\n                    kw = k.parent(),\r\n                    anim = kcalcL(cw,ch,d),\r\n                    kbtl =  new punchgs.TimelineLite();\r\n\r\n\r\n                kbtl.pause();\r\n\r\n                anim.start.transformOrigin = \"0% 0%\";\r\n                anim.starto.transformOrigin = \"0% 0%\";\r\n\r\n                kbtl.add(punchgs.TweenLite.fromTo(k,d.duration/1000,anim.start,anim.end),0);\r\n                kbtl.add(punchgs.TweenLite.fromTo(kw,d.duration/1000,anim.starto,anim.endo),0);\r\n\r\n                kbtl.progress(prgs);\r\n                if (jQuery('#kenburn-playpause-wrapper').hasClass(\"playing\"))\r\n                    kbtl.play(0);\r\n                else\r\n                    kbtl.pause();\r\n\r\n                kbtl.eventCallback(\"onComplete\", function() {\r\n                    kbtl.play(0);\r\n                });\r\n                l.data('kbtl',kbtl);\r\n            }\r\n\r\n\r\n            t.updateKenBurnExampleValues = function() {\r\n                var img = new Image(),\r\n                    nsrc = jQuery('#ken_burn_slot_example').data('src'),\r\n                    lsrc = jQuery('#ken_burn_example').data('lastsrc'),\r\n                    inloadalready = jQuery('#ken_burn_slot_example').data('inload');\r\n\r\n                if (!inloadalready) {\r\n\r\n                    if (nsrc!==lsrc) {\r\n                        jQuery('#ken_burn_slot_example').data('inload',true)\r\n                        img.onload = function() {\r\n                            jQuery('#ken_burn_example').data({\r\n                                lastsrc: this.src,\r\n                                owidth:this.width,\r\n                                oheight:this.height,\r\n                                bgposition:jQuery('#slide_bg_position').val(),\r\n                                duration:parseInt(jQuery('#kb_duration').val(),0),\r\n                                rotatestart: parseInt(jQuery('#kb_start_rotate').val(),0),\r\n                                rotateend: parseInt(jQuery('#kb_end_rotate').val(),0),\r\n                                scalestart: parseInt(jQuery('#kb_start_fit').val(),0),\r\n                                scaleend: parseInt(jQuery('#kb_end_fit').val(),0),\r\n                                offsetstart: jQuery('#kb_start_offset_x').val()+\" \"+jQuery('#kb_start_offset_y').val(),\r\n                                offsetend: jQuery('#kb_end_offset_x').val()+\" \"+jQuery('#kb_end_offset_y').val(),\r\n                                ease:jQuery('#kb_easing').val()\r\n                            });\r\n                            jQuery('#ken_burn_slot_example').data('inload',false)\r\n                            t.startKenBurn();\r\n                        }\r\n                        img.onerror = function() {\r\n                            console.log(\"Ken Burn Demo Image could not be Loaded\");\r\n                        }\r\n                        img.onabort = function() {\r\n                            console.log(\"Ken Burn Demo Image could not be Loaded\");\r\n                        }\r\n                        img.src = nsrc;\r\n                    } else {\r\n                        jQuery('#ken_burn_example').data({\r\n                            lastsrc: jQuery('#ken_burn_slot_example').data('src'),\r\n                            owidth:jQuery('#ken_burn_example').data('owdith'),\r\n                            oheight:jQuery('#ken_burn_example').data('oheight'),\r\n                            bgposition:jQuery('#slide_bg_position').val(),\r\n                            duration:parseInt(jQuery('#kb_duration').val(),0),\r\n                            rotatestart: parseInt(jQuery('#kb_start_rotate').val(),0),\r\n                            rotateend: parseInt(jQuery('#kb_end_rotate').val(),0),\r\n                            scalestart: parseInt(jQuery('#kb_start_fit').val(),0),\r\n                            scaleend: parseInt(jQuery('#kb_end_fit').val(),0),\r\n                            offsetstart: jQuery('#kb_start_offset_x').val()+\" \"+jQuery('#kb_start_offset_y').val(),\r\n                            offsetend: jQuery('#kb_end_offset_x').val()+\" \"+jQuery('#kb_end_offset_y').val(),\r\n                            ease:jQuery('#kb_easing').val()\r\n                        });\r\n                        t.startKenBurn();\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n            var buildKenBurnExample = function() {\r\n                var wrapper = jQuery('#ken_burn_example'),\r\n                    swrapper = jQuery('#ken_burn_slot_example'),\r\n                    c = jQuery('#divLayers'),\r\n                    newh = (wrapper.width() / c.width())*c.height();\r\n\r\n                wrapper.css({height:newh+\"px\"});\r\n                t.updateKenBurnExampleValues();\r\n\r\n\r\n            }\r\n\r\n            var initBackgroundFunctions = function(){\r\n                jQuery('body').on('change', 'select[name=\"layer_target[]\"]', function(){\r\n                    jQuery(this).data('selectoption', jQuery(this).find('option:selected').val());\r\n\r\n\r\n                    //update do-layer-animation-overwrite and do-layer-trigger-memory\r\n                    var dataAnim = t.getAnimTimingAndTrigger(jQuery(this).find('option:selected').val());\r\n\r\n                    jQuery(this).closest('li').find('select[name=\"do-layer-animation-overwrite[]\"] option[value=\"'+dataAnim['animation_overwrite']+'\"]').attr('selected', true);\r\n                    jQuery(this).closest('li').find('select[name=\"do-layer-trigger-memory[]\"] option[value=\"'+dataAnim['trigger_memory']+'\"]').attr('selected', true);\r\n                });\r\n                jQuery('body').on('change', 'select[name=\"jump_to_slide[]\"]', function(){\r\n                    jQuery(this).data('selectoption', jQuery(this).find('option:selected').val());\r\n                });\r\n\r\n\r\n                jQuery('body').on('change', 'select[name=\"do-layer-animation-overwrite[]\"]', function(){\r\n                    var do_sel = jQuery(this).closest('li').find('select[name=\"layer_target[]\"] option:selected').val();\r\n                    var new_val = jQuery(this).val();\r\n\r\n                    var lid = t.getLayerIdByUniqueId(do_sel);\r\n\r\n                    var objUpdate = {};\r\n\r\n                    objUpdate.animation_overwrite = new_val;\r\n\r\n                    update_layer_changes = false;\r\n                    t.updateLayer(lid,objUpdate);\r\n                    update_layer_changes = true;\r\n\r\n                    var clayer = t.getLayer(t.selectedLayerSerial);\r\n                    if(clayer.unique_id == do_sel){\r\n                        //change the current parent sel box\r\n                        jQuery('#layer-animation-overwrite option[value=\"'+new_val+'\"]').attr('selected', true);\r\n                    }\r\n\r\n                    jQuery('select[name=\"layer_target[]\"] option:selected').each(function(){\r\n                        if(jQuery(this).val() == do_sel){\r\n                            jQuery(this).closest('li').find('select[name=\"do-layer-animation-overwrite[]\"] option[value=\"'+new_val+'\"]').attr('selected', true);\r\n                        }\r\n                    });\r\n                });\r\n\r\n\r\n                jQuery('body').on('change', 'select[name=\"do-layer-trigger-memory[]\"]', function(){\r\n                    var do_sel = jQuery(this).closest('li').find('select[name=\"layer_target[]\"] option:selected').val();\r\n                    var new_val = jQuery(this).val();\r\n                    var lid = t.getLayerIdByUniqueId(do_sel);\r\n\r\n                    var objUpdate = {};\r\n\r\n                    objUpdate.trigger_memory = new_val;\r\n\r\n                    update_layer_changes = false;\r\n                    t.updateLayer(lid,objUpdate);\r\n                    update_layer_changes = true;\r\n\r\n                    var clayer = t.getLayer(t.selectedLayerSerial);\r\n                    if(clayer.unique_id == do_sel){\r\n                        //change the current parent sel box\r\n                        jQuery('#layer-tigger-memory option[value=\"'+new_val+'\"]').attr('selected', true);\r\n                    }\r\n\r\n                    jQuery('select[name=\"layer_target[]\"] option:selected').each(function(){\r\n                        if(jQuery(this).val() == do_sel){\r\n                            jQuery(this).closest('li').find('select[name=\"do-layer-trigger-memory[]\"] option[value=\"'+new_val+'\"]').attr('selected', true);\r\n                        }\r\n                    });\r\n                });\r\n\r\n                jQuery('#slide_bg_fit').change(function(){\r\n                    if(jQuery(this).val() == 'percentage'){\r\n                        jQuery('input[name=\"bg_fit_x\"]').show();\r\n                        jQuery('input[name=\"bg_fit_y\"]').show();\r\n\r\n                        jQuery('#divbgholder').css('background-size', jQuery('input[name=\"bg_fit_x\"]').val()+'% '+jQuery('input[name=\"bg_fit_y\"]').val()+'%');\r\n                    }else{\r\n                        jQuery('input[name=\"bg_fit_x\"]').hide();\r\n                        jQuery('input[name=\"bg_fit_y\"]').hide();\r\n\r\n                        jQuery('#divbgholder').css('background-size', jQuery(this).val());\r\n                    }\r\n\r\n\r\n                    if(jQuery(this).val() == 'contain'){\r\n                        jQuery('#divLayers-wrapper').css('maxWidth', jQuery('#divbgholder').css('minWidth'));\r\n                    }else{\r\n                        jQuery('#divLayers-wrapper').css('maxWidth', '100%');\r\n                    }\r\n\r\n\r\n                });\r\n                jQuery('#slide_bg_fit').change();\r\n\r\n                jQuery('input[name=\"bg_fit_x\"]').change(function(){\r\n                    jQuery('#divbgholder').css('background-size', jQuery('input[name=\"bg_fit_x\"]').val()+'% '+jQuery('input[name=\"bg_fit_y\"]').val()+'%');\r\n                });\r\n\r\n                jQuery('input[name=\"bg_fit_y\"]').change(function(){\r\n                    jQuery('#divbgholder').css('background-size', jQuery('input[name=\"bg_fit_x\"]').val()+'% '+jQuery('input[name=\"bg_fit_y\"]').val()+'%');\r\n                });\r\n\r\n                jQuery('#slide_bg_position').change(function(){\r\n                    if(jQuery(this).val() == 'percentage'){\r\n                        jQuery('input[name=\"bg_position_x\"]').show();\r\n                        jQuery('input[name=\"bg_position_y\"]').show();\r\n\r\n                        jQuery('#divbgholder').css('background-position', jQuery('input[name=\"bg_fit_x\"]').val()+'% '+jQuery('input[name=\"bg_fit_y\"]').val()+'%');\r\n                    }else{\r\n                        jQuery('input[name=\"bg_position_x\"]').hide();\r\n                        jQuery('input[name=\"bg_position_y\"]').hide();\r\n\r\n                        jQuery('#divbgholder').css('background-position', jQuery(this).val());\r\n                    }\r\n\r\n                });\r\n\r\n                jQuery('input[name=\"bg_position_x\"]').change(function(){\r\n                    jQuery('#divbgholder').css('background-position', jQuery('input[name=\"bg_position_x\"]').val()+'% '+jQuery('input[name=\"bg_position_y\"]').val()+'%');\r\n                });\r\n\r\n                jQuery('input[name=\"bg_position_y\"]').change(function(){\r\n                    jQuery('#divbgholder').css('background-position', jQuery('input[name=\"bg_position_x\"]').val()+'% '+jQuery('input[name=\"bg_position_y\"]').val()+'%');\r\n                });\r\n\r\n                jQuery('#slide_bg_repeat').change(function(){\r\n                    jQuery('#divbgholder').css('background-repeat', jQuery(this).val());\r\n                });\r\n\r\n                jQuery('input[name=\"kenburn_effect\"]').change(function(){\r\n\r\n                    if(jQuery(this)[0].checked){\r\n                        jQuery('#kenburn_wrapper').show();\r\n\r\n                        jQuery('#divbgholder').css('background-repeat', '');\r\n                        jQuery('#divbgholder').css('background-position', '');\r\n                        jQuery('#divbgholder').css('background-size', '');\r\n\r\n                        jQuery('input[name=\"kb_start_fit\"]').change();\r\n\r\n                        jQuery('#divLayers-wrapper').css('maxWidth', 'none');\r\n\r\n                        jQuery('#slide_bg_position').change();\r\n                        jQuery('#bg-setting-bgfit-wrap').css({display:\"none\"});\r\n                        jQuery('#bg-setting-bgrep-wrap').css({display:\"none\"});\r\n                        jQuery('#bg-setting-bgpos-wrap').prependTo('#kenburn_wrapper');\r\n                        buildKenBurnExample();\r\n                    }else{\r\n                        jQuery('#kenburn_wrapper').hide();\r\n\r\n                        jQuery('#slide_bg_repeat').change();\r\n                        jQuery('#slide_bg_position').change();\r\n                        jQuery('#slide_bg_fit').change();\r\n                        jQuery('#bg-setting-bgfit-wrap').show();\r\n                        jQuery('#bg-setting-bgrep-wrap').show();\r\n                        jQuery('#bg-setting-bgpos-wrap').appendTo('#bg-setting-bgpos-def-wrap');\r\n                        if(jQuery('#slide_bg_fit').val() == 'contain'){\r\n                            jQuery('#divLayers-wrapper').css('maxWidth', jQuery('#divbgholder').css('minWidth'));\r\n                        }else{\r\n                            jQuery('#divLayers-wrapper').css('maxWidth', '100%');\r\n                        }\r\n                    }\r\n                    t.changeSlotBGs();\r\n                });\r\n                jQuery('input[name=\"kenburn_effect\"]:checked').change();\r\n\r\n\r\n                // MEDIA FILTER CHANGES\r\n                jQuery('body').on('mouseenter','.inst-filter-griditem',function() {\r\n                    punchgs.TweenLite.to(jQuery(this).find('.inst-filter-griditem-img'),0.5,{autoAlpha:0});\r\n                })\r\n                jQuery('body').on('mouseleave','.inst-filter-griditem',function() {\r\n                    punchgs.TweenLite.to(jQuery(this).find('.inst-filter-griditem-img'),0.5,{autoAlpha:1});\r\n                });\r\n\r\n                jQuery('body').on('click','.inst-filter-griditem',function() {\r\n                    var a = jQuery(this);\r\n                    jQuery('#media-filter-type option:selected').prop('selected',false);\r\n                    jQuery('#media-filter-type option[value=\"'+a.data(\"type\")+'\"]').attr('selected','selected');\r\n                    jQuery('.inst-filter-griditem.selected').removeClass(\"selected\")\r\n                    a.addClass(\"selected\");\r\n                    jQuery('.oldslotholder').attr(\"class\",\"oldslotholder \"+a.data(\"type\"));\r\n                    jQuery('.slotholder').attr(\"class\",\"slotholder \"+a.data(\"type\"));\r\n                });\r\n\r\n                // SET CURRENT FILTER\r\n                var mediafilter = jQuery('#media-filter-type option:selected').val();\r\n                if (mediafilter!==undefined) {\r\n                    jQuery('.inst-filter-griditem.selected').removeClass(\"selected\");\r\n                    jQuery('.inst-filter-griditem.filter_'+mediafilter).addClass(\"selected\");\r\n                    jQuery('.oldslotholder').attr(\"class\",\"oldslotholder \"+mediafilter);\r\n                    jQuery('.slotholder').attr(\"class\",\"slotholder \"+mediafilter);\r\n                }\r\n                // END OF MEDIA FILTER CHANGES\r\n\r\n\r\n                jQuery('#slide_bg_end_position').change(function(){\r\n                    if(jQuery(this).val() == 'percentage'){\r\n                        jQuery('input[name=\"bg_end_position_x\"]').show();\r\n                        jQuery('input[name=\"bg_end_position_y\"]').show();\r\n                    }else{\r\n                        jQuery('input[name=\"bg_end_position_x\"]').hide();\r\n                        jQuery('input[name=\"bg_end_position_y\"]').hide();\r\n                    }\r\n                });\r\n\r\n\r\n                jQuery('input[name=\"kb_start_fit\"]').change(function(){\r\n                    var fitVal = parseInt(jQuery(this).val());\r\n                    var limg = new Image();\r\n                    limg.onload = function() {\r\n                        calculateKenBurnScales(fitVal, limg.width, limg.height, jQuery('#divbgholder'));\r\n                    }\r\n\r\n                    var urlImage = '';\r\n                    if(jQuery('#radio_back_image')[0].checked)\r\n                        urlImage = jQuery(\"#image_url\").val();\r\n                    else if(jQuery('#radio_back_external')[0].checked)\r\n                        urlImage = jQuery(\"#slide_bg_external\").val();\r\n\r\n                    if(urlImage != ''){\r\n                        limg.src = urlImage;\r\n                    }\r\n                    t.changeSlotBGs();\r\n                });\r\n\r\n                var calculateKenBurnScales = function(proc,owidth,oheight,opt) {\r\n                    var ow = owidth;\r\n                    var oh = oheight;\r\n\r\n\r\n                    var factor = (opt.width() /ow);\r\n                    var factorh = (opt.height() / oh);\r\n\r\n                    var nheight = oh * factor;\r\n                    proc = proc + \"%\";\r\n                    var hfactor = \"auto\";\r\n\r\n                    jQuery('#divbgholder').css('background-size', proc+\" \"+hfactor);\r\n                    t.changeSlotBGs();\r\n                }\r\n\r\n                jQuery(\"#layer_resize-full\").change(function(){\r\n                    if(!jQuery(this)[0].checked){\r\n                        jQuery('#layer_resizeme').prop('checked', false);\r\n                        RevSliderSettings.onoffStatus(jQuery(\"#layer_resizeme\"));\r\n                    }\r\n                });\r\n\r\n                jQuery(\"#layer_resizeme\").change(function(){\r\n                    if(jQuery(this)[0].checked){\r\n                        jQuery('#layer_resize-full').prop('checked', true);\r\n                        RevSliderSettings.onoffStatus(jQuery(\"#layer_resize-full\"));\r\n                    }\r\n                });\r\n\r\n\r\n                jQuery(window).resize(function(){\r\n                    if(jQuery('input[name=\"kenburn_effect\"]:checked').val() == 'on'){\r\n                        var fitVal = parseInt(jQuery('input[name=\"kb_start_fit\"]').val());\r\n                        var limg = new Image();\r\n                        limg.onload = function() {\r\n                            calculateKenBurnScales(fitVal, limg.width, limg.height, jQuery('#divbgholder'));\r\n                        }\r\n\r\n                        var urlImage = '';\r\n                        if(jQuery('#radio_back_image')[0].checked)\r\n                            urlImage = jQuery(\"#image_url\").val();\r\n                        else if(jQuery('#radio_back_external')[0].checked)\r\n                            urlImage = jQuery(\"#slide_bg_external\").val();\r\n\r\n                        if(urlImage != ''){\r\n                            limg.src = urlImage;\r\n                        }\r\n\r\n                    }\r\n                    t.setObjectLibraryHeight();\r\n\r\n                });\r\n            }\r\n\r\n            //======================================================\r\n            //\tMain Background Image Functions End\r\n            //======================================================\r\n\r\n            var initLoopFunctions = function(){\r\n\r\n                jQuery('select[name=\"layer_loop_animation\"]').change(function(){\r\n                    showHideLoopFunctions();\r\n                });\r\n\r\n                jQuery('#layer_static_start').change(function(){\r\n                    changeEndStaticFunctions();\r\n                });\r\n            }\r\n\r\n            var showHideLoopFunctions = function(){\r\n\r\n                jQuery('select[name=\"layer_loop_animation\"]').each(function(){\r\n                    jQuery(\"#layer_easing_wrapper\").hide();\r\n                    jQuery(\"#layer_speed_wrapper\").hide();\r\n                    jQuery(\"#layer_parameters_wrapper\").hide();\r\n                    jQuery(\"#layer_degree_wrapper\").hide();\r\n                    jQuery(\"#layer_origin_wrapper\").hide();\r\n                    jQuery(\"#layer_x_wrapper\").hide();\r\n                    jQuery(\"#layer_y_wrapper\").hide();\r\n                    jQuery(\"#layer_zoom_wrapper\").hide();\r\n                    jQuery(\"#layer_angle_wrapper\").hide();\r\n                    jQuery(\"#layer_radius_wrapper\").hide();\r\n\r\n                    switch(jQuery(this).val()){\r\n                        case 'none':\r\n                            break;\r\n                        case 'rs-pendulum':\r\n                            jQuery(\"#layer_easing_wrapper\").show();\r\n                            jQuery(\"#layer_speed_wrapper\").show();\r\n                            jQuery(\"#layer_parameters_wrapper\").show();\r\n                            jQuery(\"#layer_degree_wrapper\").show();\r\n                            jQuery(\"#layer_origin_wrapper\").show();\r\n                            break;\r\n                        case 'rs-rotate':\r\n                            jQuery(\"#layer_easing_wrapper\").show();\r\n                            jQuery(\"#layer_speed_wrapper\").show();\r\n                            jQuery(\"#layer_parameters_wrapper\").show();\r\n                            jQuery(\"#layer_degree_wrapper\").show();\r\n                            jQuery(\"#layer_origin_wrapper\").show();\r\n                            break;\r\n\r\n                        case 'rs-slideloop':\r\n                            jQuery(\"#layer_easing_wrapper\").show();\r\n                            jQuery(\"#layer_speed_wrapper\").show();\r\n                            jQuery(\"#layer_parameters_wrapper\").show();\r\n                            jQuery(\"#layer_x_wrapper\").show();\r\n                            jQuery(\"#layer_y_wrapper\").show();\r\n                            break;\r\n                        case 'rs-pulse':\r\n                            jQuery(\"#layer_easing_wrapper\").show();\r\n                            jQuery(\"#layer_speed_wrapper\").show();\r\n                            jQuery(\"#layer_parameters_wrapper\").show();\r\n                            jQuery(\"#layer_zoom_wrapper\").show();\r\n                            break;\r\n                        case 'rs-wave':\r\n                            jQuery(\"#layer_speed_wrapper\").show();\r\n                            jQuery(\"#layer_parameters_wrapper\").show();\r\n                            jQuery(\"#layer_angle_wrapper\").show();\r\n                            jQuery(\"#layer_radius_wrapper\").show();\r\n                            jQuery(\"#layer_origin_wrapper\").show();\r\n                            break;\r\n                    }\r\n                });\r\n            }\r\n\r\n            var changeEndStaticFunctions = function(){\r\n\r\n                jQuery('#layer_static_start').each(function(){\r\n                    var cur_att = parseInt(jQuery(this).val());\r\n                    var cur_end = jQuery('#layer_static_end option:selected').val();\r\n                    var go_max_up_to = parseInt(jQuery('#layer_static_start option:last-child').val());\r\n\r\n                    jQuery('#layer_static_end').empty();\r\n\r\n                    for(var cur=cur_att+ 1; cur<=go_max_up_to; cur++){\r\n                        jQuery(\"#layer_static_end\").append('<option value=\"'+cur+'\">'+cur+'</option>');\r\n                    }\r\n                    jQuery(\"#layer_static_end\").append('<option value=\"last\">'+rev_lang.last_slide+'</option>');\r\n\r\n                    jQuery(\"#layer_static_end option[value='\"+cur_end+\"']\").attr('selected', 'selected');\r\n                });\r\n            }\r\n\r\n            t.get_current_selected_layer = function(){\r\n                return t.selectedLayerSerial;\r\n            }\r\n\r\n            t.addPreventLeave = function(){\r\n                /**\r\n                 * warn the user if changes are made and not saved yet\r\n                 */\r\n                window.onbeforeunload = function (e) {\r\n                    if(save_needed) {\r\n                        var message = rev_lang.leave_not_saved,\r\n                            e = e || window.event;\r\n                        // For IE and Firefox\r\n                        if (e) {\r\n                            e.returnValue = message;\r\n                        }\r\n\r\n                        // For Safari\r\n                        return message;\r\n                    }\r\n                };\r\n            }\r\n\r\n        }\r\n\r\n        jQuery(document).ready(function(){\r\n            UniteLayersRev.setGlobalAction(wp.template( \"rs-action-layer-wrap\" ));\r\n            UniteLayersRev.setGlobalSlideImport(wp.template( \"rs-import-layer-wrap\" ));\r\n        });\r\n\r\n        // for compatibilty with add-on scripts\r\n        window['UniteLayersRev'] = UniteLayersRev;\r\n\r\n        return UniteLayersRev;\r\n    }\r\n);","Nwdthemes_Revslider/admin/assets/js/source/show_premium_dialog.js":"define('show_premium_dialog', ['jquery'], function(jQuery) {\r\n\r\n    return function (clicked) {\r\n        jQuery('#rs-premium-benefits-dialog').dialog({\r\n            width: 830,\r\n            height: 750,\r\n            modal: true,\r\n            resizable: false,\r\n            open: function (ui) {\r\n                var dialog = jQuery(ui.target).parent(),\r\n                    dialogtitle = dialog.find('.ui-dialog-title');\r\n\r\n                dialog.addClass(\"rs-open-premium-benefits-dialog-container\");\r\n                if (!dialogtitle.hasClass(\"titlechanged\")) {\r\n                    dialogtitle.html(\"\");\r\n                    dialogtitle.append(jQuery('#rs-premium-benefits-dialog .rs-premium-benefits-dialogtitles'));\r\n                    dialogtitle.addClass(\"titlechanged\");\r\n                }\r\n\r\n                //HIDE TITLE\r\n                jQuery('#rs-library-license-info-dialogtitle, #rs-plugin-object-library-feedback-title, #rs-wrong-purchase-code-title, #rs-plugin-update-feedback-title, #rs-plugin-download-template-feedback-title').hide();\r\n                jQuery('#rs-premium-benefits-dialog').removeClass(\"nomainbg\")\r\n                //HIDE CONTENT\r\n                jQuery('#basic_objectlibrary_license_block, #basic_premium_benefits_block').hide();\r\n\r\n                switch (clicked) {\r\n                    case \"regsiter-to-access-update-none\":\r\n                        jQuery('#rs-plugin-update-feedback-title').show();\r\n                        jQuery('#basic_premium_benefits_block').show();\r\n                        break;\r\n                    case \"regsiter-to-access-store-none\":\r\n                        jQuery('#rs-plugin-download-template-feedback-title').show();\r\n                        jQuery('#basic_premium_benefits_block').show();\r\n                        break;\r\n                    case \"register-wrong-purchase-code\":\r\n                        jQuery('#rs-wrong-purchase-code-title').show();\r\n                        jQuery('#basic_premium_benefits_block').show();\r\n                        break;\r\n                    case \"register-to-acess-object-library\":\r\n                        jQuery('#rs-plugin-object-library-feedback-title').show();\r\n                        jQuery('#basic_premium_benefits_block').show();\r\n                        break;\r\n                    case \"licence_obect_library\":\r\n                        jQuery('#basic_objectlibrary_license_block').show();\r\n                        jQuery('#rs-library-license-info-dialogtitle').show();\r\n                        jQuery('#rs-premium-benefits-dialog').addClass(\"nomainbg\");\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n});\r\n","Nwdthemes_Revslider/admin/assets/js/source/jquery.tipsy.js":"\r\n// tipsy, facebook style tooltips for jquery\r\n// version 1.0.0a\r\n// (c) 2008-2010 jason frame [jason@onehackoranother.com]\r\n// releated under the MIT license\r\n\r\n(function($) {\r\n    \r\n    function fixTitle($ele) {\r\n        if ($ele.attr('title') || typeof($ele.attr('original-title')) != 'string') {\r\n            $ele.attr('original-title', $ele.attr('title') || '').removeAttr('title');\r\n        }\r\n    }\r\n    \r\n    function Tipsy(element, options) {\r\n        this.$element = $(element);\r\n        this.options = options;\r\n        this.enabled = true;\r\n        fixTitle(this.$element);\r\n    }\r\n    \r\n    Tipsy.prototype = {\r\n        show: function() {\r\n            var title = this.getTitle();\r\n            if (title && this.enabled) {\r\n                var $tip = this.tip();\r\n                \r\n                $tip.find('.tipsy-inner')[this.options.html ? 'html' : 'text'](title);\r\n                $tip[0].className = 'tipsy'; // reset classname in case of dynamic gravity\r\n                $tip.remove().css({top: 0, left: 0, visibility: 'hidden', display: 'block'}).appendTo(document.body);\r\n                \r\n                var pos = $.extend({}, this.$element.offset(), {\r\n                    width: this.$element[0].offsetWidth,\r\n                    height: this.$element[0].offsetHeight\r\n                });\r\n                \r\n                var actualWidth = $tip[0].offsetWidth, actualHeight = $tip[0].offsetHeight;\r\n                var gravity = (typeof this.options.gravity == 'function')\r\n                                ? this.options.gravity.call(this.$element[0])\r\n                                : this.options.gravity;\r\n                \r\n                var tp;\r\n                switch (gravity.charAt(0)) {\r\n                    case 'n':\r\n                        tp = {top: pos.top + pos.height + this.options.offset, left: pos.left + pos.width / 2 - actualWidth / 2};\r\n                        break;\r\n                    case 's':\r\n                        tp = {top: pos.top - actualHeight - this.options.offset, left: pos.left + pos.width / 2 - actualWidth / 2};\r\n                        break;\r\n                    case 'e':\r\n                        tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth - this.options.offset};\r\n                        break;\r\n                    case 'w':\r\n                        tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width + this.options.offset};\r\n                        break;\r\n                }\r\n                \r\n                if (gravity.length == 2) {\r\n                    if (gravity.charAt(1) == 'w') {\r\n                        tp.left = pos.left + pos.width / 2 - 15;\r\n                    } else {\r\n                        tp.left = pos.left + pos.width / 2 - actualWidth + 15;\r\n                    }\r\n                }\r\n                \r\n                $tip.css(tp).addClass('tipsy-' + gravity);\r\n                \r\n                if (this.options.fade) {\r\n                    $tip.stop().css({opacity: 0, display: 'block', visibility: 'visible'}).animate({opacity: this.options.opacity});\r\n                } else {\r\n                    $tip.css({visibility: 'visible', opacity: this.options.opacity});\r\n                }\r\n            }\r\n        },\r\n        \r\n        hide: function() {\r\n            if (this.options.fade) {\r\n                this.tip().stop().fadeOut(function() { $(this).remove(); });\r\n            } else {\r\n                this.tip().remove();\r\n            }\r\n        },\r\n        \r\n        getTitle: function() {\r\n            var title, $e = this.$element, o = this.options;\r\n            fixTitle($e);\r\n            var title, o = this.options;\r\n            if (typeof o.title == 'string') {\r\n                title = $e.attr(o.title == 'title' ? 'original-title' : o.title);\r\n            } else if (typeof o.title == 'function') {\r\n                title = o.title.call($e[0]);\r\n            }\r\n            title = ('' + title).replace(/(^\\s*|\\s*$)/, \"\");\r\n            return title || o.fallback;\r\n        },\r\n        \r\n        tip: function() {\r\n            if (!this.$tip) {\r\n                this.$tip = $('<div class=\"tipsy\"></div>').html('<div class=\"tipsy-arrow\"></div><div class=\"tipsy-inner\"/></div>');\r\n            }\r\n            return this.$tip;\r\n        },\r\n        \r\n        validate: function() {\r\n            if (!this.$element[0].parentNode) {\r\n                this.hide();\r\n                this.$element = null;\r\n                this.options = null;\r\n            }\r\n        },\r\n        \r\n        enable: function() { this.enabled = true; },\r\n        disable: function() { this.enabled = false; },\r\n        toggleEnabled: function() { this.enabled = !this.enabled; }\r\n    };\r\n    \r\n    $.fn.tipsy = function(options) {\r\n        \r\n        if (options === true) {\r\n            return this.data('tipsy');\r\n        } else if (typeof options == 'string') {\r\n            return this.data('tipsy')[options]();\r\n        }\r\n        \r\n        options = $.extend({}, $.fn.tipsy.defaults, options);\r\n        \r\n        function get(ele) {\r\n            var tipsy = $.data(ele, 'tipsy');\r\n            if (!tipsy) {\r\n                tipsy = new Tipsy(ele, $.fn.tipsy.elementOptions(ele, options));\r\n                $.data(ele, 'tipsy', tipsy);\r\n            }\r\n            return tipsy;\r\n        }\r\n        \r\n        function enter() {\r\n            var tipsy = get(this);\r\n            tipsy.hoverState = 'in';\r\n            if (options.delayIn == 0) {\r\n                tipsy.show();\r\n            } else {\r\n                setTimeout(function() { if (tipsy.hoverState == 'in') tipsy.show(); }, options.delayIn);\r\n            }\r\n        };\r\n        \r\n        function leave() {\r\n            var tipsy = get(this);\r\n            tipsy.hoverState = 'out';\r\n            if (options.delayOut == 0) {\r\n                tipsy.hide();\r\n            } else {\r\n                setTimeout(function() { if (tipsy.hoverState == 'out') tipsy.hide(); }, options.delayOut);\r\n            }\r\n        };\r\n        \r\n        if (!options.live) this.each(function() { get(this); });\r\n        \r\n        if (options.trigger != 'manual') {\r\n            var binder   = options.live ? 'live' : 'bind',\r\n                eventIn  = options.trigger == 'hover' ? 'mouseenter' : 'focus',\r\n                eventOut = options.trigger == 'hover' ? 'mouseleave' : 'blur';\r\n            this[binder](eventIn, enter)[binder](eventOut, leave);\r\n        }\r\n        \r\n        return this;\r\n        \r\n    };\r\n    \r\n    $.fn.tipsy.defaults = {\r\n        delayIn: 0,\r\n        delayOut: 0,\r\n        fade: false,\r\n        fallback: '',\r\n        gravity: 'n',\r\n        html: false,\r\n        live: false,\r\n        offset: 0,\r\n        opacity: 0.8,\r\n        title: 'title',\r\n        trigger: 'hover'\r\n    };\r\n    \r\n    // Overwrite this method to provide options on a per-element basis.\r\n    // For example, you could store the gravity in a 'tipsy-gravity' attribute:\r\n    // return $.extend({}, options, {gravity: $(ele).attr('tipsy-gravity') || 'n' });\r\n    // (remember - do not modify 'options' in place!)\r\n    $.fn.tipsy.elementOptions = function(ele, options) {\r\n        return $.metadata ? $.extend({}, options, $(ele).metadata()) : options;\r\n    };\r\n    \r\n    $.fn.tipsy.autoNS = function() {\r\n        return $(this).offset().top > ($(document).scrollTop() + $(window).height() / 2) ? 's' : 'n';\r\n    };\r\n    \r\n    $.fn.tipsy.autoWE = function() {\r\n        return $(this).offset().left > ($(document).scrollLeft() + $(window).width() / 2) ? 'e' : 'w';\r\n    };\r\n    \r\n})(jQuery);\r\n","Nwdthemes_Revslider/admin/assets/js/source/admin.js":"define(\r\n    'admin',\r\n    ['jquery', 'galleryBrowser', 'rev_lang', 'loading', 'themepunchTools', 'settings'],\r\n    function(jQuery, galleryBrowser, rev_lang, showWaitAMinute, punchgs, RevSliderSettings) {\r\n\r\n        var UniteAdminRev = new function(){\r\n\r\n            var t = this;\r\n\r\n            var errorMessageID = null;\r\n            var successMessageID = null;\r\n            var ajaxLoaderID = null;\r\n            var ajaxHideButtonID = null;\r\n            var g_multiple_text_key = [];\r\n\r\n            //video dialog vars:\r\n            var lastVideoData = null;\t\t//last fetched data\r\n            var lastVideoCallback = null;   //last callback from video dialog return\r\n            var colorPickerCallback = null;\r\n            var video_found = false;\r\n\r\n\r\n            /**********************************\r\n             -\tSHOW INFO AND HIDE INFO\t-\r\n             ********************************/\r\n\r\n            t.showInfo = function(obj) {\r\n\r\n                var info = '<i class=\"eg-icon-info\"></i>';\r\n                if (obj.type==\"warning\") info = '<i class=\"eg-icon-cancel\"></i>';\r\n                if (obj.type==\"success\") info = '<i class=\"eg-icon-ok\"></i>';\r\n\r\n                obj.showdelay = obj.showdelay != undefined ? obj.showdelay : 0;\r\n                obj.hidedelay = obj.hidedelay != undefined ? obj.hidedelay : 0;\r\n\r\n                // CHECK IF THE TOOLBOX WRAPPER EXIST ALREADY\r\n                if (jQuery('#eg-toolbox-wrapper').length==0) jQuery('#viewWrapper').append('<div id=\"eg-toolbox-wrapper\"></div>');\r\n\r\n                // ADD NEW INFO BOX\r\n                jQuery('#eg-toolbox-wrapper').append('<div class=\"eg-toolbox newadded\">'+info+obj.content+'</div>');\r\n                var nt = jQuery('#eg-toolbox-wrapper').find('.eg-toolbox.newadded');\r\n                nt.removeClass('newadded');\r\n\r\n\r\n                // ANIMATE THE INFO BOX\r\n                punchgs.TweenLite.fromTo(nt,0.5,{y:-50,autoAlpha:0,transformOrigin:\"50% 50%\", transformPerspective:900, rotationX:-90},{autoAlpha:1,y:0,rotationX:0,ease:punchgs.Back.easeOut,delay:obj.showdelay});\r\n\r\n                if (obj.hideon != \"event\") {\r\n                    nt.click(function() {\r\n                        punchgs.TweenLite.to(nt,0.3,{x:200,ease:punchgs.Power3.easeInOut,autoAlpha:0,onComplete:function() {nt.remove()}});\r\n                    })\r\n\r\n                    if (obj.hidedelay !=0 && obj.hideon!=\"click\")\r\n                        punchgs.TweenLite.to(nt,0.3,{x:200,ease:punchgs.Power3.easeInOut,autoAlpha:0,delay:obj.hidedelay + obj.showdelay, onComplete:function() {nt.remove()}});\r\n                } else  {\r\n                    jQuery('#eg-toolbox-wrapper').on(obj.event,function() {\r\n                        punchgs.TweenLite.to(nt,0.3,{x:200,ease:punchgs.Power3.easeInOut,autoAlpha:0,onComplete:function() {nt.remove()}});\r\n                    });\r\n                }\r\n            }\r\n\r\n            /**\r\n             * escape html, turn html to a string\r\n             */\r\n            t.htmlspecialchars = function(string){\r\n                return string\r\n                    .replace(/&/g, \"&amp;\")\r\n                    .replace(/</g, \"&lt;\")\r\n                    .replace(/>/g, \"&gt;\")\r\n                    .replace(/\"/g, \"&quot;\")\r\n                    .replace(/'/g, \"&#039;\");\r\n            }\r\n\r\n            /**\r\n             * Find absolute position on the screen of some element\r\n             */\r\n            t.getAbsolutePos = function(obj){\r\n                var curleft = curtop = 0;\r\n                if (obj.offsetParent) {\r\n                    curleft = obj.offsetLeft;\r\n                    curtop = obj.offsetTop;\r\n                    while (obj = obj.offsetParent) {\r\n                        curleft += obj.offsetLeft;\r\n                        curtop += obj.offsetTop;\r\n                    }\r\n                }\r\n                return[curleft,curtop];\r\n            }\r\n\r\n            t.stripslashes = function(str) {\r\n                return (str + '').replace(/\\\\(.?)/g, function (s, n1) {\r\n                    switch (n1) {\r\n                        case '\\\\':\r\n                            return '\\\\';\r\n                        case '0':\r\n                            return '\\u0000';\r\n                        case '':\r\n                            return '';\r\n                        default:\r\n                            return n1;\r\n                    }\r\n                });\r\n            }\r\n\r\n            /**\r\n             * turn string value (\"true\", \"false\") to string\r\n             */\r\n            t.strToBool = function(str){\r\n\r\n                if(str == undefined)\r\n                    return(false);\r\n\r\n                if(typeof(str) != \"string\")\r\n                    return(false);\r\n\r\n                str = str.toLowerCase();\r\n\r\n                var bool = (str == \"true\")?true:false;\r\n                return(bool);\r\n            }\r\n\r\n            /**\r\n             * set callback on color picker movement\r\n             */\r\n            t.setColorPickerCallback = function(callbackFunc){\r\n                colorPickerCallback = callbackFunc;\r\n            }\r\n\r\n            /**\r\n             * on color picker event. Pass the event further\r\n             */\r\n            t.onColorPickerMoveEvent = function(event){\r\n\r\n                if(typeof colorPickerCallback == \"function\")\r\n                    colorPickerCallback(event);\r\n            }\r\n\r\n\r\n            /**\r\n             * strip html tags\r\n             */\r\n            t.stripTags = function(input, allowed) {\r\n                allowed = (((allowed || \"\") + \"\").toLowerCase().match(/<[a-z][a-z0-9]*>/g) || []).join(''); // making sure the allowed arg is a string containing only tags in lowercase (<a><b><c>)\r\n                var tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi,\r\n                    commentsAndPhpTags = /<!--[\\s\\S]*?-->|<\\?(?:php)?[\\s\\S]*?\\?>/gi;\r\n                return input.replace(commentsAndPhpTags, '').replace(tags, function ($0, $1) {\r\n                    return allowed.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : '';\r\n                });\r\n            }\r\n\r\n            /**\r\n             * change rgb & rgba to hex\r\n             */\r\n            t.rgb2hex = function(rgb) {\r\n                if (rgb.search(\"rgb\") == -1 || jQuery.trim(rgb) == '') return rgb; //ie6\r\n\r\n                function hex(x) {\r\n                    return (\"0\" + parseInt(x).toString(16)).slice(-2);\r\n                }\r\n\r\n                if(rgb.indexOf('-moz') > -1){\r\n                    var temp = rgb.split(' ');\r\n                    delete temp[0];\r\n                    rgb = jQuery.trim(temp.join(' '));\r\n                }\r\n\r\n                if(rgb.split(')').length > 2){\r\n                    var hexReturn = '';\r\n                    var rgbArr = rgb.split(')');\r\n                    for(var i = 0; i < rgbArr.length - 1; i++){\r\n                        rgbArr[i] += ')';\r\n                        var temp = rgbArr[i].split(',');\r\n                        if(temp.length == 4){\r\n                            rgb = temp[0]+','+temp[1]+','+temp[2];\r\n                            rgb += ')';\r\n                        }else{\r\n                            rgb = rgbArr[i];\r\n                        }\r\n                        rgb = jQuery.trim(rgb);\r\n\r\n                        rgb = rgb.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+))?\\)$/);\r\n\r\n                        hexReturn += \"#\" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3])+\" \";\r\n                    }\r\n\r\n                    return hexReturn;\r\n                }else{\r\n                    var temp = rgb.split(',');\r\n                    if(temp.length == 4){\r\n                        rgb = temp[0]+','+temp[1]+','+temp[2];\r\n                        rgb += ')';\r\n                    }\r\n\r\n                    rgb = rgb.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+))?\\)$/);\r\n\r\n                    return \"#\" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * get transparency value from 0 to 100\r\n             */\r\n            t.getTransparencyFromRgba = function(rgba, inPercent){\r\n                var temp = rgba.split(',');\r\n                if(temp.length == 4){\r\n                    inPercent = (typeof inPercent !== 'undefined') ? inPercent : true;\r\n                    return (inPercent) ? temp[3].replace(/[^\\d.]/g, \"\") : temp[3].replace(/[^\\d.]/g, \"\") * 100;\r\n                }\r\n\r\n                return false;\r\n            }\r\n\r\n\r\n            /**\r\n             * debug html on the top of the page (from the master view)\r\n             */\r\n            t.debug = function(html){\r\n                jQuery(\"#div_debug\").show().html(html);\r\n            }\r\n\r\n\r\n            /**\r\n             * output data to console\r\n             */\r\n            t.trace = function(data,clear){\r\n                if(clear && clear == true)\r\n                    console.clear();\r\n                console.log(data);\r\n            }\r\n\r\n\r\n            /**\r\n             * show error message or call once custom handler function\r\n             */\r\n            t.showErrorMessage = function(htmlError){\r\n                t.showInfo({content:htmlError, type:\"warning\", showdelay:0, hidedelay:3, hideon:\"\", event:\"\" });\r\n\r\n                showAjaxButton();\r\n            }\r\n\r\n\r\n            /**\r\n             * hide error message\r\n             */\r\n            var hideErrorMessage = function(){\r\n                if(errorMessageID !== null){\r\n                    jQuery(\"#\"+errorMessageID).hide();\r\n                    errorMessageID = null;\r\n                }else\r\n                    jQuery(\"#error_message\").hide();\r\n            }\r\n\r\n\r\n            /**\r\n             * set error message id\r\n             */\r\n            t.setErrorMessageID = function(id){\r\n                errorMessageID = id;\r\n            }\r\n\r\n\r\n            /**\r\n             * set success message id\r\n             */\r\n            t.setSuccessMessageID = function(id){\r\n                successMessageID = id;\r\n            }\r\n\r\n\r\n            /**\r\n             * show success message\r\n             */\r\n            var showSuccessMessage = function(htmlSuccess){\r\n\r\n                t.showInfo({content:htmlSuccess, type:\"success\", showdelay:0, hidedelay:1, hideon:\"\", event:\"\" });\r\n\r\n                showAjaxButton();\r\n            }\r\n\r\n\r\n            /**\r\n             * hide success message\r\n             */\r\n            this.hideSuccessMessage = function(){\r\n\r\n                if(successMessageID){\r\n                    jQuery(\"#\"+successMessageID).hide();\r\n                    successMessageID = null;\t//can be used only once.\r\n                }\r\n                else\r\n                    jQuery(\"#success_message\").slideUp(\"slow\").fadeOut(\"slow\");\r\n\r\n                showAjaxButton();\r\n            }\r\n\r\n\r\n            /**\r\n             * set ajax loader id that will be shown, and hidden on ajax request\r\n             * this loader will be shown only once, and then need to be sent again.\r\n             */\r\n            this.setAjaxLoaderID = function(id){\r\n                ajaxLoaderID = id;\r\n            }\r\n\r\n            /**\r\n             * show loader on ajax actions\r\n             */\r\n            var showAjaxLoader = function(){\r\n                if(ajaxLoaderID)\r\n                    jQuery(\"#\"+ajaxLoaderID).show();\r\n            }\r\n\r\n            /**\r\n             * hide and remove ajax loader. next time has to be set again before \"ajaxRequest\" function.\r\n             */\r\n            var hideAjaxLoader = function(){\r\n                if(ajaxLoaderID){\r\n                    jQuery(\"#\"+ajaxLoaderID).hide();\r\n                    ajaxLoaderID = null;\r\n                }\r\n            }\r\n\r\n            /**\r\n             * set button to hide / show on ajax operations.\r\n             */\r\n            this.setAjaxHideButtonID = function(buttonID){\r\n                ajaxHideButtonID = buttonID;\r\n            }\r\n\r\n            /**\r\n             * if exist ajax button to hide, hide it.\r\n             */\r\n            var hideAjaxButton = function(){\r\n                if(ajaxHideButtonID){\r\n                    var doHide = ajaxHideButtonID.split(',');\r\n                    if(doHide.length > 1){\r\n                        for(var i = 0; i < doHide.length; i++){\r\n                            jQuery(\"#\"+doHide[i]).hide();\r\n                        }\r\n                    }else{\r\n                        jQuery(\"#\"+ajaxHideButtonID).hide();\r\n                    }\r\n                }\r\n            }\r\n\r\n            /**\r\n             * if exist ajax button, show it, and remove the button id.\r\n             */\r\n            var showAjaxButton = function(){\r\n                if(ajaxHideButtonID){\r\n                    var doShow = ajaxHideButtonID.split(',');\r\n                    if(doShow.length > 1){\r\n                        for(var i = 0; i < doShow.length; i++){\r\n                            jQuery(\"#\"+doShow[i]).show();\r\n                        }\r\n                    }else{\r\n                        jQuery(\"#\"+ajaxHideButtonID).show();\r\n                    }\r\n                    ajaxHideButtonID = null;\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * Ajax request function. call wp ajax, if error - print error message.\r\n             * if success, call \"success function\"\r\n             */\r\n            t.ajaxRequest = function(action,data,successFunction,hideOverlay,hideError){\r\n\r\n                var objData = {\r\n                    action:g_uniteDirPlugin+\"_ajax_action\",\r\n                    client_action:action,\r\n                    nonce:g_revNonce,\r\n                    form_key:window.FORM_KEY,\r\n                    data:data\r\n                }\r\n                hideErrorMessage();\r\n                showAjaxLoader();\r\n                hideAjaxButton();\r\n\r\n                if(hideOverlay===undefined)\r\n                    showWaitAMinute({fadeIn:300,text:rev_lang.please_wait_a_moment});\r\n\r\n                jQuery.ajax({\r\n                    type:\"post\",\r\n                    url:ajaxurl,\r\n                    dataType: 'json',\r\n                    data:objData,\r\n                    success:function(response){\r\n                        if (hideOverlay===undefined && response && !response.is_redirect)\r\n                            showWaitAMinute({fadeOut:300});\r\n\r\n                        hideAjaxLoader();\r\n\r\n                        if(!response){\r\n                            t.showErrorMessage(\"Empty ajax response!\");\r\n                            return(false);\r\n                        }\r\n\r\n                        if(response == -1){\r\n                            t.showErrorMessage(\"ajax error!!!\");\r\n                            return(false);\r\n                        }\r\n\r\n                        if(response == 0){\r\n                            t.showErrorMessage(\"ajax error, action: <b>\"+action+\"</b> not found\");\r\n                            return(false);\r\n                        }\r\n\r\n                        if(response.success == undefined){\r\n                            t.showErrorMessage(\"The 'success' param is a must!\");\r\n                            return(false);\r\n                        }\r\n\r\n                        if(response.success == false){\r\n                            if(hideError===undefined){\r\n                                t.showErrorMessage(response.message);\r\n                                return(false);\r\n                            }else{\r\n                                if(typeof successFunction == \"function\"){\r\n                                    successFunction(response);\r\n                                }\r\n                            }\r\n                        }else{\r\n\r\n                            //success actions:\r\n\r\n                            //run a success event function\r\n                            if(typeof successFunction == \"function\"){\r\n                                successFunction(response);\r\n                            }\r\n\r\n                            if(response.message)\r\n                                showSuccessMessage(response.message);\r\n\r\n                            if(response.is_redirect)\r\n                                location.href=response.redirect_url;\r\n                        }\r\n                    },\r\n                    error:function(jqXHR, textStatus, errorThrown){\r\n                        if(hideOverlay===undefined)\r\n                            showWaitAMinute({fadeOut:300});\r\n\r\n                        hideAjaxLoader();\r\n\r\n                        if(textStatus == \"parsererror\")\r\n                            t.debug(jqXHR.responseText);\r\n\r\n                        t.showErrorMessage(\"Ajax Error!!! \" + textStatus);\r\n                    }\r\n                });\r\n\r\n            }//ajaxrequest\r\n\r\n            /**\r\n             * open Magento add image dialog\r\n             * TODO: Implement multiple images upload\r\n             */\r\n\r\n            var openMageImageDialog = function(title, onInsert, isMultiple, fileType) {\r\n\r\n                MediabrowserUtility.openDialog(\r\n                    revMageImageUploadUrl.replace('file_type', fileType ? fileType : 'image'),\r\n                    false,\r\n                    false,\r\n                    title,\r\n                    {},\r\n                    onInsert\r\n                );\r\n            }\r\n\r\n\r\n            t.openAddImageDialog = function(title,onInsert,isMultiple){\r\n\r\n                if(!title)\r\n                    title = rev_lang.select_image;\r\n\r\n                openMageImageDialog(title, onInsert, isMultiple);\r\n\r\n            }\r\n\r\n\r\n            t.openAddVideoDialog = function(title,onInsert,isMultiple){\r\n\r\n                if(!title)\r\n                    title = rev_lang.select_image;\r\n\r\n                openMageImageDialog(title, onInsert, isMultiple, 'video');\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * load css file on the fly\r\n             * replace current item if exists\r\n             */\r\n            t.loadCssFile = function(urlCssFile,replaceID,getCached){\r\n\r\n                var rand = Math.floor((Math.random()*100000)+1);\r\n\r\n                if ( ! getCached)\r\n                    urlCssFile += \"?rand=\"+rand;\r\n\r\n                if(replaceID)\r\n                    jQuery(\"#\"+replaceID).remove();\r\n\r\n                jQuery(\"head\").append(\"<link>\");\r\n                var css = jQuery(\"head\").children(\":last\");\r\n                css.attr({\r\n                    rel:  \"stylesheet\",\r\n                    type: \"text/css\",\r\n                    href: urlCssFile\r\n                });\r\n\r\n                //replace current element\r\n                if(replaceID)\r\n                    css.attr({id:replaceID});\r\n            }\r\n\r\n\r\n            /**\r\n             * get show image url\r\n             */\r\n            t.getUrlShowImage = function(imageID,width,height,exact){\r\n                var urlImage = g_urlAjaxShowImage.replace('-image-', imageID);\r\n\r\n                if(width)\r\n                    urlImage = urlImage.replace('-width-', width);\r\n\r\n                if(height)\r\n                    urlImage = urlImage.replace('-height-', height);\r\n\r\n                if(exact && exact == true)\r\n                    urlImage = urlImage.replace('-type-', 'exact');\r\n\r\n                return(urlImage);\r\n            }\r\n\r\n\r\n            /**\r\n             * set html to youtube dialog\r\n             * if empty data - clear the dialog\r\n             */\r\n            var setYoutubeDialogHtml = function(data){\r\n\r\n                //if empty data - clear the dialog\r\n                if(!data){\r\n                    jQuery(\"#video_content\").html(\"\");\r\n                    return(false);\r\n                }\r\n\r\n                var thumb = data.thumb_medium;\r\n\r\n                var useURL = (jQuery.trim(jQuery('#input_video_preview').val()) != '') ? jQuery('#input_video_preview').val() : thumb.url;\r\n\r\n                var html = '<div class=\"video-thumbnail-all-wrapper\">';\r\n                html += '<div class=\"video-thumbnail-preview-wrapper\"><div id=\"video-thumbnail-preview\" style=\"background-size:cover; background-position:center center; background-image:url('+useURL+'); width:'+thumb.width+'px; height:'+thumb.height+'px;display:inline-block;vertical-align:bottom\"></div></div>';\r\n                html += '<div class=\"video-content-description\">';\r\n                html += '<div class=\"video-content-title\">'+data.title+'</div>';\r\n                if(typeof data.desc_small != \"undefined\") html += data.desc_small;\r\n                html += '</div>';\r\n                html += '</div>';\r\n\r\n                jQuery(\"#video_content\").html(html);\r\n            }\r\n\r\n\r\n            /**\r\n             * set html to youtube dialog\r\n             * if empty data - clear the dialog\r\n             */\r\n            var setAudioDialogHtml = function(data){\r\n\r\n                jQuery('#button-audio-add').text(jQuery('#button-audio-add').data(\"textadd\"));\r\n\r\n                jQuery('#video_radio_audio').attr('checked', true);\r\n\r\n                jQuery(\"#video_type_chooser\").hide();\r\n                jQuery(\"#video_block_youtube\").hide();\r\n                jQuery(\"#video_block_vimeo\").hide();\r\n                jQuery(\"#video_block_html5\").hide();\r\n                jQuery('#video_block_audio').show();\r\n\r\n                jQuery('.rs-hide-on-audio').hide();\r\n                jQuery('.rs-show-on-audio').show();\r\n\r\n\r\n\r\n                //if empty data - clear the dialog\r\n                if(!data){\r\n                    jQuery(\"#video_content\").html(\"\");\r\n                    return(false);\r\n                }\r\n\r\n                var thumb = data.thumb_medium;\r\n\r\n                var useURL = (jQuery.trim(jQuery('#input_video_preview').val()) != '') ? jQuery('#input_video_preview').val() : thumb.url;\r\n\r\n                var html = '<div class=\"video-thumbnail-all-wrapper\">';\r\n                html += '<div class=\"video-thumbnail-preview-wrapper\"><div id=\"video-thumbnail-preview\" style=\"background-size:cover; background-position:center center; background-image:url('+useURL+'); width:'+thumb.width+'px; height:'+thumb.height+'px;display:inline-block;vertical-align:bottom\"></div></div>';\r\n                html += '<div class=\"video-content-description\">';\r\n                html += '<div class=\"video-content-title\">'+data.title+'</div>';\r\n                if(typeof data.desc_small != \"undefined\") html += data.desc_small;\r\n                html += '</div>';\r\n                html += '</div>';\r\n\r\n                jQuery(\"#video_content\").html(html);\r\n            }\r\n\r\n\r\n            /**\r\n             * pass youtube id or youtube url, and get the id\r\n             */\r\n            var getYoutubeIDFromUrl = function(url){\r\n                url = jQuery.trim(url);\r\n\r\n                var video_id = url.split('v=')[1];\r\n\r\n                if(video_id){\r\n                    var ampersandPosition = video_id.indexOf('&');\r\n                    if(ampersandPosition != -1) {\r\n                        video_id = video_id.substring(0, ampersandPosition);\r\n                    }\r\n                }else{\r\n                    if (url.indexOf('youtu.be/') != -1) {\r\n                        video_id = url.split('youtu.be/')[1];\r\n                    } else {\r\n                        video_id = url;\r\n                    }\r\n                }\r\n\r\n                return(video_id);\r\n            }\r\n\r\n\r\n            /**\r\n             * get vimeo id from url\r\n             */\r\n            var getVimeoIDFromUrl = function(url){\r\n                url = jQuery.trim(url);\r\n\r\n                var video_id = url.replace(/[^0-9]+/g, '');\r\n                video_id = jQuery.trim(video_id);\r\n\r\n                return(video_id);\r\n            }\r\n\r\n\r\n\r\n            /**\r\n             * youtube callback script, set and store youtube data, and add it to dialog\r\n             */\r\n            t.onYoutubeCallback = function(obj){\r\n                jQuery(\"#youtube_loader\").hide();\r\n                var desc_small_size = 200;\r\n\r\n                //prepare data\r\n                var data = {};\r\n                data.id = jQuery(\"#youtube_id\").val();\r\n                data.id = jQuery.trim(data.id);\r\n                data.video_type = \"youtube\";\r\n                if(obj[0].width <= 129 || obj[0].height <= 96) {\r\n                    if (obj[0].src.indexOf('/sddefault.jpg') != -1) {\r\n                        obj[0].src = obj[0].src.replace('sddefault.jpg', 'hqdefault.jpg');\r\n                        return false;\r\n                    }\r\n                    data.title = 'YouTube: '+rev_lang.maybe_wrong_yt_id;\r\n                }else{\r\n                    data.title = 'YouTube';\r\n                }\r\n                data.author = 'YouTube';\r\n                data.link = '';\r\n                data.description = '';\r\n                data.desc_small = '';\r\n\r\n                if(data.description.length > desc_small_size)\r\n                    data.desc_small = data.description.slice(0,desc_small_size)+\"...\";\r\n\r\n                data.thumb_small = {url:obj[0].src,width:200,height:150};\r\n                data.thumb_medium = {url:obj[0].src,width:320,height:240};\r\n                data.thumb_big = {url:obj[0].src,width:obj[0].width,height:obj[0].height};\r\n                data.thumb_very_big = {url:obj[0].src.replace('sddefault.jpg', 'maxresdefault.jpg'),width:obj[0].width,height:obj[0].height};\r\n\r\n                data.video_width = obj[0].width;\r\n                data.video_height = obj[0].height;\r\n\r\n                //set html in dialog\r\n                setYoutubeDialogHtml(data);\r\n\r\n                //set the youtube arguments\r\n                var objArguments = jQuery(\"#input_video_arguments\");\r\n                if(objArguments.val() == \"\")\r\n                    objArguments.val(objArguments.data(\"youtube\"));\r\n\r\n                //store last video data\r\n                lastVideoData = data;\r\n\r\n                jQuery('#video_dialog_tabs').removeClass('disabled');\r\n\r\n                video_found = true;\r\n                jQuery('#button-video-add').show();\r\n            }\r\n\r\n            t.initVideoDef = function(){\r\n                jQuery('.button-image-select-video-default').click(function(){\r\n\r\n                    if(typeof(lastVideoData) == 'undefined') return false;\r\n\r\n                    switch(lastVideoData.video_type){\r\n                        case 'vimeo':\r\n                            jQuery(\"#input_video_preview\").val(lastVideoData.thumb_medium.url);\r\n                            //update preview image:\r\n                            jQuery(\"#video-thumbnail-preview\").css({backgroundImage:'url('+lastVideoData.thumb_medium.url+')'});\r\n                            break;\r\n                        case 'youtube':\r\n                            jQuery(\"#input_video_preview\").val(lastVideoData.thumb_big.url);\r\n                            //update preview image:\r\n                            jQuery(\"#video-thumbnail-preview\").css({backgroundImage:'url('+lastVideoData.thumb_big.url+')'});\r\n                            break;\r\n                    }\r\n                });\r\n\r\n                jQuery('.button-image-select-video-max').click(function(){\r\n\r\n                    if(typeof(lastVideoData) == 'undefined') return false;\r\n\r\n                    switch(lastVideoData.video_type){\r\n                        case 'vimeo':\r\n                            jQuery(\"#input_video_preview\").val(lastVideoData.thumb_large.url);\r\n                            //update preview image:\r\n                            jQuery(\"#video-thumbnail-preview\").css({backgroundImage:'url('+lastVideoData.thumb_large.url+')'});\r\n                            break;\r\n                        case 'youtube':\r\n                            jQuery(\"#input_video_preview\").val(lastVideoData.thumb_very_big.url);\r\n                            //update preview image:\r\n                            jQuery(\"#video-thumbnail-preview\").css({backgroundImage:'url('+lastVideoData.thumb_very_big.url+')'});\r\n                            break;\r\n                    }\r\n                });\r\n            }\r\n\r\n\r\n            /**\r\n             * vimeo callback script, set and store vimeo data, and add it to dialog\r\n             */\r\n            t.onVimeoCallback = function(obj){\r\n                jQuery(\"#vimeo_loader\").hide();\r\n\r\n                var desc_small_size = 200;\r\n                obj = obj[0];\r\n\r\n                var data = {};\r\n                data.video_type = \"vimeo\";\r\n                data.id = obj.id;\r\n                data.id = jQuery.trim(data.id);\r\n                data.title = obj.title;\r\n                data.link = obj.url;\r\n                data.author = obj.user_name;\r\n\r\n                data.description = obj.description;\r\n                if(data.description.length > desc_small_size)\r\n                    data.desc_small = data.description.slice(0,desc_small_size)+\"...\";\r\n\r\n                data.thumb_large = {url:obj.thumbnail_large,width:640,height:360};\r\n                data.thumb_medium = {url:obj.thumbnail_medium,width:200,height:150};\r\n                data.thumb_small = {url:obj.thumbnail_small,width:100,height:75};\r\n\r\n                data.video_with = 640;\r\n                data.video_height = 360;\r\n\r\n                //set html in dialog\r\n                setYoutubeDialogHtml(data);\r\n\r\n                //set the vimeo arguments\r\n                var objArguments = jQuery(\"#input_video_arguments\");\r\n                if(objArguments.val() == \"\")\r\n                    objArguments.val(objArguments.data(\"vimeo\"));\r\n\r\n                //store last video data\r\n                lastVideoData = data;\r\n\r\n                jQuery('#video_dialog_tabs').removeClass('disabled');\r\n\r\n                video_found = true;\r\n                jQuery('#button-video-add').show();\r\n            }\r\n\r\n\r\n            /**\r\n             * show error message on the dialog\r\n             */\r\n            t.videoDialogOnError = function(){\r\n\r\n                //if ok, don't do nothing\r\n                if(video_found == true){\r\n                    if(jQuery('#video_radio_audio').is(':checked')){\r\n                        jQuery('#button-audio-add').show();\r\n                    }else{\r\n                        jQuery('#button-video-add').show();\r\n                    }\r\n                    video_found = false;\r\n                    return(false);\r\n                }\r\n\r\n                //if error - show message\r\n                jQuery('#button-video-add').hide();\r\n                jQuery('#button-audio-add').hide();\r\n                jQuery(\"#youtube_loader\").hide();\r\n                jQuery(\"#vimeo_loader\").hide();\r\n                var html = \"<div class='video-content-error'>\"+rev_lang.video_not_found+\"</div>\";\r\n                jQuery(\"#video_content\").html(html);\r\n            }\r\n\r\n\r\n            /**\r\n             * update video size enabled disabled according fullwidth properties\r\n             */\r\n            var updateVideoSizeProps = function(){\r\n                var isFullwidth = jQuery(\"#input_video_fullwidth\").is(\":checked\");\r\n                if(isFullwidth == true){\t//disable\r\n                    jQuery('#video_full_screen_settings').show();\r\n                }else{\t\t//enable\r\n                    jQuery(\"#input_video_cover\").prop(\"checked\",false);\r\n                    jQuery('#video_full_screen_settings').hide();\r\n                }\r\n\r\n                var isCover = jQuery(\"#input_video_cover\").is(\":checked\");\r\n                if(isCover == true){\t//disable\r\n                    jQuery(\"#input_video_ratio_lbl, #input_video_ratio, #input_video_dotted_overlay_lbl, #input_video_dotted_overlay\").show();\r\n                }else{\t\t//enable\r\n                    jQuery(\"#input_video_ratio_lbl, #input_video_ratio, #input_video_dotted_overlay_lbl, #input_video_dotted_overlay\").hide();\r\n                }\r\n\r\n\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_fullwidth'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_cover'));\r\n            }\r\n\r\n            /**\r\n             * open dialog for youtube or vimeo import , add / update\r\n             */\r\n            t.openVideoDialog = function(callback,objCurrentVideoData,gal_type){\r\n\r\n                lastVideoCallback = callback;\r\n\r\n                var dialogVideo = jQuery(\"#dialog_video\");\r\n\r\n                //set buttons:\r\n                var buttons = {\r\n                    \"Close\":function(){\r\n                        dialogVideo.dialog(\"close\");\r\n                    }\r\n                };\r\n\r\n                if(gal_type == 'audio'){\r\n                    setAudioDialogHtml(false);\r\n                }else{\r\n                    //clear the dialog content\r\n                    setYoutubeDialogHtml(false);\r\n                    jQuery(\"#video_block_youtube\").show();\r\n                    jQuery(\"#video_block_audio\").hide();\r\n                    jQuery('#video_radio_youtube').attr('checked', true);\r\n                    jQuery('.rs-hide-on-audio').show();\r\n                    jQuery('.rs-show-on-audio').hide();\r\n                    jQuery(\"#video_type_chooser\").show();\r\n                    jQuery('#video_type_chooser input[type=radio]:checked').trigger('click');\r\n                }\r\n\r\n                //enable fields:\r\n\r\n                jQuery(\"#youtube_id,#vimeo_id\").prop(\"disabled\",\"\").removeClass(\"input-disabled\");\r\n\r\n                //clear the fields\r\n                jQuery('#html5_url_poster').val('');\r\n                jQuery('#html5_url_mp4').val('');\r\n                jQuery('#html5_url_webm').val('');\r\n                jQuery('#html5_url_ogv').val('');\r\n                jQuery('#html5_url_audio').val('');\r\n\r\n                jQuery(\"#input_video_arguments\").val(\"\");\r\n                jQuery(\"#select_video_autoplay option[value='false']\").attr(\"selected\",true);\r\n                //jQuery(\"#input_video_autoplay\").prop(\"checked\",\"\");\r\n                //jQuery(\"#showautoplayfirsttime\").hide();\r\n                //jQuery(\"#input_video_autoplay_first_time\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_nextslide\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_force_rewind\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_fullwidth\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_control\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_mute\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_disable_on_mobile\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_show_cover_pause\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_large_controls\").prop(\"checked\",true);\r\n                jQuery(\"#input_video_leave_fs_on_pause\").prop(\"checked\",true);\r\n                jQuery(\"#input_video_cover\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_stopallvideo\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_allowfullscreen\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_dotted_overlay option[value='none']\").attr(\"selected\",true);\r\n                jQuery(\"#input_video_ratio option[value='16:9']\").attr(\"selected\",true);\r\n                jQuery('#input_video_preload option[value=\"auto\"]').attr(\"selected\",true);\r\n                jQuery('#input_video_preload_wait option[value=\"5\"]').attr(\"selected\",true);\r\n\r\n\r\n                jQuery('#input_video_speed option[value=\"1\"]').attr(\"selected\",true);\r\n                jQuery('#input_video_loop option[value=\"none\"]').attr(\"selected\",true);\r\n                jQuery(\"#input_video_preview\").val(\"\");\r\n                jQuery(\"#input_use_poster_on_mobile\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_show_visibility\").prop(\"checked\",\"\");\r\n                jQuery(\"#input_video_play_inline\").prop(\"checked\",\"\");\r\n\r\n                jQuery(\"#input_video_start_at\").val('');\r\n                jQuery(\"#input_video_end_at\").val('');\r\n\r\n                jQuery(\"#input_video_volume\").val('100');\r\n\r\n                //RevSliderSettings.onoffStatus(jQuery(\"#input_video_autoplay\"));\r\n                //RevSliderSettings.onoffStatus(jQuery(\"#input_video_autoplay_first_time\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_nextslide\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_force_rewind\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_fullwidth\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_control\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_mute\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_disable_on_mobile\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_cover\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_stopallvideo\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_allowfullscreen\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_use_poster_on_mobile\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_show_cover_pause\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_large_controls\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_leave_fs_on_pause\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_show_visibility\"));\r\n                RevSliderSettings.onoffStatus(jQuery(\"#input_video_play_inline\"));\r\n\r\n                jQuery('#button-video-add').hide();\r\n                jQuery('#button-audio-add').hide();\r\n                if(!jQuery('#video_dialog_tabs').hasClass('disabled')) jQuery('#video_dialog_tabs').addClass('disabled');\r\n\r\n                jQuery(\"#youtube_id\").val(\"\");\r\n                jQuery(\"#vimeo_id\").val(\"\");\r\n\r\n                jQuery(\"#fullscreenvideofun\").hide();\r\n\r\n                var buttonVideoAdd = jQuery(\"#button-video-add\");\r\n                buttonVideoAdd.text(buttonVideoAdd.data(\"textadd\"));\r\n\r\n                var buttonAudioAdd = jQuery(\"#button-audio-add\");\r\n                buttonAudioAdd.text(buttonAudioAdd.data(\"textadd\"));\r\n\r\n                //open the dialog\r\n                dialogVideo.dialog({\r\n                    buttons:buttons,\r\n                    minWidth:830,\r\n                    minHeight:500,\r\n                    modal:true,\r\n                    dialogClass:\"tpdialogs\",\r\n                    create:function(ui) {\r\n                        jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                    }\r\n                });\r\n\r\n\r\n                //if update dialog open:\r\n                if(objCurrentVideoData)\r\n                    setVideoDialogUpdateMode(objCurrentVideoData);\r\n\r\n                updateVideoSizeProps();\r\n            }\r\n\r\n\r\n            /**\r\n             * prepare the dialog for video update\r\n             */\r\n            var setVideoDialogUpdateMode = function(data){\r\n\r\n                data.id = jQuery.trim(data.id);\r\n\r\n                //disable fields:\r\n                //jQuery(\"#youtube_id,#vimeo_id\").prop(\"disabled\",\"disabled\").addClass(\"input-disabled\");\r\n\r\n                //set mode and video id\r\n                switch(data.video_type){\r\n                    case \"youtube\":\r\n                        jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                        jQuery(\"#video_radio_youtube\").trigger(\"click\");\r\n                        jQuery(\"#youtube_id\").val(data.id);\r\n                        jQuery(\"#fullscreenvideofun\").hide();\r\n                        break;\r\n                    case \"vimeo\":\r\n                        jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                        jQuery(\"#video_radio_vimeo\").trigger(\"click\");\r\n                        jQuery(\"#vimeo_id\").val(data.id);\r\n                        jQuery(\"#fullscreenvideofun\").hide();\r\n                        break;\r\n                    case \"html5\":\r\n                        jQuery(\"#video-dialog-wrap\").addClass(\"html5select\");\r\n                        jQuery(\"#html5_url_poster\").val(data.urlPoster);\r\n                        jQuery(\"#html5_url_mp4\").val(data.urlMp4);\r\n                        jQuery(\"#html5_url_webm\").val(data.urlWebm);\r\n                        jQuery(\"#html5_url_ogv\").val(data.urlOgv);\r\n                        jQuery(\"#video_radio_html5\").trigger(\"click\");\r\n                        jQuery(\"#fullscreenvideofun\").show();\r\n                        break;\r\n                    case 'streamvimeo':\r\n                        jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                        jQuery(\"#video_radio_streamvimeo\").trigger(\"click\");\r\n                        break;\r\n                    case 'streamyoutube':\r\n                        jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                        jQuery(\"#video_radio_streamyoutube\").trigger(\"click\");\r\n                        break;\r\n                    case 'streaminstagram':\r\n                        jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                        jQuery(\"#video_radio_streaminstagram\").trigger(\"click\");\r\n                        break;\r\n                    case 'audio':\r\n                        jQuery(\"#html5_url_audio\").val(data.urlAudio);\r\n                        jQuery(\"#rev-html5-options\").hide();\r\n\r\n                        break;\r\n                }\r\n\r\n                jQuery(\"#input_video_arguments\").val(data.args);\r\n\r\n                jQuery(\"#input_video_preview\").val(data.previewimage);\r\n\r\n                if(data.use_poster_on_mobile && data.use_poster_on_mobile == true){\r\n                    jQuery(\"#input_use_poster_on_mobile\").prop(\"checked\",\"checked\");\r\n                }else{\r\n                    jQuery(\"#input_use_poster_on_mobile\").prop(\"checked\",\"\");\r\n                }\r\n\r\n                if(data.video_show_visibility && data.video_show_visibility == true){\r\n                    jQuery(\"#input_video_show_visibility\").prop(\"checked\",\"checked\");\r\n                }else{\r\n                    jQuery(\"#input_video_show_visibility\").prop(\"checked\",\"\");\r\n                }\r\n\r\n                if(data.video_play_inline && data.video_play_inline == true){\r\n                    jQuery(\"#input_video_play_inline\").prop(\"checked\",\"checked\");\r\n                }else{\r\n                    jQuery(\"#input_video_play_inline\").prop(\"checked\",\"\");\r\n                }\r\n\r\n                if(data.autoplayonlyfirsttime && data.autoplayonlyfirsttime == true)\r\n                    data.autoplay = '1sttime';\r\n\r\n                if(data.autoplay){\r\n                    switch(data.autoplay){\r\n                        case 'true':\r\n                        case true:\r\n                            jQuery('#select_video_autoplay option[value=\"true\"]').attr('selected', true);\r\n                            break;\r\n                        case false:\r\n                        case 'false':\r\n                            jQuery('#select_video_autoplay option[value=\"false\"]').attr('selected', true);\r\n                            break;\r\n                        default:\r\n                            jQuery('#select_video_autoplay option[value=\"'+data.autoplay+'\"]').attr('selected', true);\r\n                            break;\r\n                    }\r\n                }\r\n\r\n                if(data.nextslide && data.nextslide == true)\r\n                    jQuery(\"#input_video_nextslide\").prop(\"checked\",\"checked\");\r\n                else\r\n                    jQuery(\"#input_video_nextslide\").prop(\"checked\",\"\");\r\n\r\n                if(data.forcerewind && data.forcerewind == true)\r\n                    jQuery(\"#input_video_force_rewind\").prop(\"checked\",\"checked\");\r\n                else\r\n                    jQuery(\"#input_video_force_rewind\").prop(\"checked\",\"\");\r\n\r\n                if(data.fullwidth && data.fullwidth == true)\r\n                    jQuery(\"#input_video_fullwidth\").prop(\"checked\",\"checked\");\r\n                else\r\n                    jQuery(\"#input_video_fullwidth\").prop(\"checked\",\"\");\r\n\r\n                if(data.controls && data.controls == true)\r\n                    jQuery(\"#input_video_control\").prop(\"checked\",\"checked\");\r\n                else\r\n                    jQuery(\"#input_video_control\").prop(\"checked\",\"\");\r\n\r\n                if(data.mute && data.mute == true)\r\n                    jQuery(\"#input_video_mute\").prop(\"checked\",\"checked\");\r\n                else\r\n                    jQuery(\"#input_video_mute\").prop(\"checked\",\"\");\r\n\r\n                if(data.disable_on_mobile && data.disable_on_mobile == true)\r\n                    jQuery(\"#input_disable_on_mobile\").prop(\"checked\",\"checked\");\r\n                else\r\n                    jQuery(\"#input_disable_on_mobile\").prop(\"checked\",\"\");\r\n\r\n                if(data.cover && data.cover == true)\r\n                    jQuery(\"#input_video_cover\").prop(\"checked\",\"checked\");\r\n                else\r\n                    jQuery(\"#input_video_cover\").prop(\"checked\",\"\");\r\n\r\n                if(data.stopallvideo && data.stopallvideo == true)\r\n                    jQuery(\"#input_video_stopallvideo\").prop(\"checked\",\"checked\");\r\n                else\r\n                    jQuery(\"#input_video_stopallvideo\").prop(\"checked\",\"\");\r\n\r\n                if(data.allowfullscreen && data.allowfullscreen == true)\r\n                    jQuery(\"#input_video_allowfullscreen\").prop(\"checked\",\"checked\");\r\n                else\r\n                    jQuery(\"#input_video_allowfullscreen\").prop(\"checked\",\"\");\r\n\r\n                if(data.preload){\r\n                    jQuery(\"#input_video_preload option\").each(function(){\r\n                        if(jQuery(this).val() == data.preload)\r\n                            jQuery(this).attr('selected', true);\r\n                    });\r\n                }\r\n\r\n                if(data.preload_audio){\r\n                    jQuery(\"#input_audio_preload option\").each(function(){\r\n                        if(jQuery(this).val() == data.preload_audio)\r\n                            jQuery(this).attr('selected', true);\r\n                    });\r\n                }\r\n\r\n                if(data.preload_wait){\r\n                    jQuery(\"#input_video_preload_wait option\").each(function(){\r\n                        if(jQuery(this).val() == data.preload_wait)\r\n                            jQuery(this).attr('selected', true);\r\n                    });\r\n                }\r\n\r\n                if(data.videospeed){\r\n                    jQuery(\"#input_video_speed option\").each(function(){\r\n                        if(jQuery(this).val() == data.videospeed)\r\n                            jQuery(this).attr('selected', true);\r\n                    });\r\n                }\r\n\r\n                if(data.dotted){\r\n                    jQuery(\"#input_video_dotted_overlay option\").each(function(){\r\n                        if(jQuery(this).val() == data.dotted)\r\n                            jQuery(this).attr('selected', true);\r\n                    });\r\n                }\r\n                if(data.ratio){\r\n                    jQuery(\"#input_video_ratio option\").each(function(){\r\n                        if(jQuery(this).val() == data.ratio)\r\n                            jQuery(this).attr('selected', true);\r\n                    });\r\n                }\r\n\r\n                if(data.videoloop){\r\n                    if(data.videoloop == true){\r\n                        jQuery('#input_video_loop option[value=\"loop\"]').attr(\"selected\",true);\r\n                    }else{\r\n                        jQuery(\"#input_video_loop option\").each(function(){\r\n                            if(jQuery(this).val() == data.videoloop)\r\n                                jQuery(this).attr('selected', true);\r\n                        });\r\n                    }\r\n                }\r\n\r\n                //change button text:\r\n                var buttonVideoAdd = jQuery(\"#button-video-add\");\r\n                buttonVideoAdd.text(buttonVideoAdd.data(\"textupdate\"));\r\n\r\n                var buttonAudioAdd = jQuery(\"#button-audio-add\");\r\n                buttonAudioAdd.text(buttonAudioAdd.data(\"textupdate\"));\r\n\r\n                //search\r\n                switch(data.video_type){\r\n                    case \"youtube\":\r\n                        jQuery(\"#button_youtube_search\").trigger(\"click\");\r\n                        break;\r\n                    case \"vimeo\":\r\n                        jQuery(\"#button_vimeo_search\").trigger(\"click\");\r\n                        break;\r\n                }\r\n\r\n                if(data.show_cover_pause && data.show_cover_pause == true)\r\n                    jQuery('#input_video_show_cover_pause').prop('checked', 'checked');\r\n                else\r\n                    jQuery('#input_video_show_cover_pause').prop('checked', '');\r\n\r\n                if(typeof(data.large_controls) !== 'undefined' && data.large_controls == false)\r\n                    jQuery('#input_video_large_controls').prop('checked', '');\r\n                else\r\n                    jQuery('#input_video_large_controls').prop('checked', 'checked');\r\n\r\n                if(typeof(data.leave_on_pause) !== 'undefined' && data.leave_on_pause == false)\r\n                    jQuery('#input_video_leave_fs_on_pause').prop('checked', '');\r\n                else\r\n                    jQuery('#input_video_leave_fs_on_pause').prop('checked', 'checked');\r\n\r\n\r\n                jQuery(\"#input_video_start_at\").val(data.start_at);\r\n                jQuery(\"#input_video_end_at\").val(data.end_at);\r\n\r\n                jQuery(\"#input_video_volume\").val(data.volume);\r\n\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_nextslide'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_force_rewind'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_fullwidth'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_control'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_mute'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_disable_on_mobile'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_cover'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_stopallvideo'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_allowfullscreen'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_use_poster_on_mobile'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_show_cover_pause'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_large_controls'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_leave_fs_on_pause'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_show_visibility'));\r\n                RevSliderSettings.onoffStatus(jQuery('#input_video_play_inline'));\r\n\r\n                if(data.video_type === 'audio'){\r\n                    jQuery('#button-video-add').hide();\r\n                    jQuery('#button-audio-add').show();\r\n                }else{\r\n                    jQuery('#button-video-add').show();\r\n                    jQuery('#button-audio-add').hide();\r\n                }\r\n                jQuery('#video_dialog_tabs').removeClass('disabled');\r\n\r\n                jQuery('#reset_video_dialog_tab').click();\r\n\r\n            }\r\n\r\n\r\n            //add params from textboxes to object\r\n            var addTextboxParamsToObj = function(obj){\r\n                obj.args = jQuery(\"#input_video_arguments\").val();\r\n                obj.previewimage = jQuery(\"#input_video_preview\").val();\r\n                obj.autoplay = jQuery(\"#select_video_autoplay option:selected\").val();\r\n                obj.use_poster_on_mobile = jQuery(\"#input_use_poster_on_mobile\").is(\":checked\");\r\n                obj.video_show_visibility = jQuery(\"#input_video_show_visibility\").is(\":checked\");\r\n                obj.video_play_inline = jQuery(\"#input_video_play_inline\").is(\":checked\");\r\n                obj.nextslide = jQuery(\"#input_video_nextslide\").is(\":checked\");\r\n                obj.forcerewind = jQuery(\"#input_video_force_rewind\").is(\":checked\");\r\n                obj.fullwidth = jQuery(\"#input_video_fullwidth\").is(\":checked\");\r\n                obj.controls = jQuery(\"#input_video_control\").is(\":checked\");\r\n                obj.mute = jQuery(\"#input_video_mute\").is(\":checked\");\r\n                obj.disable_on_mobile = jQuery(\"#input_disable_on_mobile\").is(\":checked\");\r\n                obj.cover = jQuery(\"#input_video_cover\").is(\":checked\");\r\n                obj.stopallvideo = jQuery(\"#input_video_stopallvideo\").is(\":checked\");\r\n                obj.allowfullscreen = jQuery(\"#input_video_allowfullscreen\").is(\":checked\");\r\n                obj.dotted = jQuery(\"#input_video_dotted_overlay option:selected\").val();\r\n                obj.preload = jQuery(\"#input_video_preload option:selected\").val();\r\n                obj.preload_audio = jQuery(\"#input_audio_preload option:selected\").val();\r\n                obj.preload_wait = jQuery(\"#input_video_preload_wait option:selected\").val();\r\n                obj.videospeed = jQuery(\"#input_video_speed option:selected\").val();\r\n                obj.ratio = jQuery(\"#input_video_ratio option:selected\").val();\r\n                obj.videoloop = jQuery(\"#input_video_loop option:selected\").val();\r\n                obj.show_cover_pause = jQuery(\"#input_video_show_cover_pause\").is(\":checked\");\r\n                obj.start_at = jQuery(\"#input_video_start_at\").val();\r\n                obj.end_at = jQuery(\"#input_video_end_at\").val();\r\n                obj.volume = jQuery(\"#input_video_volume\").val();\r\n                obj.large_controls = jQuery('#input_video_large_controls').is(':checked');\r\n                obj.leave_on_pause = jQuery('#input_video_leave_fs_on_pause').is(':checked');\r\n\r\n                return(obj);\r\n            }\r\n\r\n\r\n            /**\r\n             * init video dialog buttons\r\n             */\r\n            var initVideoDialog = function(){\r\n\r\n                //set youtube radio checked:\r\n                jQuery(\"#video_radio_youtube\").prop(\"checked\",true);\r\n\r\n                //set radio boxes:\r\n                jQuery(\"#video_radio_vimeo\").click(function(){\r\n                    jQuery(\"#video_block_youtube\").hide();\r\n                    jQuery(\"#video_block_html5\").hide();\r\n                    jQuery(\"#rev-html5-options\").hide();\r\n                    jQuery(\"#rev-youtube-options\").hide();\r\n                    jQuery(\"#rev-playsinline-options\").hide();\r\n                    jQuery(\"#video_block_vimeo\").show();\r\n                    jQuery(\"#preview-image-video-wrap\").show();\r\n                    jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                    jQuery(\"#fullscreenvideofun\").hide();\r\n                    jQuery(\".video-volume\").show();\r\n                    jQuery('.hide-for-vimeo').hide();\r\n                });\r\n\r\n                jQuery(\"#video_radio_youtube\").click(function(){\r\n                    jQuery(\"#video_block_vimeo\").hide();\r\n                    jQuery(\"#video_block_html5\").hide();\r\n                    jQuery(\"#rev-html5-options\").hide();\r\n                    jQuery(\"#rev-youtube-options\").show();\r\n                    jQuery(\"#rev-playsinline-options\").show();\r\n                    jQuery(\"#video_block_youtube\").show();\r\n                    jQuery(\"#preview-image-video-wrap\").show();\r\n                    jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                    jQuery(\"#fullscreenvideofun\").hide();\r\n                    jQuery(\".video-volume\").show();\r\n                    jQuery('.hide-for-vimeo').show();\r\n                });\r\n\r\n                jQuery(\"#video_radio_html5\").click(function(){\r\n                    jQuery(\"#video_block_vimeo\").hide();\r\n                    jQuery(\"#video_block_youtube\").hide();\r\n                    jQuery(\"#video_block_html5\").show();\r\n                    jQuery(\"#rev-youtube-options\").hide();\r\n                    jQuery(\"#rev-playsinline-options\").show();\r\n                    jQuery(\"#rev-html5-options\").show();\r\n                    jQuery(\"#video_content\").hide();\r\n                    jQuery(\"#preview-image-video-wrap\").hide();\r\n                    jQuery(\"#video-dialog-wrap\").addClass(\"html5select\");\r\n                    jQuery(\"#fullscreenvideofun\").show();\r\n                    jQuery(\".video-volume\").show();\r\n                    jQuery('.hide-for-vimeo').show();\r\n                });\r\n\r\n\r\n                jQuery(\"#video_radio_streamyoutube\").click(function(){\r\n                    jQuery(\"#video_block_youtube\").hide();\r\n                    jQuery(\"#video_block_vimeo\").hide();\r\n                    jQuery(\"#video_block_html5\").hide();\r\n                    jQuery(\"#rev-html5-options\").hide();\r\n                    jQuery(\"#rev-youtube-options\").hide();\r\n                    jQuery(\"#rev-playsinline-options\").hide();\r\n                    jQuery(\"#preview-image-video-wrap\").show();\r\n                    jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                    jQuery(\"#fullscreenvideofun\").hide();\r\n                    jQuery('#video_dialog_tabs').removeClass('disabled');\r\n                    jQuery('#button-video-add').show();\r\n                    jQuery(\".video-volume\").show();\r\n                    jQuery('.hide-for-vimeo').show();\r\n                });\r\n\r\n\r\n                jQuery(\"#video_radio_streamvimeo\").click(function(){\r\n                    jQuery(\"#video_block_youtube\").hide();\r\n                    jQuery(\"#video_block_vimeo\").hide();\r\n                    jQuery(\"#video_block_html5\").hide();\r\n                    jQuery(\"#rev-html5-options\").hide();\r\n                    jQuery(\"#rev-youtube-options\").show();\r\n                    jQuery(\"#rev-playsinline-options\").show();\r\n                    jQuery(\"#preview-image-video-wrap\").show();\r\n                    jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                    jQuery(\"#fullscreenvideofun\").hide();\r\n                    jQuery('#video_dialog_tabs').removeClass('disabled');\r\n                    jQuery('#button-video-add').show();\r\n                    jQuery(\".video-volume\").show();\r\n                    jQuery('.hide-for-vimeo').hide();\r\n                });\r\n\r\n\r\n                jQuery(\"#video_radio_streaminstagram\").click(function(){\r\n                    jQuery(\"#video_block_youtube\").hide();\r\n                    jQuery(\"#video_block_vimeo\").hide();\r\n                    jQuery(\"#video_block_html5\").hide();\r\n                    jQuery(\"#rev-html5-options\").hide();\r\n                    jQuery(\"#rev-youtube-options\").hide();\r\n                    jQuery(\"#rev-playsinline-options\").hide();\r\n                    jQuery(\"#preview-image-video-wrap\").show();\r\n                    jQuery(\"#video-dialog-wrap\").removeClass(\"html5select\");\r\n                    jQuery(\"#fullscreenvideofun\").hide();\r\n                    jQuery('#video_dialog_tabs').removeClass('disabled');\r\n                    jQuery('#button-video-add').show();\r\n                    jQuery(\".video-volume\").hide();\r\n                    jQuery('.hide-for-vimeo').show();\r\n                });\r\n\r\n\r\n\r\n                jQuery(\"#input_video_cover\").change(function(){\r\n                    if(jQuery(this).is(\":checked\")){\r\n                        if(!jQuery('#input_video_fullwidth').is(\":checked\")) jQuery('#input_video_fullwidth').prop(\"checked\",true);\r\n                        RevSliderSettings.onoffStatus(jQuery('#input_video_fullwidth'));\r\n                    }\r\n                    updateVideoSizeProps();\r\n                });\r\n\r\n\r\n                jQuery(\"#input_video_fullwidth\").change(function(){\r\n                    if(jQuery(this).is(':checked')){\r\n                        jQuery('#video_full_screen_settings').show();\r\n                    }else{\r\n                        jQuery('#video_full_screen_settings').hide();\r\n                    }\r\n                });\r\n\r\n\r\n                //set youtube search action\r\n                jQuery(\"#button_youtube_search\").click(function(){\r\n\r\n                    //init data\r\n                    setYoutubeDialogHtml(false);\r\n\r\n                    jQuery(\"#youtube_loader\").show();\r\n                    var youtubeID = jQuery(\"#youtube_id\").val();\r\n                    youtubeID = jQuery.trim(youtubeID);\r\n\r\n                    youtubeID = getYoutubeIDFromUrl(youtubeID);\r\n                    jQuery(\"#youtube_id\").val(youtubeID);\r\n\r\n                    var img = new Image();\r\n                    img.onload = function() {\r\n                        var img = jQuery(this);\r\n                        UniteAdminRev.onYoutubeCallback(img);\r\n                    }\r\n                    img.src = \"https://img.youtube.com/vi/\"+youtubeID+\"/maxresdefault.jpg\";\r\n\r\n                    jQuery(\"#video_content\").show();\r\n\r\n                    //handle not found:\r\n                    setTimeout(\"UniteAdminRev.videoDialogOnError()\",2000);\r\n                });\r\n\r\n\r\n                //add the selected video to the callback function\r\n                jQuery(\"#button-video-add, #button-audio-add\").click(function(){\r\n\r\n                    var html5Checked = jQuery(\"#video_radio_html5\").prop(\"checked\");\r\n                    var audioChecked = jQuery(\"#video_radio_audio\").prop(\"checked\");\r\n                    var ytstreamChecked = jQuery(\"#video_radio_streamyoutube\").prop(\"checked\");\r\n                    var vmstreamChecked = jQuery(\"#video_radio_streamvimeo\").prop(\"checked\");\r\n                    var igstreamChecked = jQuery(\"#video_radio_streaminstagram\").prop(\"checked\");\r\n\r\n                    jQuery(\"#video_content\").hide();\r\n\r\n                    if(html5Checked){\t//in case of html5\r\n                        var obj = {};\r\n                        obj.video_type = \"html5\";\r\n                        obj.urlPoster = jQuery(\"#html5_url_poster\").val();\r\n                        obj.urlMp4 = jQuery(\"#html5_url_mp4\").val();\r\n                        obj.urlWebm = jQuery(\"#html5_url_webm\").val();\r\n                        obj.urlOgv = jQuery(\"#html5_url_ogv\").val();\r\n\r\n                        obj.video_width = 480;\r\n                        obj.video_height = 360;\r\n\r\n                        obj = addTextboxParamsToObj(obj);\r\n\r\n                        if(typeof lastVideoCallback == \"function\")\r\n                            lastVideoCallback(obj);\r\n\r\n                        jQuery(\"#dialog_video\").dialog(\"close\");\r\n\r\n                    }else if(ytstreamChecked){\r\n                        var obj = {};\r\n                        obj.video_type = \"streamyoutube\";\r\n\r\n                        obj.video_width = 480;\r\n                        obj.video_height = 360;\r\n\r\n                        obj = addTextboxParamsToObj(obj);\r\n\r\n                        if(typeof lastVideoCallback == \"function\")\r\n                            lastVideoCallback(obj);\r\n\r\n                        jQuery(\"#dialog_video\").dialog(\"close\");\r\n                    }else if(vmstreamChecked){\r\n                        var obj = {};\r\n                        obj.video_type = \"streamvimeo\";\r\n\r\n                        obj.video_width = 480;\r\n                        obj.video_height = 360;\r\n\r\n                        obj = addTextboxParamsToObj(obj);\r\n\r\n                        if(typeof lastVideoCallback == \"function\")\r\n                            lastVideoCallback(obj);\r\n\r\n                        jQuery(\"#dialog_video\").dialog(\"close\");\r\n                    }else if(igstreamChecked){\r\n                        var obj = {};\r\n                        obj.video_type = \"streaminstagram\";\r\n\r\n                        obj.video_width = 480;\r\n                        obj.video_height = 360;\r\n\r\n                        obj = addTextboxParamsToObj(obj);\r\n\r\n                        if(typeof lastVideoCallback == \"function\")\r\n                            lastVideoCallback(obj);\r\n\r\n                        jQuery(\"#dialog_video\").dialog(\"close\");\r\n                    }else if(audioChecked){\r\n                        var obj = {};\r\n                        obj.video_type = 'audio';\r\n                        obj.urlAudio = jQuery(\"#html5_url_audio\").val();\r\n\r\n                        obj.video_width = 200;\r\n                        obj.video_height = 34;\r\n\r\n                        //maybe 30x30\r\n\r\n                        obj = addTextboxParamsToObj(obj);\r\n\r\n                        if(typeof lastVideoCallback == \"function\")\r\n                            lastVideoCallback(obj);\r\n\r\n                        jQuery(\"#dialog_video\").dialog(\"close\");\r\n                    }else{ //in case of vimeo and youtube\r\n                        if(!lastVideoData)\r\n                            return(false);\r\n\r\n                        lastVideoData = addTextboxParamsToObj(lastVideoData);\r\n\r\n                        if(typeof lastVideoCallback == \"function\")\r\n                            lastVideoCallback(lastVideoData);\r\n\r\n                        jQuery(\"#dialog_video\").dialog(\"close\");\r\n                    }\r\n                    try {\r\n                        UniteLayersRev.setLayerSelected(selectedLayerSerial,true);\r\n                    } catch(e) {\r\n\r\n                    }\r\n\r\n\r\n                });\r\n\r\n                jQuery('#html5_url_ogv, #html5_url_webm, #html5_url_mp4').on(\"change\",function() {\r\n                    jQuery('#video_dialog_tabs').removeClass('disabled');\r\n                    jQuery('#button-video-add').show();\r\n                    jQuery('#button-audio-add').hide();\r\n                });\r\n\r\n                jQuery('#html5_url_audio').on(\"change\",function() {\r\n                    jQuery('#video_dialog_tabs').removeClass('disabled');\r\n                    jQuery('#button-video-add').hide();\r\n                    jQuery('#button-audio-add').show();\r\n                });\r\n\r\n                //set vimeo search\r\n                jQuery(\"#button_vimeo_search\").click(function(){\r\n                    //init data\r\n                    setYoutubeDialogHtml(false);\r\n\r\n                    jQuery(\"#vimeo_loader\").show();\r\n\r\n                    jQuery(\"#video_content\").show();\r\n\r\n                    var vimeoID = jQuery(\"#vimeo_id\").val();\r\n                    vimeoID = jQuery.trim(vimeoID);\r\n                    vimeoID = getVimeoIDFromUrl(vimeoID);\r\n\r\n                    var urlAPI = '//www.vimeo.com/api/v2/video/' + vimeoID + '.json?callback=UniteAdminRev.onVimeoCallback';\r\n                    jQuery.getScript(urlAPI);\r\n\r\n                    //handle not found:\r\n                    setTimeout(\"UniteAdminRev.videoDialogOnError()\",2000);\r\n                });\r\n\r\n\r\n                jQuery(\"#input_video_fullwidth\").change(updateVideoSizeProps);\r\n\r\n            }//end initVideoDialog\r\n\r\n\r\n            /**\r\n             * init general settings dialog\r\n             */\r\n            var initGeneralSettings = function(){\r\n\r\n                //button save general settings\r\n                jQuery(\".button_save_general_settings\").click(function(){\r\n                    var data = RevSliderSettings.getSettingsObject(\"form_general_settings\");\r\n                    jQuery(\"#loader_general_settings\").show();\r\n                    UniteAdminRev.ajaxRequest(\"update_general_settings\",data,function() {});\r\n                });\r\n\r\n                //button trigger font update process\r\n                jQuery(\"#trigger_font_deletion\").click(function(){\r\n                    if(confirm('This will update all downloaded Google Fonts')){\r\n                        UniteAdminRev.ajaxRequest(\"trigger_font_deletion\",{},function(response){});\r\n                    }\r\n                });\r\n\r\n            }\r\n\r\n\r\n            //adds the update/deactivate option\r\n            var initUpdateRoutine = function(){\r\n\r\n                jQuery('#rs-validation-activate').click(function(){\r\n\r\n                    var data = {\r\n                        code: jQuery('input[name=\"rs-validation-token\"]').val().replace(/[^0-9a-z-]/gi, '')\r\n                    }\r\n\r\n                    UniteAdminRev.ajaxRequest(\"activate_purchase_code\",data,function(response){\r\n                        if(response.success == false){\r\n                            jQuery('#register-wrong-purchase-code').click();\r\n                        }else{\r\n                            if(response.error !== undefined){\r\n                                if(response.error == 'exist'){\r\n                                    t.showErrorMessage(response.msg);\r\n                                }\r\n                            }\r\n                        }\r\n                    },undefined,true);\r\n                });\r\n\r\n                jQuery('#rs-validation-deactivate').click(function(){\r\n                    UniteAdminRev.ajaxRequest(\"deactivate_purchase_code\",'');\r\n                });\r\n\r\n            }\r\n\r\n            /**\r\n             * set multiple key values\r\n             */\r\n            t.setMultipleTextKey = function(name, key){\r\n                g_multiple_text_key[name] = key;\r\n            }\r\n\r\n            /**\r\n             * set multiple key values\r\n             */\r\n            t.getMultipleTextKey = function(name){\r\n                return g_multiple_text_key[name];\r\n            }\r\n\r\n            var initSliderMultipleText = function(){\r\n\r\n                jQuery(\"body\").on(\"click\",\".remove_multiple_text\",function(){ //remove element\r\n                    jQuery(\"#\"+jQuery(this).data('remove')).remove();\r\n                    jQuery(this).parent().remove();\r\n                });\r\n\r\n                jQuery(\".multiple_text_add\").click(function(){ //add element\r\n\r\n                    var handle = jQuery(this).data('name');\r\n                    var key = t.getMultipleTextKey(handle) + 1;\r\n                    var template = jQuery('.'+handle+'_TEMPLATE').html();\r\n\r\n                    template = template.replace(/##ID##/ig, handle+'_'+key).replace(/##NAME##/ig, handle);\r\n                    jQuery('#'+handle+'_row .setting_input').append(template);\r\n\r\n                    t.setMultipleTextKey(handle, key);\r\n                });\r\n\r\n            }\r\n\r\n            /**\r\n             * set multiple key values\r\n             */\r\n            t.parseCssMultiAttribute = function(value){\r\n                if(value == '') return false;\r\n                var raw = value.split(' ');\r\n                var retObj = [];\r\n\r\n                switch(raw.length){\r\n                    case 1:\r\n                        retObj[0] = raw[0];\r\n                        retObj[1] = raw[0];\r\n                        retObj[2] = raw[0];\r\n                        retObj[3] = raw[0];\r\n                        break;\r\n                    case 2:\r\n                        retObj[0] = raw[0];\r\n                        retObj[1] = raw[1];\r\n                        retObj[2] = raw[0];\r\n                        retObj[3] = raw[1];\r\n                        break;\r\n                    case 3:\r\n                        retObj[0] = raw[0];\r\n                        retObj[1] = raw[1];\r\n                        retObj[2] = raw[2];\r\n                        retObj[3] = raw[1];\r\n                        break;\r\n                    case 4:\r\n                        retObj[0] = raw[0];\r\n                        retObj[1] = raw[1];\r\n                        retObj[2] = raw[2];\r\n                        retObj[3] = raw[3];\r\n                        break;\r\n                    case 0:\r\n                    default:\r\n                        return false;\r\n                        break;\r\n                }\r\n\r\n                return retObj;\r\n            }\r\n\r\n            /**\r\n             * get rgb from hex values\r\n             */\r\n            t.convertHexToRGB = function(hex) {\r\n                var hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\r\n                return [hex >> 16,(hex & 0x00FF00) >> 8,(hex & 0x0000FF)];\r\n            }\r\n\r\n\r\n            t.initGoogleFonts = function(){\r\n                jQuery('#eg-font-setting-change').click(function(){\r\n                    UniteAdminRev.ajaxRequest(\"change_google_fonts_settings\", {'setting': jQuery('input[name=\"load_fonts_place\"]:checked').val()}, function(response){});\r\n                });\r\n\r\n                jQuery('#eg-font-add').click(function(){\r\n                    jQuery('#font-dialog-wrap').dialog({\r\n                        modal:true,\r\n                        draggable:false,\r\n                        resizable:false,\r\n                        width:470,\r\n                        height:320,\r\n                        closeOnEscape:true,\r\n                        dialogClass:\"tpdialogs\",\r\n                        create:function(ui) {\r\n                            jQuery(ui.target).parent().find('.ui-dialog-titlebar').addClass(\"tp-slider-new-dialog-title\");\r\n                        },\r\n                        buttons: [ { text: 'Add Font', click: function() {\r\n                            var data = {};\r\n\r\n                            data.handle = t.sanitize_input(jQuery('input[name=\"eg-font-handle\"]').val());\r\n                            data['url'] = jQuery('input[name=\"eg-font-url\"]').val();\r\n\r\n                            if(data.handle.length < 3 || data.url.length < 3){\r\n                                alert(rev_lang.handle_at_least_three_chars);\r\n                                return false;\r\n                            }\r\n\r\n                            UniteAdminRev.ajaxRequest(\"add_google_fonts\", data, function(response){}); //'#eg-font-add',\r\n\r\n                        } } ],\r\n                    });\r\n                });\r\n\r\n\r\n                jQuery('body').on('click', '.eg-font-edit', function(){\r\n                    if(confirm(rev_lang.really_change_font_sett)){\r\n                        var data = {};\r\n                        var el = jQuery(this);\r\n                        data.handle = el.closest('.inside').find('input[name=\"esg-font-handle[]\"]').val();\r\n                        data['url'] = el.closest('.inside').find('input[name=\"esg-font-url[]\"]').val();\r\n\r\n                        UniteAdminRev.ajaxRequest(\"edit_google_fonts\", data, function(response){}); //'#eg-font-add, .eg-font-edit, .eg-font-delete',\r\n                    }\r\n\r\n                });\r\n\r\n\r\n                jQuery('body').on('click', '.eg-font-delete', function(){\r\n                    if(confirm(rev_lang.really_delete_font)){\r\n                        var data = {};\r\n                        var el = jQuery(this);\r\n\r\n                        data.handle = el.closest('.inside').find('input[name=\"esg-font-handle[]\"]').val();\r\n\r\n                        UniteAdminRev.ajaxRequest(\"remove_google_fonts\", data, function(response){ //'#eg-font-add, .eg-font-edit, .eg-font-delete',\r\n                            if(response.success == true){\r\n                                el.closest('.postbox.eg-postbox').remove();\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n\r\n            }\r\n\r\n            t.sanitize_input = function(raw){\r\n                return raw.replace(/ /g, '-').replace(/[^-0-9a-zA-Z_-]/g,'');\r\n            }\r\n\r\n            t.sanitize_input_lc = function(raw){\r\n                return raw.replace(/ /g, '-').replace(/[^-0-9a-z_-]/g,'');\r\n            }\r\n\r\n            t.initAccordion = function(){\r\n                jQuery(\".postbox-arrow\").each(function(i) {\r\n\r\n                    jQuery(this).closest('h3').click(function(){\r\n                        var handle = jQuery(this);\r\n\r\n                        //open\r\n                        if(!handle.hasClass(\"box-closed\")){\r\n                            handle.closest('.postbox').find('.inside').slideUp(\"fast\");\r\n                            handle.addClass(\"box-closed\");\r\n\r\n                        }else{\t//close\r\n                            jQuery('.postbox-arrow').each(function() {\r\n                                var handle = jQuery(this).closest('h3');\r\n                                handle.closest('.postbox').find('.inside').slideUp(\"fast\");\r\n                                handle.addClass(\"box-closed\");\r\n                            })\r\n                            handle.closest('.postbox').find('.inside').slideDown(\"fast\");\r\n                            handle.removeClass(\"box-closed\");\r\n\r\n                        }\r\n                    });\r\n\r\n                });\r\n            };\r\n\r\n            t.return_ajaxurl_param = function(){\r\n                return (ajaxurl.indexOf('?') === -1) ? '?' : '&';\r\n            };\r\n\r\n            t.duplicateObject = function(obj, isDeep) {\r\n                return t.removePrototypeMethods('undefined' != typeof isDeep && isDeep ? jQuery.extend(true, {}, obj) : jQuery.extend({}, obj));\r\n            };\r\n\r\n            t.duplicateObjectDeep = function(obj) {\r\n                return t.duplicateObject(obj, true);\r\n            };\r\n\r\n            t.removePrototypeMethods = function(obj) {\r\n                for (var key in obj) {\r\n                    if ( ! obj.hasOwnProperty(key)) {\r\n                        delete obj[key];\r\n                    } else {\r\n                        if (typeof obj[key] == 'Object' || typeof obj[key] == 'Array') {\r\n                            obj[key] = t.removePrototypeMethods(obj[key]);\r\n                        }\r\n                    }\r\n                }\r\n                return obj;\r\n            };\r\n\r\n            //run the init function\r\n            jQuery(document).ready(function(){\r\n                jQuery('body').addClass('wp-core-ui');\r\n                initVideoDialog();\r\n                initGeneralSettings();\r\n                initSliderMultipleText();\r\n                initUpdateRoutine();\r\n            });\r\n        };\r\n\r\n        //user functions:\r\n\r\n        function trace(data,clear){\r\n            UniteAdminRev.trace(data,clear);\r\n        }\r\n\r\n        function debug(data){\r\n            UniteAdminRev.debug(data);\r\n        }\r\n\r\n        // for compatibilty with add-on scripts\r\n        window['UniteAdminRev'] = UniteAdminRev;\r\n\r\n        return UniteAdminRev;\r\n    }\r\n);","Nwdthemes_Revslider/admin/assets/js/source/context_menu.js":"define(\r\n    'contextMenu',\r\n    ['jquery', 'themepunchTools'],\r\n    function(jQuery, punchgs) {\r\n\r\n        var tpLayerContextMenu = new function() {\r\n\r\n            /** CONTEXT MENU VARIABLES**/\r\n            var\tt = this,\r\n                u = new Object(),\r\n                tl = new Object(),\r\n\r\n                contextMenuClassName = \"context-menu\",\r\n                contextMenuItemClassName = \"context-menu__item\",\r\n                contextMenuLinkClassName = \"context-menu__link\",\r\n                contextMenuActive = \"context-menu--active\",\r\n                taskItemInContext,\r\n\r\n                clickCoords,\r\n                clickCoordsX,\r\n                clickCoordsY,\r\n\r\n                _ctxmenu,\r\n                _ctxmenuItems,\r\n                _ctxmenuState = 0,\r\n                _ctxmenuWidth,\r\n                _ctxmenuHeight,\r\n                _ctxmenuPosition,\r\n                _ctxmenuPositionX,\r\n                _ctxmenuPositionY,\r\n\r\n                _ctxwindowWidth,\r\n                _ctxwindowHeight;\r\n            t.stylecache = {};\r\n\r\n            t.init = function(UniteLayersRev, tpLayerTimelinesRev) {\r\n\r\n                //return false;\r\n                u = UniteLayersRev;\r\n                tl = tpLayerTimelinesRev;\r\n                _ctxmenu = document.querySelector(\"#context-menu\");\r\n                _ctxmenuItems = _ctxmenu.querySelectorAll(\".context-menu__item\");\r\n                _contextMenuinit();\r\n\r\n                // PERFECT SCROLLBARS IN SUBMENUS\r\n                jQuery('.context-submenu').perfectScrollbar({wheelPropagation:false, suppressScrollX:true});\r\n                jQuery('.context-submenu').each(function() {\r\n                    jQuery(this).on('mouseenter',function() {\r\n                        jQuery(this).perfectScrollbar(\"update\");\r\n                    });\r\n                });\r\n\r\n                //LAYER BORDER SHOW ON HOVER\r\n                jQuery('body').on('mouseenter','.ctx-dyn-avl-list-item',function() {\r\n                    jQuery('.layer_due_list_element_selected').removeClass('layer_due_list_element_selected');\r\n                    jQuery('#slide_layer_'+jQuery(this).data('serial')).addClass(\"layer_due_list_element_selected\");\r\n                });\r\n                jQuery('body').on('mouseleave','.ctx-dyn-avl-list-item',function() {\r\n                    jQuery('.layer_due_list_element_selected').removeClass('layer_due_list_element_selected');\r\n                });\r\n\r\n                //SWITCHER CLICK\r\n                jQuery('body').on('click','.ctx-td-switcher',function() {\r\n                    var sw = jQuery(this);\r\n                    sw.toggleClass(\"ctx-td-s-off\");\r\n                });\r\n\r\n                jQuery('body').on('click','.ctx-td-option-selector', function() {\r\n                    var btn = jQuery(this);\r\n                    btn.parent().find('.selected').removeClass(\"selected\");\r\n                    btn.addClass(\"selected\");\r\n                });\r\n            }\r\n\r\n            /****************************************\r\n             -\tCONTEXT MENU EXTENSION    -\r\n             *****************************************/\r\n\r\n\r\n\r\n            /**\r\n             * Get's exact position of event.\r\n             *\r\n             * @param {Object} e The event passed in\r\n             * @return {Object} Returns the x and y position\r\n             */\r\n            function getPosition(e) {\r\n                var posx = 0;\r\n                var posy = 0;\r\n\r\n                if (!e) var e = window.event;\r\n\r\n                if (e.pageX || e.pageY) {\r\n                    posx = e.pageX;\r\n                    posy = e.pageY;\r\n                } else if (e.clientX || e.clientY) {\r\n                    posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n                    posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n                }\r\n\r\n                return {\r\n                    x: posx,\r\n                    y: posy\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * Initialise our application's code.\r\n             */\r\n            function _contextMenuinit() {\r\n\r\n                contextListener();\r\n                clickListener();\r\n                keyupListener();\r\n                resizeListener();\r\n            }\r\n\r\n            /**\r\n             * Listens for contextmenu events.\r\n             */\r\n            function contextListener() {\r\n                document.addEventListener( \"contextmenu\", function(e) {\r\n                    taskItemInContext = u.clickInsideElement( e, 'slide_layer');\r\n\r\n                    if (jQuery(taskItemInContext).hasClass(\"demo_layer\")) return;\r\n\r\n                    // CHECK FOR LAYER CONTEXT\r\n                    if ( taskItemInContext ) {\r\n                        u.setLayerSelected(jQuery(taskItemInContext).data('serial'));\r\n                        e.preventDefault();\r\n                        t.toggleMenuOn(\"layer\");\r\n                        positionMenu(e);\r\n                    } else {\r\n                        // CHECK FOR BG CONTEXT\r\n                        taskItemInContext = u.clickInsideElement( e, 'bg_context_listener');\r\n                        if (taskItemInContext) {\r\n                            e.preventDefault();\r\n                            t.toggleMenuOn(\"background\");\r\n                            positionMenu(e);\r\n                        } else {\r\n                            // CHECK FOR\r\n                            taskItemInContext = u.clickInsideElement( e, 'ignorecontextmenu');\r\n                            if (taskItemInContext) {\r\n                                e.preventDefault();\r\n                                t.toggleMenuOn();\r\n                                positionMenu(e);\r\n                            } else {\r\n                                taskItemInContext = null;\r\n                                t.toggleMenuOff();\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            /**\r\n             * Listens for click events.\r\n             */\r\n            function clickListener() {\r\n                jQuery('body').on('click',function(e) {\r\n                    var clickeElIsLink = u.clickInsideElement( e, contextMenuLinkClassName );\r\n\r\n                    if ( clickeElIsLink ) {\r\n                        e.preventDefault();\r\n                        menuItemListener( clickeElIsLink );\r\n                    } else {\r\n                        var button = e.which || e.button;\r\n\r\n                        if ( button === 1 ) {\r\n                            t.toggleMenuOff();\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            /**\r\n             * Listens for keyup events.\r\n             */\r\n            function keyupListener() {\r\n                window.onkeyup = function(e) {\r\n                    if ( e.keyCode === 27 ) {\r\n                        t.toggleMenuOff();\r\n                    }\r\n                }\r\n            }\r\n\r\n            /**\r\n             * Window resize event listener\r\n             */\r\n            function resizeListener() {\r\n                window.onresize = function(e) {\r\n                    t.toggleMenuOff();\r\n                };\r\n            }\r\n\r\n            function getLayerIcon(type) {\r\n                var c=\"rs-icon-layerimage_n\";\r\n                switch (type) {\r\n                    case \"image\":\r\n                        c='rs-icon-layerimage_n';\r\n                        break;\r\n                    case \"text\":\r\n                        c='rs-icon-layerfont_n';\r\n                        break;\r\n                    case \"button\":\r\n                        c='rs-icon-layerbutton_n';\r\n                        break;\r\n                    case \"audio\":\r\n                        c='rs-icon-layeraudio_n';\r\n                        break;\r\n                    case \"video\":\r\n                        c='rs-icon-layervideo_n';\r\n                        break;\r\n                    case \"svg\":\r\n                        c='rs-icon-layersvg_n';\r\n                        break;\r\n                    case \"row\":\r\n                        c='rs-icon-layergroup_n';\r\n                        break;\r\n                    case \"column\":\r\n                        c='rs-icon-layercolumn_n';\r\n                        break;\r\n                    case \"group\":\r\n                        c='rs-icon-layergroup_n';\r\n                        break;\r\n                }\r\n                return c;\r\n            }\r\n\r\n            function setCTXOnOff(v,cont) {\r\n                if (v)\r\n                    jQuery(cont).removeClass(\"ctx-td-s-off\")\r\n                else\r\n                    jQuery(cont).addClass(\"ctx-td-s-off\");\r\n            }\r\n\r\n            function showContextMebuForBackground() {\r\n                jQuery('.not_in_ctx_bg').hide();\r\n                jQuery('.not_in_ctx_layer').show();\r\n                // CREATE LIST OF LAYERS AND UNVISIBLE LAYERS\r\n                var avl = jQuery('#ctx_list_of_layers');\r\n                avl.html(\"\");\r\n                for (i in u.arrLayers) if (u.arrLayers.hasOwnProperty(i)) {\r\n                    var layer = u.arrLayers[i],\r\n                        licon = getLayerIcon(layer.type);\r\n\r\n                    avl.append('<li class=\"ctx-dyn-avl-list-item context-menu__item\" data-serial=\"'+layer.serial+'\"><div class=\"ctx_item_inner\"><div class=\"context-menu__link\" data-serial=\"'+layer.serial+'\" data-action=\"selectonelayer\"><i class=\"'+licon+'\"></i><span class=\"cx-layer-name\">'+layer.alias+'</span></div></div></li>');\r\n                }\r\n\r\n            }\r\n\r\n            function showContextMenuForSelectedLayer() {\r\n                var objLayer = u.getLayer(u.selectedLayerSerial),\r\n                    layer = objLayer.references.htmlLayer;\r\n\r\n                jQuery('.not_in_ctx_bg').show();\r\n                jQuery('.not_in_ctx_layer').hide();\r\n\r\n                // PREPARE MENU, ICON, ALIAS\r\n                jQuery('#cx-selected-layer-name').html(objLayer.alias);\r\n                var slic = jQuery('#cx-selected-layer-icon');\r\n                slic.attr('class',getLayerIcon(objLayer.type));\r\n\r\n                // PREPARE CONTEXT MENU VISIBILITY AND LOCK ICONS / TEXTS\r\n                var eye = jQuery('#cx-selected-layer-visible'),\r\n                    lock = jQuery('#cx-selected-layer-locked');\r\n                if(tl.isLayerVisible(layer)) {\r\n                    eye.find('i').attr('class','eg-icon-eye-off')\r\n                    eye.find('.cx-layer-name').html(\"Hide Layer\");\r\n                }\r\n                else {\r\n                    eye.find('i').attr('class','eg-icon-eye')\r\n                    eye.find('.cx-layer-name').html(\"Show Layer\");\r\n                }\r\n\r\n                if(!tl.isLayerLocked(layer)) {\r\n                    lock.find('i').attr('class','eg-icon-lock');\r\n                    lock.find('.cx-layer-name').html(\"Lock Layer\");\r\n                }\r\n                else {\r\n                    lock.find('i').attr('class','eg-icon-lock-open')\r\n                    lock.find('.cx-layer-name').html(\"Unlock Layer\");\r\n                }\r\n\r\n                // PREPARE CONTECT MENU UNVISIBLE ELEMENT LISTS\r\n                var inv = jQuery('#ctx_list_of_invisibles'),\r\n                    avl = jQuery('#ctx_list_of_layers'),\r\n                    first_invisible = true;\r\n\r\n                inv.find('.ctx-dyn-inv-list-item').remove();\r\n                avl.html(\"\");\r\n\r\n                // CREATE LIST OF LAYERS AND UNVISIBLE LAYERS\r\n                for (i in u.arrLayers) if (u.arrLayers.hasOwnProperty(i)) {\r\n                    var layer = u.arrLayers[i],\r\n                        licon = getLayerIcon(layer.type),\r\n                        htmll = layer.references!==undefined && layer.references.htmlLayer!==undefined ? layer.references.htmlLayer : undefined;\r\n\r\n                    if (htmll!==undefined && htmll.hasClass(\"currently_not_visible\")) {\r\n                        var clas_ext = first_invisible ? \"ctx-m-top-divider\" : \"\";\r\n                        first_invisible = false;\r\n                        inv.append('<li class=\"ctx-dyn-inv-list-item '+clas_ext+' context-menu__item\"><div class=\"ctx_item_inner\"><div class=\"context-menu__link\" data-serial=\"'+layer.serial+'\" data-action=\"showonelayer\"><i class=\"eg-icon-eye\"></i><span class=\"cx-layer-name\">'+layer.alias+'</span></div></div></li>')\r\n                    }\r\n                    avl.append('<li class=\"ctx-dyn-avl-list-item context-menu__item\" data-serial=\"'+layer.serial+'\"><div class=\"ctx_item_inner\"><div class=\"context-menu__link\" data-serial=\"'+layer.serial+'\" data-action=\"selectonelayer\"><i class=\"'+licon+'\"></i><span class=\"cx-layer-name\">'+layer.alias+'</span></div></div></li>');\r\n                }\r\n\r\n                // SET RESPONSIVNESS SETTINGS\r\n                if (objLayer.basealign===\"grid\") {\r\n                    jQuery('#ctx_gridbased').addClass(\"selected\");\r\n                    jQuery('#ctx_slidebased').removeClass(\"selected\");\r\n                } else {\r\n                    jQuery('#ctx_gridbased').removeClass(\"selected\");\r\n                    jQuery('#ctx_slidebased').addClass(\"selected\");\r\n                }\r\n\r\n                setCTXOnOff(objLayer['resize-full'],'#ctx_autoresponsive');\r\n                setCTXOnOff(objLayer.resizeme,'#ctx_childrenresponsive');\r\n                setCTXOnOff(objLayer.responsive_offset,'#ctx_responsiveoffset');\r\n\r\n\r\n                // SET VISIBILTY ON/OFF\r\n                setCTXOnOff(objLayer['visible-desktop'],'#ctx_showhideondesktop');\r\n                setCTXOnOff(objLayer['visible-notebook'],'#ctx_showhideonnotebook');\r\n                setCTXOnOff(objLayer['visible-tablet'],'#ctx_showhideontablet');\r\n                setCTXOnOff(objLayer['visible-mobile'],'#ctx_showhideonmobile');\r\n\r\n\r\n                // SET STYLE SETTINGS\r\n                setCTXOnOff(objLayer.autolinebreak,'#ctx_linebreak');\r\n                setCTXOnOff(objLayer.scaleProportional,'#ctx_keepaspect');\r\n\r\n                if (objLayer.displaymode || objLayer.display===\"block\") {\r\n                    jQuery('#ctx_displayblock').addClass(\"selected\");\r\n                    jQuery('#ctx_displayinline').removeClass(\"selected\");\r\n                } else {\r\n                    jQuery('#ctx_displayblock').removeClass(\"selected\");\r\n                    jQuery('#ctx_displayinline').addClass(\"selected\");\r\n                }\r\n\r\n                // SET LAYER LINK GROUP\r\n                jQuery('#ctx-list-of-layer-links').data('uniqueid',objLayer.unique_id);\r\n                var groupLink = objLayer.groupLink !==undefined ? objLayer.groupLink : 0,\r\n                    _csl = jQuery('#ctx-layer-link-type-element-cs');\r\n                for (var i=0;i<6;i++) {\r\n                    _csl.removeClass('ctx-layer-link-type-'+i);\r\n                }\r\n                _csl.addClass('ctx-layer-link-type-'+groupLink);\r\n\r\n                // SAVE THE CURRENT LAYER IN SOME DATA CONTAINER\r\n                jQuery(_ctxmenu).data('current_layer',htmll);\r\n\r\n\r\n                // SET ELEMENTS VISIBLE / HIDDEN BASED ON LAYER TYPE AND MAIN CLASS\r\n                var incolumn = u.getObjLayerType(objLayer.p_uid)===\"column\";\r\n                _ctxmenu.className=\"context-menu layer_type_\"+objLayer.type+\" in_column_\"+incolumn;\r\n\r\n                // HIDE INHERIT FROM DEVICE SIZES WHICH ARE NOT AVAILABLE\r\n                jQuery('#ctx-inheritdesktop').show();\r\n                jQuery('#ctx-inheritnotebook').show();\r\n                jQuery('#ctx-inherittablet').show();\r\n                jQuery('#ctx-inheritmobile').show();\r\n                switch (u.getLayout()) {\r\n                    case \"desktop\":\r\n                        jQuery('#ctx-inheritdesktop').hide();\r\n                        break;\r\n                    case \"notebook\":\r\n                        jQuery('#ctx-inheritnotebook').hide();\r\n                        break;\r\n                    case \"tablet\":\r\n                        jQuery('#ctx-inherittablet').hide();\r\n                        break;\r\n                    case \"mobile\":\r\n                        jQuery('#ctx-inheritmobile').hide();\r\n                        break;\r\n                }\r\n            }\r\n\r\n            function showContextMenuWithoutSelectedLayer() {\r\n\r\n            }\r\n\r\n            /**\r\n             * Turns the custom context menu on.\r\n             */\r\n            t.toggleMenuOn = function(type) {\r\n\r\n                punchgs.TweenLite.fromTo(_ctxmenu,0.2,{x:10,autoAlpha:0},{x:0,autoAlpha:1,display:\"block\",ease:punchgs.Power2.easeInOut,delay:0.2});\r\n                //punchgs.TweenLite.to(jQuery('#context_menu_underlay'),0.2,{autoAlpha:1,delay:0.2});\r\n                if ( _ctxmenuState !== 1 ) {\r\n                    _ctxmenuState = 1;\r\n                }\r\n\r\n                if (type===\"layer\") {\r\n                    // LAYER SELECTED OR NOT ?\r\n                    if (u.selectedLayerSerial!=-1)\r\n                        showContextMenuForSelectedLayer();\r\n                    else\r\n                        showContextMenuWithoutSelectedLayer();\r\n                } else\r\n                if (type===\"background\") {\r\n                    showContextMebuForBackground();\r\n                }\r\n\r\n\r\n            }\r\n\r\n            /**\r\n             * Turns the custom context menu off.\r\n             */\r\n            t.toggleMenuOff = function() {\r\n                if ( _ctxmenuState !== 0 ) {\r\n                    _ctxmenuState = 0;\r\n                    punchgs.TweenLite.to(_ctxmenu,0.2,{y:25,autoAlpha:0});\r\n                    //  punchgs.TweenLite.to(jQuery('#context_menu_underlay'),0.2,{autoAlpha:0});\r\n\r\n                }\r\n            }\r\n\r\n            /**\r\n             * Positions the menu properly.\r\n             *\r\n             * @param {Object} e The event\r\n             */\r\n            function positionMenu(e) {\r\n                clickCoords = getPosition(e);\r\n                clickCoordsX = clickCoords.x;\r\n                clickCoordsY = clickCoords.y;\r\n\r\n\r\n                var of = jQuery('#viewWrapper').offset(),\r\n                    dof = jQuery('#divbgholder').offset(),\r\n                    so = jQuery(window).scrollTop();\r\n\r\n\r\n                _ctxmenuWidth = _ctxmenu.offsetWidth + 4;\r\n                _ctxmenuHeight = _ctxmenu.offsetHeight + 4;\r\n\r\n                _ctxwindowWidth = window.innerWidth;\r\n                _ctxwindowHeight = window.innerHeight;\r\n\r\n                var cvt = so,\r\n                    cvb = so+_ctxwindowHeight;\r\n\r\n                var newl = (15+clickCoordsX - of.left),\r\n                    newt = (clickCoordsY-(of.top+25));\r\n\r\n                clickCoords.x = clickCoordsX -dof.left;\r\n                clickCoords.y = clickCoordsY - dof.top;\r\n\r\n                newl = newl+250>_ctxwindowWidth-of.left ? _ctxwindowWidth-(260+of.left) : newl;\r\n                newt = (newt+300+of.top)>cvb ? cvb - 300-of.top :  newt;\r\n\r\n\r\n                _ctxmenu.style.left = newl+\"px\";\r\n                _ctxmenu.style.top = newt+\"px\";\r\n\r\n\r\n\r\n                if (newl>_ctxwindowWidth-(of.left+500))\r\n                    jQuery('#context-menu-first-ul').addClass(\"submenustoleft\");\r\n                else\r\n                    jQuery('#context-menu-first-ul').removeClass(\"submenustoleft\");\r\n\r\n                if (newt+300+of.top+200 > cvb)\r\n                    jQuery('#context-menu-first-ul').addClass(\"submenustobottom\");\r\n                else\r\n                    jQuery('#context-menu-first-ul').removeClass(\"submenustobottom\");\r\n\r\n\r\n\r\n            }\r\n\r\n            function switchOnOff(link) {\r\n                if (jQuery(link).hasClass(\"ctx-td-s-off\"))\r\n                    return false;\r\n\r\n                else\r\n                    return true;\r\n\r\n            }\r\n\r\n            /**\r\n             * Dummy action function that logs an action when a menu item link is clicked\r\n             *\r\n             * @param {HTMLElement} link The link that was clicked\r\n             */\r\n            function menuItemListener( link ) {\r\n                var hideAfterAction = true,\r\n                    objUpdate = {},\r\n                    htmlLayer,\r\n                    updateLayerForm = false,\r\n                    rebuild = false;\r\n\r\n                if (link.getAttribute(\"data-action\")===\"delegate\") {\r\n                    jQuery(document.getElementById(link.getAttribute(\"data-delegate\"))).click();\r\n                    return;\r\n                }\r\n\r\n                switch (link.getAttribute(\"data-action\")) {\r\n                    case \"delete\":\r\n                        jQuery('#button_delete_layer').click();\r\n                        break;\r\n                    case \"duplicate\":\r\n                        jQuery('#button_duplicate_layer').click();\r\n                        break;\r\n                    case \"showhide\":\r\n                        jQuery('#layer-short-toolbar .quick-layer-view').click();\r\n                        break;\r\n                    case \"lockunlock\":\r\n                        jQuery('#layer-short-toolbar .quick-layer-lock').click();\r\n                        break;\r\n                    case \"showalllayer\":\r\n                        u.showAllLayers();\r\n                        break;\r\n                    case \"showonlycurrent\":\r\n                        u.hideAllLayers(u.selectedLayerSerial);\r\n                        break;\r\n                    case \"showonelayer\":\r\n                        var obj = u.getLayer(jQuery(link).data('serial'));\r\n                        tl.showLayer(obj);\r\n                        break;\r\n                    case \"selectonelayer\":\r\n                        u.setLayerSelected(jQuery(link).data('serial'));\r\n                        break;\r\n                    case \"autoresponsive\":\r\n                        hideAfterAction = false;\r\n                        objUpdate['resize-full'] = switchOnOff(link);\r\n                        if (!objUpdate['resize-full']) {\r\n                            objUpdate.resizeme=false;\r\n                            jQuery('#ctx_childrenresponsive').addClass(\"ctx-td-s-off\");\r\n                        }\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"childrenresponsive\":\r\n                        hideAfterAction = false;\r\n                        objUpdate.resizeme = switchOnOff(link);\r\n                        if (objUpdate.resizeme) {\r\n                            objUpdate['resize-full'] = true;\r\n                            jQuery('#ctx_autoresponsive').removeClass(\"ctx-td-s-off\");\r\n                        }\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"responsiveoffset\":\r\n                        hideAfterAction = false;\r\n                        objUpdate.responsive_offset = switchOnOff(link);\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"gridbased\":\r\n                        hideAfterAction = false;\r\n\r\n                        objUpdate.basealign = \"grid\";\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"slidebased\":\r\n                        hideAfterAction = false;\r\n\r\n                        objUpdate.basealign = \"slide\";\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"nothing\":\r\n                        hideAfterAction = false;\r\n                        break;\r\n\r\n                    case \"linebreak\":\r\n                        hideAfterAction = false;\r\n                        if (jQuery(\"#layer_auto_line_break\")[0].checked)\r\n                            jQuery(\"#layer_auto_line_break\")[0].checked = false;\r\n                        else\r\n                            jQuery(\"#layer_auto_line_break\")[0].checked = true;\r\n                        u.clickOnAutoLineBreak();\r\n                        break;\r\n\r\n                    case \"displayblock\":\r\n                        hideAfterAction = false;\r\n                        objUpdate.displaymode = true;\r\n                        objUpdate.display=\"block\";\r\n                        updateLayerForm = true;\r\n                        htmlLayer = jQuery(_ctxmenu).data('current_layer');\r\n                        rebuild = true;\r\n                        break;\r\n\r\n                    case \"displayinline\":\r\n                        hideAfterAction = false;\r\n                        objUpdate.displaymode = false;\r\n                        objUpdate.display=\"inline-block\";\r\n                        updateLayerForm = true;\r\n                        htmlLayer = jQuery(_ctxmenu).data('current_layer');\r\n                        rebuild = true;\r\n                        break;\r\n\r\n                    case \"advancedcss\":\r\n                        jQuery('#advanced-css-layer').click();\r\n                        break;\r\n\r\n                    case \"resetsize\":\r\n                        jQuery('#reset-scale').click();\r\n                        break;\r\n\r\n                    case \"aspectratio\":\r\n                        hideAfterAction = false;\r\n                        if (jQuery('#layer_proportional_scale')[0].checked) {\r\n                            jQuery('#layer_proportional_scale')[0].checked = false;\r\n                            jQuery('#ctx_keepaspect').addClass(\"ctx-td-s-off\");\r\n                        }\r\n                        else {\r\n                            jQuery('#layer_proportional_scale')[0].checked = true;\r\n                            jQuery('#ctx_keepaspect').removeClass(\"ctx-td-s-off\");\r\n                        }\r\n                        objUpdate.scaleProportional = jQuery('#layer_proportional_scale')[0].checked;\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"copystyle\":\r\n                        hideAfterAction = false;\r\n                        var objLayer = u.getLayer(u.selectedLayerSerial);\r\n                        t.stylecache = UniteAdminRev.duplicateObject(objLayer);\r\n                        UniteAdminRev.showInfo({type:\"success\",content:\"Layer Style Successfull Copied to Clipboard\",hidedelay:3});\r\n                        break;\r\n                    case \"pastestyle\":\r\n                        hideAfterAction = false;\r\n                        var objLayer = u.getLayer(u.selectedLayerSerial);\r\n\r\n                        if (jQuery.isEmptyObject(t.stylecache)===false) {\r\n                            objUpdate.deformation = t.stylecache.deformation;\r\n                            objUpdate[\"deformation-hover\"] = t.stylecache[\"deformation-hover\"];\r\n                            objUpdate.display = t.stylecache.display;\r\n                            objUpdate.displaymode = t.stylecache.displaymode;\r\n                            objUpdate.margin = t.stylecache.margin;\r\n                            objUpdate.autolinebreak = t.stylecache.autolinebreak;\r\n                            objUpdate.padding = t.stylecache.padding;\r\n                            objUpdate.whitespace = t.stylecache.whitespace;\r\n                            objUpdate.static_styles = t.stylecache.static_styles;\r\n                            objUpdate[\"2d_rotation\"] = t.stylecache[\"2d_rotation\"];\r\n                            objUpdate[\"image-size\"] = t.stylecache[\"image-size\"];\r\n                            updateLayerForm = true;\r\n                            htmlLayer = objLayer.references.htmlLayer;\r\n                            rebuild = true;\r\n                        } else {\r\n                            UniteAdminRev.showInfo({type:\"warning\",content:\"No Style saved to Clipboard\",hidedelay:3});\r\n                        }\r\n                        break;\r\n\r\n                    case \"inheritfromdesktop\":\r\n                    case \"inheritfromnotebook\":\r\n                    case \"inheritfromtablet\":\r\n                    case \"inheritfrommobile\":\r\n                        var objLayer = u.getLayer(u.selectedLayerSerial),\r\n                            size = link.getAttribute(\"data-size\"),\r\n                            objUpdate = {};\r\n                        objUpdate.static_styles = {};\r\n                        objUpdate.static_styles[\"color\"]={};\r\n                        objUpdate.static_styles[\"font-size\"]={};\r\n                        objUpdate.static_styles[\"line-height\"]={};\r\n                        objUpdate.static_styles[\"font-weight\"]={};\r\n                        objUpdate.padding = {};\r\n                        objUpdate.margin = {};\r\n                        objUpdate.max_height = {};\r\n                        objUpdate.max_width = {};\r\n                        objUpdate.scaleX = {};\r\n                        objUpdate.scaleY = {};\r\n                        objUpdate[\"text-align\"] = {};\r\n                        objUpdate.vieo_width = {};\r\n                        objUpdate.video_height = {};\r\n                        objUpdate.whitespace = {};\r\n\r\n\r\n                        objUpdate.static_styles = u.setVal(objUpdate[\"static_styles\"],\"color\",u.getVal(objLayer[\"static_styles\"], \"color\",size), false);\r\n                        objUpdate.static_styles = u.setVal(objUpdate[\"static_styles\"],\"font-size\",u.getVal(objLayer[\"static_styles\"], \"font-size\",size), false);\r\n                        objUpdate.static_styles = u.setVal(objUpdate[\"static_styles\"],\"line-height\",u.getVal(objLayer[\"static_styles\"], \"line-height\",size), false);\r\n                        objUpdate.static_styles = u.setVal(objUpdate[\"static_styles\"],\"font-weight\",u.getVal(objLayer[\"static_styles\"], \"font-weight\",size), false);\r\n\r\n                        objUpdate = u.setVal(objUpdate,\"padding\",u.getVal(objLayer, \"padding\",size), false);\r\n                        objUpdate = u.setVal(objUpdate,\"margin\",u.getVal(objLayer, \"margin\",size), false);\r\n                        objUpdate = u.setVal(objUpdate,\"max_height\",u.getVal(objLayer, \"max_height\",size), false);\r\n                        objUpdate = u.setVal(objUpdate,\"max_width\",u.getVal(objLayer, \"max_width\",size), false);\r\n                        objUpdate = u.setVal(objUpdate,\"scaleX\",u.getVal(objLayer, \"scaleX\",size), false);\r\n                        objUpdate = u.setVal(objUpdate,\"scaleY\",u.getVal(objLayer, \"scaleY\",size), false);\r\n                        objUpdate = u.setVal(objUpdate,\"text-align\",u.getVal(objLayer, \"text-align\",size), false);\r\n                        objUpdate = u.setVal(objUpdate,\"vieo_width\",u.getVal(objLayer, \"vieo_width\",size), false);\r\n                        objUpdate = u.setVal(objUpdate,\"video_height\",u.getVal(objLayer, \"video_height\",size), false);\r\n                        objUpdate = u.setVal(objUpdate,\"whitespace\",u.getVal(objLayer, \"whitespace\",size), false);\r\n\r\n\r\n                        updateLayerForm = true;\r\n                        htmlLayer = objLayer.references.htmlLayer;\r\n                        rebuild = true;\r\n                        break;\r\n\r\n                    case \"showhideondesktop\":\r\n                        hideAfterAction = false;\r\n                        objUpdate['visible-desktop'] = switchOnOff(link);\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"showhideonnotebook\":\r\n                        hideAfterAction = false;\r\n                        objUpdate['visible-notebook'] = switchOnOff(link);\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"showhideontablet\":\r\n                        hideAfterAction = false;\r\n                        objUpdate['visible-tablet'] = switchOnOff(link);\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"showhideonmobile\":\r\n                        hideAfterAction = false;\r\n                        objUpdate['visible-mobile'] = switchOnOff(link);\r\n                        updateLayerForm = true;\r\n                        break;\r\n                    case \"grouplinkchange\":\r\n                        hideAfterAction = false;\r\n                        objUpdate.groupLink = link.getAttribute(\"data-linktype\");\r\n                        var objLayer = u.getLayer(u.selectedLayerSerial),\r\n                            _sl = objLayer.references.sorttable.layer.find('.layer-link-type-element-cs').first(),\r\n                            _csl = jQuery('#ctx-layer-link-type-element-cs');\r\n                        for (var i=0;i<6;i++) {\r\n                            _sl.removeClass('layer-link-type-'+i);\r\n                            _csl.removeClass('ctx-layer-link-type-'+i);\r\n                        }\r\n                        _sl.addClass('layer-link-type-'+objUpdate.groupLink);\r\n                        _csl.addClass('ctx-layer-link-type-'+objUpdate.groupLink);\r\n\r\n                        break;\r\n                    case \"addtextlayer\":\r\n                        u.nextNewLayerToPosition(clickCoords);\r\n                        jQuery('#button_add_layer').click();\r\n                        break;\r\n                    case \"addimagelayer\":\r\n                        u.nextNewLayerToPosition(clickCoords);\r\n                        jQuery('#button_add_layer_image').click();\r\n                        break;\r\n                    case \"addaudiolayer\":\r\n                        u.nextNewLayerToPosition(clickCoords);\r\n                        jQuery('#button_add_layer_audio').click();\r\n                        break;\r\n                    case \"addvideolayer\":\r\n                        u.nextNewLayerToPosition(clickCoords);\r\n                        jQuery('#button_add_layer_video').click();\r\n                        break;\r\n                    case \"addbuttonlayer\":\r\n                        u.nextNewLayerToPosition(clickCoords);\r\n                        jQuery('#button_add_layer_button').click();\r\n                        break;\r\n                    case \"addshapelayer\":\r\n                        u.nextNewLayerToPosition(clickCoords);\r\n                        jQuery('#button_add_layer_shape').click();\r\n                        break;\r\n                    case \"addobjectlayer\":\r\n                        u.nextNewLayerToPosition(clickCoords);\r\n                        jQuery('#button_add_layer_svg').click();\r\n                        break;\r\n\r\n\r\n\r\n                }\r\n\r\n                if (jQuery.isEmptyObject(objUpdate)===false)\r\n                    u.updateLayer(u.selectedLayerSerial, objUpdate);\r\n\r\n                if (updateLayerForm)\r\n                    u.updateLayerFormFields(u.selectedLayerSerial);\r\n\r\n                if (rebuild)\r\n                    tl.rebuildLayerIdle(htmlLayer);\r\n\r\n                //console.log( \"Task ID - \" + taskItemInContext.getAttribute(\"data-id\") + \", Task action - \" + link.getAttribute(\"data-action\"));\r\n                if (hideAfterAction) t.toggleMenuOff();\r\n            }\r\n\r\n        }\r\n\r\n        return tpLayerContextMenu;\r\n    }\r\n);","Nwdthemes_Revslider/admin/assets/js/source/settings.js":"define(\r\n    'settings',\r\n    ['jquery', 'tipsy', 'themepunchTools'],\r\n    function(jQuery, Tipsy, punchgs) {\r\n\r\n        var RevSliderSettings = new function () {\r\n\r\n            var arrControls = {};\r\n            var colorPicker;\r\n\r\n            var t = this;\r\n\r\n            this.getSettingsObject = function (formID) {\r\n                var obj = new Object();\r\n                var form = document.getElementById(formID);\r\n                var name, value, type, flagUpdate;\r\n\r\n                //enabling all form items connected to mx\r\n                var len = form.elements.length;\r\n                for (var i = 0; i < len; i++) {\r\n                    var element = form.elements[i];\r\n\r\n                    if (element.name == \"##NAME##[]\") continue; //ignore dummy from multi text\r\n                    if (jQuery(element).hasClass(\"rs-ingore-save\")) continue; //ignore some fields that do not need to be saved\r\n\r\n                    name = element.name;\r\n                    value = element.value;\r\n\r\n                    type = element.type;\r\n                    if (jQuery(element).hasClass(\"wp-editor-area\"))\r\n                        type = \"editor\";\r\n\r\n                    flagUpdate = true;\r\n\r\n                    switch (type) {\r\n                        case \"checkbox\":\r\n                            if (typeof(form.elements[i].getAttribute('data-useval')) !== 'undefined' && form.elements[i].getAttribute('data-useval') !== null) {\r\n                                if (form.elements[i].checked) {\r\n                                    value = form.elements[i].value;\r\n                                } else {\r\n                                    continue;\r\n                                }\r\n                                ;\r\n                            } else if (typeof(form.elements[i].getAttribute('data-unchecked')) !== 'undefined' && form.elements[i].getAttribute('data-unchecked') !== null) {\r\n                                value = (form.elements[i].checked) ? value : form.elements[i].getAttribute('data-unchecked');\r\n                            } else {\r\n                                value = form.elements[i].checked;\r\n                            }\r\n                            break;\r\n                        case \"radio\":\r\n                            if (form.elements[i].checked == false)\r\n                                flagUpdate = false;\r\n                            break;\r\n                        case \"editor\":\r\n                            if (typeof(tiynMCE) !== 'undefined' && tinyMCE.get(name) != null) {\r\n                                value = tinyMCE.get(name).getContent();\r\n                            }\r\n                            break;\r\n                        case \"select-multiple\":\r\n                            value = jQuery(element).val();\r\n                            if (value)\r\n                                value = value.toString();\r\n                            break;\r\n                    }\r\n\r\n                    if (flagUpdate == true && name != undefined) {\r\n                        if (name.indexOf('[]') > -1) {\r\n                            name = name.replace('[]', '');\r\n                            if (typeof obj[name] !== 'object') obj[name] = [];\r\n\r\n                            obj[name][Object.keys(obj[name]).length] = value;\r\n                        } else {\r\n                            obj[name] = value;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return (obj);\r\n            }\r\n\r\n\r\n            /**\r\n             * combine controls to one object, and init control events.\r\n             * OBSOLETE?\r\n             */\r\n            var initControls = function () {\r\n\r\n                //combine controls\r\n                if (typeof g_settingsObj !== 'undefined') {\r\n                    for (key in g_settingsObj) if (g_settingsObj.hasOwnProperty(key)) {\r\n                        var obj = g_settingsObj[key];\r\n\r\n                        for (controlKey in obj.controls) if (obj.controls.hasOwnProperty(controlKey)) {\r\n                            arrControls[controlKey] = obj.controls[controlKey];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * close all accordion items\r\n             */\r\n            var closeAllAccordionItems = function (formID) {\r\n                jQuery(\"#\" + formID + \" .unite-postbox .inside\").slideUp(\"fast\");\r\n                jQuery(\"#\" + formID + \" .unite-postbox h3\").addClass(\"box_closed\");\r\n            }\r\n\r\n            /**\r\n             * init side settings accordion - started from php\r\n             */\r\n            t.initAccordion = function (formID) {\r\n                var classClosed = \"box_closed\";\r\n                jQuery(\"#\" + formID + \" .unite-postbox h3\").click(function () {\r\n                    var handle = jQuery(this);\r\n\r\n                    //open\r\n                    if (handle.hasClass(classClosed)) {\r\n                        closeAllAccordionItems(formID);\r\n                        handle.removeClass(classClosed).siblings(\".inside\").slideDown(\"fast\");\r\n                    } else {\t//close\r\n                        handle.addClass(classClosed).siblings(\".inside\").slideUp(\"fast\");\r\n                    }\r\n\r\n                });\r\n            }\r\n\r\n            /**\r\n             * image search\r\n             */\r\n            var initImageSearch = function () {\r\n\r\n                jQuery(\".button-image-select\").click(function () {\r\n                    var settingID = this.id.replace(\"_button\", \"\");\r\n                    require(['admin'], function(UniteAdminRev) {\r\n                        UniteAdminRev.openAddImageDialog(\"Choose Image\", function (urlImage, imageID) {\r\n                            //update input:\r\n                            jQuery(\"#\" + settingID).val(urlImage);\r\n\r\n                            //update preview image:\r\n                            var urlShowImage = UniteAdminRev.getUrlShowImage(imageID, 100, 70, true);\r\n                            jQuery(\"#\" + settingID + \"_button_preview\").html('<div style=\"width:100px;height:70px;background:url(\\'' + urlShowImage + '\\'); background-position:center center; background-size:cover;\"></div>');\r\n                            jQuery('.show_on_thumbnail_exist').show();\r\n                            // Use Admin Thumbnail if Selected\r\n                            if (jQuery('#thumb_for_admin').prop('checked') == \"checked\") {\r\n                                var tbgimg = jQuery('#slide_thumb_button_preview div').css(\"background-image\");\r\n                                jQuery('#slide_selector .list_slide_links li.selected .slide-media-container').css({\r\n                                    \"background-image\": tbgimg,\r\n                                    backgroundSize: \"cover\",\r\n                                    backgroundPosition: \"center center\"\r\n                                });\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n\r\n                jQuery(\".button-image-remove\").click(function () {\r\n                    var settingID = this.id.replace(\"_button_remove\", \"\");\r\n                    jQuery(\"#\" + settingID).val('');\r\n\r\n                    jQuery(\"#\" + settingID + \"_button_preview\").html('');\r\n                    jQuery('.show_on_thumbnail_exist').hide();\r\n                });\r\n\r\n                jQuery(\".button-image-select-video\").click(function () {\r\n                    require(['admin'], function(UniteAdminRev) {\r\n                        UniteAdminRev.openAddImageDialog(\"Choose Image\", function (urlImage, imageID) {\r\n\r\n                            //update input:\r\n                            jQuery(\"#input_video_preview\").val(urlImage);\r\n\r\n                            //update preview image:\r\n                            var urlShowImage = UniteAdminRev.getUrlShowImage(imageID, 200, 150, true);\r\n                            jQuery(\"#video-thumbnail-preview\").css({backgroundImage: 'url(' + urlShowImage + ')'});\r\n\r\n                        });\r\n                    });\r\n                });\r\n\r\n                jQuery(\".button-image-remove-video\").click(function () {\r\n                    jQuery(\"#input_video_preview\").val('');\r\n\r\n                    if (jQuery('#video_block_vimeo').css('display') != 'none')\r\n                        jQuery(\"#button_vimeo_search\").trigger(\"click\");\r\n\r\n                    if (jQuery('#video_block_youtube').css('display') != 'none')\r\n                        jQuery(\"#button_youtube_search\").trigger(\"click\");\r\n\r\n                });\r\n\r\n\r\n                jQuery(\".button-image-select-html5-video\").click(function () {\r\n                    jQuery('.ui-dialog.ui-widget,.ui-widget-overlay').hide();\r\n                    require(['admin'], function(UniteAdminRev) {\r\n                        UniteAdminRev.openAddImageDialog(\"Choose Image\", function (urlImage, imageID) {\r\n                            jQuery('.ui-dialog.ui-widget,.ui-widget-overlay').show();\r\n                            //update input:\r\n                            jQuery(\"#html5_url_poster\").val(urlImage);\r\n                        });\r\n                    });\r\n                });\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * init the settings function, set the tootips on sidebars.\r\n             */\r\n            var init = function () {\r\n\r\n                //init tipsy\r\n                jQuery(\".list_settings li .setting_text\").tipsy({\r\n                    gravity: \"e\",\r\n                    delayIn: 70\r\n                });\r\n\r\n                jQuery(\".tipsy_enabled_top\").tipsy({\r\n                    gravity: \"s\",\r\n                    delayIn: 70\r\n                });\r\n\r\n                jQuery(\".tipsy_enabled_top_left\").tipsy({\r\n                    gravity: \"se\",\r\n                    delayIn: 70\r\n                });\r\n\r\n                jQuery(\".button-primary\").tipsy({\r\n                    gravity: \"s\",\r\n                    delayIn: 70\r\n                });\r\n\r\n                jQuery('input[type=\"checkbox\"]').change(function () {\r\n                    RevSliderSettings.onoffStatus(jQuery(this));\r\n                });\r\n\r\n                //init controls\r\n                initControls();\r\n\r\n                initImageSearch();\r\n\r\n                /****\r\n                 * PREVIEW SLIDE/SLIDER SCRIPT\r\n                 ****/\r\n\r\n                jQuery('body').on('click', '.rs-close-preview', function () {\r\n                    var rs_form = jQuery('#rs-preview-form');\r\n                    rs_form.action = g_urlAjaxActions;\r\n                    jQuery(\"#preview-slide-data\").val(\"empty_output\");\r\n                    jQuery(\"#preview_sliderid\").val(\"empty_output\");\r\n\r\n                    jQuery('#rs-preview-wrapper').hide();\r\n\r\n                    rs_form.submit();\r\n                });\r\n\r\n                jQuery(document).keyup(function (e) {\r\n                    if (e.keyCode == 27) jQuery('.rs-close-preview').click(); // 27 == esc\r\n                });\r\n\r\n                jQuery(window).resize(function () {\r\n                    jQuery('.rs-preview-width').text(jQuery('.rs-frame-preview-wrapper').width());\r\n                    jQuery('.rs-preview-height').text(jQuery('.rs-frame-preview-wrapper').height());\r\n                });\r\n\r\n            }\r\n\r\n\r\n            t.createModernOnOff = function () {\r\n                // CREATE AND HANLDE OF SINGLE INPUT BOXES BASED ON CHECKBOX\r\n                jQuery(\".tp-moderncheckbox\").each(function () {\r\n                    var inp = jQuery(this);\r\n                    inp.wrap('<div class=\"tp-onoffbutton\"><span class=\"tp-onoff-onstate\">On</span><span class=\"tp-onoff-offstate\">Off</span></div>');\r\n                    inp.change(function () {\r\n                        var inp = jQuery(this);\r\n                        if (!inp.hasClass(\"changedbyclick\"))\r\n                            t.onoffStatus(inp)\r\n                    });\r\n                });\r\n\r\n                // CREATE AND HANDLE OF INPUT BOXES BASED ON TWO INPUT BOXES WITH VALUE ON AND OFF\r\n                jQuery(\".tp-modernonoffboxes\").each(function () {\r\n                    var inp = jQuery(this);\r\n                    inp.wrap('<div class=\"tp-onoffbutton tp-onoffbasedontwo\"><span class=\"tp-onoff-onstate\">On</span><span class=\"tp-onoff-offstate\">Off</span></div>');\r\n                    var inpon = inp.find('input[value=\"on\"]'),\r\n                        inpoff = inp.find('input[value=\"off\"]');\r\n                    inpon.change(function () {\r\n                        if (!inpon.hasClass(\"changedbyclick\"))\r\n                            t.onoffStatusBasedOnTwo(inpon, inpoff);\r\n                    })\r\n                    inpoff.change(function () {\r\n                        if (!inpon.hasClass(\"changedbyclick\"))\r\n                            t.onoffStatusBasedOnTwo(inpon, inpoff);\r\n                    })\r\n                    t.onoffStatusBasedOnTwo(inpon, inpoff);\r\n                });\r\n\r\n                jQuery('.tp-onoffbutton').each(function () {\r\n                    var cb = jQuery(this);\r\n                    cb.click(function () {\r\n                        var cb = jQuery(this);\r\n                        if (cb.hasClass(\"tp-onoffbasedontwo\")) {\r\n                            var inpon = cb.find('input[value=\"on\"]'),\r\n                                inpoff = cb.find('input[value=\"off\"]');\r\n                            inpon.addClass(\"changedbyclick\");\r\n                            setTimeout(function () {\r\n                                inpon.removeClass(\"changedbyclick\");\r\n                            }, 200);\r\n                            if (inpon.prop('checked') === undefined || inpon.prop('checked') == false || inpon.prop(\"checked\") == \"\") {\r\n                                inpon.attr('checked', \"checked\");\r\n                                inpoff.attr('checked', false);\r\n                            }\r\n                            else {\r\n                                inpon.attr('checked', false);\r\n                                inpoff.attr('checked', \"checked\");\r\n                            }\r\n                            inpon.trigger(\"change\");\r\n                            inpoff.trigger(\"change\");\r\n                            t.onoffStatusBasedOnTwo(inpon, inpoff);\r\n                        } else {\r\n                            inp = cb.find('input');\r\n                            inp.addClass(\"changedbyclick\");\r\n                            setTimeout(function () {\r\n                                inp.removeClass(\"changedbyclick\");\r\n                            }, 200);\r\n                            if (inp.prop('checked') === undefined || inp.prop('checked') == false || inp.prop(\"checked\") == \"\")\r\n                                inp.attr('checked', \"checked\");\r\n                            else\r\n                                inp.attr('checked', false);\r\n\r\n                            inp.trigger(\"change\");\r\n                            t.onoffStatus(inp);\r\n                        }\r\n                    });\r\n                });\r\n\r\n\r\n            }\r\n\r\n            t.onoffStatus = function (inp) {\r\n                var cb = inp.closest('.tp-onoffbutton'),\r\n                    con = cb.find('.tp-onoff-onstate'),\r\n                    coff = cb.find('.tp-onoff-offstate');\r\n\r\n                if (inp.prop('checked') === undefined || inp.prop('checked') == false || inp.prop(\"checked\") == \"\") {\r\n                    punchgs.TweenLite.to(con, 0.2, {left: \"50px\"});\r\n                    punchgs.TweenLite.to(coff, 0.2, {left: \"0px\"});\r\n                } else {\r\n                    punchgs.TweenLite.to(con, 0.2, {left: \"0px\"});\r\n                    punchgs.TweenLite.to(coff, 0.2, {left: \"-50px\"});\r\n                }\r\n            }\r\n\r\n            t.onoffStatusBasedOnTwo = function (inpon, inpoff) {\r\n                var cb = inpon.closest('.tp-onoffbutton'),\r\n                    con = cb.find('.tp-onoff-onstate'),\r\n                    coff = cb.find('.tp-onoff-offstate');\r\n\r\n                if (inpon.prop('checked') === undefined || inpon.prop('checked') == false || inpon.prop(\"checked\") == \"\") {\r\n                    punchgs.TweenLite.to(con, 0.2, {left: \"50px\"});\r\n                    punchgs.TweenLite.to(coff, 0.2, {left: \"0px\"});\r\n                } else {\r\n                    punchgs.TweenLite.to(con, 0.2, {left: \"0px\"});\r\n                    punchgs.TweenLite.to(coff, 0.2, {left: \"-50px\"});\r\n                }\r\n            }\r\n\r\n\r\n            //call \"constructor\"\r\n            jQuery(document).ready(function () {\r\n                init();\r\n            });\r\n\r\n        } // UniteSettings class end\r\n\r\n        return RevSliderSettings;\r\n    }\r\n);","Nwdthemes_Revslider/admin/assets/js/source/css_editor.js":"define(\r\n    'cssEditor',\r\n    ['jquery', 'rsCodeMirror', 'admin'],\r\n    function(jQuery, CodeMirror, UniteAdminRev) {\r\n\r\n        var UniteCssEditorRev = new function(){\r\n\r\n            var t = this;\r\n            var initCssStyles = [];\r\n            var cssPreClass = '.tp-caption';\r\n            var cssCurrentType = 'params';\r\n            var curActiveStyles = new Object;\r\n            var curFullClass = new Object;\r\n            var isHoverActive = false;\r\n\r\n            var g_codemirrorCssUneditable = null;\r\n            var g_codemirrorCssEditable = null;\r\n            var g_codemirrorCssLayer = null;\r\n            var common_styles = {\r\n                'background-color': 'backgroundColor', //rgb rgba and opacity\r\n                'border-color': 'borderColor',\r\n                'border-radius': 'borderRadius',\r\n                'border-style': 'borderStyle',\r\n                'border-width': 'borderWidth',\r\n                'color': 'color',\r\n                'font-family': 'fontFamily',\r\n                'font-size': 'fontSize',\r\n                'font-style': 'fontStyle',\r\n                'font-weight': 'fontWeight',\r\n                'line-height': 'lineHeight',\r\n                'opacity': 'opacity',\r\n                'padding': 'padding',\r\n                'text-decoration': 'textDecoration'\r\n            };\r\n            var cur_editing = 'idle';\r\n            var opened = 'idle';\r\n\r\n            //======================================================\r\n            //\tInit Functions\r\n            //======================================================\r\n\r\n            /**\r\n             * set init css styles array\r\n             */\r\n            t.setInitCssStyles = function(jsonClasses){\r\n                initCssStyles = jQuery.parseJSON(jsonClasses);\r\n            }\r\n\r\n            /**\r\n             * set init css styles array\r\n             */\r\n            t.setInitCssStylesObj = function(finalobject){\r\n                initCssStyles = finalobject;\r\n            }\r\n\r\n\r\n            /**\r\n             * init the css editor\r\n             */\r\n            t.init = function(UniteLayersRev, tpLayerTimelinesRev){\r\n\r\n                t.UniteLayersRev = UniteLayersRev;\r\n                t.tpLayerTimelinesRev = tpLayerTimelinesRev;\r\n\r\n                init50Editor();\r\n                t.initAdvancedEditor();\r\n            }\r\n\r\n            //======================================================\r\n            //\tGeneral Functions\r\n            //======================================================\r\n\r\n            /**\r\n             * fill curFullClass with curActiveStyles\r\n             */\r\n            var updateCurFullClass = function(){\r\n                curFullClass[cssCurrentType] = curActiveStyles;\r\n            };\r\n\r\n\r\n            /**\r\n             * creates the padding & corner in 1 line\r\n             */\r\n            var filterCssPadCor = function(id){\r\n                var retObj = [];\r\n                var i = 0;\r\n                var found = 0;\r\n                jQuery(id).each(function(){\r\n                    retObj[i] = jQuery(this).val();\r\n                    if(retObj[i] != '') found++;\r\n                    i++;\r\n                });\r\n\r\n                switch(found){\r\n                    case 0:\r\n                        return false; //empty, no entrys found\r\n                        break;\r\n                    case 1:\r\n                        for(key in retObj) if (retObj.hasOwnProperty(key)) {\r\n                            if(retObj[key] != '') return retObj[key]+'px';\r\n                        }\r\n                        break;\r\n                    case 2:\r\n                        var checkVal = 0;\r\n                        for(key in retObj) if (retObj.hasOwnProperty(key)) {\r\n                            if(retObj[key] != '') checkVal+= parseInt(key);\r\n                        }\r\n\r\n                        switch(checkVal){\r\n                            case 1: // 1 1 x x\r\n                                return retObj[0]+'px '+retObj[1]+'px';\r\n                                break;\r\n                            case 2: // 1 x 1 x\r\n                                if(retObj[0] == retObj[2])\r\n                                    return retObj[0]+'px 0';\r\n                                else\r\n                                    return retObj[0]+'px 0 '+retObj[2]+'px';\r\n                                break;\r\n                            case 3: // 1 x x 1 || x 1 1 x\r\n                                if(retObj[0] != '')\r\n                                    return retObj[0]+'px '+retObj[3]+'px';\r\n                                else\r\n                                    return retObj[2]+'px '+retObj[1]+'px';\r\n                                break;\r\n                            case 4: // x 1 x 1\r\n                                if(retObj[1] == retObj[3])\r\n                                    return '0 '+retObj[1]+'px ';\r\n                                else\r\n                                    return '0 '+retObj[1]+'px 0 '+retObj[3]+'px';\r\n                            case 5: // x x 1 1\r\n                                return retObj[2]+'px '+retObj[3]+'px';\r\n                            default:\r\n                                return false;\r\n                        }\r\n                        break;\r\n                    case 3:\r\n                        if(retObj[3] != ''){\r\n                            for(key in retObj) if (retObj.hasOwnProperty(key)) {\r\n                                if(retObj[key] == '') retObj[key] = '0';\r\n                            }\r\n                        }\r\n                        return retObj[0]+'px '+retObj[1]+'px '+retObj[2]+'px';\r\n                        break;\r\n                    case 4:\r\n                    default:\r\n                        return retObj[0]+'px '+retObj[1]+'px '+retObj[2]+'px '+retObj[3]+'px';\r\n                        break;\r\n                }\r\n            }\r\n\r\n\r\n            /*****************\r\n             * Ver 5.0 changes\r\n             *****************/\r\n\r\n            var init50Editor = function(){\r\n                /**\r\n                 * new advanced style editor dialog\r\n                 **/\r\n                jQuery('.rev-advanced-css-idle, .rev-advanced-css-hover').click(function(){\r\n                    //check if layer is selected or not\r\n                    var sel_layer = t.UniteLayersRev.get_current_selected_layer();\r\n\r\n                    if(sel_layer === -1) return false;\r\n\r\n                    var clayer = t.UniteLayersRev.getCurrentLayer();\r\n\r\n                    if(clayer['hover'] !== true){\r\n                        jQuery('#change_acea_wrappers').hide();\r\n                    }else{\r\n                        jQuery('#change_acea_wrappers').show();\r\n                    }\r\n\r\n                    if(!t.checkIfHandleExists(jQuery('#layer_caption').val())){\r\n                        alert(rev_lang.please_select_first_an_existing_style);\r\n                        return false;\r\n                    }\r\n\r\n                    cur_editing = (jQuery(this).hasClass('rev-advanced-css-idle')) ? 'idle' : 'hover';\r\n\r\n                    jQuery('#dialog_advanced_css').dialog({\r\n                        modal:true,\r\n                        resizable:false,\r\n                        title:'Currently editing: '+jQuery('#layer_caption').val(),\r\n                        minWidth:700,\r\n                        minHeight:500,\r\n                        closeOnEscape:true,\r\n                        dialogClass:\"tpdialogs\",\r\n                        open:function () {\r\n                            jQuery('.current-advance-edited-class').text(jQuery('#layer_caption').val());\r\n\r\n                            jQuery(this).closest(\".ui-dialog\")\r\n                                .find(\".ui-button\").each(function(i) {\r\n                                var cl;\r\n                                if (i==0) cl=\"revgray\";\r\n                                if (i==1) cl=\"revgreen\";\r\n                                if (i==2) cl=\"revred\";\r\n                                if (i==3) cl=\"revred\";\r\n                                jQuery(this).addClass(cl).addClass(\"button-primary\").addClass(\"rev-uibuttons\");\r\n                            });\r\n\r\n                            if(g_codemirrorCssEditable != null) g_codemirrorCssEditable.refresh();\r\n                            if(g_codemirrorCssUneditable != null) g_codemirrorCssUneditable.refresh();\r\n\r\n                            t.setTemplateCssUneditable();\r\n                            t.setTemplateCssEditable();\r\n                        },\r\n                        buttons:{\r\n                            \"Save\":function(){\r\n                                t.saveTemplateStylesInDb();\r\n                                updateCurFullClass();\r\n                            },\r\n                            \"Cancel\":function(){\r\n                                jQuery(this).dialog(\"close\");\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n\r\n\r\n                /**\r\n                 * additional Layer CSS dialog\r\n                 **/\r\n                jQuery('.rev-advanced-css-idle-layer, .rev-advanced-css-hover-layer').click(function(){\r\n                    //check if layer is selected or not\r\n                    var sel_layer = t.UniteLayersRev.get_current_selected_layer();\r\n\r\n                    if(sel_layer === -1) return false;\r\n\r\n                    cur_editing = (jQuery(this).hasClass('rev-advanced-css-idle-layer')) ? 'idle' : 'hover';\r\n\r\n                    jQuery('#dialog_advanced_layer_css').dialog({\r\n                        modal:true,\r\n                        resizable:false,\r\n                        minWidth:700,\r\n                        minHeight:500,\r\n                        closeOnEscape:true,\r\n                        dialogClass:'tpdialogs',\r\n                        open:function () {\r\n                            //jQuery('.current-advance-edited-class').text(jQuery('#layer_caption').val());\r\n\r\n                            jQuery(this).closest(\".ui-dialog\")\r\n                                .find(\".ui-button\").each(function(i) {\r\n                                var cl;\r\n                                if (i==0) cl = \"revgray\";\r\n                                if (i==1) cl = \"revgreen\";\r\n                                if (i==2) cl = \"revred\";\r\n                                if (i==3) cl = \"revred\";\r\n                                jQuery(this).addClass(cl).addClass(\"button-primary\").addClass(\"rev-uibuttons\");\r\n                            });\r\n\r\n                            if(g_codemirrorCssLayer != null) g_codemirrorCssLayer.refresh();\r\n\r\n                            t.setTemplateCssLayer();\r\n                        },\r\n                        buttons:{\r\n                            \"Save\":function(){\r\n                                updateLayerCSS();\r\n                                jQuery(this).dialog(\"close\");\r\n                            },\r\n                            \"Cancel\":function(){\r\n                                jQuery(this).dialog(\"close\");\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n\r\n            }\r\n\r\n            jQuery(document).ready(function() {\r\n                jQuery('body').on('click','#change_ace_toidle',function() {\r\n                    if(confirm(rev_lang.save_changes)){\r\n                        updateLayerCSS();\r\n                    }\r\n                    cur_editing = \"idle\";\r\n                    t.setTemplateCssLayer();\r\n                });\r\n\r\n                jQuery('body').on('click','#change_ace_tohover',function() {\r\n                    if(confirm(rev_lang.save_changes)){\r\n                        updateLayerCSS();\r\n                    }\r\n                    cur_editing = \"hover\";\r\n                    t.setTemplateCssLayer();\r\n                });\r\n\r\n\r\n                jQuery('body').on('click','#change_acea_toidle',function() {\r\n                    if(confirm(rev_lang.save_changes)){\r\n                        t.saveTemplateStylesInDb();\r\n                        updateCurFullClass();\r\n                    }\r\n                    cur_editing = \"idle\";\r\n                    t.setTemplateCssUneditable();\r\n                    t.setTemplateCssEditable();\r\n                });\r\n\r\n                jQuery('body').on('click','#change_acea_tohover',function() {\r\n                    if(confirm(rev_lang.save_changes)){\r\n                        t.saveTemplateStylesInDb();\r\n                        updateCurFullClass();\r\n                    }\r\n                    cur_editing = \"hover\";\r\n                    t.setTemplateCssUneditable();\r\n                    t.setTemplateCssEditable();\r\n                });\r\n            });\r\n\r\n            t.initAdvancedEditor = function(){\r\n                g_codemirrorCssEditable = CodeMirror.fromTextArea(document.getElementById(\"textarea_advanced_css_editor\"), {\r\n                    onChange: function(){ },\r\n                    lineNumbers: true\r\n                });\r\n\r\n                g_codemirrorCssUneditable = CodeMirror.fromTextArea(document.getElementById(\"textarea_template_css_editor_uneditable\"), {\r\n                    onChange: function(){ },\r\n                    lineNumbers: true,\r\n                    readOnly: true\r\n                });\r\n\r\n                g_codemirrorCssLayer = CodeMirror.fromTextArea(document.getElementById(\"textarea_template_css_editor_layer\"), {\r\n                    onChange: function(){ },\r\n                    lineNumbers: true,\r\n                    readOnly: false\r\n                });\r\n            }\r\n\r\n\r\n            /**\r\n             * add Class name to the preview\r\n             * @since: 5.0\r\n             */\r\n            t.setPreviewTextClass = function(){\r\n                if(typeof(curFullClass['handle']) !== 'undefined'){\r\n                    var use_class = curFullClass['handle'].split('.');\r\n                    for(var key in use_class) if (use_class.hasOwnProperty(key)) {\r\n                        jQuery('#rev-example-style-layer').addClass(use_class[key]);\r\n                    }\r\n                }\r\n                jQuery('#rev-example-style-layer').parent().show();\r\n            }\r\n\r\n\r\n            /**\r\n             * remove all CSS classes and inline styles to clean the preview from all styling\r\n             * @since: 5.0\r\n             */\r\n            t.clearPreviewText = function(){\r\n                jQuery('#rev-example-style-layer').attr('style', '');\r\n                jQuery('#rev-example-style-layer').attr('class', '');\r\n            }\r\n\r\n\r\n            /**\r\n             * set template css from choosen css\r\n             * @since: 5.0\r\n             */\r\n            t.setTemplateCssUneditable = function(){\r\n                jQuery(\"#textarea_template_css_editor_uneditable\").val('');\r\n\r\n                var cssData = \"{\\n\";\r\n                setFullClass();\r\n\r\n                if (cur_editing===\"idle\")\r\n                    jQuery('.acsa_idle_or_hover').html(\"- IDLE\")\r\n                else\r\n                    jQuery('.acsa_idle_or_hover').html(\"- HOVER\");\r\n\r\n                if(cur_editing == 'idle' && typeof(curFullClass['params']) !== 'undefined'){\r\n                    curActiveStyles = curFullClass['params'];\r\n                }else if(cur_editing == 'hover' && typeof(curFullClass['hover']) !== 'undefined'){\r\n                    curActiveStyles = curFullClass['hover'];\r\n                }else{\r\n                    curActiveStyles = [];\r\n                }\r\n\r\n                if(!jQuery.isEmptyObject(curActiveStyles)){\r\n                    for(var key in common_styles) if (common_styles.hasOwnProperty(key)) {\r\n                        var the_style = '';\r\n\r\n                        switch(key){ //could add padding for example\r\n                            default:\r\n                                if(typeof(curActiveStyles[key]) === 'object'){\r\n                                    the_style = curActiveStyles[key].join(' ');\r\n                                }else{\r\n                                    the_style = curActiveStyles[key];\r\n                                }\r\n                                break;\r\n                        }\r\n\r\n                        if(the_style !== 'undefined' && the_style !== undefined && the_style !== '' && the_style !== 'none'){\r\n                            cssData += '\t'+key+': '+the_style+\";\\n\";\r\n                        }\r\n                    }\r\n                }\r\n\r\n                cssData += \"}\";\r\n\r\n                if(g_codemirrorCssUneditable != null){\r\n                    g_codemirrorCssUneditable.setValue(cssData);\r\n                }else{\r\n                    jQuery(\"#textarea_template_css_editor_uneditable\").val(cssData);\r\n                    t.initAdvancedEditor();\r\n                }\r\n                g_codemirrorCssUneditable.refresh();\r\n            }\r\n\r\n\r\n            /**\r\n             * set template css from choosen css which is editable (meaning advanced styles)\r\n             * @since: 5.0\r\n             */\r\n            t.setTemplateCssEditable = function(){\r\n                jQuery(\"#textarea_advanced_css_editor\").val('');\r\n\r\n                var cssData = \"{\\n\";\r\n                setFullClass();\r\n\r\n                if(cur_editing == 'idle' && typeof(curFullClass['advanced']) !== 'undefined' && typeof(curFullClass['advanced']['idle']) !== 'undefined'){\r\n                    var myStyles = jQuery.extend({},curFullClass['advanced']['idle']);\r\n                }else if(cur_editing == 'hover' && typeof(curFullClass['advanced']) !== 'undefined' && typeof(curFullClass['advanced']['hover']) !== 'undefined'){\r\n                    var myStyles = jQuery.extend({},curFullClass['advanced']['hover']);\r\n                }else{\r\n                    var myStyles = [];\r\n                }\r\n\r\n\r\n                for(var key in myStyles) if (myStyles.hasOwnProperty(key)) {\r\n                    var the_style = '';\r\n\r\n                    switch(key){\r\n                        default:\r\n                            if(typeof(myStyles[key]) === 'object'){\r\n                                the_style = myStyles[key].join(' ');\r\n                            }else{\r\n                                the_style = myStyles[key];\r\n                            }\r\n                            break;\r\n                    }\r\n\r\n\r\n                    if(the_style !== 'undefined' && the_style !== undefined && the_style !== ''){\r\n                        cssData += '\t'+key+': '+the_style+\";\\n\";\r\n                    }\r\n                }\r\n\r\n                cssData += \"}\";\r\n\r\n                if(g_codemirrorCssEditable != null){\r\n                    g_codemirrorCssEditable.setValue(cssData);\r\n                }else{\r\n                    jQuery(\"#textarea_advanced_css_editor\").val(cssData);\r\n                    t.initAdvancedEditor();\r\n                }\r\n                g_codemirrorCssEditable.refresh();\r\n            }\r\n\r\n\r\n            /**\r\n             * set layer inline css from choosen css which is editable\r\n             * @since: 5.0\r\n             */\r\n            t.setTemplateCssLayer = function(){\r\n                jQuery(\"#textarea_template_css_editor_layer\").val('');\r\n\r\n                var cssData = \"{\\n\";\r\n                setFullClass();\r\n\r\n                var layer = t.UniteLayersRev.getCurrentLayer();\r\n\r\n                if(layer === null) return false;\r\n\r\n                if (cur_editing===\"idle\")\r\n                    jQuery('#acs_idle_or_hover').html(\"- IDLE\")\r\n                else\r\n                    jQuery('#acs_idle_or_hover').html(\"- HOVER\");\r\n\r\n                if(layer)\r\n                    if(cur_editing == 'idle' && typeof(layer['inline']) !== 'undefined' && typeof(layer['inline']['idle']) !== 'undefined')\r\n                        var myStyles = jQuery.extend({},layer['inline']['idle']);\r\n                    else\r\n                    if(cur_editing == 'hover' && typeof(layer['inline']) !== 'undefined' && typeof(layer['inline']['hover']) !== 'undefined')\r\n\r\n                        var myStyles = jQuery.extend({},layer['inline']['hover']);\r\n                    else\r\n                        var myStyles = [];\r\n\r\n                for(var key in myStyles) if (myStyles.hasOwnProperty(key)) {\r\n                    var the_style = '';\r\n\r\n                    switch(key){\r\n                        default:\r\n                            if(typeof(myStyles[key]) === 'object'){\r\n                                the_style = myStyles[key].join(' ');\r\n                            }else{\r\n                                the_style = myStyles[key];\r\n                            }\r\n                            break;\r\n                    }\r\n\r\n\r\n                    if(the_style !== 'undefined' && the_style !== undefined && the_style !== ''){\r\n                        cssData += '\t'+key+': '+the_style+\";\\n\";\r\n                    }\r\n                }\r\n\r\n                cssData += \"}\";\r\n\r\n                if(g_codemirrorCssLayer != null){\r\n                    g_codemirrorCssLayer.setValue(cssData);\r\n                }else{\r\n                    jQuery(\"#textarea_template_css_editor_layer\").val(cssData);\r\n                    t.initAdvancedEditor();\r\n                }\r\n                g_codemirrorCssLayer.refresh();\r\n            }\r\n\r\n\r\n            /**\r\n             * save styles for class/create new class\r\n             * @since: 5.0\r\n             */\r\n            t.saveStylesInDb = function(handle, new_style, dialog_obj){\r\n                var data = {'idle':{},'hover':{}};\r\n\r\n                var layer = t.UniteLayersRev.getCurrentLayer();\r\n\r\n                data['handle'] = handle;\r\n\r\n                data['idle']['color'] = jQuery('input[name=\"color_static\"]').val();\r\n                data['idle']['color-transparency'] = jQuery('input[name=\"css_font-transparency\"]').val();\r\n                data['idle']['font-size'] = jQuery('input[name=\"font_size_static\"]').val();\r\n                data['idle']['line-height'] = jQuery('input[name=\"line_height_static\"]').val();\r\n                data['idle']['font-weight'] = jQuery('select[name=\"font_weight_static\"] option:selected').val();\r\n\r\n                data['idle']['font-style'] = (jQuery('input[name=\"css_font-style\"]').is(':checked')) ? 'italic' : 'normal';\r\n                data['idle']['font-family'] = jQuery('input[name=\"css_font-family\"]').val() ? jQuery('input[name=\"css_font-family\"]').val() : 'Arial';\r\n                data['idle']['text-decoration'] = jQuery('select[name=\"css_text-decoration\"] option:selected').val();\r\n\r\n                data['idle']['text-align'] = layer['text-align'];\r\n                data['idle']['margin'] = layer['margin'];\r\n                data['idle']['padding'] = layer['padding'];\r\n\r\n                data['idle']['background-color'] = jQuery('input[name=\"css_background-color\"]').val();\r\n                data['idle']['background-transparency'] = jQuery('input[name=\"css_background-transparency\"]').val();\r\n                data['idle']['border-color'] = jQuery('input[name=\"css_border-color-show\"]').val();\r\n                data['idle']['border-transparency'] = jQuery('input[name=\"css_border-transparency\"]').val();\r\n                data['idle']['border-style'] = jQuery('select[name=\"css_border-style\"] option:selected').val();\r\n                data['idle']['border-width'] = {};\r\n                jQuery('input[name=\"css_border-width[]\"]').each(function(i){ data['idle']['border-width'][i] = jQuery(this).val(); });\r\n                data['idle']['border-radius'] = {};\r\n                jQuery('input[name=\"css_border-radius[]\"]').each(function(i){ data['idle']['border-radius'][i] = jQuery(this).val();});\r\n                data['idle']['x'] = jQuery('input[name=\"layer__x\"]').val();\r\n                data['idle']['y'] = jQuery('input[name=\"layer__y\"]').val();\r\n                data['idle']['z'] = jQuery('input[name=\"layer__z\"]').val();\r\n                data['idle']['skewx'] = jQuery('input[name=\"layer__skewx\"]').val();\r\n                data['idle']['skewy'] = jQuery('input[name=\"layer__skewy\"]').val();\r\n                data['idle']['scalex'] = jQuery('input[name=\"layer__scalex\"]').val();\r\n                data['idle']['scaley'] = jQuery('input[name=\"layer__scaley\"]').val();\r\n                data['idle']['opacity'] = jQuery('input[name=\"layer__opacity\"]').val();\r\n                data['idle']['xrotate'] = jQuery('input[name=\"layer__xrotate\"]').val();\r\n                data['idle']['yrotate'] = jQuery('input[name=\"layer__yrotate\"]').val();\r\n                data['idle']['2d_rotation'] = jQuery('input[name=\"layer_2d_rotation\"]').val();\r\n                data['idle']['2d_origin_x'] = jQuery('input[name=\"layer_2d_origin_x\"]').val();\r\n                data['idle']['2d_origin_y'] = jQuery('input[name=\"layer_2d_origin_y\"]').val();\r\n                data['idle']['pers'] = jQuery('input[name=\"layer__pers\"]').val();\r\n                data['idle']['corner_left'] = jQuery('select[name=\"layer_cornerleft\"] option:selected').val();\r\n                data['idle']['corner_right'] = jQuery('select[name=\"layer_cornerright\"] option:selected').val();\r\n\r\n                data['idle']['parallax'] = jQuery('select[name=\"parallax_level\"] option:selected').val();\r\n\r\n\r\n                data['hover']['color'] = jQuery('input[name=\"hover_color_static\"]').val();\r\n                data['hover']['color-transparency'] = jQuery('input[name=\"hover_css_font-transparency\"]').val();\r\n                data['hover']['text-decoration'] = jQuery('select[name=\"hover_css_text-decoration\"] option:selected').val();\r\n                data['hover']['background-color'] = jQuery('input[name=\"hover_css_background-color\"]').val();\r\n                data['hover']['background-transparency'] = jQuery('input[name=\"hover_css_background-transparency\"]').val();\r\n                data['hover']['border-color'] = jQuery('input[name=\"hover_css_border-color-show\"]').val();\r\n                data['hover']['border-transparency'] = jQuery('input[name=\"hover_css_border-transparency\"]').val();\r\n                data['hover']['border-style'] = jQuery('select[name=\"hover_css_border-style\"] option:selected').val();\r\n                data['hover']['border-width'] = {};\r\n                jQuery('input[name=\"hover_css_border-width[]\"]').each(function(i){ data['hover']['border-width'][i] = jQuery(this).val(); });\r\n                data['hover']['border-radius'] = {};\r\n                jQuery('input[name=\"hover_css_border-radius[]\"]').each(function(i){ data['hover']['border-radius'][i] = jQuery(this).val(); });\r\n                data['hover']['opacity'] = jQuery('input[name=\"hover_layer__opacity\"]').val();\r\n                data['hover']['scalex'] = jQuery('input[name=\"hover_layer__scalex\"]').val();\r\n                data['hover']['scaley'] = jQuery('input[name=\"hover_layer__scaley\"]').val();\r\n                data['hover']['skewx'] = jQuery('input[name=\"hover_layer__skewx\"]').val();\r\n                data['hover']['skewy'] = jQuery('input[name=\"hover_layer__skewy\"]').val();\r\n                data['hover']['xrotate'] = jQuery('input[name=\"hover_layer__xrotate\"]').val();\r\n                data['hover']['yrotate'] = jQuery('input[name=\"hover_layer__yrotate\"]').val();\r\n                data['hover']['2d_rotation'] = jQuery('input[name=\"hover_layer_2d_rotation\"]').val(); //z rotate\r\n                data['hover']['css_cursor'] = jQuery('select[name=\"css_cursor\"] option:selected').val();\r\n\t\tdata['hover']['pointer_events'] = jQuery('select[name=\"pointer_events\"] option:selected').val();\r\n\r\n                data['hover']['speed'] = jQuery('input[name=\"hover_speed\"]').val();\r\n                data['hover']['easing'] = jQuery('select[name=\"hover_easing\"] option:selected').val();\r\n\r\n                layer = t.UniteLayersRev.getCurrentLayer();\r\n\r\n                data['settings'] = new Object;\r\n                data['settings']['hover'] = jQuery('input[name=\"hover_allow\"]').is(\":checked\");\r\n                data['settings']['type'] = layer.type;\r\n\r\n                data['advanced'] = {'idle':{},'hover':{}};\r\n\r\n                setFullClass();\r\n\r\n                if(typeof(curFullClass['advanced']) !== 'undefined'){\r\n                    if(typeof(curFullClass['advanced']['idle']) !== 'undefined') data['advanced']['idle'] = curFullClass['advanced']['idle'];\r\n                    if(typeof(curFullClass['advanced']['hover']) !== 'undefined') data['advanced']['hover'] = curFullClass['advanced']['hover'];\r\n                }\r\n\r\n                var donow = (new_style === true) ? 'insert_captions_css' : 'update_captions_css'; // ? create new : update existing\r\n\r\n                //make changes to database\r\n                UniteAdminRev.ajaxRequest(donow,data,function(response){\r\n\r\n                    t.UniteLayersRev.setCaptionClasses(response.arrCaptions);\r\n\r\n                    t.updateCaptionsInput(response.arrCaptions);\r\n\r\n                    t.setInitCssStylesObj(response.initstyles);\r\n\r\n                    if(response.compressed_css !== 'undefined'){\r\n                        t.refresh_css(response.compressed_css);\r\n                    }\r\n\r\n                    if(typeof(dialog_obj) !== 'undefined') dialog_obj.dialog('close');\r\n\r\n                    jQuery('#layer_caption').val(handle);\r\n                    jQuery('#layer_caption').change();\r\n                });\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * save styles for class/create new class\r\n             * @since: 5.0\r\n             */\r\n            t.saveTemplateStylesInDb = function(){\r\n                var data = {};\r\n\r\n                var handle = cssPreClass+'.'+jQuery('#layer_caption').val();\r\n                var cssData = g_codemirrorCssEditable.getValue();\r\n\r\n                while(cssData.indexOf(\"/*\") !== -1){\r\n                    if(cssData.indexOf(\"*/\") === -1) return false;\r\n                    var start = cssData.indexOf(\"/*\");\r\n                    var end = cssData.indexOf(\"*/\") + 2;\r\n                    cssData = cssData.replace(cssData.substr(start, end - start), '');\r\n                }\r\n\r\n                //delete all before the }\r\n                if(cssData.indexOf('{') > -1){\r\n                    var temp = cssData.substr(0,cssData.indexOf('{'));\r\n                    cssData = cssData.replace(temp, '');\r\n                }\r\n\r\n                //delete all after the }\r\n                if(cssData.indexOf('}') > -1){\r\n                    cssData = cssData.substr(0,cssData.indexOf('}'));\r\n                }\r\n\r\n                cssData = cssData.replace(/{/g, '').replace(/}/g, '').replace(/\t/g, '').replace(/\\n/g, '');\r\n\r\n                var rs_css = cssData.split(';');\r\n\r\n                var adv_styles = {};\r\n\r\n                for(var key in rs_css) if (rs_css.hasOwnProperty(key)) {\r\n                    if(jQuery.trim(rs_css[key]) == '') continue;\r\n                    var t_style = rs_css[key].split(':');\r\n                    if(t_style.length !== 2) continue;\r\n\r\n                    adv_styles[jQuery.trim(t_style[0])] = jQuery.trim(t_style[1]);\r\n                }\r\n\r\n                if(jQuery.isEmptyObject(adv_styles)) adv_styles = '';\r\n\r\n                data['handle'] = handle;\r\n                data['styles'] = adv_styles;\r\n                data['type'] = cur_editing;\r\n\r\n                UniteAdminRev.ajaxRequest(\"update_captions_advanced_css\",data,function(response){\r\n\r\n                    if(response.success !== false){\r\n                        //update html select (got as \"data\" from response)\r\n\r\n                        t.UniteLayersRev.setCaptionClasses(response.arrCaptions);\r\n\r\n                        t.updateCaptionsInput(response.arrCaptions);\r\n\r\n                        t.setInitCssStylesObj(response.initstyles);\r\n\r\n                        if(response.compressed_css !== 'undefined'){\r\n                            t.refresh_css(response.compressed_css);\r\n                        }\r\n\r\n                        //refresh initCSS\r\n                        curFullClass['advanced'][data['type']] = data['styles'];\r\n\r\n                        var id = t.checkIfHandleExists(jQuery('#layer_caption').val());\r\n\r\n                        t.updateInitCssStyles(jQuery('#layer_caption').val(), id);\r\n                    }\r\n                });\r\n\r\n            }\r\n\r\n\r\n            var updateLayerCSS = function(){\r\n                var layer = t.UniteLayersRev.getCurrentLayer();\r\n\r\n                if(layer === null) return false;\r\n\r\n                var data = {};\r\n\r\n                var cssData = g_codemirrorCssLayer.getValue();\r\n\r\n                while(cssData.indexOf(\"/*\") !== -1){\r\n                    if(cssData.indexOf(\"*/\") === -1) return false;\r\n                    var start = cssData.indexOf(\"/*\");\r\n                    var end = cssData.indexOf(\"*/\") + 2;\r\n                    cssData = cssData.replace(cssData.substr(start, end - start), '');\r\n                }\r\n\r\n                //delete all before the }\r\n                if(cssData.indexOf('{') > -1){\r\n                    var temp = cssData.substr(0,cssData.indexOf('{'));\r\n                    cssData = cssData.replace(temp, '');\r\n                }\r\n\r\n                //delete all after the }\r\n                if(cssData.indexOf('}') > -1){\r\n                    cssData = cssData.substr(0,cssData.indexOf('}'));\r\n                }\r\n\r\n                cssData = cssData.replace(/{/g, '').replace(/}/g, '').replace(/\t/g, '').replace(/\\n/g, '');\r\n\r\n                var rs_css = cssData.split(';');\r\n\r\n                var adv_styles = {};\r\n\r\n                for(var key in rs_css) if (rs_css.hasOwnProperty(key)) {\r\n                    if(jQuery.trim(rs_css[key]) == '') continue;\r\n                    var t_style = rs_css[key].split(':');\r\n                    if(t_style.length !== 2) continue;\r\n\r\n                    adv_styles[jQuery.trim(t_style[0])] = jQuery.trim(t_style[1]);\r\n                }\r\n\r\n                if(typeof(layer['inline']) === 'undefined') layer['inline'] = {};\r\n                if(typeof(layer['inline'][cur_editing]) === 'undefined') layer['inline'][cur_editing] = {};\r\n\r\n                layer['inline'][cur_editing] = adv_styles;\r\n\r\n                t.tpLayerTimelinesRev.rebuildLayerIdle(jQuery('.slide_layer.layer_selected'));\r\n                //refresh building of layer css\r\n            }\r\n\r\n            /**\r\n             * rename class name in database with a new one\r\n             * @since: 5.0\r\n             */\r\n            t.renameStylesInDb = function(old_name, new_name){\r\n\r\n                var data = {};\r\n\r\n                data.old_name = old_name;\r\n                data.new_name = new_name;\r\n\r\n                UniteAdminRev.ajaxRequest(\"rename_captions_css\",data,function(response){\r\n\r\n                    t.UniteLayersRev.setCaptionClasses(response.arrCaptions);\r\n\r\n                    //update html select (got as \"data\" from response)\r\n                    t.updateCaptionsInput(response.arrCaptions);\r\n\r\n\r\n                    t.setInitCssStylesObj(response.initstyles);\r\n\r\n                    if(response.compressed_css !== 'undefined'){\r\n                        t.refresh_css(response.compressed_css);\r\n                    }\r\n\r\n                    var objUpdate = {};\r\n                    objUpdate.style = new_name;\r\n\r\n                    var layers = t.UniteLayersRev.getSimpleLayers();\r\n\r\n                    for(var key in layers) if (layers.hasOwnProperty(key)) {\r\n                        if(layers[key].style == old_name){\r\n                            t.UniteLayersRev.updateLayer(key, objUpdate);\r\n                        }\r\n                    }\r\n\r\n                    jQuery('#layer_caption').val(new_name);\r\n                    jQuery('#layer_caption').change();\r\n\r\n                    jQuery('#dialog_rename_css').dialog('close');\r\n\r\n                });\r\n\r\n                t.updateInitCssStyles(old_name, -1); //-1 is for ignore\r\n\r\n                curFullClass = new Object;\r\n                curActiveStyles = new Object;\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * delete class from db if exists\r\n             */\r\n            t.deleteStylesInDb = function(handle, id){\r\n                UniteAdminRev.setErrorMessageID(\"dialog_error_message\");\r\n\r\n                UniteAdminRev.ajaxRequest(\"delete_captions_css\",handle,function(response){\r\n\r\n                    t.UniteLayersRev.setCaptionClasses(response.arrCaptions);\r\n\r\n                    //update html select (got as \"data\" from response)\r\n                    t.updateCaptionsInput(response.arrCaptions);\r\n\r\n                    t.setInitCssStylesObj(response.initstyles);\r\n\r\n                    if(response.compressed_css !== 'undefined'){\r\n                        t.refresh_css(response.compressed_css);\r\n                    }\r\n                });\r\n\r\n                t.updateInitCssStyles(handle, id, true);\r\n\r\n                jQuery('#layer_caption').val('');\r\n\r\n                curFullClass = new Object;\r\n                curActiveStyles = new Object;\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * fill temp class with init class if found\r\n             */\r\n            var setFullClass = function(){\r\n                curFullClass = new Object;\r\n\r\n                for(var key in initCssStyles) if (initCssStyles.hasOwnProperty(key)) {\r\n                    if(initCssStyles[key]['handle'] == cssPreClass+'.'+jQuery(\"#layer_caption\").val()){\r\n                        curFullClass = jQuery.extend({},initCssStyles[key]);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n\r\n            /**\r\n             * check if class exists and return index\r\n             */\r\n            t.checkIfHandleExists = function(handle){\r\n                for(var key in initCssStyles) if (initCssStyles.hasOwnProperty(key)) {\r\n                    if(initCssStyles[key]['handle'] == cssPreClass+'.'+handle){\r\n                        return key;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n\r\n            /**\r\n             * update the select html, set selected option, and update events.\r\n             */\r\n            t.updateCaptionsInput = function(arrCaptions){\r\n                layer = t.UniteLayersRev.getCurrentLayer();\r\n\r\n                var use_captions = [];\r\n\r\n                if(layer !== false){\r\n                    switch(layer.type){\r\n                        case 'image':\r\n                            //add image classes\r\n                            for(var key in arrCaptions) if (arrCaptions.hasOwnProperty(key)) {\r\n                                if(arrCaptions[key]['type'] == 'image'){\r\n                                    use_captions.push(arrCaptions[key]);\r\n                                }\r\n                            }\r\n                            break;\r\n                        case 'button':\r\n                            //add button classes\r\n                            for(var key in arrCaptions) if (arrCaptions.hasOwnProperty(key)) {\r\n                                if(arrCaptions[key]['type'] == 'button'){\r\n                                    use_captions.push(arrCaptions[key]);\r\n                                }\r\n                            }\r\n                            break;\r\n                        case 'shape':\r\n                            //add shape classes\r\n                            for(var key in arrCaptions) if (arrCaptions.hasOwnProperty(key)) {\r\n                                if(arrCaptions[key]['type'] == 'shape'){\r\n                                    use_captions.push(arrCaptions[key]);\r\n                                }\r\n                            }\r\n                            break;\r\n                        default:\r\n                            //add all except button and shape\r\n                            for(var key in arrCaptions) if (arrCaptions.hasOwnProperty(key)) {\r\n                                if(arrCaptions[key]['type'] == 'text'){\r\n                                    use_captions.push(arrCaptions[key]);\r\n                                }\r\n                            }\r\n                            break;\r\n                    }\r\n                }\r\n\r\n                jQuery(\"#layer_caption\").catcomplete(\"option\",\"source\",use_captions);\r\n            }\r\n\r\n            /**\r\n             * update css object with new values\r\n             */\r\n            t.updateInitCssStyles = function(handle, id, doDelete){\r\n                var key = false;\r\n\r\n                for(var i in initCssStyles) if (initCssStyles.hasOwnProperty(i)) {\r\n                    if(initCssStyles[i]['handle'] == cssPreClass+'.'+handle){\r\n                        key = i;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                if(typeof doDelete !== 'undefined'){\r\n                    delete initCssStyles[key];\r\n                    return true;\r\n                }\r\n\r\n                if(key === false) key = initCssStyles.length;\r\n\r\n                if(id === false){\r\n                    id = initCssStyles.length;\r\n                    initCssStyles[key] = new Object;\r\n                    initCssStyles[key]['id'] = id;\r\n                    initCssStyles[key]['handle'] = cssPreClass+'.'+handle;\r\n                    initCssStyles[key]['params'] = [];\r\n                    initCssStyles[key]['hover'] = [];\r\n                    initCssStyles[key]['settings'] = [];\r\n                    initCssStyles[key]['advanced'] = {'hover':{},'idle':{}};\r\n                }\r\n\r\n                initCssStyles[key]['params'] = curFullClass['params'];\r\n                initCssStyles[key]['hover'] = curFullClass['hover'];\r\n                initCssStyles[key]['advanced'] = curFullClass['advanced'];\r\n                if(typeof(initCssStyles[key]['settings']) == 'undefined')\r\n                    initCssStyles[key]['settings'] = new Object;\r\n\r\n                initCssStyles[key]['settings']['hover'] = isHoverActive;\r\n\r\n                return initCssStyles[key];\r\n            }\r\n\r\n\r\n            t.refresh_css = function(compressed_css){\r\n                var remstyles = jQuery('#rs-inline-captions-css');\r\n                if(remstyles.is('style')){\r\n                    remstyles.html(compressed_css);\r\n                }\r\n            }\r\n\r\n\r\n            t.getStyleSettingsByHandle = function(handle){\r\n                for(var key in initCssStyles) if (initCssStyles.hasOwnProperty(key)) {\r\n                    if(initCssStyles[key]['handle'] == cssPreClass+'.'+handle){\r\n                        return initCssStyles[key];\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n\r\n\r\n            t.set_state = function(obj, handle, selector, def,  type, value){\r\n\r\n                if(value === undefined){\r\n                    switch(type){\r\n                        case 'select':\r\n                            value = jQuery(selector+' option:selected').val();\r\n                            break;\r\n                        case 'multi':\r\n                            value = {};\r\n                            jQuery(selector).each(function(i){\r\n                                value[i] = jQuery(this).val();\r\n                            });\r\n                            break;\r\n                        default:\r\n                            value = jQuery(selector).val();\r\n                            break;\r\n                    }\r\n                }\r\n\r\n                //check if suffix is available, if yes, check both\r\n                var suffix = '';\r\n                if(typeof(jQuery(selector).data('suffix')) !== 'undefined') suffix = jQuery(selector).data('suffix');\r\n                if(typeof(obj[handle]) === 'undefined'){ //check if default value, if not then do differentthandefault\r\n                    //check def with value\r\n                    if(def == value || def+suffix == value){\r\n                        jQuery(selector).removeClass('differentthandefault');\r\n                        jQuery(selector).css('color', '#777');\r\n                    }else{\r\n                        jQuery(selector).addClass('differentthandefault');\r\n                        //jQuery(selector).css('color', '#F00');\r\n                    }\r\n                    if(typeof(def) === 'object'){ //if object\r\n                        var def_s = '';\r\n                        var val_s = '';\r\n                        var val_su = '';\r\n                        for(var key in def) if (def.hasOwnProperty(key)) {\r\n                            if(def[key] == '') continue;\r\n                            def_s += def[key]+suffix;\r\n                        }\r\n                        for(var key in value) if (value.hasOwnProperty(key)) {\r\n                            if(value[key] == '') continue;\r\n                            val_s += value[key];\r\n                            val_su += value[key]+suffix;\r\n                        }\r\n\r\n                        if(def_s===val_s || def_s===val_su){ //check again since its object\r\n                            jQuery(selector).removeClass('differentthandefault');\r\n                            jQuery(selector).css('color', '#777');\r\n                        }\r\n                    }\r\n\r\n                }else if(typeof(obj[handle]) === 'object'){\r\n                    var def_s = '';\r\n                    var val_s = '';\r\n                    var val_su = '';\r\n                    for(var key in obj[handle]) if (obj[handle].hasOwnProperty(key)) {\r\n                        if(obj[handle][key] == '') continue;\r\n                        def_s += obj[handle][key]+suffix;\r\n                    }\r\n                    for(var key in value) if (value.hasOwnProperty(key)) {\r\n                        if(value[key] == '') continue;\r\n                        val_s += value[key];\r\n                        val_su += value[key]+suffix;\r\n                    }\r\n                    if(def_s===val_s || def_s===val_su){ //check again since its object\r\n                        jQuery(selector).removeClass('differentthandefault');\r\n                        jQuery(selector).css('color', '#777');\r\n                    }else{\r\n                        jQuery(selector).addClass('differentthandefault');\r\n                        //jQuery(selector).css('color', '#F00');\r\n                    }\r\n                }else if(obj[handle] !== value && obj[handle]+suffix !== value){\r\n                    if(typeof(value) === 'object'){\r\n\r\n                        var cval = obj[handle].split(' ');\r\n                        var tempvar = '';\r\n                        switch(cval.length){\r\n                            case 1:\r\n                                tempvar = cval[0]+cval[0]+cval[0]+cval[0];\r\n                                break;\r\n                            case 2:\r\n                                tempvar = cval[0]+cval[1]+cval[0]+cval[1];\r\n                                break;\r\n                            case 3:\r\n                                tempvar = cval[0]+cval[1]+cval[2]+cval[1];\r\n                                break;\r\n                        }\r\n\r\n                        val_s = '';\r\n                        val_su = '';\r\n                        for(var key in value) if (value.hasOwnProperty(key)) {\r\n                            if(value[key] == '') continue;\r\n                            val_s += value[key];\r\n                            val_su += value[key]+suffix;\r\n                        }\r\n\r\n                        if(tempvar == val_s || tempvar == val_su){\r\n                            jQuery(selector).removeClass('differentthandefault');\r\n                            jQuery(selector).css('color', '#777');\r\n                        }else{\r\n                            jQuery(selector).addClass('differentthandefault');\r\n                            //jQuery(selector).css('color', '#F00');\r\n                        }\r\n                    }else{\r\n                        jQuery(selector).addClass('differentthandefault');\r\n                        //jQuery(selector).css('color', '#F00');\r\n                    }\r\n\r\n                }else{\r\n                    jQuery(selector).removeClass('differentthandefault');\r\n                    jQuery(selector).css('color', '#777');\r\n                }\r\n\r\n            }\r\n\r\n\r\n            /**\r\n             * Compare current CSS settings to original settings and point out the differences\r\n             */\r\n            t.compare_to_original = function(){\r\n                var original_handle = jQuery('#layer_caption').val();\r\n\r\n                orig_styles = t.getStyleSettingsByHandle(original_handle);\r\n\r\n                if(orig_styles === false) return false; //maybe set all to be different state?\r\n\r\n                if(typeof(orig_styles['params']) !== 'undefined'){\r\n                    var idle = orig_styles['params'];\r\n                    var italic = jQuery('input[name=\"css_font-style\"]').is(':checked') ? 'italic' : 'normal';\r\n                    t.set_state(idle, 'color-transparency', 'input[name=\"css_font-transparency\"]', '1');\r\n                    t.set_state(idle, 'font-style', 'input[name=\"css_font-style\"]', 'normal', 'checkbox', italic);\r\n                    t.set_state(idle, 'font-family', 'input[name=\"css_font-family\"]', '');\r\n                    t.set_state(idle, 'padding', 'input[name=\"css_padding[]\"]', {0:'0', 1:'0', 2:'0', 3:'0'}, 'multi');\r\n                    t.set_state(idle, 'text-decoration', 'select[name=\"css_text-decoration\"]', 'none', 'select');\r\n                    t.set_state(idle, 'background-color', 'input[name=\"css_background-color\"]', 'transparent');\r\n                    t.set_state(idle, 'background-transparency', 'input[name=\"css_background-transparency\"]', '1');\r\n                    t.set_state(idle, 'border-color', 'input[name=\"css_border-color-show\"]', 'transparent');\r\n                    t.set_state(idle, 'border-transparency', 'input[name=\"css_border-transparency\"]', '1');\r\n                    t.set_state(idle, 'border-style', 'select[name=\"css_border-style\"]', 'none', 'select');\r\n                    t.set_state(idle, 'border-width', 'input[name=\"css_border-width\"]', '0');\r\n                    t.set_state(idle, 'border-radius', 'input[name=\"css_border-radius[]\"]', {0:'0', 1:'0', 2:'0', 3:'0'}, 'multi');\r\n                    t.set_state(idle, 'x', 'input[name=\"layer__x\"]', '0');\r\n                    t.set_state(idle, 'y', 'input[name=\"layer__y\"]', '0');\r\n                    t.set_state(idle, 'z', 'input[name=\"layer__z\"]', '0');\r\n                    t.set_state(idle, 'skewx', 'input[name=\"layer__skewx\"]', '0');\r\n                    t.set_state(idle, 'skewy', 'input[name=\"layer__skewy\"]', '0');\r\n                    t.set_state(idle, 'scalex', 'input[name=\"layer__scalex\"]', '1');\r\n                    t.set_state(idle, 'scaley', 'input[name=\"layer__scaley\"]', '1');\r\n                    t.set_state(idle, 'opacity', 'input[name=\"layer__opacity\"]', '1');\r\n                    t.set_state(idle, 'xrotate', 'input[name=\"layer__xrotate\"]', '0');\r\n                    t.set_state(idle, 'yrotate', 'input[name=\"layer__yrotate\"]', '0');\r\n                    t.set_state(idle, '2d_rotation', 'input[name=\"layer_2d_rotation\"]', '0');\r\n                    t.set_state(idle, '2d_origin_x', 'input[name=\"layer_2d_origin_x\"]', '50');\r\n                    t.set_state(idle, '2d_origin_y', 'input[name=\"layer_2d_origin_y\"]', '50');\r\n                    t.set_state(idle, 'pers', 'input[name=\"layer__pers\"]', '600');\r\n                    t.set_state(idle, 'corner_left', 'select[name=\"layer_cornerleft\"]', 'nothing', 'select');\r\n                    t.set_state(idle, 'corner_right', 'select[name=\"layer_cornerright\"]', 'nothing', 'select');\r\n                }\r\n\r\n                if(typeof(orig_styles['hover']) !== 'undefined' && !jQuery.isEmptyObject(orig_styles['hover'])){\r\n                    var hover = orig_styles['hover'];\r\n\r\n\r\n                    t.set_state(hover, 'color', 'input[name=\"hover_color_static\"]');\r\n                    t.set_state(hover, 'color-transparency', 'input[name=\"hover_css_font-transparency\"]', '1');\r\n                    t.set_state(hover, 'text-decoration', 'select[name=\"hover_css_text-decoration\"]', 'none', 'select');\r\n                    t.set_state(hover, 'background-color', 'input[name=\"hover_css_background-color\"]', 'transparent');\r\n                    t.set_state(hover, 'background-transparency', 'input[name=\"hover_css_background-transparency\"]', '1');\r\n                    t.set_state(hover, 'border-color', 'input[name=\"hover_css_border-color-show\"]', 'transparent');\r\n                    t.set_state(hover, 'border-transparency', 'input[name=\"hover_css_border-transparency\"]', '1');\r\n                    t.set_state(hover, 'border-style', 'select[name=\"hover_css_border-style\"]', 'none', 'select');\r\n                    t.set_state(hover, 'border-width', 'input[name=\"hover_css_border-width\"]', '0', 'select');\r\n                    t.set_state(hover, 'border-radius', 'input[name=\"hover_css_border-radius[]\"]', {0:'0', 1:'0', 2:'0', 3:'0'}, 'multi');\r\n\r\n                    t.set_state(hover, 'skewx', 'input[name=\"hover_layer__skewx\"]', '0');\r\n                    t.set_state(hover, 'skewy', 'input[name=\"hover_layer__skewy\"]', '0');\r\n                    t.set_state(hover, 'scalex', 'input[name=\"hover_layer__scalex\"]', '1');\r\n                    t.set_state(hover, 'scaley', 'input[name=\"hover_layer__scaley\"]', '1');\r\n                    t.set_state(hover, 'opacity', 'input[name=\"hover_layer__opacity\"]', '1');\r\n                    t.set_state(hover, 'xrotate', 'input[name=\"hover_layer__xrotate\"]', '0');\r\n                    t.set_state(hover, 'yrotate', 'input[name=\"hover_layer__yrotate\"]', '0');\r\n                    t.set_state(hover, '2d_rotation', 'input[name=\"hover_layer_2d_rotation\"]', '0');\r\n                    t.set_state(hover, 'css_cursor', 'select[name=\"css_cursor\"]', 'auto', 'select');\r\n                    t.set_state(hover, 'pointer_events', 'select[name=\"pointer_events\"]', 'auto', 'select');\r\n\r\n                    t.set_state(hover, 'speed', 'input[name=\"hover_speed\"]', '0');\r\n                    t.set_state(hover, 'easing', 'select[name=\"hover_easing\"]', '50', 'select');\r\n                }\r\n\r\n                return true;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return UniteCssEditorRev;\r\n    }\r\n);","Nwdthemes_Revslider/admin/assets/js/source/rev_addon-admin.js":"\r\n(function( $ ) {\r\n\t$(document).ready(function(){\r\n\t\t//hover toggles buttons\r\n\r\n\r\n\t\t//click event to install plugin\r\n\t\t\t$(\".rs-addon-not-installed\").click(function(){\r\n\t\t\t\tshowWaitAMinute({fadeIn:300,text:rev_slider_addon.please_wait_a_moment});\r\n\t\t\t\t$this = $(this);\r\n\t\t\t\t//console.log(\"install process\");\r\n\t\t\t\t$.ajax({\r\n\t\t\t\turl : rev_slider_addon.ajax_url,\r\n\t\t\t\ttype : 'post',\r\n\t\t\t\tdata : {\r\n\t\t\t\t\taction : 'install_plugin',\r\n\t\t\t\t\tnonce: \t$('#ajax_rev_slider_addon_nonce').text(),// The security nonce\r\n                    form_key:window.FORM_KEY,\r\n\t\t\t\t\tplugin: $this.data(\"plugin\")\r\n\t\t\t\t},\r\n\t\t\t\tsuccess : function( response ) {\r\n\t\t\t\t\tswitch(response){\r\n\t\t\t\t\t\tcase \"0\":\r\n                                showWaitAMinute({fadeOut:300,text:rev_slider_addon.please_wait_a_moment});\r\n                                UniteAdminRev.showErrorMessage(\"Something went wrong!\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"1\":\r\n\t\t\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"-1\":\r\n                                showWaitAMinute({fadeOut:300,text:rev_slider_addon.please_wait_a_moment});\r\n                                UniteAdminRev.showErrorMessage(\"Nonce missing!\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror : function ( response ){\r\n                    showWaitAMinute({fadeOut:300,text:rev_slider_addon.please_wait_a_moment});\r\n                    UniteAdminRev.showErrorMessage(\"Something went wrong!\");\r\n\t\t\t\t}\r\n\t\t\t}); // End Ajax\r\n\t\t}); // End Click\r\n\r\n\t\t//click event to activate plugin\r\n\t\t\t$(\".rs-addon-not-activated\").click(function(){\r\n\t\t\t\tshowWaitAMinute({fadeIn:300,text:rev_slider_addon.please_wait_a_moment});\r\n\t\t\t\t\r\n\t\t\t\t$this = $(this);\r\n\t\t\t\t$.ajax({\r\n\t\t\t\turl : rev_slider_addon.ajax_url,\r\n\t\t\t\ttype : 'post',\r\n\t\t\t\tdata : {\r\n\t\t\t\t\taction : 'activate_plugin',\r\n\t\t\t\t\tnonce: \t$('#ajax_rev_slider_addon_nonce').text(),// The security nonce\r\n                    form_key:window.FORM_KEY,\r\n\t\t\t\t\tplugin: $this.data(\"plugin\")\r\n\t\t\t\t},\r\n\t\t\t\tsuccess : function( response ) {\r\n\t\t\t\t\tswitch(response){\r\n\t\t\t\t\t\tcase \"0\":\r\n\t\t\t\t\t\t\t\tconsole.log(\"Something Went Wrong\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"1\":\r\n\t\t\t\t\t\t\t\tconsole.log(\"Plugin activated\");\r\n\t\t\t\t\t\t\t\t location.reload();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"-1\":\r\n\t\t\t\t\t\t\t\tconsole.log(\"Nonce missing\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror : function ( response ){\r\n\t\t\t\t\tconsole.log('Ajax Error');\r\n\t\t\t\t}\r\n\t\t\t}); // End Ajax\r\n\t\t}); // End Click\r\n\r\n\t\t//click event to deactivate plugin\r\n\t\t$(\".rs-dash-deactivate-addon\").click(function(){\r\n\t\t\t\tshowWaitAMinute({fadeIn:300,text:rev_slider_addon.please_wait_a_moment});\r\n\t\t\t\t$this = $(this);\r\n\t\t\t\t$.ajax({\r\n\t\t\t\turl : rev_slider_addon.ajax_url,\r\n\t\t\t\ttype : 'post',\r\n\t\t\t\tdata : {\r\n\t\t\t\t\taction : 'deactivate_plugin',\r\n\t\t\t\t\tnonce: \t$('#ajax_rev_slider_addon_nonce').text(),// The security nonce\r\n                    form_key:window.FORM_KEY,\r\n\t\t\t\t\tplugin: $this.data(\"plugin\")\r\n\t\t\t\t},\r\n\t\t\t\tsuccess : function( response ) {\r\n\t\t\t\t\tswitch(response){\r\n\t\t\t\t\t\tcase \"0\":\r\n\t\t\t\t\t\t\t\tconsole.log(\"Something Went Wrong\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"1\":\r\n\t\t\t\t\t\t\t\tconsole.log(\"Plugin deactivated\");\r\n\t\t\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"-1\":\r\n\t\t\t\t\t\t\t\tconsole.log(\"Nonce missing\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror : function ( response ){\r\n\t\t\t\t}\r\n\t\t\t}); // End Ajax\r\n\t\t}); // End Click\r\n\t});// End Document ready\r\n\r\n})( jQuery );\r\n\r\n\r\nif (showWaitAMinute===undefined)\r\n\tfunction showWaitAMinute(obj) {\r\n\t\tvar wm = jQuery('#waitaminute');\r\n\t\t// SHOW AND HIDE WITH DELAY\r\n\t\tif (obj.delay!=undefined) {\r\n\r\n\t\t\tpunchgs.TweenLite.to(wm,0.3,{autoAlpha:1,ease:punchgs.Power3.easeInOut});\r\n\t\t\tpunchgs.TweenLite.set(wm,{display:\"block\"});\r\n\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tpunchgs.TweenLite.to(wm,0.3,{autoAlpha:0,ease:punchgs.Power3.easeInOut,onComplete:function() {\r\n\t\t\t\t\tpunchgs.TweenLite.set(wm,{display:\"block\"});\r\n\t\t\t\t}});\r\n\t\t\t},obj.delay)\r\n\t\t}\r\n\r\n\t\t// SHOW IT\r\n\t\tif (obj.fadeIn != undefined) {\r\n\t\t\tpunchgs.TweenLite.to(wm,obj.fadeIn/1000,{autoAlpha:1,ease:punchgs.Power3.easeInOut});\r\n\t\t\tpunchgs.TweenLite.set(wm,{display:\"block\"});\r\n\t\t}\r\n\r\n\t\t// HIDE IT\r\n\t\tif (obj.fadeOut != undefined) {\r\n\r\n\t\t\tpunchgs.TweenLite.to(wm,obj.fadeOut/1000,{autoAlpha:0,ease:punchgs.Power3.easeInOut,onComplete:function() {\r\n\t\t\t\t\tpunchgs.TweenLite.set(wm,{display:\"block\"});\r\n\t\t\t\t}});\r\n\t\t}\r\n\r\n\t\t// CHANGE TEXT\r\n\t\tif (obj.text != undefined) {\r\n\t\t\tswitch (obj.text) {\r\n\t\t\t\tcase \"progress1\":\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\twm.html('<div class=\"waitaminute-message\"><i class=\"eg-icon-emo-coffee\"></i><br>'+obj.text+'</div>');\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n"}
}});
